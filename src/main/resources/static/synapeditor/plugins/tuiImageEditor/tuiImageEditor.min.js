/*! For license information please see tuiImageEditor.min.js.LICENSE */
!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1204)}({1140:function(e,t,n){"use strict";var i=s(n(1141)),r=s(n(1142)),o=s(n(1152));n(1153),n(1154);var a=n(486);function s(e){return e&&e.__esModule?e:{default:e}}var l='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs>\n        <circle id="a" cx="16" cy="16" r="16"/>\n    </defs><symbol id="icon-a-ic-apply" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path stroke="#434343" d="M4 12.011l5 5L20.011 6"/>\n    </g>\n</symbol><symbol id="icon-a-ic-cancel" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path stroke="#434343" d="M6 6l12 12M18 6L6 18"/>\n    </g>\n</symbol><symbol id="icon-a-ic-color-transparent-w" viewBox="0 0 32 32">\n    \n    <g fill="none" fill-rule="evenodd">\n        <g>\n            <use fill="#FFF" xlink:href="#a"/>\n            <circle cx="16" cy="16" r="15.5" stroke="#D5D5D5"/>\n        </g>\n        <path stroke="#FF4040" stroke-width="1.5" d="M27 5L5 27"/>\n    </g>\n</symbol><symbol id="icon-a-ic-crop" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#434343" d="M4 0h1v20a1 1 0 0 1-1-1V0zM20 17h-1V5h1v12zm0 2v5h-1v-5h1z"/>\n        <path fill="#434343" d="M5 19h19v1H5zM4.762 4v1H0V4h4.762zM7 4h12a1 1 0 0 1 1 1H7V4z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-delete-all" viewBox="0 0 24 24">\n    <g fill="#434343" fill-rule="evenodd">\n        <path d="M5 23H3a1 1 0 0 1-1-1V6h1v16h2v1zm16-10h-1V6h1v7zM9 13H8v-3h1v3zm3 0h-1v-3h1v3zm3 0h-1v-3h1v3zM14.794 3.794L13 2h-3L8.206 3.794A.963.963 0 0 1 8 2.5l.703-1.055A1 1 0 0 1 9.535 1h3.93a1 1 0 0 1 .832.445L15 2.5a.965.965 0 0 1-.206 1.294zM14.197 4H8.803h5.394z"/>\n        <path d="M0 3h23v1H0zM11.286 21H8.714L8 23H7l1-2.8V20h.071L9.5 16h1l1.429 4H12v.2l1 2.8h-1l-.714-2zm-.357-1L10 17.4 9.071 20h1.858zM20 22h3v1h-4v-7h1v6zm-5 0h3v1h-4v-7h1v6z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-delete" viewBox="0 0 24 24">\n    <g fill="#434343" fill-rule="evenodd">\n        <path d="M3 6v16h17V6h1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6h1zM14.794 3.794L13 2h-3L8.206 3.794A.963.963 0 0 1 8 2.5l.703-1.055A1 1 0 0 1 9.535 1h3.93a1 1 0 0 1 .832.445L15 2.5a.965.965 0 0 1-.206 1.294zM14.197 4H8.803h5.394z"/>\n        <path d="M0 3h23v1H0zM8 10h1v6H8v-6zm3 0h1v6h-1v-6zm3 0h1v6h-1v-6z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-draw-free" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" d="M2.5 20.929C2.594 10.976 4.323 6 7.686 6c5.872 0 2.524 19 7.697 19s1.89-14.929 6.414-14.929 1.357 10.858 5.13 10.858c1.802 0 2.657-2.262 2.566-6.786"/>\n    </g>\n</symbol><symbol id="icon-a-ic-draw-line" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" d="M2 15.5h28"/>\n    </g>\n</symbol><symbol id="icon-a-ic-draw" viewBox="0 0 24 24">\n    <g fill="none">\n        <path stroke="#434343" d="M2.5 21.5H5c.245 0 .48-.058.691-.168l.124-.065.14.01c.429.028.85-.127 1.16-.437L22.55 5.405a.5.5 0 0 0 0-.707l-3.246-3.245a.5.5 0 0 0-.707 0L3.162 16.888a1.495 1.495 0 0 0-.437 1.155l.01.14-.065.123c-.111.212-.17.448-.17.694v2.5z"/>\n        <path fill="#434343" d="M16.414 3.707l3.89 3.89-.708.706-3.889-3.889z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-filter" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#434343" d="M12 7v1H2V7h10zm6 0h4v1h-4V7zM12 16v1h10v-1H12zm-6 0H2v1h4v-1z"/>\n        <path fill="#434343" d="M8.5 20a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7zm0-1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zM15.5 11a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7zm0-1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-flip-reset" viewBox="0 0 31 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M31 0H0v32h31z"/>\n        <path fill="#434343" d="M28 16a8 8 0 0 1-8 8H3v-1h1v-7H3a8 8 0 0 1 8-8h17v1h-1v7h1zM11 9a7 7 0 0 0-7 7v7h16a7 7 0 0 0 7-7V9H11z"/>\n        <path stroke="#434343" stroke-linecap="square" d="M24 5l3.5 3.5L24 12M7 20l-3.5 3.5L7 27"/>\n    </g>\n</symbol><symbol id="icon-a-ic-flip-x" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M32 32H0V0h32z"/>\n        <path fill="#434343" d="M17 32h-1V0h1zM27.167 11l.5 3h-1.03l-.546-3h1.076zm-.5-3h-1.122L25 5h-5V4h5.153a1 1 0 0 1 .986.836L26.667 8zm1.5 9l.5 3h-.94l-.545-3h.985zm1 6l.639 3.836A1 1 0 0 1 28.819 28H26v-1h3l-.726-4h.894zM23 28h-3v-1h3v1zM13 4v1H7L3 27h10v1H3.18a1 1 0 0 1-.986-1.164l3.666-22A1 1 0 0 1 6.847 4H13z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-flip-y" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0v32h32V0z"/>\n        <path fill="#434343" d="M0 16v1h32v-1zM11 27.167l3 .5v-1.03l-3-.546v1.076zm-3-.5v-1.122L5 25v-5H4v5.153a1 1 0 0 0 .836.986L8 26.667zm9 1.5l3 .5v-.94l-3-.545v.985zm6 1l3.836.639A1 1 0 0 0 28 28.82V26h-1v3l-4-.727v.894zM28 23v-3h-1v3h1zM4 13h1V7l22-4v10h1V3.18a1 1 0 0 0-1.164-.986l-22 3.667A1 1 0 0 0 4 6.847V13z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-flip" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#434343" d="M11 0h1v24h-1zM19 21v-1h2v-2h1v2a1 1 0 0 1-1 1h-2zm-2 0h-3v-1h3v1zm5-5h-1v-3h1v3zm0-5h-1V8h1v3zm0-5h-1V4h-2V3h2a1 1 0 0 1 1 1v2zm-5-3v1h-3V3h3zM9 3v1H2v16h7v1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h7z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-arrow-2" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" stroke-linecap="round" stroke-linejoin="round" d="M21.793 18.5H2.5v-5h18.935l-7.6-8h5.872l10.5 10.5-10.5 10.5h-5.914l8-8z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-arrow-3" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" stroke-linecap="round" stroke-linejoin="round" d="M25.288 16.42L14.208 27.5H6.792l11.291-11.291L6.826 4.5h7.381l11.661 11.661-.58.258z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-arrow" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" d="M2.5 11.5v9h18v5.293L30.293 16 20.5 6.207V11.5h-18z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-bubble" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" stroke-linecap="round" stroke-linejoin="round" d="M22.207 24.5L16.5 30.207V24.5H8A6.5 6.5 0 0 1 1.5 18V9A6.5 6.5 0 0 1 8 2.5h16A6.5 6.5 0 0 1 30.5 9v9a6.5 6.5 0 0 1-6.5 6.5h-1.793z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-heart" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill-rule="nonzero" stroke="#434343" d="M15.996 30.675l1.981-1.79c7.898-7.177 10.365-9.718 12.135-13.012.922-1.716 1.377-3.37 1.377-5.076 0-4.65-3.647-8.297-8.297-8.297-2.33 0-4.86 1.527-6.817 3.824l-.38.447-.381-.447C13.658 4.027 11.126 2.5 8.797 2.5 4.147 2.5.5 6.147.5 10.797c0 1.714.46 3.375 1.389 5.098 1.775 3.288 4.26 5.843 12.123 12.974l1.984 1.806z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-load" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" stroke-linecap="round" stroke-linejoin="round" d="M17.314 18.867l1.951-2.53 4 5.184h-17l6.5-8.84 4.549 6.186z"/>\n        <path fill="#434343" d="M18.01 4a11.798 11.798 0 0 0 0 1H3v24h24V14.986a8.738 8.738 0 0 0 1 0V29a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h15.01z"/>\n        <path fill="#434343" d="M25 3h1v9h-1z"/>\n        <path stroke="#434343" d="M22 6l3.5-3.5L29 6"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-location" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <g stroke="#434343">\n            <path d="M16 31.28C23.675 23.302 27.5 17.181 27.5 13c0-6.351-5.149-11.5-11.5-11.5S4.5 6.649 4.5 13c0 4.181 3.825 10.302 11.5 18.28z"/>\n            <circle cx="16" cy="13" r="4.5"/>\n        </g>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-polygon" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" d="M.576 16L8.29 29.5h15.42L31.424 16 23.71 2.5H8.29L.576 16z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-star-2" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" d="M19.446 31.592l2.265-3.272 3.946.25.636-3.94 3.665-1.505-1.12-3.832 2.655-2.962-2.656-2.962 1.12-3.832-3.664-1.505-.636-3.941-3.946.25-2.265-3.271L16 3.024 12.554 1.07 10.289 4.34l-3.946-.25-.636 3.941-3.665 1.505 1.12 3.832L.508 16.33l2.656 2.962-1.12 3.832 3.664 1.504.636 3.942 3.946-.25 2.265 3.27L16 29.638l3.446 1.955z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon-star" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" d="M25.292 29.878l-1.775-10.346 7.517-7.327-10.388-1.51L16 1.282l-4.646 9.413-10.388 1.51 7.517 7.327-1.775 10.346L16 24.993l9.292 4.885z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-icon" viewBox="0 0 24 24">\n    <g fill="none">\n        <path stroke="#434343" stroke-linecap="round" stroke-linejoin="round" d="M11.923 19.136L5.424 22l.715-7.065-4.731-5.296 6.94-1.503L11.923 2l3.574 6.136 6.94 1.503-4.731 5.296L18.42 22z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-mask-load" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#434343" d="M18.01 4a11.798 11.798 0 0 0 0 1H3v24h24V14.986a8.738 8.738 0 0 0 1 0V29a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h15.01zM15 23a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-1a5 5 0 1 0 0-10 5 5 0 0 0 0 10z"/>\n        <path fill="#434343" d="M25 3h1v9h-1z"/>\n        <path stroke="#434343" d="M22 6l3.5-3.5L29 6"/>\n    </g>\n</symbol><symbol id="icon-a-ic-mask" viewBox="0 0 24 24">\n    <g fill="none">\n        <circle cx="12" cy="12" r="4.5" stroke="#434343"/>\n        <path fill="#434343" d="M2 1h20a1 1 0 0 1 1 1v20a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zm0 1v20h20V2H2z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-redo" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z" opacity=".5"/>\n        <path fill="#434343" d="M21 6H9a6 6 0 1 0 0 12h12v1H9A7 7 0 0 1 9 5h12v1z"/>\n        <path stroke="#434343" stroke-linecap="square" d="M19 3l2.5 2.5L19 8"/>\n    </g>\n</symbol><symbol id="icon-a-ic-reset" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z" opacity=".5"/>\n        <path fill="#434343" d="M2 13v-1a7 7 0 0 1 7-7h13v1h-1v5h1v1a7 7 0 0 1-7 7H2v-1h1v-5H2zm7-7a6 6 0 0 0-6 6v6h12a6 6 0 0 0 6-6V6H9z"/>\n        <path stroke="#434343" stroke-linecap="square" d="M19 3l2.5 2.5L19 8M5 16l-2.5 2.5L5 21"/>\n    </g>\n</symbol><symbol id="icon-a-ic-rotate-clockwise" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#434343" d="M29 17h-.924c0 6.627-5.373 12-12 12-6.628 0-12-5.373-12-12C4.076 10.398 9.407 5.041 16 5V4C8.82 4 3 9.82 3 17s5.82 13 13 13 13-5.82 13-13z"/>\n        <path stroke="#434343" stroke-linecap="square" d="M16 1.5l4 3-4 3"/>\n        <path fill="#434343" fill-rule="nonzero" d="M16 4h4v1h-4z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-rotate-counterclockwise" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#434343" d="M3 17h.924c0 6.627 5.373 12 12 12 6.628 0 12-5.373 12-12 0-6.602-5.331-11.96-11.924-12V4c7.18 0 13 5.82 13 13s-5.82 13-13 13S3 24.18 3 17z"/>\n        <path fill="#434343" fill-rule="nonzero" d="M12 4h4v1h-4z"/>\n        <path stroke="#434343" stroke-linecap="square" d="M16 1.5l-4 3 4 3"/>\n    </g>\n</symbol><symbol id="icon-a-ic-rotate" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#434343" d="M8.349 22.254a10.002 10.002 0 0 1-2.778-1.719l.65-.76a9.002 9.002 0 0 0 2.495 1.548l-.367.931zm2.873.704l.078-.997a9 9 0 1 0-.557-17.852l-.14-.99A10.076 10.076 0 0 1 12.145 3c5.523 0 10 4.477 10 10s-4.477 10-10 10c-.312 0-.62-.014-.924-.042zm-7.556-4.655a9.942 9.942 0 0 1-1.253-2.996l.973-.234a8.948 8.948 0 0 0 1.124 2.693l-.844.537zm-1.502-5.91A9.949 9.949 0 0 1 2.88 9.23l.925.382a8.954 8.954 0 0 0-.644 2.844l-.998-.062zm2.21-5.686c.687-.848 1.51-1.58 2.436-2.166l.523.852a9.048 9.048 0 0 0-2.188 1.95l-.771-.636z"/>\n        <path stroke="#434343" stroke-linecap="square" d="M13 1l-2.5 2.5L13 6"/>\n    </g>\n</symbol><symbol id="icon-a-ic-shape-circle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <circle cx="16" cy="16" r="14.5" stroke="#434343"/>\n    </g>\n</symbol><symbol id="icon-a-ic-shape-rectangle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <rect width="27" height="27" x="2.5" y="2.5" stroke="#434343" rx="1"/>\n    </g>\n</symbol><symbol id="icon-a-ic-shape-triangle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#434343" stroke-linecap="round" stroke-linejoin="round" d="M16 2.5l15.5 27H.5z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-shape" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#434343" d="M14.706 8H21a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-4h1v4h12V9h-5.706l-.588-1z"/>\n        <path stroke="#434343" stroke-linecap="round" stroke-linejoin="round" d="M8.5 1.5l7.5 13H1z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-text-align-center" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#434343" d="M2 5h28v1H2zM8 12h16v1H8zM2 19h28v1H2zM8 26h16v1H8z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-text-align-left" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#434343" d="M2 5h28v1H2zM2 12h16v1H2zM2 19h28v1H2zM2 26h16v1H2z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-text-align-right" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#434343" d="M2 5h28v1H2zM14 12h16v1H14zM2 19h28v1H2zM14 26h16v1H14z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-text-bold" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#434343" d="M7 2h2v2H7zM7 28h2v2H7z"/>\n        <path stroke="#434343" stroke-width="2" d="M9 3v12h9a6 6 0 1 0 0-12H9zM9 15v14h10a7 7 0 0 0 0-14H9z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-text-italic" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#434343" d="M15 2h5v1h-5zM11 29h5v1h-5zM17 3h1l-4 26h-1z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-text-underline" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#434343" d="M8 2v14a8 8 0 1 0 16 0V2h1v14a9 9 0 0 1-18 0V2h1zM3 29h26v1H3z"/>\n        <path fill="#434343" d="M5 2h5v1H5zM22 2h5v1h-5z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-text" viewBox="0 0 24 24">\n    <g fill="#434343" fill-rule="evenodd">\n        <path d="M4 3h15a1 1 0 0 1 1 1H3a1 1 0 0 1 1-1zM3 4h1v1H3zM19 4h1v1h-1z"/>\n        <path d="M11 3h1v18h-1z"/>\n        <path d="M10 20h3v1h-3z"/>\n    </g>\n</symbol><symbol id="icon-a-ic-undo" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M24 0H0v24h24z" opacity=".5"/>\n        <path fill="#434343" d="M3 6h12a6 6 0 1 1 0 12H3v1h12a7 7 0 0 0 0-14H3v1z"/>\n        <path stroke="#434343" stroke-linecap="square" d="M5 3L2.5 5.5 5 8"/>\n    </g>\n</symbol><symbol id="icon-a-img-bi" viewBox="0 0 257 26">\n    <g fill="#FDBA3B">\n        <path d="M26 5a8.001 8.001 0 0 0 0 16 8.001 8.001 0 0 0 0-16M51.893 19.812L43.676 5.396A.78.78 0 0 0 43 5a.78.78 0 0 0-.677.396l-8.218 14.418a.787.787 0 0 0 0 .792c.14.244.396.394.676.394h16.436c.28 0 .539-.15.678-.396a.796.796 0 0 0-.002-.792M15.767 5.231A.79.79 0 0 0 15.21 5H.791A.791.791 0 0 0 0 5.79v6.42a.793.793 0 0 0 .791.79h3.21v7.21c.001.21.082.408.234.56.147.148.347.23.558.23h6.416a.788.788 0 0 0 .792-.79V13h3.006c.413 0 .611-.082.762-.232.15-.149.23-.35.231-.559V5.791a.787.787 0 0 0-.233-.56M85.767 5.231A.79.79 0 0 0 85.21 5H70.791a.791.791 0 0 0-.791.79v6.42a.793.793 0 0 0 .791.79h3.21v7.21c.001.21.082.408.234.56.147.148.347.23.558.23h6.416a.788.788 0 0 0 .792-.79V13h3.006c.413 0 .611-.082.762-.232.15-.149.23-.35.231-.559V5.791a.787.787 0 0 0-.233-.56M65.942 9.948l2.17-3.76a.78.78 0 0 0 0-.792.791.791 0 0 0-.684-.396h-8.54A5.889 5.889 0 0 0 53 10.86a5.887 5.887 0 0 0 3.07 5.17l-2.184 3.782A.792.792 0 0 0 54.571 21h8.54a5.89 5.89 0 0 0 2.831-11.052M105.7 21h2.3V5h-2.3zM91 5h2.4v10.286c0 1.893 1.612 3.429 3.6 3.429s3.6-1.536 3.6-3.429V5h2.4v10.286c0 3.156-2.686 5.714-6 5.714-3.313 0-6-2.558-6-5.714V5zM252.148 21.128h-2.377V9.659h2.27v1.64c.69-1.299 1.792-1.938 3.304-1.938.497 0 .95.065 1.382.192l-.215 2.277a3.734 3.734 0 0 0-1.275-.213c-1.814 0-3.089 1.234-3.089 3.638v5.873zm-7.095-5.744a3.734 3.734 0 0 0-1.101-2.703c-.714-.766-1.6-1.149-2.658-1.149-1.058 0-1.944.383-2.679 1.149a3.803 3.803 0 0 0-1.08 2.703c0 1.063.368 1.978 1.08 2.722.735.746 1.62 1.128 2.68 1.128 1.058 0 1.943-.382 2.657-1.128.734-.744 1.101-1.659 1.101-2.722zm-9.916 0c0-1.682.583-3.086 1.729-4.256 1.166-1.17 2.635-1.767 4.428-1.767 1.793 0 3.262.597 4.407 1.767 1.167 1.17 1.75 2.574 1.75 4.256 0 1.7-.583 3.127-1.75 4.297-1.145 1.17-2.614 1.745-4.407 1.745-1.793 0-3.262-.575-4.428-1.745-1.146-1.17-1.729-2.596-1.729-4.297zm-1.5 3.233l.821 1.83c-.864.638-1.944.958-3.22.958-2.526 0-3.822-1.554-3.822-4.383V11.66h-2.01v-2h2.031V5.595h2.355v4.063h4.018v2h-4.018v5.405c0 1.469.605 2.191 1.793 2.191.626 0 1.318-.212 2.052-.638zm-12.43 2.51h2.375V9.66h-2.376v11.469zm1.23-12.977c-.929 0-1.642-.682-1.642-1.596 0-.873.713-1.554 1.643-1.554.885 0 1.576.681 1.576 1.554 0 .914-.69 1.596-1.576 1.596zm-6.49 7.234c0-1.086-.346-1.98-1.037-2.724-.692-.745-1.599-1.128-2.7-1.128-1.102 0-2.01.383-2.7 1.128-.692.744-1.037 1.638-1.037 2.724 0 1.084.345 2.02 1.036 2.766.691.744 1.6 1.105 2.7 1.105 1.102 0 2.01-.361 2.7-1.105.692-.746 1.038-1.682 1.038-2.766zm-.173-4.129V5h2.397v16.128h-2.354v-1.596c-1.015 1.255-2.333 1.873-3.91 1.873-1.663 0-3.068-.575-4.169-1.724-1.102-1.17-1.663-2.596-1.663-4.297 0-1.682.561-3.107 1.663-4.256 1.101-1.17 2.485-1.745 4.148-1.745 1.534 0 2.83.617 3.888 1.872zm-11.48 9.873h-10.218V5.405h10.195v2.318h-7.711V12h7.15v2.32h-7.15v4.489h7.733v2.319zm-23.891-9.724c-1.793 0-3.132 1.192-3.478 2.979h6.783c-.194-1.808-1.555-2.979-3.305-2.979zm5.703 3.766c0 .32-.021.703-.086 1.128h-9.095c.346 1.787 1.62 3 3.867 3 1.318 0 2.916-.49 3.953-1.234l.994 1.724c-1.189.872-3.067 1.595-5.033 1.595-4.364 0-6.243-3-6.243-6.021 0-1.724.54-3.15 1.642-4.277 1.101-1.127 2.548-1.702 4.298-1.702 1.664 0 3.046.511 4.105 1.553 1.058 1.043 1.598 2.447 1.598 4.234zm-19.949 3.894c1.08 0 1.966-.362 2.68-1.085.712-.724 1.058-1.617 1.058-2.703 0-1.084-.346-2-1.059-2.701-.713-.702-1.599-1.064-2.679-1.064-1.058 0-1.944.362-2.656 1.085-.714.702-1.059 1.596-1.059 2.68 0 1.086.345 2 1.059 2.724.712.702 1.598 1.064 2.656 1.064zm3.673-7.936V9.66h2.29v10.299c0 1.85-.584 3.32-1.728 4.404-1.146 1.085-2.68 1.638-4.58 1.638-1.945 0-3.672-.553-5.206-1.638l1.037-1.808c1.296.915 2.679 1.36 4.126 1.36 2.484 0 3.996-1.51 3.996-3.637v-.83c-1.015 1.127-2.311 1.702-3.91 1.702-1.684 0-3.089-.554-4.19-1.68-1.102-1.128-1.642-2.532-1.642-4.214 0-1.68.561-3.085 1.706-4.191 1.145-1.128 2.571-1.681 4.234-1.681 1.534 0 2.83.575 3.867 1.745zm-18.07 8.127c1.102 0 1.988-.382 2.7-1.128.714-.744 1.06-1.659 1.06-2.743 0-1.065-.346-1.98-1.06-2.724-.712-.745-1.598-1.128-2.7-1.128-1.101 0-2.008.383-2.7 1.128-.691.744-1.036 1.66-1.036 2.745 0 1.084.345 2 1.037 2.745.691.744 1.598 1.105 2.7 1.105zm3.652-8V9.66h2.29v11.469h-2.29v-1.575c-1.059 1.234-2.399 1.852-3.976 1.852-1.663 0-3.067-.575-4.168-1.745-1.102-1.17-1.642-2.617-1.642-4.34 0-1.724.54-3.128 1.642-4.256 1.1-1.128 2.505-1.681 4.168-1.681 1.577 0 2.917.617 3.976 1.872zM138.79 9.34c1.404 0 2.527.448 3.37 1.34.863.873 1.295 2.086 1.295 3.596v6.852h-2.376V14.66c0-2.021-1.036-3.128-2.657-3.128-1.727 0-2.915 1.255-2.915 3.192v6.404h-2.377v-6.426c0-1.978-1.037-3.17-2.679-3.17-1.728 0-2.937 1.277-2.937 3.234v6.362h-2.377V9.659h2.333v1.66c.692-1.212 1.988-1.979 3.522-1.979 1.533.021 2.958.767 3.586 2.107.798-1.277 2.419-2.107 4.212-2.107zm-19.517 11.788h2.484V5.405h-2.484v15.723z"/>\n    </g>\n</symbol></svg>',c='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs/><symbol id="icon-b-ic-apply" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path stroke="#555555" d="M4 12.011l5 5L20.011 6"/>\n    </g>\n</symbol><symbol id="icon-b-ic-cancel" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path stroke="#555555" d="M6 6l12 12M18 6L6 18"/>\n    </g>\n</symbol><symbol id="icon-b-ic-crop" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#555555" d="M4 0h1v20a1 1 0 0 1-1-1V0zM20 17h-1V5h1v12zm0 2v5h-1v-5h1z"/>\n        <path fill="#555555" d="M5 19h19v1H5zM4.762 4v1H0V4h4.762zM7 4h12a1 1 0 0 1 1 1H7V4z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-delete-all" viewBox="0 0 24 24">\n    <g fill="#555555" fill-rule="evenodd">\n        <path d="M5 23H3a1 1 0 0 1-1-1V6h1v16h2v1zm16-10h-1V6h1v7zM9 13H8v-3h1v3zm3 0h-1v-3h1v3zm3 0h-1v-3h1v3zM14.794 3.794L13 2h-3L8.206 3.794A.963.963 0 0 1 8 2.5l.703-1.055A1 1 0 0 1 9.535 1h3.93a1 1 0 0 1 .832.445L15 2.5a.965.965 0 0 1-.206 1.294zM14.197 4H8.803h5.394z"/>\n        <path d="M0 3h23v1H0zM11.286 21H8.714L8 23H7l1-2.8V20h.071L9.5 16h1l1.429 4H12v.2l1 2.8h-1l-.714-2zm-.357-1L10 17.4 9.071 20h1.858zM20 22h3v1h-4v-7h1v6zm-5 0h3v1h-4v-7h1v6z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-delete" viewBox="0 0 24 24">\n    <g fill="#555555" fill-rule="evenodd">\n        <path d="M3 6v16h17V6h1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6h1zM14.794 3.794L13 2h-3L8.206 3.794A.963.963 0 0 1 8 2.5l.703-1.055A1 1 0 0 1 9.535 1h3.93a1 1 0 0 1 .832.445L15 2.5a.965.965 0 0 1-.206 1.294zM14.197 4H8.803h5.394z"/>\n        <path d="M0 3h23v1H0zM8 10h1v6H8v-6zm3 0h1v6h-1v-6zm3 0h1v6h-1v-6z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-draw-free" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" d="M2.5 20.929C2.594 10.976 4.323 6 7.686 6c5.872 0 2.524 19 7.697 19s1.89-14.929 6.414-14.929 1.357 10.858 5.13 10.858c1.802 0 2.657-2.262 2.566-6.786"/>\n    </g>\n</symbol><symbol id="icon-b-ic-draw-line" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" d="M2 15.5h28"/>\n    </g>\n</symbol><symbol id="icon-b-ic-draw" viewBox="0 0 24 24">\n    <g fill="none">\n        <path stroke="#555555" d="M2.5 21.5H5c.245 0 .48-.058.691-.168l.124-.065.14.01c.429.028.85-.127 1.16-.437L22.55 5.405a.5.5 0 0 0 0-.707l-3.246-3.245a.5.5 0 0 0-.707 0L3.162 16.888a1.495 1.495 0 0 0-.437 1.155l.01.14-.065.123c-.111.212-.17.448-.17.694v2.5z"/>\n        <path fill="#555555" d="M16.414 3.707l3.89 3.89-.708.706-3.889-3.889z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-filter" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#555555" d="M12 7v1H2V7h10zm6 0h4v1h-4V7zM12 16v1h10v-1H12zm-6 0H2v1h4v-1z"/>\n        <path fill="#555555" d="M8.5 20a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7zm0-1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zM15.5 11a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7zm0-1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-flip-reset" viewBox="0 0 31 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M31 0H0v32h31z"/>\n        <path fill="#555555" d="M28 16a8 8 0 0 1-8 8H3v-1h1v-7H3a8 8 0 0 1 8-8h17v1h-1v7h1zM11 9a7 7 0 0 0-7 7v7h16a7 7 0 0 0 7-7V9H11z"/>\n        <path stroke="#555555" stroke-linecap="square" d="M24 5l3.5 3.5L24 12M7 20l-3.5 3.5L7 27"/>\n    </g>\n</symbol><symbol id="icon-b-ic-flip-x" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M32 32H0V0h32z"/>\n        <path fill="#555555" d="M17 32h-1V0h1zM27.167 11l.5 3h-1.03l-.546-3h1.076zm-.5-3h-1.122L25 5h-5V4h5.153a1 1 0 0 1 .986.836L26.667 8zm1.5 9l.5 3h-.94l-.545-3h.985zm1 6l.639 3.836A1 1 0 0 1 28.819 28H26v-1h3l-.726-4h.894zM23 28h-3v-1h3v1zM13 4v1H7L3 27h10v1H3.18a1 1 0 0 1-.986-1.164l3.666-22A1 1 0 0 1 6.847 4H13z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-flip-y" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0v32h32V0z"/>\n        <path fill="#555555" d="M0 16v1h32v-1zM11 27.167l3 .5v-1.03l-3-.546v1.076zm-3-.5v-1.122L5 25v-5H4v5.153a1 1 0 0 0 .836.986L8 26.667zm9 1.5l3 .5v-.94l-3-.545v.985zm6 1l3.836.639A1 1 0 0 0 28 28.82V26h-1v3l-4-.727v.894zM28 23v-3h-1v3h1zM4 13h1V7l22-4v10h1V3.18a1 1 0 0 0-1.164-.986l-22 3.667A1 1 0 0 0 4 6.847V13z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-flip" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#555555" d="M11 0h1v24h-1zM19 21v-1h2v-2h1v2a1 1 0 0 1-1 1h-2zm-2 0h-3v-1h3v1zm5-5h-1v-3h1v3zm0-5h-1V8h1v3zm0-5h-1V4h-2V3h2a1 1 0 0 1 1 1v2zm-5-3v1h-3V3h3zM9 3v1H2v16h7v1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h7z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-arrow-2" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" stroke-linecap="round" stroke-linejoin="round" d="M21.793 18.5H2.5v-5h18.935l-7.6-8h5.872l10.5 10.5-10.5 10.5h-5.914l8-8z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-arrow-3" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" stroke-linecap="round" stroke-linejoin="round" d="M25.288 16.42L14.208 27.5H6.792l11.291-11.291L6.826 4.5h7.381l11.661 11.661-.58.258z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-arrow" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" d="M2.5 11.5v9h18v5.293L30.293 16 20.5 6.207V11.5h-18z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-bubble" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" stroke-linecap="round" stroke-linejoin="round" d="M22.207 24.5L16.5 30.207V24.5H8A6.5 6.5 0 0 1 1.5 18V9A6.5 6.5 0 0 1 8 2.5h16A6.5 6.5 0 0 1 30.5 9v9a6.5 6.5 0 0 1-6.5 6.5h-1.793z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-heart" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill-rule="nonzero" stroke="#555555" d="M15.996 30.675l1.981-1.79c7.898-7.177 10.365-9.718 12.135-13.012.922-1.716 1.377-3.37 1.377-5.076 0-4.65-3.647-8.297-8.297-8.297-2.33 0-4.86 1.527-6.817 3.824l-.38.447-.381-.447C13.658 4.027 11.126 2.5 8.797 2.5 4.147 2.5.5 6.147.5 10.797c0 1.714.46 3.375 1.389 5.098 1.775 3.288 4.26 5.843 12.123 12.974l1.984 1.806z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-load" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" stroke-linecap="round" stroke-linejoin="round" d="M17.314 18.867l1.951-2.53 4 5.184h-17l6.5-8.84 4.549 6.186z"/>\n        <path fill="#555555" d="M18.01 4a11.798 11.798 0 0 0 0 1H3v24h24V14.986a8.738 8.738 0 0 0 1 0V29a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h15.01z"/>\n        <path fill="#555555" d="M25 3h1v9h-1z"/>\n        <path stroke="#555555" d="M22 6l3.5-3.5L29 6"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-location" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <g stroke="#555555">\n            <path d="M16 31.28C23.675 23.302 27.5 17.181 27.5 13c0-6.351-5.149-11.5-11.5-11.5S4.5 6.649 4.5 13c0 4.181 3.825 10.302 11.5 18.28z"/>\n            <circle cx="16" cy="13" r="4.5"/>\n        </g>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-polygon" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" d="M.576 16L8.29 29.5h15.42L31.424 16 23.71 2.5H8.29L.576 16z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-star-2" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" d="M19.446 31.592l2.265-3.272 3.946.25.636-3.94 3.665-1.505-1.12-3.832 2.655-2.962-2.656-2.962 1.12-3.832-3.664-1.505-.636-3.941-3.946.25-2.265-3.271L16 3.024 12.554 1.07 10.289 4.34l-3.946-.25-.636 3.941-3.665 1.505 1.12 3.832L.508 16.33l2.656 2.962-1.12 3.832 3.664 1.504.636 3.942 3.946-.25 2.265 3.27L16 29.638l3.446 1.955z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon-star" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" d="M25.292 29.878l-1.775-10.346 7.517-7.327-10.388-1.51L16 1.282l-4.646 9.413-10.388 1.51 7.517 7.327-1.775 10.346L16 24.993l9.292 4.885z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-icon" viewBox="0 0 24 24">\n    <g fill="none">\n        <path stroke="#555555" stroke-linecap="round" stroke-linejoin="round" d="M11.923 19.136L5.424 22l.715-7.065-4.731-5.296 6.94-1.503L11.923 2l3.574 6.136 6.94 1.503-4.731 5.296L18.42 22z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-mask-load" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#555555" d="M18.01 4a11.798 11.798 0 0 0 0 1H3v24h24V14.986a8.738 8.738 0 0 0 1 0V29a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h15.01zM15 23a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-1a5 5 0 1 0 0-10 5 5 0 0 0 0 10z"/>\n        <path fill="#555555" d="M25 3h1v9h-1z"/>\n        <path stroke="#555555" d="M22 6l3.5-3.5L29 6"/>\n    </g>\n</symbol><symbol id="icon-b-ic-mask" viewBox="0 0 24 24">\n    <g fill="none">\n        <circle cx="12" cy="12" r="4.5" stroke="#555555"/>\n        <path fill="#555555" d="M2 1h20a1 1 0 0 1 1 1v20a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zm0 1v20h20V2H2z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-redo" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z" opacity=".5"/>\n        <path fill="#555555" d="M21 6H9a6 6 0 1 0 0 12h12v1H9A7 7 0 0 1 9 5h12v1z"/>\n        <path stroke="#555555" stroke-linecap="square" d="M19 3l2.5 2.5L19 8"/>\n    </g>\n</symbol><symbol id="icon-b-ic-reset" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z" opacity=".5"/>\n        <path fill="#555555" d="M2 13v-1a7 7 0 0 1 7-7h13v1h-1v5h1v1a7 7 0 0 1-7 7H2v-1h1v-5H2zm7-7a6 6 0 0 0-6 6v6h12a6 6 0 0 0 6-6V6H9z"/>\n        <path stroke="#555555" stroke-linecap="square" d="M19 3l2.5 2.5L19 8M5 16l-2.5 2.5L5 21"/>\n    </g>\n</symbol><symbol id="icon-b-ic-rotate-clockwise" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#555555" d="M29 17h-.924c0 6.627-5.373 12-12 12-6.628 0-12-5.373-12-12C4.076 10.398 9.407 5.041 16 5V4C8.82 4 3 9.82 3 17s5.82 13 13 13 13-5.82 13-13z"/>\n        <path stroke="#555555" stroke-linecap="square" d="M16 1.5l4 3-4 3"/>\n        <path fill="#555555" fill-rule="nonzero" d="M16 4h4v1h-4z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-rotate-counterclockwise" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#555555" d="M3 17h.924c0 6.627 5.373 12 12 12 6.628 0 12-5.373 12-12 0-6.602-5.331-11.96-11.924-12V4c7.18 0 13 5.82 13 13s-5.82 13-13 13S3 24.18 3 17z"/>\n        <path fill="#555555" fill-rule="nonzero" d="M12 4h4v1h-4z"/>\n        <path stroke="#555555" stroke-linecap="square" d="M16 1.5l-4 3 4 3"/>\n    </g>\n</symbol><symbol id="icon-b-ic-rotate" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#555555" d="M8.349 22.254a10.002 10.002 0 0 1-2.778-1.719l.65-.76a9.002 9.002 0 0 0 2.495 1.548l-.367.931zm2.873.704l.078-.997a9 9 0 1 0-.557-17.852l-.14-.99A10.076 10.076 0 0 1 12.145 3c5.523 0 10 4.477 10 10s-4.477 10-10 10c-.312 0-.62-.014-.924-.042zm-7.556-4.655a9.942 9.942 0 0 1-1.253-2.996l.973-.234a8.948 8.948 0 0 0 1.124 2.693l-.844.537zm-1.502-5.91A9.949 9.949 0 0 1 2.88 9.23l.925.382a8.954 8.954 0 0 0-.644 2.844l-.998-.062zm2.21-5.686c.687-.848 1.51-1.58 2.436-2.166l.523.852a9.048 9.048 0 0 0-2.188 1.95l-.771-.636z"/>\n        <path stroke="#555555" stroke-linecap="square" d="M13 1l-2.5 2.5L13 6"/>\n    </g>\n</symbol><symbol id="icon-b-ic-shape-circle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <circle cx="16" cy="16" r="14.5" stroke="#555555"/>\n    </g>\n</symbol><symbol id="icon-b-ic-shape-rectangle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <rect width="27" height="27" x="2.5" y="2.5" stroke="#555555" rx="1"/>\n    </g>\n</symbol><symbol id="icon-b-ic-shape-triangle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#555555" stroke-linecap="round" stroke-linejoin="round" d="M16 2.5l15.5 27H.5z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-shape" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#555555" d="M14.706 8H21a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-4h1v4h12V9h-5.706l-.588-1z"/>\n        <path stroke="#555555" stroke-linecap="round" stroke-linejoin="round" d="M8.5 1.5l7.5 13H1z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-text-align-center" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#555555" d="M2 5h28v1H2zM8 12h16v1H8zM2 19h28v1H2zM8 26h16v1H8z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-text-align-left" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#555555" d="M2 5h28v1H2zM2 12h16v1H2zM2 19h28v1H2zM2 26h16v1H2z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-text-align-right" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#555555" d="M2 5h28v1H2zM14 12h16v1H14zM2 19h28v1H2zM14 26h16v1H14z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-text-bold" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#555555" d="M7 2h2v2H7zM7 28h2v2H7z"/>\n        <path stroke="#555555" stroke-width="2" d="M9 3v12h9a6 6 0 1 0 0-12H9zM9 15v14h10a7 7 0 0 0 0-14H9z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-text-italic" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#555555" d="M15 2h5v1h-5zM11 29h5v1h-5zM17 3h1l-4 26h-1z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-text-underline" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#555555" d="M8 2v14a8 8 0 1 0 16 0V2h1v14a9 9 0 0 1-18 0V2h1zM3 29h26v1H3z"/>\n        <path fill="#555555" d="M5 2h5v1H5zM22 2h5v1h-5z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-text" viewBox="0 0 24 24">\n    <g fill="#555555" fill-rule="evenodd">\n        <path d="M4 3h15a1 1 0 0 1 1 1H3a1 1 0 0 1 1-1zM3 4h1v1H3zM19 4h1v1h-1z"/>\n        <path d="M11 3h1v18h-1z"/>\n        <path d="M10 20h3v1h-3z"/>\n    </g>\n</symbol><symbol id="icon-b-ic-undo" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M24 0H0v24h24z" opacity=".5"/>\n        <path fill="#555555" d="M3 6h12a6 6 0 1 1 0 12H3v1h12a7 7 0 0 0 0-14H3v1z"/>\n        <path stroke="#555555" stroke-linecap="square" d="M5 3L2.5 5.5 5 8"/>\n    </g>\n</symbol><symbol id="icon-b-img-bi" viewBox="0 0 257 26">\n    <g fill="#FDBA3B">\n        <path d="M26 5a8.001 8.001 0 0 0 0 16 8.001 8.001 0 0 0 0-16M51.893 19.812L43.676 5.396A.78.78 0 0 0 43 5a.78.78 0 0 0-.677.396l-8.218 14.418a.787.787 0 0 0 0 .792c.14.244.396.394.676.394h16.436c.28 0 .539-.15.678-.396a.796.796 0 0 0-.002-.792M15.767 5.231A.79.79 0 0 0 15.21 5H.791A.791.791 0 0 0 0 5.79v6.42a.793.793 0 0 0 .791.79h3.21v7.21c.001.21.082.408.234.56.147.148.347.23.558.23h6.416a.788.788 0 0 0 .792-.79V13h3.006c.413 0 .611-.082.762-.232.15-.149.23-.35.231-.559V5.791a.787.787 0 0 0-.233-.56M85.767 5.231A.79.79 0 0 0 85.21 5H70.791a.791.791 0 0 0-.791.79v6.42a.793.793 0 0 0 .791.79h3.21v7.21c.001.21.082.408.234.56.147.148.347.23.558.23h6.416a.788.788 0 0 0 .792-.79V13h3.006c.413 0 .611-.082.762-.232.15-.149.23-.35.231-.559V5.791a.787.787 0 0 0-.233-.56M65.942 9.948l2.17-3.76a.78.78 0 0 0 0-.792.791.791 0 0 0-.684-.396h-8.54A5.889 5.889 0 0 0 53 10.86a5.887 5.887 0 0 0 3.07 5.17l-2.184 3.782A.792.792 0 0 0 54.571 21h8.54a5.89 5.89 0 0 0 2.831-11.052M105.7 21h2.3V5h-2.3zM91 5h2.4v10.286c0 1.893 1.612 3.429 3.6 3.429s3.6-1.536 3.6-3.429V5h2.4v10.286c0 3.156-2.686 5.714-6 5.714-3.313 0-6-2.558-6-5.714V5zM252.148 21.128h-2.377V9.659h2.27v1.64c.69-1.299 1.792-1.938 3.304-1.938.497 0 .95.065 1.382.192l-.215 2.277a3.734 3.734 0 0 0-1.275-.213c-1.814 0-3.089 1.234-3.089 3.638v5.873zm-7.095-5.744a3.734 3.734 0 0 0-1.101-2.703c-.714-.766-1.6-1.149-2.658-1.149-1.058 0-1.944.383-2.679 1.149a3.803 3.803 0 0 0-1.08 2.703c0 1.063.368 1.978 1.08 2.722.735.746 1.62 1.128 2.68 1.128 1.058 0 1.943-.382 2.657-1.128.734-.744 1.101-1.659 1.101-2.722zm-9.916 0c0-1.682.583-3.086 1.729-4.256 1.166-1.17 2.635-1.767 4.428-1.767 1.793 0 3.262.597 4.407 1.767 1.167 1.17 1.75 2.574 1.75 4.256 0 1.7-.583 3.127-1.75 4.297-1.145 1.17-2.614 1.745-4.407 1.745-1.793 0-3.262-.575-4.428-1.745-1.146-1.17-1.729-2.596-1.729-4.297zm-1.5 3.233l.821 1.83c-.864.638-1.944.958-3.22.958-2.526 0-3.822-1.554-3.822-4.383V11.66h-2.01v-2h2.031V5.595h2.355v4.063h4.018v2h-4.018v5.405c0 1.469.605 2.191 1.793 2.191.626 0 1.318-.212 2.052-.638zm-12.43 2.51h2.375V9.66h-2.376v11.469zm1.23-12.977c-.929 0-1.642-.682-1.642-1.596 0-.873.713-1.554 1.643-1.554.885 0 1.576.681 1.576 1.554 0 .914-.69 1.596-1.576 1.596zm-6.49 7.234c0-1.086-.346-1.98-1.037-2.724-.692-.745-1.599-1.128-2.7-1.128-1.102 0-2.01.383-2.7 1.128-.692.744-1.037 1.638-1.037 2.724 0 1.084.345 2.02 1.036 2.766.691.744 1.6 1.105 2.7 1.105 1.102 0 2.01-.361 2.7-1.105.692-.746 1.038-1.682 1.038-2.766zm-.173-4.129V5h2.397v16.128h-2.354v-1.596c-1.015 1.255-2.333 1.873-3.91 1.873-1.663 0-3.068-.575-4.169-1.724-1.102-1.17-1.663-2.596-1.663-4.297 0-1.682.561-3.107 1.663-4.256 1.101-1.17 2.485-1.745 4.148-1.745 1.534 0 2.83.617 3.888 1.872zm-11.48 9.873h-10.218V5.405h10.195v2.318h-7.711V12h7.15v2.32h-7.15v4.489h7.733v2.319zm-23.891-9.724c-1.793 0-3.132 1.192-3.478 2.979h6.783c-.194-1.808-1.555-2.979-3.305-2.979zm5.703 3.766c0 .32-.021.703-.086 1.128h-9.095c.346 1.787 1.62 3 3.867 3 1.318 0 2.916-.49 3.953-1.234l.994 1.724c-1.189.872-3.067 1.595-5.033 1.595-4.364 0-6.243-3-6.243-6.021 0-1.724.54-3.15 1.642-4.277 1.101-1.127 2.548-1.702 4.298-1.702 1.664 0 3.046.511 4.105 1.553 1.058 1.043 1.598 2.447 1.598 4.234zm-19.949 3.894c1.08 0 1.966-.362 2.68-1.085.712-.724 1.058-1.617 1.058-2.703 0-1.084-.346-2-1.059-2.701-.713-.702-1.599-1.064-2.679-1.064-1.058 0-1.944.362-2.656 1.085-.714.702-1.059 1.596-1.059 2.68 0 1.086.345 2 1.059 2.724.712.702 1.598 1.064 2.656 1.064zm3.673-7.936V9.66h2.29v10.299c0 1.85-.584 3.32-1.728 4.404-1.146 1.085-2.68 1.638-4.58 1.638-1.945 0-3.672-.553-5.206-1.638l1.037-1.808c1.296.915 2.679 1.36 4.126 1.36 2.484 0 3.996-1.51 3.996-3.637v-.83c-1.015 1.127-2.311 1.702-3.91 1.702-1.684 0-3.089-.554-4.19-1.68-1.102-1.128-1.642-2.532-1.642-4.214 0-1.68.561-3.085 1.706-4.191 1.145-1.128 2.571-1.681 4.234-1.681 1.534 0 2.83.575 3.867 1.745zm-18.07 8.127c1.102 0 1.988-.382 2.7-1.128.714-.744 1.06-1.659 1.06-2.743 0-1.065-.346-1.98-1.06-2.724-.712-.745-1.598-1.128-2.7-1.128-1.101 0-2.008.383-2.7 1.128-.691.744-1.036 1.66-1.036 2.745 0 1.084.345 2 1.037 2.745.691.744 1.598 1.105 2.7 1.105zm3.652-8V9.66h2.29v11.469h-2.29v-1.575c-1.059 1.234-2.399 1.852-3.976 1.852-1.663 0-3.067-.575-4.168-1.745-1.102-1.17-1.642-2.617-1.642-4.34 0-1.724.54-3.128 1.642-4.256 1.1-1.128 2.505-1.681 4.168-1.681 1.577 0 2.917.617 3.976 1.872zM138.79 9.34c1.404 0 2.527.448 3.37 1.34.863.873 1.295 2.086 1.295 3.596v6.852h-2.376V14.66c0-2.021-1.036-3.128-2.657-3.128-1.727 0-2.915 1.255-2.915 3.192v6.404h-2.377v-6.426c0-1.978-1.037-3.17-2.679-3.17-1.728 0-2.937 1.277-2.937 3.234v6.362h-2.377V9.659h2.333v1.66c.692-1.212 1.988-1.979 3.522-1.979 1.533.021 2.958.767 3.586 2.107.798-1.277 2.419-2.107 4.212-2.107zm-19.517 11.788h2.484V5.405h-2.484v15.723z"/>\n    </g>\n</symbol></svg>',u='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs/><symbol id="icon-c-ic-apply" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path stroke="#e9e9e9" d="M4 12.011l5 5L20.011 6"/>\n    </g>\n</symbol><symbol id="icon-c-ic-cancel" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path stroke="#e9e9e9" d="M6 6l12 12M18 6L6 18"/>\n    </g>\n</symbol><symbol id="icon-c-ic-crop" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#e9e9e9" d="M4 0h1v20a1 1 0 0 1-1-1V0zM20 17h-1V5h1v12zm0 2v5h-1v-5h1z"/>\n        <path fill="#e9e9e9" d="M5 19h19v1H5zM4.762 4v1H0V4h4.762zM7 4h12a1 1 0 0 1 1 1H7V4z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-delete-all" viewBox="0 0 24 24">\n    <g fill="#e9e9e9" fill-rule="evenodd">\n        <path d="M5 23H3a1 1 0 0 1-1-1V6h1v16h2v1zm16-10h-1V6h1v7zM9 13H8v-3h1v3zm3 0h-1v-3h1v3zm3 0h-1v-3h1v3zM14.794 3.794L13 2h-3L8.206 3.794A.963.963 0 0 1 8 2.5l.703-1.055A1 1 0 0 1 9.535 1h3.93a1 1 0 0 1 .832.445L15 2.5a.965.965 0 0 1-.206 1.294zM14.197 4H8.803h5.394z"/>\n        <path d="M0 3h23v1H0zM11.286 21H8.714L8 23H7l1-2.8V20h.071L9.5 16h1l1.429 4H12v.2l1 2.8h-1l-.714-2zm-.357-1L10 17.4 9.071 20h1.858zM20 22h3v1h-4v-7h1v6zm-5 0h3v1h-4v-7h1v6z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-delete" viewBox="0 0 24 24">\n    <g fill="#e9e9e9" fill-rule="evenodd">\n        <path d="M3 6v16h17V6h1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6h1zM14.794 3.794L13 2h-3L8.206 3.794A.963.963 0 0 1 8 2.5l.703-1.055A1 1 0 0 1 9.535 1h3.93a1 1 0 0 1 .832.445L15 2.5a.965.965 0 0 1-.206 1.294zM14.197 4H8.803h5.394z"/>\n        <path d="M0 3h23v1H0zM8 10h1v6H8v-6zm3 0h1v6h-1v-6zm3 0h1v6h-1v-6z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-draw-free" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" d="M2.5 20.929C2.594 10.976 4.323 6 7.686 6c5.872 0 2.524 19 7.697 19s1.89-14.929 6.414-14.929 1.357 10.858 5.13 10.858c1.802 0 2.657-2.262 2.566-6.786"/>\n    </g>\n</symbol><symbol id="icon-c-ic-draw-line" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" d="M2 15.5h28"/>\n    </g>\n</symbol><symbol id="icon-c-ic-draw" viewBox="0 0 24 24">\n    <g fill="none">\n        <path stroke="#e9e9e9" d="M2.5 21.5H5c.245 0 .48-.058.691-.168l.124-.065.14.01c.429.028.85-.127 1.16-.437L22.55 5.405a.5.5 0 0 0 0-.707l-3.246-3.245a.5.5 0 0 0-.707 0L3.162 16.888a1.495 1.495 0 0 0-.437 1.155l.01.14-.065.123c-.111.212-.17.448-.17.694v2.5z"/>\n        <path fill="#e9e9e9" d="M16.414 3.707l3.89 3.89-.708.706-3.889-3.889z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-filter" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#e9e9e9" d="M12 7v1H2V7h10zm6 0h4v1h-4V7zM12 16v1h10v-1H12zm-6 0H2v1h4v-1z"/>\n        <path fill="#e9e9e9" d="M8.5 20a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7zm0-1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zM15.5 11a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7zm0-1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-flip-reset" viewBox="0 0 31 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M31 0H0v32h31z"/>\n        <path fill="#e9e9e9" d="M28 16a8 8 0 0 1-8 8H3v-1h1v-7H3a8 8 0 0 1 8-8h17v1h-1v7h1zM11 9a7 7 0 0 0-7 7v7h16a7 7 0 0 0 7-7V9H11z"/>\n        <path stroke="#e9e9e9" stroke-linecap="square" d="M24 5l3.5 3.5L24 12M7 20l-3.5 3.5L7 27"/>\n    </g>\n</symbol><symbol id="icon-c-ic-flip-x" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M32 32H0V0h32z"/>\n        <path fill="#e9e9e9" d="M17 32h-1V0h1zM27.167 11l.5 3h-1.03l-.546-3h1.076zm-.5-3h-1.122L25 5h-5V4h5.153a1 1 0 0 1 .986.836L26.667 8zm1.5 9l.5 3h-.94l-.545-3h.985zm1 6l.639 3.836A1 1 0 0 1 28.819 28H26v-1h3l-.726-4h.894zM23 28h-3v-1h3v1zM13 4v1H7L3 27h10v1H3.18a1 1 0 0 1-.986-1.164l3.666-22A1 1 0 0 1 6.847 4H13z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-flip-y" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0v32h32V0z"/>\n        <path fill="#e9e9e9" d="M0 16v1h32v-1zM11 27.167l3 .5v-1.03l-3-.546v1.076zm-3-.5v-1.122L5 25v-5H4v5.153a1 1 0 0 0 .836.986L8 26.667zm9 1.5l3 .5v-.94l-3-.545v.985zm6 1l3.836.639A1 1 0 0 0 28 28.82V26h-1v3l-4-.727v.894zM28 23v-3h-1v3h1zM4 13h1V7l22-4v10h1V3.18a1 1 0 0 0-1.164-.986l-22 3.667A1 1 0 0 0 4 6.847V13z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-flip" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#e9e9e9" d="M11 0h1v24h-1zM19 21v-1h2v-2h1v2a1 1 0 0 1-1 1h-2zm-2 0h-3v-1h3v1zm5-5h-1v-3h1v3zm0-5h-1V8h1v3zm0-5h-1V4h-2V3h2a1 1 0 0 1 1 1v2zm-5-3v1h-3V3h3zM9 3v1H2v16h7v1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h7z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-arrow-2" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" stroke-linecap="round" stroke-linejoin="round" d="M21.793 18.5H2.5v-5h18.935l-7.6-8h5.872l10.5 10.5-10.5 10.5h-5.914l8-8z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-arrow-3" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" stroke-linecap="round" stroke-linejoin="round" d="M25.288 16.42L14.208 27.5H6.792l11.291-11.291L6.826 4.5h7.381l11.661 11.661-.58.258z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-arrow" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" d="M2.5 11.5v9h18v5.293L30.293 16 20.5 6.207V11.5h-18z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-bubble" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" stroke-linecap="round" stroke-linejoin="round" d="M22.207 24.5L16.5 30.207V24.5H8A6.5 6.5 0 0 1 1.5 18V9A6.5 6.5 0 0 1 8 2.5h16A6.5 6.5 0 0 1 30.5 9v9a6.5 6.5 0 0 1-6.5 6.5h-1.793z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-heart" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill-rule="nonzero" stroke="#e9e9e9" d="M15.996 30.675l1.981-1.79c7.898-7.177 10.365-9.718 12.135-13.012.922-1.716 1.377-3.37 1.377-5.076 0-4.65-3.647-8.297-8.297-8.297-2.33 0-4.86 1.527-6.817 3.824l-.38.447-.381-.447C13.658 4.027 11.126 2.5 8.797 2.5 4.147 2.5.5 6.147.5 10.797c0 1.714.46 3.375 1.389 5.098 1.775 3.288 4.26 5.843 12.123 12.974l1.984 1.806z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-load" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" stroke-linecap="round" stroke-linejoin="round" d="M17.314 18.867l1.951-2.53 4 5.184h-17l6.5-8.84 4.549 6.186z"/>\n        <path fill="#e9e9e9" d="M18.01 4a11.798 11.798 0 0 0 0 1H3v24h24V14.986a8.738 8.738 0 0 0 1 0V29a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h15.01z"/>\n        <path fill="#e9e9e9" d="M25 3h1v9h-1z"/>\n        <path stroke="#e9e9e9" d="M22 6l3.5-3.5L29 6"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-location" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <g stroke="#e9e9e9">\n            <path d="M16 31.28C23.675 23.302 27.5 17.181 27.5 13c0-6.351-5.149-11.5-11.5-11.5S4.5 6.649 4.5 13c0 4.181 3.825 10.302 11.5 18.28z"/>\n            <circle cx="16" cy="13" r="4.5"/>\n        </g>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-polygon" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" d="M.576 16L8.29 29.5h15.42L31.424 16 23.71 2.5H8.29L.576 16z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-star-2" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" d="M19.446 31.592l2.265-3.272 3.946.25.636-3.94 3.665-1.505-1.12-3.832 2.655-2.962-2.656-2.962 1.12-3.832-3.664-1.505-.636-3.941-3.946.25-2.265-3.271L16 3.024 12.554 1.07 10.289 4.34l-3.946-.25-.636 3.941-3.665 1.505 1.12 3.832L.508 16.33l2.656 2.962-1.12 3.832 3.664 1.504.636 3.942 3.946-.25 2.265 3.27L16 29.638l3.446 1.955z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon-star" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" d="M25.292 29.878l-1.775-10.346 7.517-7.327-10.388-1.51L16 1.282l-4.646 9.413-10.388 1.51 7.517 7.327-1.775 10.346L16 24.993l9.292 4.885z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-icon" viewBox="0 0 24 24">\n    <g fill="none">\n        <path stroke="#e9e9e9" stroke-linecap="round" stroke-linejoin="round" d="M11.923 19.136L5.424 22l.715-7.065-4.731-5.296 6.94-1.503L11.923 2l3.574 6.136 6.94 1.503-4.731 5.296L18.42 22z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-mask-load" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#e9e9e9" d="M18.01 4a11.798 11.798 0 0 0 0 1H3v24h24V14.986a8.738 8.738 0 0 0 1 0V29a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h15.01zM15 23a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-1a5 5 0 1 0 0-10 5 5 0 0 0 0 10z"/>\n        <path fill="#e9e9e9" d="M25 3h1v9h-1z"/>\n        <path stroke="#e9e9e9" d="M22 6l3.5-3.5L29 6"/>\n    </g>\n</symbol><symbol id="icon-c-ic-mask" viewBox="0 0 24 24">\n    <g fill="none">\n        <circle cx="12" cy="12" r="4.5" stroke="#e9e9e9"/>\n        <path fill="#e9e9e9" d="M2 1h20a1 1 0 0 1 1 1v20a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zm0 1v20h20V2H2z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-redo" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z" opacity=".5"/>\n        <path fill="#e9e9e9" d="M21 6H9a6 6 0 1 0 0 12h12v1H9A7 7 0 0 1 9 5h12v1z"/>\n        <path stroke="#e9e9e9" stroke-linecap="square" d="M19 3l2.5 2.5L19 8"/>\n    </g>\n</symbol><symbol id="icon-c-ic-reset" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z" opacity=".5"/>\n        <path fill="#e9e9e9" d="M2 13v-1a7 7 0 0 1 7-7h13v1h-1v5h1v1a7 7 0 0 1-7 7H2v-1h1v-5H2zm7-7a6 6 0 0 0-6 6v6h12a6 6 0 0 0 6-6V6H9z"/>\n        <path stroke="#e9e9e9" stroke-linecap="square" d="M19 3l2.5 2.5L19 8M5 16l-2.5 2.5L5 21"/>\n    </g>\n</symbol><symbol id="icon-c-ic-rotate-clockwise" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#e9e9e9" d="M29 17h-.924c0 6.627-5.373 12-12 12-6.628 0-12-5.373-12-12C4.076 10.398 9.407 5.041 16 5V4C8.82 4 3 9.82 3 17s5.82 13 13 13 13-5.82 13-13z"/>\n        <path stroke="#e9e9e9" stroke-linecap="square" d="M16 1.5l4 3-4 3"/>\n        <path fill="#e9e9e9" fill-rule="nonzero" d="M16 4h4v1h-4z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-rotate-counterclockwise" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#e9e9e9" d="M3 17h.924c0 6.627 5.373 12 12 12 6.628 0 12-5.373 12-12 0-6.602-5.331-11.96-11.924-12V4c7.18 0 13 5.82 13 13s-5.82 13-13 13S3 24.18 3 17z"/>\n        <path fill="#e9e9e9" fill-rule="nonzero" d="M12 4h4v1h-4z"/>\n        <path stroke="#e9e9e9" stroke-linecap="square" d="M16 1.5l-4 3 4 3"/>\n    </g>\n</symbol><symbol id="icon-c-ic-rotate" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#e9e9e9" d="M8.349 22.254a10.002 10.002 0 0 1-2.778-1.719l.65-.76a9.002 9.002 0 0 0 2.495 1.548l-.367.931zm2.873.704l.078-.997a9 9 0 1 0-.557-17.852l-.14-.99A10.076 10.076 0 0 1 12.145 3c5.523 0 10 4.477 10 10s-4.477 10-10 10c-.312 0-.62-.014-.924-.042zm-7.556-4.655a9.942 9.942 0 0 1-1.253-2.996l.973-.234a8.948 8.948 0 0 0 1.124 2.693l-.844.537zm-1.502-5.91A9.949 9.949 0 0 1 2.88 9.23l.925.382a8.954 8.954 0 0 0-.644 2.844l-.998-.062zm2.21-5.686c.687-.848 1.51-1.58 2.436-2.166l.523.852a9.048 9.048 0 0 0-2.188 1.95l-.771-.636z"/>\n        <path stroke="#e9e9e9" stroke-linecap="square" d="M13 1l-2.5 2.5L13 6"/>\n    </g>\n</symbol><symbol id="icon-c-ic-shape-circle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <circle cx="16" cy="16" r="14.5" stroke="#e9e9e9"/>\n    </g>\n</symbol><symbol id="icon-c-ic-shape-rectangle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <rect width="27" height="27" x="2.5" y="2.5" stroke="#e9e9e9" rx="1"/>\n    </g>\n</symbol><symbol id="icon-c-ic-shape-triangle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#e9e9e9" stroke-linecap="round" stroke-linejoin="round" d="M16 2.5l15.5 27H.5z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-shape" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#e9e9e9" d="M14.706 8H21a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-4h1v4h12V9h-5.706l-.588-1z"/>\n        <path stroke="#e9e9e9" stroke-linecap="round" stroke-linejoin="round" d="M8.5 1.5l7.5 13H1z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-text-align-center" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#e9e9e9" d="M2 5h28v1H2zM8 12h16v1H8zM2 19h28v1H2zM8 26h16v1H8z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-text-align-left" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#e9e9e9" d="M2 5h28v1H2zM2 12h16v1H2zM2 19h28v1H2zM2 26h16v1H2z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-text-align-right" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#e9e9e9" d="M2 5h28v1H2zM14 12h16v1H14zM2 19h28v1H2zM14 26h16v1H14z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-text-bold" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#e9e9e9" d="M7 2h2v2H7zM7 28h2v2H7z"/>\n        <path stroke="#e9e9e9" stroke-width="2" d="M9 3v12h9a6 6 0 1 0 0-12H9zM9 15v14h10a7 7 0 0 0 0-14H9z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-text-italic" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#e9e9e9" d="M15 2h5v1h-5zM11 29h5v1h-5zM17 3h1l-4 26h-1z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-text-underline" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#e9e9e9" d="M8 2v14a8 8 0 1 0 16 0V2h1v14a9 9 0 0 1-18 0V2h1zM3 29h26v1H3z"/>\n        <path fill="#e9e9e9" d="M5 2h5v1H5zM22 2h5v1h-5z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-text" viewBox="0 0 24 24">\n    <g fill="#e9e9e9" fill-rule="evenodd">\n        <path d="M4 3h15a1 1 0 0 1 1 1H3a1 1 0 0 1 1-1zM3 4h1v1H3zM19 4h1v1h-1z"/>\n        <path d="M11 3h1v18h-1z"/>\n        <path d="M10 20h3v1h-3z"/>\n    </g>\n</symbol><symbol id="icon-c-ic-undo" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M24 0H0v24h24z" opacity=".5"/>\n        <path fill="#e9e9e9" d="M3 6h12a6 6 0 1 1 0 12H3v1h12a7 7 0 0 0 0-14H3v1z"/>\n        <path stroke="#e9e9e9" stroke-linecap="square" d="M5 3L2.5 5.5 5 8"/>\n    </g>\n</symbol><symbol id="icon-c-img-bi" viewBox="0 0 257 26">\n    <g fill="#FDBA3B">\n        <path d="M26 5a8.001 8.001 0 0 0 0 16 8.001 8.001 0 0 0 0-16M51.893 19.812L43.676 5.396A.78.78 0 0 0 43 5a.78.78 0 0 0-.677.396l-8.218 14.418a.787.787 0 0 0 0 .792c.14.244.396.394.676.394h16.436c.28 0 .539-.15.678-.396a.796.796 0 0 0-.002-.792M15.767 5.231A.79.79 0 0 0 15.21 5H.791A.791.791 0 0 0 0 5.79v6.42a.793.793 0 0 0 .791.79h3.21v7.21c.001.21.082.408.234.56.147.148.347.23.558.23h6.416a.788.788 0 0 0 .792-.79V13h3.006c.413 0 .611-.082.762-.232.15-.149.23-.35.231-.559V5.791a.787.787 0 0 0-.233-.56M85.767 5.231A.79.79 0 0 0 85.21 5H70.791a.791.791 0 0 0-.791.79v6.42a.793.793 0 0 0 .791.79h3.21v7.21c.001.21.082.408.234.56.147.148.347.23.558.23h6.416a.788.788 0 0 0 .792-.79V13h3.006c.413 0 .611-.082.762-.232.15-.149.23-.35.231-.559V5.791a.787.787 0 0 0-.233-.56M65.942 9.948l2.17-3.76a.78.78 0 0 0 0-.792.791.791 0 0 0-.684-.396h-8.54A5.889 5.889 0 0 0 53 10.86a5.887 5.887 0 0 0 3.07 5.17l-2.184 3.782A.792.792 0 0 0 54.571 21h8.54a5.89 5.89 0 0 0 2.831-11.052M105.7 21h2.3V5h-2.3zM91 5h2.4v10.286c0 1.893 1.612 3.429 3.6 3.429s3.6-1.536 3.6-3.429V5h2.4v10.286c0 3.156-2.686 5.714-6 5.714-3.313 0-6-2.558-6-5.714V5zM252.148 21.128h-2.377V9.659h2.27v1.64c.69-1.299 1.792-1.938 3.304-1.938.497 0 .95.065 1.382.192l-.215 2.277a3.734 3.734 0 0 0-1.275-.213c-1.814 0-3.089 1.234-3.089 3.638v5.873zm-7.095-5.744a3.734 3.734 0 0 0-1.101-2.703c-.714-.766-1.6-1.149-2.658-1.149-1.058 0-1.944.383-2.679 1.149a3.803 3.803 0 0 0-1.08 2.703c0 1.063.368 1.978 1.08 2.722.735.746 1.62 1.128 2.68 1.128 1.058 0 1.943-.382 2.657-1.128.734-.744 1.101-1.659 1.101-2.722zm-9.916 0c0-1.682.583-3.086 1.729-4.256 1.166-1.17 2.635-1.767 4.428-1.767 1.793 0 3.262.597 4.407 1.767 1.167 1.17 1.75 2.574 1.75 4.256 0 1.7-.583 3.127-1.75 4.297-1.145 1.17-2.614 1.745-4.407 1.745-1.793 0-3.262-.575-4.428-1.745-1.146-1.17-1.729-2.596-1.729-4.297zm-1.5 3.233l.821 1.83c-.864.638-1.944.958-3.22.958-2.526 0-3.822-1.554-3.822-4.383V11.66h-2.01v-2h2.031V5.595h2.355v4.063h4.018v2h-4.018v5.405c0 1.469.605 2.191 1.793 2.191.626 0 1.318-.212 2.052-.638zm-12.43 2.51h2.375V9.66h-2.376v11.469zm1.23-12.977c-.929 0-1.642-.682-1.642-1.596 0-.873.713-1.554 1.643-1.554.885 0 1.576.681 1.576 1.554 0 .914-.69 1.596-1.576 1.596zm-6.49 7.234c0-1.086-.346-1.98-1.037-2.724-.692-.745-1.599-1.128-2.7-1.128-1.102 0-2.01.383-2.7 1.128-.692.744-1.037 1.638-1.037 2.724 0 1.084.345 2.02 1.036 2.766.691.744 1.6 1.105 2.7 1.105 1.102 0 2.01-.361 2.7-1.105.692-.746 1.038-1.682 1.038-2.766zm-.173-4.129V5h2.397v16.128h-2.354v-1.596c-1.015 1.255-2.333 1.873-3.91 1.873-1.663 0-3.068-.575-4.169-1.724-1.102-1.17-1.663-2.596-1.663-4.297 0-1.682.561-3.107 1.663-4.256 1.101-1.17 2.485-1.745 4.148-1.745 1.534 0 2.83.617 3.888 1.872zm-11.48 9.873h-10.218V5.405h10.195v2.318h-7.711V12h7.15v2.32h-7.15v4.489h7.733v2.319zm-23.891-9.724c-1.793 0-3.132 1.192-3.478 2.979h6.783c-.194-1.808-1.555-2.979-3.305-2.979zm5.703 3.766c0 .32-.021.703-.086 1.128h-9.095c.346 1.787 1.62 3 3.867 3 1.318 0 2.916-.49 3.953-1.234l.994 1.724c-1.189.872-3.067 1.595-5.033 1.595-4.364 0-6.243-3-6.243-6.021 0-1.724.54-3.15 1.642-4.277 1.101-1.127 2.548-1.702 4.298-1.702 1.664 0 3.046.511 4.105 1.553 1.058 1.043 1.598 2.447 1.598 4.234zm-19.949 3.894c1.08 0 1.966-.362 2.68-1.085.712-.724 1.058-1.617 1.058-2.703 0-1.084-.346-2-1.059-2.701-.713-.702-1.599-1.064-2.679-1.064-1.058 0-1.944.362-2.656 1.085-.714.702-1.059 1.596-1.059 2.68 0 1.086.345 2 1.059 2.724.712.702 1.598 1.064 2.656 1.064zm3.673-7.936V9.66h2.29v10.299c0 1.85-.584 3.32-1.728 4.404-1.146 1.085-2.68 1.638-4.58 1.638-1.945 0-3.672-.553-5.206-1.638l1.037-1.808c1.296.915 2.679 1.36 4.126 1.36 2.484 0 3.996-1.51 3.996-3.637v-.83c-1.015 1.127-2.311 1.702-3.91 1.702-1.684 0-3.089-.554-4.19-1.68-1.102-1.128-1.642-2.532-1.642-4.214 0-1.68.561-3.085 1.706-4.191 1.145-1.128 2.571-1.681 4.234-1.681 1.534 0 2.83.575 3.867 1.745zm-18.07 8.127c1.102 0 1.988-.382 2.7-1.128.714-.744 1.06-1.659 1.06-2.743 0-1.065-.346-1.98-1.06-2.724-.712-.745-1.598-1.128-2.7-1.128-1.101 0-2.008.383-2.7 1.128-.691.744-1.036 1.66-1.036 2.745 0 1.084.345 2 1.037 2.745.691.744 1.598 1.105 2.7 1.105zm3.652-8V9.66h2.29v11.469h-2.29v-1.575c-1.059 1.234-2.399 1.852-3.976 1.852-1.663 0-3.067-.575-4.168-1.745-1.102-1.17-1.642-2.617-1.642-4.34 0-1.724.54-3.128 1.642-4.256 1.1-1.128 2.505-1.681 4.168-1.681 1.577 0 2.917.617 3.976 1.872zM138.79 9.34c1.404 0 2.527.448 3.37 1.34.863.873 1.295 2.086 1.295 3.596v6.852h-2.376V14.66c0-2.021-1.036-3.128-2.657-3.128-1.727 0-2.915 1.255-2.915 3.192v6.404h-2.377v-6.426c0-1.978-1.037-3.17-2.679-3.17-1.728 0-2.937 1.277-2.937 3.234v6.362h-2.377V9.659h2.333v1.66c.692-1.212 1.988-1.979 3.522-1.979 1.533.021 2.958.767 3.586 2.107.798-1.277 2.419-2.107 4.212-2.107zm-19.517 11.788h2.484V5.405h-2.484v15.723z"/>\n    </g>\n</symbol></svg>',h='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs/><symbol id="icon-d-ic-apply" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path stroke="#8a8a8a" d="M4 12.011l5 5L20.011 6"/>\n    </g>\n</symbol><symbol id="icon-d-ic-cancel" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path stroke="#8a8a8a" d="M6 6l12 12M18 6L6 18"/>\n    </g>\n</symbol><symbol id="icon-d-ic-crop" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#8a8a8a" d="M4 0h1v20a1 1 0 0 1-1-1V0zM20 17h-1V5h1v12zm0 2v5h-1v-5h1z"/>\n        <path fill="#8a8a8a" d="M5 19h19v1H5zM4.762 4v1H0V4h4.762zM7 4h12a1 1 0 0 1 1 1H7V4z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-delete-all" viewBox="0 0 24 24">\n    <g fill="#8a8a8a" fill-rule="evenodd">\n        <path d="M5 23H3a1 1 0 0 1-1-1V6h1v16h2v1zm16-10h-1V6h1v7zM9 13H8v-3h1v3zm3 0h-1v-3h1v3zm3 0h-1v-3h1v3zM14.794 3.794L13 2h-3L8.206 3.794A.963.963 0 0 1 8 2.5l.703-1.055A1 1 0 0 1 9.535 1h3.93a1 1 0 0 1 .832.445L15 2.5a.965.965 0 0 1-.206 1.294zM14.197 4H8.803h5.394z"/>\n        <path d="M0 3h23v1H0zM11.286 21H8.714L8 23H7l1-2.8V20h.071L9.5 16h1l1.429 4H12v.2l1 2.8h-1l-.714-2zm-.357-1L10 17.4 9.071 20h1.858zM20 22h3v1h-4v-7h1v6zm-5 0h3v1h-4v-7h1v6z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-delete" viewBox="0 0 24 24">\n    <g fill="#8a8a8a" fill-rule="evenodd">\n        <path d="M3 6v16h17V6h1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6h1zM14.794 3.794L13 2h-3L8.206 3.794A.963.963 0 0 1 8 2.5l.703-1.055A1 1 0 0 1 9.535 1h3.93a1 1 0 0 1 .832.445L15 2.5a.965.965 0 0 1-.206 1.294zM14.197 4H8.803h5.394z"/>\n        <path d="M0 3h23v1H0zM8 10h1v6H8v-6zm3 0h1v6h-1v-6zm3 0h1v6h-1v-6z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-draw-free" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" d="M2.5 20.929C2.594 10.976 4.323 6 7.686 6c5.872 0 2.524 19 7.697 19s1.89-14.929 6.414-14.929 1.357 10.858 5.13 10.858c1.802 0 2.657-2.262 2.566-6.786"/>\n    </g>\n</symbol><symbol id="icon-d-ic-draw-line" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" d="M2 15.5h28"/>\n    </g>\n</symbol><symbol id="icon-d-ic-draw" viewBox="0 0 24 24">\n    <g fill="none">\n        <path stroke="#8a8a8a" d="M2.5 21.5H5c.245 0 .48-.058.691-.168l.124-.065.14.01c.429.028.85-.127 1.16-.437L22.55 5.405a.5.5 0 0 0 0-.707l-3.246-3.245a.5.5 0 0 0-.707 0L3.162 16.888a1.495 1.495 0 0 0-.437 1.155l.01.14-.065.123c-.111.212-.17.448-.17.694v2.5z"/>\n        <path fill="#8a8a8a" d="M16.414 3.707l3.89 3.89-.708.706-3.889-3.889z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-filter" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#8a8a8a" d="M12 7v1H2V7h10zm6 0h4v1h-4V7zM12 16v1h10v-1H12zm-6 0H2v1h4v-1z"/>\n        <path fill="#8a8a8a" d="M8.5 20a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7zm0-1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zM15.5 11a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7zm0-1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-flip-reset" viewBox="0 0 31 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M31 0H0v32h31z"/>\n        <path fill="#8a8a8a" d="M28 16a8 8 0 0 1-8 8H3v-1h1v-7H3a8 8 0 0 1 8-8h17v1h-1v7h1zM11 9a7 7 0 0 0-7 7v7h16a7 7 0 0 0 7-7V9H11z"/>\n        <path stroke="#8a8a8a" stroke-linecap="square" d="M24 5l3.5 3.5L24 12M7 20l-3.5 3.5L7 27"/>\n    </g>\n</symbol><symbol id="icon-d-ic-flip-x" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M32 32H0V0h32z"/>\n        <path fill="#8a8a8a" d="M17 32h-1V0h1zM27.167 11l.5 3h-1.03l-.546-3h1.076zm-.5-3h-1.122L25 5h-5V4h5.153a1 1 0 0 1 .986.836L26.667 8zm1.5 9l.5 3h-.94l-.545-3h.985zm1 6l.639 3.836A1 1 0 0 1 28.819 28H26v-1h3l-.726-4h.894zM23 28h-3v-1h3v1zM13 4v1H7L3 27h10v1H3.18a1 1 0 0 1-.986-1.164l3.666-22A1 1 0 0 1 6.847 4H13z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-flip-y" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0v32h32V0z"/>\n        <path fill="#8a8a8a" d="M0 16v1h32v-1zM11 27.167l3 .5v-1.03l-3-.546v1.076zm-3-.5v-1.122L5 25v-5H4v5.153a1 1 0 0 0 .836.986L8 26.667zm9 1.5l3 .5v-.94l-3-.545v.985zm6 1l3.836.639A1 1 0 0 0 28 28.82V26h-1v3l-4-.727v.894zM28 23v-3h-1v3h1zM4 13h1V7l22-4v10h1V3.18a1 1 0 0 0-1.164-.986l-22 3.667A1 1 0 0 0 4 6.847V13z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-flip" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#8a8a8a" d="M11 0h1v24h-1zM19 21v-1h2v-2h1v2a1 1 0 0 1-1 1h-2zm-2 0h-3v-1h3v1zm5-5h-1v-3h1v3zm0-5h-1V8h1v3zm0-5h-1V4h-2V3h2a1 1 0 0 1 1 1v2zm-5-3v1h-3V3h3zM9 3v1H2v16h7v1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h7z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-arrow-2" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" stroke-linecap="round" stroke-linejoin="round" d="M21.793 18.5H2.5v-5h18.935l-7.6-8h5.872l10.5 10.5-10.5 10.5h-5.914l8-8z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-arrow-3" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" stroke-linecap="round" stroke-linejoin="round" d="M25.288 16.42L14.208 27.5H6.792l11.291-11.291L6.826 4.5h7.381l11.661 11.661-.58.258z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-arrow" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" d="M2.5 11.5v9h18v5.293L30.293 16 20.5 6.207V11.5h-18z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-bubble" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" stroke-linecap="round" stroke-linejoin="round" d="M22.207 24.5L16.5 30.207V24.5H8A6.5 6.5 0 0 1 1.5 18V9A6.5 6.5 0 0 1 8 2.5h16A6.5 6.5 0 0 1 30.5 9v9a6.5 6.5 0 0 1-6.5 6.5h-1.793z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-heart" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill-rule="nonzero" stroke="#8a8a8a" d="M15.996 30.675l1.981-1.79c7.898-7.177 10.365-9.718 12.135-13.012.922-1.716 1.377-3.37 1.377-5.076 0-4.65-3.647-8.297-8.297-8.297-2.33 0-4.86 1.527-6.817 3.824l-.38.447-.381-.447C13.658 4.027 11.126 2.5 8.797 2.5 4.147 2.5.5 6.147.5 10.797c0 1.714.46 3.375 1.389 5.098 1.775 3.288 4.26 5.843 12.123 12.974l1.984 1.806z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-load" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" stroke-linecap="round" stroke-linejoin="round" d="M17.314 18.867l1.951-2.53 4 5.184h-17l6.5-8.84 4.549 6.186z"/>\n        <path fill="#8a8a8a" d="M18.01 4a11.798 11.798 0 0 0 0 1H3v24h24V14.986a8.738 8.738 0 0 0 1 0V29a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h15.01z"/>\n        <path fill="#8a8a8a" d="M25 3h1v9h-1z"/>\n        <path stroke="#8a8a8a" d="M22 6l3.5-3.5L29 6"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-location" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <g stroke="#8a8a8a">\n            <path d="M16 31.28C23.675 23.302 27.5 17.181 27.5 13c0-6.351-5.149-11.5-11.5-11.5S4.5 6.649 4.5 13c0 4.181 3.825 10.302 11.5 18.28z"/>\n            <circle cx="16" cy="13" r="4.5"/>\n        </g>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-polygon" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" d="M.576 16L8.29 29.5h15.42L31.424 16 23.71 2.5H8.29L.576 16z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-star-2" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" d="M19.446 31.592l2.265-3.272 3.946.25.636-3.94 3.665-1.505-1.12-3.832 2.655-2.962-2.656-2.962 1.12-3.832-3.664-1.505-.636-3.941-3.946.25-2.265-3.271L16 3.024 12.554 1.07 10.289 4.34l-3.946-.25-.636 3.941-3.665 1.505 1.12 3.832L.508 16.33l2.656 2.962-1.12 3.832 3.664 1.504.636 3.942 3.946-.25 2.265 3.27L16 29.638l3.446 1.955z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon-star" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" d="M25.292 29.878l-1.775-10.346 7.517-7.327-10.388-1.51L16 1.282l-4.646 9.413-10.388 1.51 7.517 7.327-1.775 10.346L16 24.993l9.292 4.885z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-icon" viewBox="0 0 24 24">\n    <g fill="none">\n        <path stroke="#8a8a8a" stroke-linecap="round" stroke-linejoin="round" d="M11.923 19.136L5.424 22l.715-7.065-4.731-5.296 6.94-1.503L11.923 2l3.574 6.136 6.94 1.503-4.731 5.296L18.42 22z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-mask-load" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#8a8a8a" d="M18.01 4a11.798 11.798 0 0 0 0 1H3v24h24V14.986a8.738 8.738 0 0 0 1 0V29a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h15.01zM15 23a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-1a5 5 0 1 0 0-10 5 5 0 0 0 0 10z"/>\n        <path fill="#8a8a8a" d="M25 3h1v9h-1z"/>\n        <path stroke="#8a8a8a" d="M22 6l3.5-3.5L29 6"/>\n    </g>\n</symbol><symbol id="icon-d-ic-mask" viewBox="0 0 24 24">\n    <g fill="none">\n        <circle cx="12" cy="12" r="4.5" stroke="#8a8a8a"/>\n        <path fill="#8a8a8a" d="M2 1h20a1 1 0 0 1 1 1v20a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zm0 1v20h20V2H2z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-redo" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z" opacity=".5"/>\n        <path fill="#8a8a8a" d="M21 6H9a6 6 0 1 0 0 12h12v1H9A7 7 0 0 1 9 5h12v1z"/>\n        <path stroke="#8a8a8a" stroke-linecap="square" d="M19 3l2.5 2.5L19 8"/>\n    </g>\n</symbol><symbol id="icon-d-ic-reset" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z" opacity=".5"/>\n        <path fill="#8a8a8a" d="M2 13v-1a7 7 0 0 1 7-7h13v1h-1v5h1v1a7 7 0 0 1-7 7H2v-1h1v-5H2zm7-7a6 6 0 0 0-6 6v6h12a6 6 0 0 0 6-6V6H9z"/>\n        <path stroke="#8a8a8a" stroke-linecap="square" d="M19 3l2.5 2.5L19 8M5 16l-2.5 2.5L5 21"/>\n    </g>\n</symbol><symbol id="icon-d-ic-rotate-clockwise" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#8a8a8a" d="M29 17h-.924c0 6.627-5.373 12-12 12-6.628 0-12-5.373-12-12C4.076 10.398 9.407 5.041 16 5V4C8.82 4 3 9.82 3 17s5.82 13 13 13 13-5.82 13-13z"/>\n        <path stroke="#8a8a8a" stroke-linecap="square" d="M16 1.5l4 3-4 3"/>\n        <path fill="#8a8a8a" fill-rule="nonzero" d="M16 4h4v1h-4z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-rotate-counterclockwise" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#8a8a8a" d="M3 17h.924c0 6.627 5.373 12 12 12 6.628 0 12-5.373 12-12 0-6.602-5.331-11.96-11.924-12V4c7.18 0 13 5.82 13 13s-5.82 13-13 13S3 24.18 3 17z"/>\n        <path fill="#8a8a8a" fill-rule="nonzero" d="M12 4h4v1h-4z"/>\n        <path stroke="#8a8a8a" stroke-linecap="square" d="M16 1.5l-4 3 4 3"/>\n    </g>\n</symbol><symbol id="icon-d-ic-rotate" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h24v24H0z"/>\n        <path fill="#8a8a8a" d="M8.349 22.254a10.002 10.002 0 0 1-2.778-1.719l.65-.76a9.002 9.002 0 0 0 2.495 1.548l-.367.931zm2.873.704l.078-.997a9 9 0 1 0-.557-17.852l-.14-.99A10.076 10.076 0 0 1 12.145 3c5.523 0 10 4.477 10 10s-4.477 10-10 10c-.312 0-.62-.014-.924-.042zm-7.556-4.655a9.942 9.942 0 0 1-1.253-2.996l.973-.234a8.948 8.948 0 0 0 1.124 2.693l-.844.537zm-1.502-5.91A9.949 9.949 0 0 1 2.88 9.23l.925.382a8.954 8.954 0 0 0-.644 2.844l-.998-.062zm2.21-5.686c.687-.848 1.51-1.58 2.436-2.166l.523.852a9.048 9.048 0 0 0-2.188 1.95l-.771-.636z"/>\n        <path stroke="#8a8a8a" stroke-linecap="square" d="M13 1l-2.5 2.5L13 6"/>\n    </g>\n</symbol><symbol id="icon-d-ic-shape-circle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <circle cx="16" cy="16" r="14.5" stroke="#8a8a8a"/>\n    </g>\n</symbol><symbol id="icon-d-ic-shape-rectangle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <rect width="27" height="27" x="2.5" y="2.5" stroke="#8a8a8a" rx="1"/>\n    </g>\n</symbol><symbol id="icon-d-ic-shape-triangle" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#8a8a8a" stroke-linecap="round" stroke-linejoin="round" d="M16 2.5l15.5 27H.5z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-shape" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#8a8a8a" d="M14.706 8H21a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-4h1v4h12V9h-5.706l-.588-1z"/>\n        <path stroke="#8a8a8a" stroke-linecap="round" stroke-linejoin="round" d="M8.5 1.5l7.5 13H1z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-text-align-center" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#8a8a8a" d="M2 5h28v1H2zM8 12h16v1H8zM2 19h28v1H2zM8 26h16v1H8z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-text-align-left" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#8a8a8a" d="M2 5h28v1H2zM2 12h16v1H2zM2 19h28v1H2zM2 26h16v1H2z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-text-align-right" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#8a8a8a" d="M2 5h28v1H2zM14 12h16v1H14zM2 19h28v1H2zM14 26h16v1H14z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-text-bold" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#8a8a8a" d="M7 2h2v2H7zM7 28h2v2H7z"/>\n        <path stroke="#8a8a8a" stroke-width="2" d="M9 3v12h9a6 6 0 1 0 0-12H9zM9 15v14h10a7 7 0 0 0 0-14H9z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-text-italic" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#8a8a8a" d="M15 2h5v1h-5zM11 29h5v1h-5zM17 3h1l-4 26h-1z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-text-underline" viewBox="0 0 32 32">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M0 0h32v32H0z"/>\n        <path fill="#8a8a8a" d="M8 2v14a8 8 0 1 0 16 0V2h1v14a9 9 0 0 1-18 0V2h1zM3 29h26v1H3z"/>\n        <path fill="#8a8a8a" d="M5 2h5v1H5zM22 2h5v1h-5z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-text" viewBox="0 0 24 24">\n    <g fill="#8a8a8a" fill-rule="evenodd">\n        <path d="M4 3h15a1 1 0 0 1 1 1H3a1 1 0 0 1 1-1zM3 4h1v1H3zM19 4h1v1h-1z"/>\n        <path d="M11 3h1v18h-1z"/>\n        <path d="M10 20h3v1h-3z"/>\n    </g>\n</symbol><symbol id="icon-d-ic-undo" viewBox="0 0 24 24">\n    <g fill="none" fill-rule="evenodd">\n        <path d="M24 0H0v24h24z" opacity=".5"/>\n        <path fill="#8a8a8a" d="M3 6h12a6 6 0 1 1 0 12H3v1h12a7 7 0 0 0 0-14H3v1z"/>\n        <path stroke="#8a8a8a" stroke-linecap="square" d="M5 3L2.5 5.5 5 8"/>\n    </g>\n</symbol><symbol id="icon-d-img-bi" viewBox="0 0 257 26">\n    <g fill="#FDBA3B">\n        <path d="M26 5a8.001 8.001 0 0 0 0 16 8.001 8.001 0 0 0 0-16M51.893 19.812L43.676 5.396A.78.78 0 0 0 43 5a.78.78 0 0 0-.677.396l-8.218 14.418a.787.787 0 0 0 0 .792c.14.244.396.394.676.394h16.436c.28 0 .539-.15.678-.396a.796.796 0 0 0-.002-.792M15.767 5.231A.79.79 0 0 0 15.21 5H.791A.791.791 0 0 0 0 5.79v6.42a.793.793 0 0 0 .791.79h3.21v7.21c.001.21.082.408.234.56.147.148.347.23.558.23h6.416a.788.788 0 0 0 .792-.79V13h3.006c.413 0 .611-.082.762-.232.15-.149.23-.35.231-.559V5.791a.787.787 0 0 0-.233-.56M85.767 5.231A.79.79 0 0 0 85.21 5H70.791a.791.791 0 0 0-.791.79v6.42a.793.793 0 0 0 .791.79h3.21v7.21c.001.21.082.408.234.56.147.148.347.23.558.23h6.416a.788.788 0 0 0 .792-.79V13h3.006c.413 0 .611-.082.762-.232.15-.149.23-.35.231-.559V5.791a.787.787 0 0 0-.233-.56M65.942 9.948l2.17-3.76a.78.78 0 0 0 0-.792.791.791 0 0 0-.684-.396h-8.54A5.889 5.889 0 0 0 53 10.86a5.887 5.887 0 0 0 3.07 5.17l-2.184 3.782A.792.792 0 0 0 54.571 21h8.54a5.89 5.89 0 0 0 2.831-11.052M105.7 21h2.3V5h-2.3zM91 5h2.4v10.286c0 1.893 1.612 3.429 3.6 3.429s3.6-1.536 3.6-3.429V5h2.4v10.286c0 3.156-2.686 5.714-6 5.714-3.313 0-6-2.558-6-5.714V5zM252.148 21.128h-2.377V9.659h2.27v1.64c.69-1.299 1.792-1.938 3.304-1.938.497 0 .95.065 1.382.192l-.215 2.277a3.734 3.734 0 0 0-1.275-.213c-1.814 0-3.089 1.234-3.089 3.638v5.873zm-7.095-5.744a3.734 3.734 0 0 0-1.101-2.703c-.714-.766-1.6-1.149-2.658-1.149-1.058 0-1.944.383-2.679 1.149a3.803 3.803 0 0 0-1.08 2.703c0 1.063.368 1.978 1.08 2.722.735.746 1.62 1.128 2.68 1.128 1.058 0 1.943-.382 2.657-1.128.734-.744 1.101-1.659 1.101-2.722zm-9.916 0c0-1.682.583-3.086 1.729-4.256 1.166-1.17 2.635-1.767 4.428-1.767 1.793 0 3.262.597 4.407 1.767 1.167 1.17 1.75 2.574 1.75 4.256 0 1.7-.583 3.127-1.75 4.297-1.145 1.17-2.614 1.745-4.407 1.745-1.793 0-3.262-.575-4.428-1.745-1.146-1.17-1.729-2.596-1.729-4.297zm-1.5 3.233l.821 1.83c-.864.638-1.944.958-3.22.958-2.526 0-3.822-1.554-3.822-4.383V11.66h-2.01v-2h2.031V5.595h2.355v4.063h4.018v2h-4.018v5.405c0 1.469.605 2.191 1.793 2.191.626 0 1.318-.212 2.052-.638zm-12.43 2.51h2.375V9.66h-2.376v11.469zm1.23-12.977c-.929 0-1.642-.682-1.642-1.596 0-.873.713-1.554 1.643-1.554.885 0 1.576.681 1.576 1.554 0 .914-.69 1.596-1.576 1.596zm-6.49 7.234c0-1.086-.346-1.98-1.037-2.724-.692-.745-1.599-1.128-2.7-1.128-1.102 0-2.01.383-2.7 1.128-.692.744-1.037 1.638-1.037 2.724 0 1.084.345 2.02 1.036 2.766.691.744 1.6 1.105 2.7 1.105 1.102 0 2.01-.361 2.7-1.105.692-.746 1.038-1.682 1.038-2.766zm-.173-4.129V5h2.397v16.128h-2.354v-1.596c-1.015 1.255-2.333 1.873-3.91 1.873-1.663 0-3.068-.575-4.169-1.724-1.102-1.17-1.663-2.596-1.663-4.297 0-1.682.561-3.107 1.663-4.256 1.101-1.17 2.485-1.745 4.148-1.745 1.534 0 2.83.617 3.888 1.872zm-11.48 9.873h-10.218V5.405h10.195v2.318h-7.711V12h7.15v2.32h-7.15v4.489h7.733v2.319zm-23.891-9.724c-1.793 0-3.132 1.192-3.478 2.979h6.783c-.194-1.808-1.555-2.979-3.305-2.979zm5.703 3.766c0 .32-.021.703-.086 1.128h-9.095c.346 1.787 1.62 3 3.867 3 1.318 0 2.916-.49 3.953-1.234l.994 1.724c-1.189.872-3.067 1.595-5.033 1.595-4.364 0-6.243-3-6.243-6.021 0-1.724.54-3.15 1.642-4.277 1.101-1.127 2.548-1.702 4.298-1.702 1.664 0 3.046.511 4.105 1.553 1.058 1.043 1.598 2.447 1.598 4.234zm-19.949 3.894c1.08 0 1.966-.362 2.68-1.085.712-.724 1.058-1.617 1.058-2.703 0-1.084-.346-2-1.059-2.701-.713-.702-1.599-1.064-2.679-1.064-1.058 0-1.944.362-2.656 1.085-.714.702-1.059 1.596-1.059 2.68 0 1.086.345 2 1.059 2.724.712.702 1.598 1.064 2.656 1.064zm3.673-7.936V9.66h2.29v10.299c0 1.85-.584 3.32-1.728 4.404-1.146 1.085-2.68 1.638-4.58 1.638-1.945 0-3.672-.553-5.206-1.638l1.037-1.808c1.296.915 2.679 1.36 4.126 1.36 2.484 0 3.996-1.51 3.996-3.637v-.83c-1.015 1.127-2.311 1.702-3.91 1.702-1.684 0-3.089-.554-4.19-1.68-1.102-1.128-1.642-2.532-1.642-4.214 0-1.68.561-3.085 1.706-4.191 1.145-1.128 2.571-1.681 4.234-1.681 1.534 0 2.83.575 3.867 1.745zm-18.07 8.127c1.102 0 1.988-.382 2.7-1.128.714-.744 1.06-1.659 1.06-2.743 0-1.065-.346-1.98-1.06-2.724-.712-.745-1.598-1.128-2.7-1.128-1.101 0-2.008.383-2.7 1.128-.691.744-1.036 1.66-1.036 2.745 0 1.084.345 2 1.037 2.745.691.744 1.598 1.105 2.7 1.105zm3.652-8V9.66h2.29v11.469h-2.29v-1.575c-1.059 1.234-2.399 1.852-3.976 1.852-1.663 0-3.067-.575-4.168-1.745-1.102-1.17-1.642-2.617-1.642-4.34 0-1.724.54-3.128 1.642-4.256 1.1-1.128 2.505-1.681 4.168-1.681 1.577 0 2.917.617 3.976 1.872zM138.79 9.34c1.404 0 2.527.448 3.37 1.34.863.873 1.295 2.086 1.295 3.596v6.852h-2.376V14.66c0-2.021-1.036-3.128-2.657-3.128-1.727 0-2.915 1.255-2.915 3.192v6.404h-2.377v-6.426c0-1.978-1.037-3.17-2.679-3.17-1.728 0-2.937 1.277-2.937 3.234v6.362h-2.377V9.659h2.333v1.66c.692-1.212 1.988-1.979 3.522-1.979 1.533.021 2.958.767 3.586 2.107.798-1.277 2.419-2.107 4.212-2.107zm-19.517 11.788h2.484V5.405h-2.484v15.723z"/>\n    </g>\n</symbol></svg>';!function(){if(window.SynapEditor){var e={usageStatistics:!1,includeUI:{initMenu:"filter",menuBarPosition:"bottom",theme:{"menu.normalIcon.path":"","menu.activeIcon.path":"","menu.disabledIcon.path":"","menu.hoverIcon.path":"","submenu.normalIcon.path":"","submenu.activeIcon.path":"","common.bi.image":o.default.TUI_LOGO_BASE64_STRING,"common.backgroundColor":"#f4f4f4","submenu.backgroundColor":"#3c3c3c","submenu.partition.color":"#3c3c3c","submenu.normalLabel.color":"#888888","submenu.normalLabel.fontWeight":"normal","submenu.activeLabel.color":"#fff","submenu.activeLabel.fontWeight":"normal","range.pointer.color":"#fff","range.bar.color":"#666","range.subbar.color":"#d1d1d1","range.disabledPointer.color":"#f4f4f4","range.disabledBar.color":"#282828","range.disabledSubbar.color":"#f4f4f4","range.value.color":"#fff","range.value.fontWeight":"lighter","range.value.fontSize":"11px","range.value.border":"1px solid #353535","range.value.backgroundColor":"#151515","range.title.color":"#fff","range.title.fontWeight":"lighter","colorpicker.button.border":"0px"}}},t=null,n=null;window.SynapEditor.addPlugin("tuiImageEditor",(function(o){var s=function(o){if(!t){var a=document.createElement("div");a.insertAdjacentHTML("beforeend",l),a.insertAdjacentHTML("beforeend",c),a.insertAdjacentHTML("beforeend",u),a.insertAdjacentHTML("beforeend",h),a.setAttribute("area-hidden","true"),a.style.cssText="width: 0; height: 0; overflow: hidden;";var s=document.createElement("div");s.id="tui-image-editor-layer",s.style.cssText="display: none; position: fixed; width: 90vw; height: 90vh; top: 5vh; left: 5vw; z-index: 2147483647;";var d=document.createElement("div");s.insertAdjacentElement("beforeend",d),s.insertAdjacentElement("beforeend",a),document.body.insertAdjacentElement("beforeend",s),t=new r.default(d,e),n=s;var f=s.querySelector(".tui-image-editor-header-buttons");Array.from(f.children).forEach((function(e){f.removeChild(e)})),f.style.cssText="margin-top: 15px;";var p=document.createElement("button");p.id="tui-image-editor-done",p.style.cssText="background-color: #34b7b8; border: 1px solid #34b7b8; color: #ffffff; border-radius: 0; margin-right: 10px;";var g=document.createElement("button");g.id="tui-image-editor-cancel",g.style.cssText="background-color: #ffffff; border: 1px solid #dddddd; color: #3c3c3c; border-radius: 0; margin-right: 10px;",f.insertAdjacentElement("beforeend",p),f.insertAdjacentText("beforeend"," "),f.insertAdjacentElement("beforeend",g)}return new i.default(o,t,n)}(o);return{buttonDef:{label:(0,a.getMessage)(o.getActualLanguage(),"tuiImageEditor"),onClickFunc:function(){s.show()}}}}))}}()},1141:function(e,t,n){"use strict";t.__esModule=!0;var i=n(486);var r=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t,this.language=t.getActualLanguage(),this.imageEditor=n,this.element=i}return e.prototype.__init__=function(){var e=document.getElementById("tui-image-editor-done"),t=document.getElementById("tui-image-editor-cancel");e.textContent=(0,i.getMessage)(this.language,"done"),t.textContent=(0,i.getMessage)(this.language,"cancel"),e.onclick=this.done.bind(this),t.onclick=this.hide.bind(this)},e.prototype.__checkImageURL__=function(e){return new Promise((function(t,n){var i=new XMLHttpRequest;i.onload=t,i.onerror=n,i.open("GET",e),i.send()}))},e.prototype.show=function(){var e=this,t=this.editor.getSelectedImage();if(t){var n=t.src;this.__checkImageURL__(n).then((function(){e.imageEditor.loadImageFromURL(n,"temp-name").then((function(t){e.__init__(),e.editor.showDimLayer(!0),Array.from(e.element.querySelectorAll("input[type=checkbox]:checked")).forEach((function(e){e.checked=!1})),e.element.style.display="",e.imageEditor.ui.activeMenuEvent(),e.imageEditor.ui.resizeEditor({imageSize:t}),e.imageEditor.ui.changeMenu("filter",!1),e.imageEditor.clearUndoStack()}))})).catch((function(t){e.editor.execCommand("showDialog","alert",(0,i.getMessage)(e.language,"imageLoadFailed"))}))}else this.editor.execCommand("showDialog","alert",(0,i.getMessage)(this.language,"noImage"))},e.prototype.hide=function(){this.editor.hideDimLayer(!0),this.element.style.display="none"},e.prototype.done=function(){this.imageEditor.isEmptyUndoStack()||this.editor.changeImage(this.imageEditor.toDataURL()),this.hide()},e}();t.default=r},1142:function(e,t,n){var i;i=function(e,t,n){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.c=t,n.p="dist",n(0)}([function(e,t,n){"use strict";n(1);var i,r=n(2),o=(i=r)&&i.__esModule?i:{default:i};n(131),n(133),n(134),n(135),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150),n(151),e.exports=o.default},function(e,t){"use strict";Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||function(e){if("Element"in e){var t=e.Element.prototype,n=Object,i=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},r=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},o=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(""===t)throw new o("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new o("INVALID_CHARACTER_ERR","String contains an invalid character");return r.call(e,t)},s=function(e){for(var t=i.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],r=0,o=n.length;r<o;r++)this.push(n[r]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},l=s.prototype=[],c=function(){return new s(this)};if(o.prototype=Error.prototype,l.item=function(e){return this[e]||null},l.contains=function(e){return-1!==a(this,e+="")},l.add=function(){var e,t=arguments,n=0,i=t.length,r=!1;do{e=t[n]+"",-1===a(this,e)&&(this.push(e),r=!0)}while(++n<i);r&&this._updateClassName()},l.remove=function(){var e,t,n=arguments,i=0,r=n.length,o=!1;do{for(e=n[i]+"",t=a(this,e);-1!==t;)this.splice(t,1),o=!0,t=a(this,e)}while(++i<r);o&&this._updateClassName()},l.toggle=function(e,t){e+="";var n=this.contains(e),i=n?!0!==t&&"remove":!1!==t&&"add";return i&&this[i](e),!0===t||!1===t?t:!n},l.toString=function(){return this.join(" ")},n.defineProperty){var u={get:c,enumerable:!0,configurable:!0};try{n.defineProperty(t,"classList",u)}catch(e){void 0!==e.number&&-2146823252!==e.number||(u.enumerable=!1,n.defineProperty(t,"classList",u))}}else n.prototype.__defineGetter__&&t.__defineGetter__("classList",c)}}(window.self),function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var n,i=arguments.length;for(n=0;n<i;n++)e=arguments[n],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:n.call(this,e)}}e=null}()),function(){if("undefined"!=typeof window&&window.addEventListener){var e,t,n,i=Object.create(null),r=function(){clearTimeout(t),t=setTimeout(e,100)},o=function(){},a=function(){var e;window.addEventListener("resize",r,!1),window.addEventListener("orientationchange",r,!1),window.MutationObserver?((e=new MutationObserver(r)).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0}),o=function(){try{e.disconnect(),window.removeEventListener("resize",r,!1),window.removeEventListener("orientationchange",r,!1)}catch(e){}}):(document.documentElement.addEventListener("DOMSubtreeModified",r,!1),o=function(){document.documentElement.removeEventListener("DOMSubtreeModified",r,!1),window.removeEventListener("resize",r,!1),window.removeEventListener("orientationchange",r,!1)})},s=function(e){function t(e){var t;return void 0!==e.protocol?t=e:(t=document.createElement("a")).href=e,t.protocol.replace(/:/g,"")+t.host}var n,i,r;return window.XMLHttpRequest&&(n=new XMLHttpRequest,i=t(location),r=t(e),n=void 0===n.withCredentials&&""!==r&&r!==i?XDomainRequest||void 0:XMLHttpRequest),n},l="http://www.w3.org/1999/xlink";e=function(){var e,t,n,r,c,u,h,d,f,p,g=0;function v(){0==(g-=1)&&(o(),a())}function m(e){return function(){!0!==i[e.base]&&(e.useEl.setAttributeNS(l,"xlink:href","#"+e.hash),e.useEl.hasAttribute("href")&&e.useEl.setAttribute("href","#"+e.hash))}}function b(e){return function(){var t,n=document.body,i=document.createElement("x");e.onload=null,i.innerHTML=e.responseText,(t=i.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",n.insertBefore(t,n.firstChild)),v()}}function y(e){return function(){e.onerror=null,e.ontimeout=null,v()}}for(o(),f=document.getElementsByTagName("use"),c=0;c<f.length;c+=1){try{t=f[c].getBoundingClientRect()}catch(e){t=!1}e=(d=(r=f[c].getAttribute("href")||f[c].getAttributeNS(l,"href")||f[c].getAttribute("xlink:href"))&&r.split?r.split("#"):["",""])[0],n=d[1],u=t&&0===t.left&&0===t.right&&0===t.top&&0===t.bottom,t&&0===t.width&&0===t.height&&!u?(f[c].hasAttribute("href")&&f[c].setAttributeNS(l,"xlink:href",r),e.length&&(!0!==(p=i[e])&&setTimeout(m({useEl:f[c],base:e,hash:n}),0),void 0===p&&void 0!==(h=s(e))&&(p=new h,i[e]=p,p.onload=b(p),p.onerror=y(p),p.ontimeout=y(p),p.open("GET",e),p.send(),g+=1))):u?e.length&&i[e]&&setTimeout(m({useEl:f[c],base:e,hash:n}),0):void 0===i[e]?i[e]=!0:i[e].onload&&(i[e].abort(),delete i[e].onload,i[e]=!0)}f="",g+=1,v()},n=function(){window.removeEventListener("load",n,!1),t=setTimeout(e,0)},"complete"!==document.readyState?window.addEventListener("load",n,!1):n()}}()},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=f(n(3)),o=f(n(4)),a=f(n(68)),s=f(n(74)),l=f(n(103)),c=f(n(69)),u=f(n(105)),h=f(n(73)),d=n(72);function f(e){return e&&e.__esModule?e:{default:e}}var p=h.default.eventNames,g=h.default.commandNames,v=h.default.keyCodes,m=h.default.rejectMessages,b=r.default.isUndefined,y=r.default.forEach,_=r.default.CustomEvents,x=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=r.default.extend({includeUI:!1,usageStatistics:!0},n),this.mode=null,this.activeObjectId=null,n.includeUI){var i=n.includeUI;i.usageStatistics=n.usageStatistics,this.ui=new s.default(t,i,this.getActions()),n=this.ui.setUiDefaultSelectionStyle(n)}this._invoker=new a.default,this._graphics=new u.default(this.ui?this.ui.getEditorArea():t,{cssMaxWidth:n.cssMaxWidth,cssMaxHeight:n.cssMaxHeight,useItext:!!this.ui,useDragAddIcon:!!this.ui}),this._handlers={keydown:this._onKeyDown.bind(this),mousedown:this._onMouseDown.bind(this),objectActivated:this._onObjectActivated.bind(this),objectMoved:this._onObjectMoved.bind(this),objectScaled:this._onObjectScaled.bind(this),createdPath:this._onCreatedPath,addText:this._onAddText.bind(this),addObject:this._onAddObject.bind(this),addObjectAfter:this._onAddObjectAfter.bind(this),textEditing:this._onTextEditing.bind(this),textChanged:this._onTextChanged.bind(this),iconCreateResize:this._onIconCreateResize.bind(this),iconCreateEnd:this._onIconCreateEnd.bind(this),selectionCleared:this._selectionCleared.bind(this),selectionCreated:this._selectionCreated.bind(this)},this._attachInvokerEvents(),this._attachGraphicsEvents(),this._attachDomEvents(),this._setSelectionStyle(n.selectionStyle,{applyCropSelectionStyle:n.applyCropSelectionStyle,applyGroupSelectionStyle:n.applyGroupSelectionStyle}),n.usageStatistics&&(0,d.sendHostName)(),this.ui&&(this.ui.initCanvas(),this.setReAction()),fabric.enableGLFiltering=!1}return i(e,[{key:"_setSelectionStyle",value:function(e,t){var n=t.applyCropSelectionStyle,i=t.applyGroupSelectionStyle;e&&this._graphics.setSelectionStyle(e),n&&this._graphics.setCropSelectionStyle(e),i&&this.on("selectionCreated",(function(t){"activeSelection"===t.type&&t.set(e)}))}},{key:"_attachInvokerEvents",value:function(){var e=p.UNDO_STACK_CHANGED,t=p.REDO_STACK_CHANGED;this._invoker.on(e,this.fire.bind(this,e)),this._invoker.on(t,this.fire.bind(this,t))}},{key:"_attachGraphicsEvents",value:function(){this._graphics.on({mousedown:this._handlers.mousedown,objectMoved:this._handlers.objectMoved,objectScaled:this._handlers.objectScaled,objectActivated:this._handlers.objectActivated,addText:this._handlers.addText,addObject:this._handlers.addObject,textEditing:this._handlers.textEditing,textChanged:this._handlers.textChanged,iconCreateResize:this._handlers.iconCreateResize,iconCreateEnd:this._handlers.iconCreateEnd,selectionCleared:this._handlers.selectionCleared,selectionCreated:this._handlers.selectionCreated,addObjectAfter:this._handlers.addObjectAfter})}},{key:"_attachDomEvents",value:function(){document.addEventListener("keydown",this._handlers.keydown)}},{key:"_detachDomEvents",value:function(){document.removeEventListener("keydown",this._handlers.keydown)}},{key:"_onKeyDown",value:function(e){var t=e.ctrlKey,n=e.keyCode,i=e.metaKey,r=this._graphics.getActiveObject(),o=this._graphics.getActiveObjects(),a=r||o&&o.size();(t||i)&&(n===v.Z?this.undo().catch((function(){})):n===v.Y&&this.redo().catch((function(){})));var s=n===v.BACKSPACE||n===v.DEL;(!r||!r.isEditing)&&s&&a&&(e.preventDefault(),this.removeActiveObject())}},{key:"removeActiveObject",value:function(){var e=this._graphics.getActiveObject(),t=this._graphics.getActiveObjects();if(t&&t.size())this.discardSelection(),this._removeObjectStream(t.getObjects());else if(e){var n=this._graphics.getObjectId(e);this.removeObject(n)}}},{key:"_removeObjectStream",value:function(e){var t=this;if(!e.length)return!0;var n=e.pop();return this.removeObject(this._graphics.getObjectId(n)).then((function(){return t._removeObjectStream(e)}))}},{key:"_onMouseDown",value:function(e,t){this.fire(p.MOUSE_DOWN,e,t)}},{key:"_pushAddObjectCommand",value:function(e){var t=c.default.create(g.ADD_OBJECT,this._graphics,e);this._invoker.pushUndoStack(t)}},{key:"_onObjectActivated",value:function(e){this.fire(p.OBJECT_ACTIVATED,e)}},{key:"_onObjectMoved",value:function(e){this.fire(p.OBJECT_MOVED,e)}},{key:"_onObjectScaled",value:function(e){this.fire(p.OBJECT_SCALED,e)}},{key:"getDrawingMode",value:function(){return this._graphics.getDrawingMode()}},{key:"clearObjects",value:function(){return this.execute(g.CLEAR_OBJECTS)}},{key:"deactivateAll",value:function(){this._graphics.deactivateAll(),this._graphics.renderAll()}},{key:"discardSelection",value:function(){this._graphics.discardSelection()}},{key:"changeSelectableAll",value:function(e){this._graphics.changeSelectableAll(e)}},{key:"execute",value:function(e){for(var t,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var o=[this._graphics].concat(i);return(t=this._invoker).execute.apply(t,[e].concat(o))}},{key:"executeSilent",value:function(e){for(var t,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var o=[this._graphics].concat(i);return(t=this._invoker).executeSilent.apply(t,[e].concat(o))}},{key:"undo",value:function(){return this._invoker.undo()}},{key:"redo",value:function(){return this._invoker.redo()}},{key:"loadImageFromFile",value:function(e,t){if(!e)return o.default.reject(m.invalidParameters);var n=URL.createObjectURL(e);return t=t||e.name,this.loadImageFromURL(n,t).then((function(t){return URL.revokeObjectURL(e),t}))}},{key:"loadImageFromURL",value:function(e,t){return t&&e?this.execute(g.LOAD_IMAGE,t,e):o.default.reject(m.invalidParameters)}},{key:"addImageObject",value:function(e){return e?this.execute(g.ADD_IMAGE_OBJECT,e):o.default.reject(m.invalidParameters)}},{key:"startDrawingMode",value:function(e,t){return this._graphics.startDrawingMode(e,t)}},{key:"stopDrawingMode",value:function(){this._graphics.stopDrawingMode()}},{key:"crop",value:function(e){var t=this._graphics.getCroppedImageData(e);return t?this.loadImageFromURL(t.url,t.imageName):o.default.reject(m.invalidParameters)}},{key:"getCropzoneRect",value:function(){return this._graphics.getCropzoneRect()}},{key:"setCropzoneRect",value:function(e){this._graphics.setCropzoneRect(e)}},{key:"_flip",value:function(e){return this.execute(g.FLIP_IMAGE,e)}},{key:"flipX",value:function(){return this._flip("flipX")}},{key:"flipY",value:function(){return this._flip("flipY")}},{key:"resetFlip",value:function(){return this._flip("reset")}},{key:"_rotate",value:function(e,t,n){return n?this.executeSilent(g.ROTATE_IMAGE,e,t):this.execute(g.ROTATE_IMAGE,e,t)}},{key:"rotate",value:function(e,t){return this._rotate("rotate",e,t)}},{key:"setAngle",value:function(e,t){return this._rotate("setAngle",e,t)}},{key:"setBrush",value:function(e){this._graphics.setBrush(e)}},{key:"setDrawingShape",value:function(e,t){this._graphics.setDrawingShape(e,t)}},{key:"addShape",value:function(e,t){return t=t||{},this._setPositions(t),this.execute(g.ADD_SHAPE,e,t)}},{key:"changeShape",value:function(e,t){return this.execute(g.CHANGE_SHAPE,e,t)}},{key:"addText",value:function(e,t){return e=e||"",t=t||{},this.execute(g.ADD_TEXT,e,t)}},{key:"changeText",value:function(e,t){return t=t||"",this.execute(g.CHANGE_TEXT,e,t)}},{key:"changeTextStyle",value:function(e,t){return this.execute(g.CHANGE_TEXT_STYLE,e,t)}},{key:"_changeActivateMode",value:function(e){"ICON"!==e&&this.getDrawingMode()!==e&&this.startDrawingMode(e)}},{key:"_onTextChanged",value:function(e){this.changeText(e.id,e.text)}},{key:"_onIconCreateResize",value:function(e){this.fire(p.ICON_CREATE_RESIZE,e)}},{key:"_onIconCreateEnd",value:function(e){this.fire(p.ICON_CREATE_END,e)}},{key:"_onTextEditing",value:function(){this.fire(p.TEXT_EDITING)}},{key:"_onAddText",value:function(e){this.fire(p.ADD_TEXT,{originPosition:e.originPosition,clientPosition:e.clientPosition})}},{key:"_onAddObject",value:function(e){var t=this._graphics.getObject(e.id);this._pushAddObjectCommand(t)}},{key:"_onAddObjectAfter",value:function(e){this.fire(p.ADD_OBJECT_AFTER,e)}},{key:"_selectionCleared",value:function(){this.fire(p.SELECTION_CLEARED)}},{key:"_selectionCreated",value:function(e){this.fire(p.SELECTION_CREATED,e)}},{key:"registerIcons",value:function(e){this._graphics.registerPaths(e)}},{key:"changeCursor",value:function(e){this._graphics.changeCursor(e)}},{key:"addIcon",value:function(e,t){return t=t||{},this._setPositions(t),this.execute(g.ADD_ICON,e,t)}},{key:"changeIconColor",value:function(e,t){return this.execute(g.CHANGE_ICON_COLOR,e,t)}},{key:"removeObject",value:function(e){return this.execute(g.REMOVE_OBJECT,e)}},{key:"hasFilter",value:function(e){return this._graphics.hasFilter(e)}},{key:"removeFilter",value:function(e){return this.execute(g.REMOVE_FILTER,e)}},{key:"applyFilter",value:function(e,t){return this.execute(g.APPLY_FILTER,e,t)}},{key:"toDataURL",value:function(e){return this._graphics.toDataURL(e)}},{key:"getImageName",value:function(){return this._graphics.getImageName()}},{key:"clearUndoStack",value:function(){this._invoker.clearUndoStack()}},{key:"clearRedoStack",value:function(){this._invoker.clearRedoStack()}},{key:"isEmptyUndoStack",value:function(){return this._invoker.isEmptyUndoStack()}},{key:"isEmptyRedoStack",value:function(){return this._invoker.isEmptyRedoStack()}},{key:"resizeCanvasDimension",value:function(e){return e?this.execute(g.RESIZE_CANVAS_DIMENSION,e):o.default.reject(m.invalidParameters)}},{key:"destroy",value:function(){var e=this;this.stopDrawingMode(),this._detachDomEvents(),this._graphics.destroy(),this._graphics=null,y(this,(function(t,n){e[n]=null}),this)}},{key:"_setPositions",value:function(e){var t=this._graphics.getCenter();b(e.left)&&(e.left=t.left),b(e.top)&&(e.top=t.top)}},{key:"setObjectProperties",value:function(e,t){return this.execute(g.SET_OBJECT_PROPERTIES,e,t)}},{key:"setObjectPropertiesQuietly",value:function(e,t){this._graphics.setObjectProperties(e,t)}},{key:"getObjectProperties",value:function(e,t){return this._graphics.getObject(e)?this._graphics.getObjectProperties(e,t):null}},{key:"getCanvasSize",value:function(){return this._graphics.getCanvasSize()}},{key:"getObjectPosition",value:function(e,t,n){return this._graphics.getObjectPosition(e,t,n)}},{key:"setObjectPosition",value:function(e,t){return this.execute(g.SET_OBJECT_POSITION,e,t)}}]),e}();l.default.mixin(x),_.mixin(x),e.exports=x},function(t,n){t.exports=e},function(e,t,n){n(5),n(6),n(50),n(54),e.exports=n(14).Promise},function(e,t){},function(e,t,n){"use strict";var i=n(7)(!0);n(10)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){var i=n(8),r=n(9);e.exports=function(e){return function(t,n){var o,a,s=String(r(t)),l=i(n),c=s.length;return l<0||l>=c?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";var i=n(11),r=n(12),o=n(27),a=n(17),s=n(28),l=n(29),c=n(30),u=n(46),h=n(48),d=n(47)("iterator"),f=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,g,v,m,b){c(n,t,g);var y,_,x,w=function(e){if(!f&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},C=t+" Iterator",S="values"==v,k=!1,T=e.prototype,E=T[d]||T["@@iterator"]||v&&T[v],M=E||w(v),O=v?S?w("entries"):M:void 0,j="Array"==t&&T.entries||E;if(j&&(x=h(j.call(new e)))!==Object.prototype&&(u(x,C,!0),i||s(x,d)||a(x,d,p)),S&&E&&"values"!==E.name&&(k=!0,M=function(){return E.call(this)}),i&&!b||!f&&!k&&T[d]||a(T,d,M),l[t]=M,l[C]=p,v)if(y={values:S?M:w("values"),keys:m?M:w("keys"),entries:O},b)for(_ in y)_ in T||o(T,_,y[_]);else r(r.P+r.F*(f||k),t,y);return y}},function(e,t){e.exports=!0},function(e,t,n){var i=n(13),r=n(14),o=n(15),a=n(17),s=function(e,t,n){var l,c,u,h=e&s.F,d=e&s.G,f=e&s.S,p=e&s.P,g=e&s.B,v=e&s.W,m=d?r:r[t]||(r[t]={}),b=m.prototype,y=d?i:f?i[t]:(i[t]||{}).prototype;for(l in d&&(n=t),n)(c=!h&&y&&void 0!==y[l])&&l in m||(u=c?y[l]:n[l],m[l]=d&&"function"!=typeof y[l]?n[l]:g&&c?o(u,i):v&&y[l]==u?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(u):p&&"function"==typeof u?o(Function.call,u):u,p&&((m.virtual||(m.virtual={}))[l]=u,e&s.R&&b&&!b[l]&&a(b,l,u)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){var i=n(16);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var i=n(18),r=n(26);e.exports=n(22)?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(19),r=n(21),o=n(25),a=Object.defineProperty;t.f=n(22)?Object.defineProperty:function(e,t,n){if(i(e),t=o(t,!0),i(n),r)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var i=n(20);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(22)&&!n(23)((function(){return 7!=Object.defineProperty(n(24)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){e.exports=!n(23)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var i=n(20),r=n(13).document,o=i(r)&&i(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},function(e,t,n){var i=n(20);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){e.exports=n(17)},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports={}},function(e,t,n){"use strict";var i=n(31),r=n(26),o=n(46),a={};n(17)(a,n(47)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=i(a,{next:r(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var i=n(19),r=n(32),o=n(44),a=n(41)("IE_PROTO"),s=function(){},l=function(){var e,t=n(24)("iframe"),i=o.length;for(t.style.display="none",n(45).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[o[i]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=i(e),n=new s,s.prototype=null,n[a]=e):n=l(),void 0===t?n:r(n,t)}},function(e,t,n){var i=n(18),r=n(19),o=n(33);e.exports=n(22)?Object.defineProperties:function(e,t){r(e);for(var n,a=o(t),s=a.length,l=0;s>l;)i.f(e,n=a[l++],t[n]);return e}},function(e,t,n){var i=n(34),r=n(44);e.exports=Object.keys||function(e){return i(e,r)}},function(e,t,n){var i=n(28),r=n(35),o=n(38)(!1),a=n(41)("IE_PROTO");e.exports=function(e,t){var n,s=r(e),l=0,c=[];for(n in s)n!=a&&i(s,n)&&c.push(n);for(;t.length>l;)i(s,n=t[l++])&&(~o(c,n)||c.push(n));return c}},function(e,t,n){var i=n(36),r=n(9);e.exports=function(e){return i(r(e))}},function(e,t,n){var i=n(37);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var i=n(35),r=n(39),o=n(40);e.exports=function(e){return function(t,n,a){var s,l=i(t),c=r(l.length),u=o(a,c);if(e&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}}},function(e,t,n){var i=n(8),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t,n){var i=n(8),r=Math.max,o=Math.min;e.exports=function(e,t){return(e=i(e))<0?r(e+t,0):o(e,t)}},function(e,t,n){var i=n(42)("keys"),r=n(43);e.exports=function(e){return i[e]||(i[e]=r(e))}},function(e,t,n){var i=n(13),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});e.exports=function(e){return r[e]||(r[e]={})}},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){e.exports=n(13).document&&document.documentElement},function(e,t,n){var i=n(18).f,r=n(28),o=n(47)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},function(e,t,n){var i=n(42)("wks"),r=n(43),o=n(13).Symbol,a="function"==typeof o;(e.exports=function(e){return i[e]||(i[e]=a&&o[e]||(a?o:r)("Symbol."+e))}).store=i},function(e,t,n){var i=n(28),r=n(49),o=n(41)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),i(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var i=n(9);e.exports=function(e){return Object(i(e))}},function(e,t,n){n(51);for(var i=n(13),r=n(17),o=n(29),a=n(47)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],l=0;l<5;l++){var c=s[l],u=i[c],h=u&&u.prototype;h&&!h[a]&&r(h,a,c),o[c]=o.Array}},function(e,t,n){"use strict";var i=n(52),r=n(53),o=n(29),a=n(35);e.exports=n(10)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var i,r,o,a=n(11),s=n(13),l=n(15),c=n(55),u=n(12),h=n(20),d=n(16),f=n(56),p=n(57),g=n(61),v=n(62).set,m=n(64)(),b=s.TypeError,y=s.process,_=s.Promise,x="process"==c(y=s.process),w=function(){},C=!!function(){try{var e=_.resolve(1),t=(e.constructor={})[n(47)("species")]=function(e){e(w,w)};return(x||"function"==typeof PromiseRejectionEvent)&&e.then(w)instanceof t}catch(e){}}(),S=function(e,t){return e===t||e===_&&t===o},k=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},T=function(e){return S(_,e)?new E(e):new r(e)},E=r=function(e){var t,n;this.promise=new e((function(e,i){if(void 0!==t||void 0!==n)throw b("Bad Promise constructor");t=e,n=i})),this.resolve=d(t),this.reject=d(n)},M=function(e){try{e()}catch(e){return{error:e}}},O=function(e,t){if(!e._n){e._n=!0;var n=e._c;m((function(){for(var i=e._v,r=1==e._s,o=0,a=function(t){var n,o,a=r?t.ok:t.fail,s=t.resolve,l=t.reject,c=t.domain;try{a?(r||(2==e._h&&A(e),e._h=1),!0===a?n=i:(c&&c.enter(),n=a(i),c&&c.exit()),n===t.promise?l(b("Promise-chain cycle")):(o=k(n))?o.call(n,s,l):s(n)):l(i)}catch(e){l(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&j(e)}))}},j=function(e){v.call(s,(function(){var t,n,i,r=e._v;if(P(e)&&(t=M((function(){x?y.emit("unhandledRejection",r,e):(n=s.onunhandledrejection)?n({promise:e,reason:r}):(i=s.console)&&i.error})),e._h=x||P(e)?2:1),e._a=void 0,t)throw t.error}))},P=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,i=0;n.length>i;)if((t=n[i++]).fail||!P(t.promise))return!1;return!0},A=function(e){v.call(s,(function(){var t;x?y.emit("rejectionHandled",e):(t=s.onrejectionhandled)&&t({promise:e,reason:e._v})}))},D=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),O(t,!0))},L=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw b("Promise can't be resolved itself");(t=k(e))?m((function(){var i={_w:n,_d:!1};try{t.call(e,l(L,i,1),l(D,i,1))}catch(e){D.call(i,e)}})):(n._v=e,n._s=1,O(n,!1))}catch(e){D.call({_w:n,_d:!1},e)}}};C||(_=function(e){f(this,_,"Promise","_h"),d(e),i.call(this);try{e(l(L,this,1),l(D,this,1))}catch(e){D.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(65)(_.prototype,{then:function(e,t){var n=T(g(this,_));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=x?y.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&O(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),E=function(){var e=new i;this.promise=e,this.resolve=l(L,e,1),this.reject=l(D,e,1)}),u(u.G+u.W+u.F*!C,{Promise:_}),n(46)(_,"Promise"),n(66)("Promise"),o=n(14).Promise,u(u.S+u.F*!C,"Promise",{reject:function(e){var t=T(this);return(0,t.reject)(e),t.promise}}),u(u.S+u.F*(a||!C),"Promise",{resolve:function(e){if(e instanceof _&&S(e.constructor,this))return e;var t=T(this);return(0,t.resolve)(e),t.promise}}),u(u.S+u.F*!(C&&n(67)((function(e){_.all(e).catch(w)}))),"Promise",{all:function(e){var t=this,n=T(t),i=n.resolve,r=n.reject,o=M((function(){var n=[],o=0,a=1;p(e,!1,(function(e){var s=o++,l=!1;n.push(void 0),a++,t.resolve(e).then((function(e){l||(l=!0,n[s]=e,--a||i(n))}),r)})),--a||i(n)}));return o&&r(o.error),n.promise},race:function(e){var t=this,n=T(t),i=n.reject,r=M((function(){p(e,!1,(function(e){t.resolve(e).then(n.resolve,i)}))}));return r&&i(r.error),n.promise}})},function(e,t,n){var i=n(37),r=n(47)("toStringTag"),o="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),r))?n:o?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var i=n(15),r=n(58),o=n(59),a=n(19),s=n(39),l=n(60),c={},u={};(t=e.exports=function(e,t,n,h,d){var f,p,g,v,m=d?function(){return e}:l(e),b=i(n,h,t?2:1),y=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(o(m)){for(f=s(e.length);f>y;y++)if((v=t?b(a(p=e[y])[0],p[1]):b(e[y]))===c||v===u)return v}else for(g=m.call(e);!(p=g.next()).done;)if((v=r(g,b,p.value,t))===c||v===u)return v}).BREAK=c,t.RETURN=u},function(e,t,n){var i=n(19);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&i(o.call(e)),t}}},function(e,t,n){var i=n(29),r=n(47)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[r]===e)}},function(e,t,n){var i=n(55),r=n(47)("iterator"),o=n(29);e.exports=n(14).getIteratorMethod=function(e){if(null!=e)return e[r]||e["@@iterator"]||o[i(e)]}},function(e,t,n){var i=n(19),r=n(16),o=n(47)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||null==(n=i(a)[o])?t:r(n)}},function(e,t,n){var i,r,o,a=n(15),s=n(63),l=n(45),c=n(24),u=n(13),h=u.process,d=u.setImmediate,f=u.clearImmediate,p=u.MessageChannel,g=0,v={},m=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},b=function(e){m.call(e.data)};d&&f||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),t)},i(g),g},f=function(e){delete v[e]},"process"==n(37)(h)?i=function(e){h.nextTick(a(m,e,1))}:p?(o=(r=new p).port2,r.port1.onmessage=b,i=a(o.postMessage,o,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(e){u.postMessage(e+"","*")},u.addEventListener("message",b,!1)):i="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),e.exports={set:d,clear:f}},function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var i=n(13),r=n(62).set,o=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,l="process"==n(37)(a);e.exports=function(){var e,t,n,c=function(){var i,r;for(l&&(i=a.domain)&&i.exit();e;){r=e.fn,e=e.next;try{r()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(l)n=function(){a.nextTick(c)};else if(o){var u=!0,h=document.createTextNode("");new o(c).observe(h,{characterData:!0}),n=function(){h.data=u=!u}}else if(s&&s.resolve){var d=s.resolve();n=function(){d.then(c)}}else n=function(){r.call(i,c)};return function(i){var r={fn:i,next:void 0};t&&(t.next=r),e||(e=r,n()),t=r}}},function(e,t,n){var i=n(17);e.exports=function(e,t,n){for(var r in t)n&&e[r]?e[r]=t[r]:i(e,r,t[r]);return e}},function(e,t,n){"use strict";var i=n(13),r=n(14),o=n(18),a=n(22),s=n(47)("species");e.exports=function(e){var t="function"==typeof r[e]?r[e]:i[e];a&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var i=n(47)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){return{done:n=!0}},o[i]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=l(n(3)),o=l(n(4)),a=l(n(69)),s=l(n(73));function l(e){return e&&e.__esModule?e:{default:e}}var c=s.default.eventNames,u=s.default.rejectMessages,h=r.default.isFunction,d=r.default.isString,f=r.default.CustomEvents,p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._undoStack=[],this._redoStack=[],this._isLocked=!1,this._isSilent=!1}return i(e,[{key:"_invokeExecution",value:function(e){var t=this;this.lock();var n=e.args;return n||(n=[]),e.execute.apply(e,n).then((function(n){return t._isSilent||t.pushUndoStack(e),t.unlock(),h(e.executeCallback)&&e.executeCallback(n),n})).catch((function(e){return t.unlock(),o.default.reject(e)}))}},{key:"_invokeUndo",value:function(e){var t=this;this.lock();var n=e.args;return n||(n=[]),e.undo.apply(e,n).then((function(n){return t.pushRedoStack(e),t.unlock(),h(e.undoCallback)&&e.undoCallback(n),n})).catch((function(e){return t.unlock(),o.default.reject(e)}))}},{key:"_fireRedoStackChanged",value:function(){this.fire(c.REDO_STACK_CHANGED,this._redoStack.length)}},{key:"_fireUndoStackChanged",value:function(){this.fire(c.UNDO_STACK_CHANGED,this._undoStack.length)}},{key:"lock",value:function(){this._isLocked=!0}},{key:"unlock",value:function(){this._isLocked=!1}},{key:"executeSilent",value:function(){var e=this;this._isSilent=!0;for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.execute.apply(this,n.concat([this._isSilent])).then((function(){e._isSilent=!1}))}},{key:"execute",value:function(){var e=this;if(this._isLocked)return o.default.reject(u.isLock);for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=n[0];return d(r)&&(r=a.default.create.apply(a.default,n)),this._invokeExecution(r).then((function(t){return e.clearRedoStack(),t}))}},{key:"undo",value:function(){var e=this._undoStack.pop(),t=void 0,n="";return e&&this._isLocked&&(this.pushUndoStack(e,!0),e=null),e?(this.isEmptyUndoStack()&&this._fireUndoStackChanged(),t=this._invokeUndo(e)):(n=u.undo,this._isLocked&&(n=n+" Because "+u.isLock),t=o.default.reject(n)),t}},{key:"redo",value:function(){var e=this._redoStack.pop(),t=void 0,n="";return e&&this._isLocked&&(this.pushRedoStack(e,!0),e=null),e?(this.isEmptyRedoStack()&&this._fireRedoStackChanged(),t=this._invokeExecution(e)):(n=u.redo,this._isLocked&&(n=n+" Because "+u.isLock),t=o.default.reject(n)),t}},{key:"pushUndoStack",value:function(e,t){this._undoStack.push(e),t||this._fireUndoStackChanged()}},{key:"pushRedoStack",value:function(e,t){this._redoStack.push(e),t||this._fireRedoStackChanged()}},{key:"isEmptyRedoStack",value:function(){return 0===this._redoStack.length}},{key:"isEmptyUndoStack",value:function(){return 0===this._undoStack.length}},{key:"clearUndoStack",value:function(){this.isEmptyUndoStack()||(this._undoStack=[],this._fireUndoStackChanged())}},{key:"clearRedoStack",value:function(){this.isEmptyRedoStack()||(this._redoStack=[],this._fireRedoStackChanged())}}]),e}();f.mixin(p),e.exports=p},function(e,t,n){"use strict";var i,r=n(70),o=(i=r)&&i.__esModule?i:{default:i},a={};e.exports={create:function(e){var t=a[e];if(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return new o.default(t,i)}return null},register:function(e){a[e.name]=e}}},function(e,t,n){"use strict";var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(71),a=(i=o)&&i.__esModule?i:{default:i},s=a.default.create,l=a.default.types,c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t.name,this.args=n,this.execute=t.execute,this.undo=t.undo,this.executeCallback=t.executeCallback||null,this.undoCallback=t.undoCallback||null,this.undoData={}}return r(e,[{key:"execute",value:function(){throw new Error(s(l.UN_IMPLEMENTATION,"execute"))}},{key:"undo",value:function(){throw new Error(s(l.UN_IMPLEMENTATION,"undo"))}},{key:"setExecuteCallback",value:function(e){return this.executeCallback=e,this}},{key:"setUndoCallback",value:function(e){return this.undoCallback=e,this}}]),e}();e.exports=c},function(e,t,n){"use strict";var i,r=n(3),o=(i=r)&&i.__esModule?i:{default:i},a=(0,n(72).keyMirror)("UN_IMPLEMENTATION","NO_COMPONENT_NAME"),s="Should implement a method: ",l="Should set a component name",c={UN_IMPLEMENTATION:function(e){return s+e},NO_COMPONENT_NAME:function(){return l}};e.exports={types:o.default.extend({},a),create:function(e){e=e.toLowerCase();for(var t=c[e],n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return t.apply(void 0,i)}}},function(e,t,n){"use strict";var i=n(3),r=Math.min,o=Math.max,a=!1;e.exports={clamp:function(e,t,n){var i=void 0;return t>n&&(i=t,t=n,n=i),o(t,r(e,n))},keyMirror:function(){for(var e={},t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(0,i.forEach)(n,(function(t){e[t]=t})),e},makeStyleText:function(e){var t="";return(0,i.forEach)(e,(function(e,n){t+=n+": "+e+";"})),t},getProperties:function(e,t){var n={},i=t.length,r=0,o=void 0;for(r=0;r<i;r+=1)n[o=t[r]]=e[o];return n},toInteger:function(e){return parseInt(e,10)},toCamelCase:function(e){return e.replace(/-([a-z])/g,(function(e,t){return t.toUpperCase()}))},isSupportFileApi:function(){return!!(window.File&&window.FileList&&window.FileReader)},getRgb:function(e,t){return 4===e.length&&(e=""+e+e.slice(1,4)),"rgba("+parseInt(e.slice(1,3),16)+", "+parseInt(e.slice(3,5),16)+", "+parseInt(e.slice(5,7),16)+", "+(t||1)+")"},sendHostName:function(){a||(a=!0,(0,i.sendHostname)("image-editor","UA-129999381-1"))},styleLoad:function(e,t){var n=document.getElementsByTagName("head")[0],i=document.createElement("link"),r=encodeURIComponent(e);t&&(i.id=t),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href","data:text/css;charset=UTF-8,"+r),n.appendChild(i)},getSelector:function(e){return function(t){return e.querySelector(t)}},base64ToBlob:function(e){var t="",n=void 0,i=void 0,r=void 0;n=e.replace(/data:(image\/.+);base64,/,(function(e,n){return t=n,""}));var o=(n=atob(n)).length;for(i=new Uint8Array(o),r=0;r<o;r+=1)i[r]=n.charCodeAt(r);return new Blob([i],{type:t})}}},function(e,t,n){"use strict";var i,r=n(72),o=(i=r)&&i.__esModule?i:{default:i};e.exports={componentNames:o.default.keyMirror("IMAGE_LOADER","CROPPER","FLIP","ROTATION","FREE_DRAWING","LINE","TEXT","ICON","FILTER","SHAPE"),commandNames:{CLEAR_OBJECTS:"clearObjects",LOAD_IMAGE:"loadImage",FLIP_IMAGE:"flip",ROTATE_IMAGE:"rotate",ADD_OBJECT:"addObject",REMOVE_OBJECT:"removeObject",APPLY_FILTER:"applyFilter",REMOVE_FILTER:"removeFilter",ADD_ICON:"addIcon",CHANGE_ICON_COLOR:"changeIconColor",ADD_SHAPE:"addShape",CHANGE_SHAPE:"changeShape",ADD_TEXT:"addText",CHANGE_TEXT:"changeText",CHANGE_TEXT_STYLE:"changeTextStyle",ADD_IMAGE_OBJECT:"addImageObject",RESIZE_CANVAS_DIMENSION:"resizeCanvasDimension",SET_OBJECT_PROPERTIES:"setObjectProperties",SET_OBJECT_POSITION:"setObjectPosition"},eventNames:{OBJECT_ACTIVATED:"objectActivated",OBJECT_MOVED:"objectMoved",OBJECT_SCALED:"objectScaled",OBJECT_CREATED:"objectCreated",TEXT_EDITING:"textEditing",TEXT_CHANGED:"textChanged",ICON_CREATE_RESIZE:"iconCreateResize",ICON_CREATE_END:"iconCreateEnd",ADD_TEXT:"addText",ADD_OBJECT:"addObject",ADD_OBJECT_AFTER:"addObjectAfter",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_MOVE:"mousemove",REDO_STACK_CHANGED:"redoStackChanged",UNDO_STACK_CHANGED:"undoStackChanged",SELECTION_CLEARED:"selectionCleared",SELECTION_CREATED:"selectionCreated"},drawingModes:o.default.keyMirror("NORMAL","CROPPER","FREE_DRAWING","LINE_DRAWING","TEXT","SHAPE"),keyCodes:{Z:90,Y:89,SHIFT:16,BACKSPACE:8,DEL:46},fObjectOptions:{SELECTION_STYLE:{borderColor:"red",cornerColor:"green",cornerSize:10,originX:"center",originY:"center",transparentCorners:!1}},rejectMessages:{addedObject:"The object is already added.",flip:"The flipX and flipY setting values are not changed.",invalidDrawingMode:"This operation is not supported in the drawing mode.",invalidParameters:"Invalid parameters.",isLock:"The executing command state is locked.",loadImage:"The background image is empty.",loadingImageFailed:"Invalid image loaded.",noActiveObject:"There is no active object.",noObject:"The object is not in canvas.",redo:"The promise of redo command is reject.",rotation:"The current angle is same the old angle.",undo:"The promise of undo command is reject.",unsupportedOperation:"Unsupported operation.",unsupportedType:"Unsupported object type."},defaultIconPath:{"icon-arrow":"M40 12V0l24 24-24 24V36H0V12h40z","icon-arrow-2":"M49,32 H3 V22 h46 l-18,-18 h12 l23,23 L43,50 h-12 l18,-18  z ","icon-arrow-3":"M43.349998,27 L17.354,53 H1.949999 l25.996,-26 L1.949999,1 h15.404 L43.349998,27  z ","icon-star":"M35,54.557999 l-19.912001,10.468 l3.804,-22.172001 l-16.108,-15.7 l22.26,-3.236 L35,3.746 l9.956,20.172001 l22.26,3.236 l-16.108,15.7 l3.804,22.172001  z ","icon-star-2":"M17,31.212 l-7.194,4.08 l-4.728,-6.83 l-8.234,0.524 l-1.328,-8.226 l-7.644,-3.14 l2.338,-7.992 l-5.54,-6.18 l5.54,-6.176 l-2.338,-7.994 l7.644,-3.138 l1.328,-8.226 l8.234,0.522 l4.728,-6.83 L17,-24.312 l7.194,-4.08 l4.728,6.83 l8.234,-0.522 l1.328,8.226 l7.644,3.14 l-2.338,7.992 l5.54,6.178 l-5.54,6.178 l2.338,7.992 l-7.644,3.14 l-1.328,8.226 l-8.234,-0.524 l-4.728,6.83  z ","icon-polygon":"M3,31 L19,3 h32 l16,28 l-16,28 H19  z ","icon-location":"M24 62C8 45.503 0 32.837 0 24 0 10.745 10.745 0 24 0s24 10.745 24 24c0 8.837-8 21.503-24 38zm0-28c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10z","icon-heart":"M49.994999,91.349998 l-6.96,-6.333 C18.324001,62.606995 2.01,47.829002 2.01,29.690998 C2.01,14.912998 13.619999,3.299999 28.401001,3.299999 c8.349,0 16.362,5.859 21.594,12 c5.229,-6.141 13.242001,-12 21.591,-12 c14.778,0 26.390999,11.61 26.390999,26.390999 c0,18.138 -16.314001,32.916 -41.025002,55.374001 l-6.96,6.285  z ","icon-bubble":"M44 48L34 58V48H12C5.373 48 0 42.627 0 36V12C0 5.373 5.373 0 12 0h40c6.627 0 12 5.373 12 12v24c0 6.627-5.373 12-12 12h-8z"},defaultRotateRangeValus:{realTimeEvent:!0,min:-360,max:360,value:0},defaultDrawRangeValus:{min:5,max:30,value:12},defaultShapeStrokeValus:{realTimeEvent:!1,min:2,max:300,value:3},defaultTextRangeValus:{realTimeEvent:!0,min:10,max:100,value:50},defaultFilterRangeValus:{tintOpacityRange:{min:0,max:1,value:.7},removewhiteDistanceRange:{min:0,max:1,value:.2},brightnessRange:{min:-1,max:1,value:0},noiseRange:{min:0,max:1e3,value:100},pixelateRange:{min:2,max:20,value:4},colorfilterThresholeRange:{min:0,max:1,value:.2}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=y(n(3)),o=y(n(72)),a=y(n(75)),s=y(n(76)),l=y(n(77)),c=y(n(80)),u=y(n(86)),h=y(n(88)),d=y(n(90)),f=y(n(92)),p=y(n(94)),g=y(n(96)),v=y(n(98)),m=y(n(100)),b=y(n(102));function y(e){return e&&e.__esModule?e:{default:e}}var _={Shape:c.default,Crop:u.default,Flip:h.default,Rotate:d.default,Text:f.default,Mask:p.default,Icon:g.default,Draw:v.default,Filter:m.default},x=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=this._initializeOption(n),this._actions=i,this.submenu=!1,this.imageSize={},this.uiSize={},this._locale=new b.default(this.options.locale),this.theme=new l.default(this.options.theme),this._submenuChangeTransection=!1,this._selectedElement=null,this._mainElement=null,this._editorElementWrap=null,this._editorElement=null,this._menuElement=null,this._subMenuElement=null,this._makeUiElement(t),this._setUiSize(),this._initMenuEvent=!1,this._els={undo:this._menuElement.querySelector("#tie-btn-undo"),redo:this._menuElement.querySelector("#tie-btn-redo"),reset:this._menuElement.querySelector("#tie-btn-reset"),delete:this._menuElement.querySelector("#tie-btn-delete"),deleteAll:this._menuElement.querySelector("#tie-btn-delete-all"),download:this._selectedElement.querySelectorAll(".tui-image-editor-download-btn"),load:this._selectedElement.querySelectorAll(".tui-image-editor-load-btn")},this._makeSubMenu()}return i(e,[{key:"setUiDefaultSelectionStyle",value:function(e){return r.default.extend({applyCropSelectionStyle:!0,applyGroupSelectionStyle:!0,selectionStyle:{cornerStyle:"circle",cornerSize:16,cornerColor:"#fff",cornerStrokeColor:"#fff",transparentCorners:!1,lineWidth:2,borderColor:"#fff"}},e)}},{key:"resizeEditor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.uiSize,n=e.imageSize,i=void 0===n?this.imageSize:n;i!==this.imageSize&&(this.imageSize=i),t&&this._setUiSize(t);var r=this._getEditorDimension(),o=r.width,a=r.height,s=this._editorElement.style,l=this.options.menuBarPosition;s.height=a+"px",s.width=o+"px",this._setEditorPosition(l),this._editorElementWrap.style.bottom="0px",this._editorElementWrap.style.top="0px",this._editorElementWrap.style.left="0px",this._editorElementWrap.style.width="100%";var c=this._selectedElement.classList;"top"===l&&this._selectedElement.offsetWidth<"1300"?c.add("tui-image-editor-top-optimization"):c.remove("tui-image-editor-top-optimization")}},{key:"changeUndoButtonStatus",value:function(e){e?this._els.undo.classList.add("enabled"):this._els.undo.classList.remove("enabled")}},{key:"changeRedoButtonStatus",value:function(e){e?this._els.redo.classList.add("enabled"):this._els.redo.classList.remove("enabled")}},{key:"changeResetButtonStatus",value:function(e){e?this._els.reset.classList.add("enabled"):this._els.reset.classList.remove("enabled")}},{key:"changeDeleteAllButtonEnabled",value:function(e){e?this._els.deleteAll.classList.add("enabled"):this._els.deleteAll.classList.remove("enabled")}},{key:"changeDeleteButtonEnabled",value:function(e){e?this._els.delete.classList.add("enabled"):this._els.delete.classList.remove("enabled")}},{key:"_initializeOption",value:function(e){return r.default.extend({loadImage:{path:"",name:""},locale:{},menuIconPath:"",menu:["crop","flip","rotate","draw","shape","icon","text","mask","filter"],initMenu:"",uiSize:{width:"100%",height:"100%"},menuBarPosition:"bottom"},e)}},{key:"_setUiSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.uiSize,t=this._selectedElement.style;t.width=e.width,t.height=e.height}},{key:"_makeSubMenu",value:function(){var e=this;r.default.forEach(this.options.menu,(function(t){var n=_[t.replace(/^[a-z]/,(function(e){return e.toUpperCase()}))];e._makeMenuElement(t),e._els[t]=e._menuElement.querySelector("#tie-btn-"+t),e[t]=new n(e._subMenuElement,{locale:e._locale,iconStyle:e.theme.getStyle("submenu.icon"),menuBarPosition:e.options.menuBarPosition,usageStatistics:e.options.usageStatistics})}))}},{key:"_makeUiElement",value:function(e){var t=void 0;window.snippet=r.default,t=e.nodeType?e:document.querySelector(e);var n=o.default.getSelector(t);t.classList.add("tui-image-editor-container"),t.innerHTML=(0,s.default)({locale:this._locale,biImage:this.theme.getStyle("common.bi"),iconStyle:this.theme.getStyle("menu.icon"),loadButtonStyle:this.theme.getStyle("loadButton"),downloadButtonStyle:this.theme.getStyle("downloadButton")})+(0,a.default)({locale:this._locale,biImage:this.theme.getStyle("common.bi"),commonStyle:this.theme.getStyle("common"),headerStyle:this.theme.getStyle("header"),loadButtonStyle:this.theme.getStyle("loadButton"),downloadButtonStyle:this.theme.getStyle("downloadButton"),submenuStyle:this.theme.getStyle("submenu")}),this._selectedElement=t,this._selectedElement.classList.add(this.options.menuBarPosition),this._mainElement=n(".tui-image-editor-main"),this._editorElementWrap=n(".tui-image-editor-wrap"),this._editorElement=n(".tui-image-editor"),this._menuElement=n(".tui-image-editor-menu"),this._subMenuElement=n(".tui-image-editor-submenu")}},{key:"_makeMenuElement",value:function(e){var t=document.createElement("li"),n=this.theme.getStyle("menu.icon"),i=n.normal,r=n.active,o=n.hover,a='\n            <svg class="svg_ic-menu">\n                <use xlink:href="'+i.path+"#"+i.name+"-ic-"+e+'" class="normal"/>\n                <use xlink:href="'+r.path+"#"+r.name+"-ic-"+e+'" class="active"/>\n                <use xlink:href="'+o.path+"#"+o.name+"-ic-"+e+'" class="hover"/>\n            </svg>\n        ';t.id="tie-btn-"+e,t.className="tui-image-editor-item normal",t.setAttribute("tooltip-content",this._locale.localize(e.replace(/^[a-z]/g,(function(e){return e.toUpperCase()})))),t.innerHTML=a,this._menuElement.appendChild(t)}},{key:"_addHelpActionEvent",value:function(e){var t=this;this._els[e].addEventListener("click",(function(){t._actions.main[e]()}))}},{key:"_addDownloadEvent",value:function(){var e=this;r.default.forEach(this._els.download,(function(t){t.addEventListener("click",(function(){e._actions.main.download()}))}))}},{key:"_addLoadEvent",value:function(){var e=this;r.default.forEach(this._els.load,(function(t){t.addEventListener("change",(function(t){e._actions.main.load(t.target.files[0])}))}))}},{key:"_addMenuEvent",value:function(e){var t=this;this._els[e].addEventListener("click",(function(){t.changeMenu(e)}))}},{key:"_addSubMenuEvent",value:function(e){this[e].addEvent(this._actions[e])}},{key:"getEditorArea",value:function(){return this._editorElement}},{key:"activeMenuEvent",value:function(){var e=this;this._initMenuEvent||(this._addHelpActionEvent("undo"),this._addHelpActionEvent("redo"),this._addHelpActionEvent("reset"),this._addHelpActionEvent("delete"),this._addHelpActionEvent("deleteAll"),this._addDownloadEvent(),r.default.forEach(this.options.menu,(function(t){e._addMenuEvent(t),e._addSubMenuEvent(t)})),this._initMenu(),this._initMenuEvent=!0)}},{key:"initCanvas",value:function(){var e=this,t=this._getLoadImage();t.path&&this._actions.main.initLoadImage(t.path,t.name).then((function(){e.activeMenuEvent()})),this._addLoadEvent();var n=document.createElement("div");n.className="tui-image-editor-grid-visual",n.innerHTML='<table>\n           <tr><td class="dot left-top"></td><td></td><td class="dot right-top"></td></tr>\n           <tr><td></td><td></td><td></td></tr>\n           <tr><td class="dot left-bottom"></td><td></td><td class="dot right-bottom"></td></tr>\n         </table>',this._editorContainerElement=this._editorElement.querySelector(".tui-image-editor-canvas-container"),this._editorContainerElement.appendChild(n)}},{key:"_getLoadImage",value:function(){return this.options.loadImage}},{key:"changeMenu",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._submenuChangeTransection||(this._submenuChangeTransection=!0,this._changeMenu(e,t,n),this._submenuChangeTransection=!1)}},{key:"_changeMenu",value:function(e,t,n){this.submenu&&(this._els[this.submenu].classList.remove("active"),this._mainElement.classList.remove("tui-image-editor-menu-"+this.submenu),n&&this._actions.main.discardSelection(),this._actions.main.changeSelectableAll(!0),this[this.submenu].changeStandbyMode()),this.submenu===e&&t?this.submenu=null:(this._els[e].classList.add("active"),this._mainElement.classList.add("tui-image-editor-menu-"+e),this.submenu=e,this[this.submenu].changeStartMode()),this.resizeEditor()}},{key:"_initMenu",value:function(){if(this.options.initMenu){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!1),this._els[this.options.initMenu].dispatchEvent(e)}this.icon&&this.icon.registDefaultIcon()}},{key:"_getEditorDimension",value:function(){var e=parseFloat(this._editorContainerElement.style.maxHeight),t=this.imageSize.newHeight>e?e:this.imageSize.newHeight,n=parseFloat(this._editorContainerElement.style.maxWidth);return{width:this.imageSize.newWidth>n?n:this.imageSize.newWidth,height:t}}},{key:"_setEditorPosition",value:function(e){var t=this._getEditorDimension(),n=t.width,i=t.height,r=this._editorElement.style,o=0,a=0;this.submenu&&("bottom"===e?o=i>this._editorElementWrap.scrollHeight-150?(i-this._editorElementWrap.scrollHeight)/2:-75:"top"===e?o=i>this._editorElementWrap.offsetHeight-150?75-(i-(this._editorElementWrap.offsetHeight-150))/2:75:"left"===e?a=n>this._editorElementWrap.offsetWidth-248?124-(n-(this._editorElementWrap.offsetWidth-248))/2:124:"right"===e&&(a=n>this._editorElementWrap.scrollWidth-248?(n-this._editorElementWrap.scrollWidth)/2:-124)),r.top=o+"px",r.left=a+"px"}}]),e}();t.default=x},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.biImage,i=e.commonStyle,r=e.headerStyle,o=e.loadButtonStyle,a=e.downloadButtonStyle,s=e.submenuStyle;return'\n    <div class="tui-image-editor-main-container" style="'+i+'">\n        <div class="tui-image-editor-header" style="'+r+'">\n            <div class="tui-image-editor-header-logo">\n                <img src="'+n+'" />\n            </div>\n            <div class="tui-image-editor-header-buttons">\n                <div style="'+o+'">\n                    '+t.localize("Load")+'\n                    <input type="file" class="tui-image-editor-load-btn" />\n                </div>\n                <button class="tui-image-editor-download-btn" style="'+a+'">\n                    '+t.localize("Download")+'\n                </button>\n            </div>\n        </div>\n        <div class="tui-image-editor-main">\n            <div class="tui-image-editor-submenu">\n                <div class="tui-image-editor-submenu-style" style="'+s+'"></div>\n            </div>\n            <div class="tui-image-editor-wrap">\n                <div class="tui-image-editor-size-wrap">\n                    <div class="tui-image-editor-align-wrap">\n                        <div class="tui-image-editor"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n'}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.biImage,i=e.iconStyle,r=i.normal,o=i.hover,a=i.disabled,s=e.loadButtonStyle,l=e.downloadButtonStyle;return'\n    <div class="tui-image-editor-controls">\n        <div class="tui-image-editor-controls-logo">\n            <img src="'+n+'" />\n        </div>\n        <ul class="tui-image-editor-menu">\n            <li id="tie-btn-undo" class="tui-image-editor-item">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-undo" class="enabled"/>\n                    <use xlink:href="'+a.path+"#"+a.name+'-ic-undo" class="normal"/>\n                    <use xlink:href="'+o.path+"#"+o.name+'-ic-undo" class="hover"/>\n                </svg>\n            </li>\n            <li id="tie-btn-redo" class="tui-image-editor-item">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-redo" class="enabled"/>\n                    <use xlink:href="'+a.path+"#"+a.name+'-ic-redo" class="normal"/>\n                    <use xlink:href="'+o.path+"#"+o.name+'-ic-redo" class="hover"/>\n                </svg>\n            </li>\n            <li id="tie-btn-reset" class="tui-image-editor-item">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-reset" class="enabled"/>\n                    <use xlink:href="'+a.path+"#"+a.name+'-ic-reset" class="normal"/>\n                    <use xlink:href="'+o.path+"#"+o.name+'-ic-reset" class="hover"/>\n                </svg>\n            </li>\n            <li class="tui-image-editor-item">\n                <div class="tui-image-editor-icpartition"></div>\n            </li>\n            <li id="tie-btn-delete" class="tui-image-editor-item">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-delete" class="enabled"/>\n                    <use xlink:href="'+a.path+"#"+a.name+'-ic-delete" class="normal"/>\n                    <use xlink:href="'+o.path+"#"+o.name+'-ic-delete" class="hover"/>\n                </svg>\n            </li>\n            <li id="tie-btn-delete-all" class="tui-image-editor-item">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-delete-all" class="enabled"/>\n                    <use xlink:href="'+a.path+"#"+a.name+'-ic-delete-all" class="normal"/>\n                    <use xlink:href="'+o.path+"#"+o.name+'-ic-delete-all" class="hover"/>\n                </svg>\n            </li>\n            <li class="tui-image-editor-item">\n                <div class="tui-image-editor-icpartition"></div>\n            </li>\n        </ul>\n\n        <div class="tui-image-editor-controls-buttons">\n            <div style="'+s+'">\n                '+t.localize("Load")+'\n                <input type="file" class="tui-image-editor-load-btn" />\n            </div>\n            <button class="tui-image-editor-download-btn" style="'+l+'">\n                '+t.localize("Download")+"\n            </button>\n        </div>\n    </div>\n"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(3),o=n(72),a=l(n(78)),s=l(n(79));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.styles=this._changeToObject((0,r.extend)(s.default,t)),(0,o.styleLoad)(this._styleMaker())}return i(e,[{key:"getStyle",value:function(e){var t=null,n=e.replace(/\..+$/,""),i=this.styles[e];switch(e){case"common.bi":t=this.styles[e].image;break;case"menu.icon":case"submenu.icon":t={active:this.styles[n+".activeIcon"],normal:this.styles[n+".normalIcon"],hover:this.styles[n+".hoverIcon"],disabled:this.styles[n+".disabledIcon"]};break;case"submenu.label":t={active:this._makeCssText(this.styles[n+".activeLabel"]),normal:this._makeCssText(this.styles[n+".normalLabel"])};break;case"submenu.partition":t={vertical:this._makeCssText((0,r.extend)({},i,{borderLeft:"1px solid "+i.color})),horizontal:this._makeCssText((0,r.extend)({},i,{borderBottom:"1px solid "+i.color}))};break;case"range.disabledPointer":case"range.disabledBar":case"range.disabledSubbar":case"range.pointer":case"range.bar":case"range.subbar":i.backgroundColor=i.color,t=this._makeCssText(i);break;default:t=this._makeCssText(i)}return t}},{key:"_styleMaker",value:function(){var e=this.getStyle("submenu.label"),t=this.getStyle("submenu.partition");return(0,a.default)({subMenuLabelActive:e.active,subMenuLabelNormal:e.normal,submenuPartitionVertical:t.vertical,submenuPartitionHorizontal:t.horizontal,biSize:this.getStyle("common.bisize"),subMenuRangeTitle:this.getStyle("range.title"),submenuRangePointer:this.getStyle("range.pointer"),submenuRangeBar:this.getStyle("range.bar"),submenuRangeSubbar:this.getStyle("range.subbar"),submenuDisabledRangePointer:this.getStyle("range.disabledPointer"),submenuDisabledRangeBar:this.getStyle("range.disabledBar"),submenuDisabledRangeSubbar:this.getStyle("range.disabledSubbar"),submenuRangeValue:this.getStyle("range.value"),submenuColorpickerTitle:this.getStyle("colorpicker.title"),submenuColorpickerButton:this.getStyle("colorpicker.button"),submenuCheckbox:this.getStyle("checkbox"),menuIconSize:this.getStyle("menu.iconSize"),submenuIconSize:this.getStyle("submenu.iconSize")})}},{key:"_changeToObject",value:function(e){var t={};return(0,r.forEach)(e,(function(e,n){var i=n.match(/^(.+)\.([a-z]+)$/i),r=i[1],o=i[2];t[r]||(t[r]={}),t[r][o]=e})),t}},{key:"_makeCssText",value:function(e){var t=this,n=[];return(0,r.forEach)(e,(function(e,i){["backgroundImage"].indexOf(i)>-1&&"none"!==e&&(e="url("+e+")"),n.push(t._toUnderScore(i)+": "+e)})),n.join(";")}},{key:"_toUnderScore",value:function(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()}))}}]),e}();t.default=c},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.subMenuLabelActive,n=e.subMenuLabelNormal,i=e.subMenuRangeTitle,r=e.submenuPartitionVertical,o=e.submenuPartitionHorizontal,a=e.submenuCheckbox,s=e.submenuRangePointer,l=e.submenuRangeValue,c=e.submenuColorpickerTitle,u=e.submenuColorpickerButton,h=e.submenuRangeBar,d=e.submenuRangeSubbar,f=e.submenuDisabledRangePointer,p=e.submenuDisabledRangeBar,g=e.submenuDisabledRangeSubbar,v=e.submenuIconSize;return'\n    #tie-icon-add-button.icon-bubble .tui-image-editor-button[data-icontype="icon-bubble"] label,\n    #tie-icon-add-button.icon-heart .tui-image-editor-button[data-icontype="icon-heart"] label,\n    #tie-icon-add-button.icon-location .tui-image-editor-button[data-icontype="icon-location"] label,\n    #tie-icon-add-button.icon-polygon .tui-image-editor-button[data-icontype="icon-polygon"] label,\n    #tie-icon-add-button.icon-star .tui-image-editor-button[data-icontype="icon-star"] label,\n    #tie-icon-add-button.icon-star-2 .tui-image-editor-button[data-icontype="icon-star-2"] label,\n    #tie-icon-add-button.icon-arrow-3 .tui-image-editor-button[data-icontype="icon-arrow-3"] label,\n    #tie-icon-add-button.icon-arrow-2 .tui-image-editor-button[data-icontype="icon-arrow-2"] label,\n    #tie-icon-add-button.icon-arrow .tui-image-editor-button[data-icontype="icon-arrow"] label,\n    #tie-icon-add-button.icon-bubble .tui-image-editor-button[data-icontype="icon-bubble"] label,\n    #tie-draw-line-select-button.line .tui-image-editor-button.line label,\n    #tie-draw-line-select-button.free .tui-image-editor-button.free label,\n    #tie-flip-button.flipX .tui-image-editor-button.flipX label,\n    #tie-flip-button.flipY .tui-image-editor-button.flipY label,\n    #tie-flip-button.resetFlip .tui-image-editor-button.resetFlip label,\n    #tie-crop-button .tui-image-editor-button.apply.active label,\n    #tie-crop-preset-button .tui-image-editor-button.preset.active label,\n    #tie-shape-button.rect .tui-image-editor-button.rect label,\n    #tie-shape-button.circle .tui-image-editor-button.circle label,\n    #tie-shape-button.triangle .tui-image-editor-button.triangle label,\n    #tie-text-effect-button .tui-image-editor-button.active label,\n    #tie-text-align-button.left .tui-image-editor-button.left label,\n    #tie-text-align-button.center .tui-image-editor-button.center label,\n    #tie-text-align-button.right .tui-image-editor-button.right label,\n    #tie-mask-apply.apply.active .tui-image-editor-button.apply label,\n    .tui-image-editor-container .tui-image-editor-submenu .tui-image-editor-button:hover > label,\n    .tui-image-editor-container .tui-image-editor-checkbox input + label {\n        '+t+"\n    }\n    .tui-image-editor-container .tui-image-editor-submenu .tui-image-editor-button > label,\n    .tui-image-editor-container .tui-image-editor-range-wrap.tui-image-editor-newline.short label {\n        "+n+"\n    }\n    .tui-image-editor-container .tui-image-editor-range-wrap label {\n        "+i+"\n    }\n    .tui-image-editor-container .tui-image-editor-partition > div {\n        "+r+"\n    }\n    .tui-image-editor-container.left .tui-image-editor-submenu .tui-image-editor-partition > div,\n    .tui-image-editor-container.right .tui-image-editor-submenu .tui-image-editor-partition > div {\n        "+o+"\n    }\n    .tui-image-editor-container .tui-image-editor-checkbox input + label:before {\n        "+a+"\n    }\n    .tui-image-editor-container .tui-image-editor-checkbox input:checked + label:before {\n        border: 0;\n    }\n    .tui-image-editor-container .tui-image-editor-virtual-range-pointer {\n        "+s+"\n    }\n    .tui-image-editor-container .tui-image-editor-virtual-range-bar {\n        "+h+"\n    }\n    .tui-image-editor-container .tui-image-editor-virtual-range-subbar {\n        "+d+"\n    }\n    .tui-image-editor-container .tui-image-editor-disabled .tui-image-editor-virtual-range-pointer {\n        "+f+"\n    }\n    .tui-image-editor-container .tui-image-editor-disabled .tui-image-editor-virtual-range-subbar {\n        "+g+"\n    }\n    .tui-image-editor-container .tui-image-editor-disabled .tui-image-editor-virtual-range-bar {\n        "+p+"\n    }\n    .tui-image-editor-container .tui-image-editor-range-value {\n        "+l+"\n    }\n    .tui-image-editor-container .tui-image-editor-submenu .tui-image-editor-button .color-picker-value + label {\n        "+c+"\n    }\n    .tui-image-editor-container .tui-image-editor-submenu .tui-image-editor-button .color-picker-value {\n        "+u+"\n    }\n    .tui-image-editor-container .svg_ic-menu {\n        "+e.menuIconSize+"\n    }\n    .tui-image-editor-container .svg_ic-submenu {\n        "+v+"\n    }\n    .tui-image-editor-container .tui-image-editor-controls-logo > img,\n    .tui-image-editor-container .tui-image-editor-header-logo > img {\n        "+e.biSize+"\n    }\n\n"}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={"common.bi.image":"https://uicdn.toast.com/toastui/img/tui-image-editor-bi.png","common.bisize.width":"251px","common.bisize.height":"21px","common.backgroundImage":"none","common.backgroundColor":"#1e1e1e","common.border":"0px","header.backgroundImage":"none","header.backgroundColor":"transparent","header.border":"0px","loadButton.backgroundColor":"#fff","loadButton.border":"1px solid #ddd","loadButton.color":"#222","loadButton.fontFamily":"'Noto Sans', sans-serif","loadButton.fontSize":"12px","downloadButton.backgroundColor":"#fdba3b","downloadButton.border":"1px solid #fdba3b","downloadButton.color":"#fff","downloadButton.fontFamily":"'Noto Sans', sans-serif","downloadButton.fontSize":"12px","menu.normalIcon.path":"icon-d.svg","menu.normalIcon.name":"icon-d","menu.activeIcon.path":"icon-b.svg","menu.activeIcon.name":"icon-b","menu.disabledIcon.path":"icon-a.svg","menu.disabledIcon.name":"icon-a","menu.hoverIcon.path":"icon-c.svg","menu.hoverIcon.name":"icon-c","menu.iconSize.width":"24px","menu.iconSize.height":"24px","submenu.backgroundColor":"#1e1e1e","submenu.partition.color":"#3c3c3c","submenu.normalIcon.path":"icon-d.svg","submenu.normalIcon.name":"icon-d","submenu.activeIcon.path":"icon-c.svg","submenu.activeIcon.name":"icon-c","submenu.iconSize.width":"32px","submenu.iconSize.height":"32px","submenu.normalLabel.color":"#8a8a8a","submenu.normalLabel.fontWeight":"lighter","submenu.activeLabel.color":"#fff","submenu.activeLabel.fontWeight":"lighter","checkbox.border":"0px","checkbox.backgroundColor":"#fff","range.pointer.color":"#fff","range.bar.color":"#666","range.subbar.color":"#d1d1d1","range.disabledPointer.color":"#414141","range.disabledBar.color":"#282828","range.disabledSubbar.color":"#414141","range.value.color":"#fff","range.value.fontWeight":"lighter","range.value.fontSize":"11px","range.value.border":"1px solid #353535","range.value.backgroundColor":"#151515","range.title.color":"#fff","range.title.fontWeight":"lighter","colorpicker.button.border":"1px solid #1e1e1e","colorpicker.title.color":"#fff"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=u(n(81)),o=u(n(83)),a=u(n(84)),s=u(n(85)),l=n(72),c=n(73);function u(e){return e&&e.__esModule?e:{default:e}}var h={stroke:"#ffbb3b",fill:"",strokeWidth:3},d=function(e){function t(e,n){var i=n.locale,a=n.iconStyle,l=n.menuBarPosition,u=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var d=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{locale:i,name:"shape",iconStyle:a,menuBarPosition:l,templateHtml:s.default,usageStatistics:u}));return d.type=null,d.options=h,d._els={shapeSelectButton:d.selector("#tie-shape-button"),shapeColorButton:d.selector("#tie-shape-color-button"),strokeRange:new o.default(d.selector("#tie-stroke-range"),c.defaultShapeStrokeValus),strokeRangeValue:d.selector("#tie-stroke-range-value"),fillColorpicker:new r.default(d.selector("#tie-color-fill"),"",d.toggleDirection,d.usageStatistics),strokeColorpicker:new r.default(d.selector("#tie-color-stroke"),"#ffbb3b",d.toggleDirection,d.usageStatistics)},d.colorPickerControls.push(d._els.fillColorpicker),d.colorPickerControls.push(d._els.strokeColorpicker),d}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"addEvent",value:function(e){this.actions=e,this._els.shapeSelectButton.addEventListener("click",this._changeShapeHandler.bind(this)),this._els.strokeRange.on("change",this._changeStrokeRangeHandler.bind(this)),this._els.fillColorpicker.on("change",this._changeFillColorHandler.bind(this)),this._els.strokeColorpicker.on("change",this._changeStrokeColorHandler.bind(this)),this._els.fillColorpicker.on("changeShow",this.colorPickerChangeShow.bind(this)),this._els.strokeColorpicker.on("changeShow",this.colorPickerChangeShow.bind(this)),this._els.strokeRangeValue.value=this._els.strokeRange.value,this._els.strokeRangeValue.setAttribute("readonly",!0)}},{key:"setShapeStatus",value:function(e){var t=e.strokeWidth,n=e.strokeColor,i=e.fillColor;this._els.strokeRange.value=t,this._els.strokeRange.trigger("change"),this._els.strokeColorpicker.color=n,this._els.fillColorpicker.color=i,this.options.stroke=n,this.options.fill=i,this.options.strokeWidth=t}},{key:"changeStartMode",value:function(){this.actions.stopDrawingMode()}},{key:"changeStandbyMode",value:function(){this.type=null,this.actions.changeSelectableAll(!0),this._els.shapeSelectButton.classList.remove("circle"),this._els.shapeSelectButton.classList.remove("triangle"),this._els.shapeSelectButton.classList.remove("rect")}},{key:"setMaxStrokeValue",value:function(e){var t=e;t<=0&&(t=c.defaultShapeStrokeValus.max),this._els.strokeRange.max=t}},{key:"setStrokeValue",value:function(e){this._els.strokeRange.value=e,this._els.strokeRange.trigger("change")}},{key:"getStrokeValue",value:function(){return this._els.strokeRange.value}},{key:"_changeShapeHandler",value:function(e){var t=e.target.closest(".tui-image-editor-button");if(t){this.actions.stopDrawingMode(),this.actions.discardSelection();var n=this.getButtonType(t,["circle","triangle","rect"]);if(this.type===n)return void this.changeStandbyMode();this.changeStandbyMode(),this.type=n,e.currentTarget.classList.add(n),this.actions.changeSelectableAll(!1),this.actions.modeChange("shape")}}},{key:"_changeStrokeRangeHandler",value:function(e){this.options.strokeWidth=(0,l.toInteger)(e),this._els.strokeRangeValue.value=(0,l.toInteger)(e),this.actions.changeShape({strokeWidth:e}),this.actions.setDrawingShape(this.type,this.options)}},{key:"_changeFillColorHandler",value:function(e){e=e||"transparent",this.options.fill=e,this.actions.changeShape({fill:e})}},{key:"_changeStrokeColorHandler",value:function(e){e=e||"transparent",this.options.stroke=e,this.actions.changeShape({stroke:e})}}]),t}(a.default);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(3)),o=a(n(82));function a(e){return e&&e.__esModule?e:{default:e}}var s=["#000000","#2a2a2a","#545454","#7e7e7e","#a8a8a8","#d2d2d2","#ffffff","","#ff4040","#ff6518","#ffbb3b","#03bd9e","#00a9ff","#515ce6","#9e5fff","#ff5583"],l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#7e7e7e",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"up",r=arguments[3];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=t.getAttribute("title");this.usageStatistics=r,this._show=!1,this._colorpickerElement=t,this._toggleDirection=i,this._makePickerButtonElement(t,n),this._makePickerLayerElement(t,a),this._color=n,this.picker=o.default.create({container:this.pickerElement,preset:s,color:n,usageStatistics:this.usageStatistics}),this._addEvent(t)}return i(e,[{key:"_changeColorElement",value:function(e){e?(this.colorElement.classList.remove("transparent"),this.colorElement.style.backgroundColor=e):(this.colorElement.style.backgroundColor="#fff",this.colorElement.classList.add("transparent"))}},{key:"_makePickerButtonElement",value:function(e,t){e.classList.add("tui-image-editor-button"),this.colorElement=document.createElement("div"),this.colorElement.className="color-picker-value",t?this.colorElement.style.backgroundColor=t:this.colorElement.classList.add("transparent")}},{key:"_makePickerLayerElement",value:function(e,t){var n=document.createElement("label"),i=document.createElement("div");this.pickerControl=document.createElement("div"),this.pickerControl.className="color-picker-control",this.pickerElement=document.createElement("div"),this.pickerElement.className="color-picker",n.innerHTML=t,i.className="triangle",this.pickerControl.appendChild(this.pickerElement),this.pickerControl.appendChild(i),e.appendChild(this.pickerControl),e.appendChild(this.colorElement),e.appendChild(n)}},{key:"_addEvent",value:function(e){var t=this;this.picker.on("selectColor",(function(e){t._changeColorElement(e.color),t._color=e.color,t.fire("change",e.color)})),e.addEventListener("click",(function(e){var n=e.target,i=n&&t._isElementInColorPickerControl(n);(!i||i&&t._isPaletteButton(n))&&(t._show=!t._show,t.pickerControl.style.display=t._show?"block":"none",t._setPickerControlPosition(),t.fire("changeShow",t)),e.stopPropagation()})),document.body.addEventListener("click",(function(){t.hide()}))}},{key:"_isPaletteButton",value:function(e){return"tui-colorpicker-palette-button"===e.className}},{key:"_isElementInColorPickerControl",value:function(e){for(var t=e;t!==document.body&&t;){if(t===this.pickerControl)return!0;t=t.parentNode}return!1}},{key:"hide",value:function(){this._show=!1,this.pickerControl.style.display="none"}},{key:"_setPickerControlPosition",value:function(){var e=this.pickerControl.style,t=this._colorpickerElement.clientWidth/2+2,n=this.pickerControl.offsetWidth/2-t,i=-1*(this.pickerControl.offsetHeight+10);"down"===this._toggleDirection&&(i=30),e.top=i+"px",e.left="-"+n+"px"}},{key:"color",get:function(){return this._color},set:function(e){this._color=e,this._changeColorElement(e)}}]),e}();r.default.CustomEvents.mixin(l),t.default=l},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(3),a=(i=o)&&i.__esModule?i:{default:i},s=n(72),l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._value=n.value||0,this.rangeElement=t,this._drawRangeElement(),this.rangeWidth=(0,s.toInteger)(window.getComputedStyle(t,null).width)-12,this._min=n.min||0,this._max=n.max||100,this._absMax=-1*this._min+this._max,this.realTimeEvent=n.realTimeEvent||!1,this._addClickEvent(),this._addDragEvent(),this.value=n.value,this.trigger("change")}return r(e,[{key:"trigger",value:function(e){this.fire(e,this._value)}},{key:"_drawRangeElement",value:function(){this.rangeElement.classList.add("tui-image-editor-range"),this.bar=document.createElement("div"),this.bar.className="tui-image-editor-virtual-range-bar",this.subbar=document.createElement("div"),this.subbar.className="tui-image-editor-virtual-range-subbar",this.pointer=document.createElement("div"),this.pointer.className="tui-image-editor-virtual-range-pointer",this.bar.appendChild(this.subbar),this.bar.appendChild(this.pointer),this.rangeElement.appendChild(this.bar)}},{key:"_addClickEvent",value:function(){var e=this;this.rangeElement.addEventListener("click",(function(t){if(t.stopPropagation(),"tui-image-editor-range"===t.target.className){var n=t.offsetX/e.rangeWidth,i=e._absMax*n+e._min;e.pointer.style.left=n*e.rangeWidth+"px",e.subbar.style.right=(1-n)*e.rangeWidth+"px",e._value=i,e.fire("change",i,!0)}}))}},{key:"_addDragEvent",value:function(){var e=this;this.pointer.addEventListener("mousedown",(function(t){e.firstPosition=t.screenX,e.firstLeft=(0,s.toInteger)(e.pointer.style.left)||0,e.dragEventHandler={changeAngle:e._changeAngle.bind(e),stopChangingAngle:e._stopChangingAngle.bind(e)},document.addEventListener("mousemove",e.dragEventHandler.changeAngle),document.addEventListener("mouseup",e.dragEventHandler.stopChangingAngle)}))}},{key:"_changeAngle",value:function(e){var t=e.screenX-this.firstPosition,n=this.firstLeft+t;n=(n=n>this.rangeWidth?this.rangeWidth:n)<0?0:n,this.pointer.style.left=n+"px",this.subbar.style.right=this.rangeWidth-n+"px";var i=n/this.rangeWidth,r=this._absMax*i+this._min;this._value=r,this.realTimeEvent&&this.fire("change",r,!1)}},{key:"_stopChangingAngle",value:function(){this.fire("change",this._value,!0),document.removeEventListener("mousemove",this.dragEventHandler.changeAngle),document.removeEventListener("mouseup",this.dragEventHandler.stopChangingAngle)}},{key:"max",set:function(e){this._max=e,this._absMax=-1*this._min+this._max,this.value=this._value},get:function(){return this._max}},{key:"value",get:function(){return this._value},set:function(e){var t=(e-this._min)*this.rangeWidth/this._absMax;this.rangeWidth<t&&(t=this.rangeWidth),this.pointer.style.left=t+"px",this.subbar.style.right=this.rangeWidth-t+"px",this._value=e}}]),e}();a.default.CustomEvents.mixin(l),t.default=l},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=function(){function e(t,n){var i=n.locale,r=n.name,o=n.iconStyle,a=n.menuBarPosition,s=n.templateHtml,l=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=function(e){return t.querySelector(e)},this.menuBarPosition=a,this.toggleDirection="top"===a?"down":"up",this.colorPickerControls=[],this.usageStatistics=l,this._makeSubMenuElement(t,{locale:i,name:r,iconStyle:o,templateHtml:s})}return n(e,[{key:"colorPickerChangeShow",value:function(e){this.colorPickerControls.forEach((function(t){e!==t&&t.hide()}))}},{key:"getButtonType",value:function(e,t){return e.className.match(RegExp("("+t.join("|")+")"))[0]}},{key:"changeClass",value:function(e,t,n){e.classList.remove(t),e.classList.add(n)}},{key:"changeStandbyMode",value:function(){}},{key:"changeStartMode",value:function(){}},{key:"_makeSubMenuElement",value:function(e,t){var n=t.locale,i=t.name,r=t.iconStyle,o=t.templateHtml,a=document.createElement("div");a.className="tui-image-editor-menu-"+i,a.innerHTML=o({locale:n,iconStyle:r}),e.appendChild(a)}}]),e}();t.default=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.iconStyle,i=n.normal,r=n.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-shape-button">\n            <div class="tui-image-editor-button rect">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-shape-rectangle"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-shape-rectangle"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Rectangle")+' </label>\n            </div>\n            <div class="tui-image-editor-button circle">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-shape-circle"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-shape-circle"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Circle")+' </label>\n            </div>\n            <div class="tui-image-editor-button triangle">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-shape-triangle"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-shape-triangle"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Triangle")+' </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li id="tie-shape-color-button">\n            <div id="tie-color-fill" title="'+t.localize("Fill")+'"></div>\n            <div id="tie-color-stroke" title="'+t.localize("Stroke")+'"></div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-newline tui-image-editor-range-wrap">\n            <label class="range">'+t.localize("Stroke")+'</label>\n            <div id="tie-stroke-range"></div>\n            <input id="tie-stroke-range-value" class="tui-image-editor-range-value" value="0" />\n        </li>\n    </ul>\n'}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(n(3)),o=s(n(84)),a=s(n(87));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){var i=n.locale,r=n.iconStyle,o=n.menuBarPosition,s=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{locale:i,name:"crop",iconStyle:r,menuBarPosition:o,templateHtml:a.default,usageStatistics:s}));return l.status="active",l._els={apply:l.selector("#tie-crop-button .apply"),cancel:l.selector("#tie-crop-button .cancel"),preset:l.selector("#tie-crop-preset-button")},l.defaultPresetButton=l._els.preset.querySelector(".preset-none"),l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"addEvent",value:function(e){var t=this;this.actions=e,this._els.apply.addEventListener("click",(function(){t.actions.crop(),t._els.apply.classList.remove("active")})),this._els.cancel.addEventListener("click",(function(){t.actions.cancel(),t._els.apply.classList.remove("active")})),this._els.preset.addEventListener("click",(function(e){var n=e.target.closest(".tui-image-editor-button.preset");if(n){var i=n.className.match(/preset-[^\s]+/)[0];t._setPresetButtonActive(n),t.actions.preset(i)}}))}},{key:"changeStartMode",value:function(){this.actions.modeChange("crop")}},{key:"changeStandbyMode",value:function(){this.actions.stopDrawingMode(),this._setPresetButtonActive()}},{key:"changeApplyButtonStatus",value:function(e){e?this._els.apply.classList.add("active"):this._els.apply.classList.remove("active")}},{key:"_setPresetButtonActive",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultPresetButton;r.default.forEach([].slice.call(this._els.preset.querySelectorAll(".preset")),(function(e){e.classList.remove("active")})),e&&e.classList.add("active")}}]),t}(o.default);t.default=l},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.iconStyle,i=n.normal,r=n.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-crop-preset-button">\n            <div class="tui-image-editor-button preset preset-none active">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-shape-rectangle"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-shape-rectangle"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Custom")+' </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-square">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Square")+' </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-3-2">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("3:2")+' </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-4-3">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("4:3")+' </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-5-4">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("5:4")+' </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-7-5">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("7:5")+' </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-16-9">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("16:9")+' </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition tui-image-editor-newline">\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li id="tie-crop-button" class="action">\n            <div class="tui-image-editor-button apply">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="'+i.path+"#"+i.name+'-ic-apply" class="normal"/>\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-apply" class="active"/>\n                </svg>\n                <label>\n                    '+t.localize("Apply")+'\n                </label>\n            </div>\n            <div class="tui-image-editor-button cancel">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="'+i.path+"#"+i.name+'-ic-cancel" class="normal"/>\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-cancel" class="active"/>\n                </svg>\n                <label>\n                    '+t.localize("Cancel")+"\n                </label>\n            </div>\n        </li>\n    </ul>\n"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(n(3)),o=s(n(84)),a=s(n(89));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){var i=n.locale,r=n.iconStyle,o=n.menuBarPosition,s=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{locale:i,name:"flip",iconStyle:r,menuBarPosition:o,templateHtml:a.default,usageStatistics:s}));return l.flipStatus=!1,l._els={flipButton:l.selector("#tie-flip-button")},l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"addEvent",value:function(e){this._actions=e,this._els.flipButton.addEventListener("click",this._changeFlip.bind(this))}},{key:"_changeFlip",value:function(e){var t=this,n=e.target.closest(".tui-image-editor-button");if(n){var i=this.getButtonType(n,["flipX","flipY","resetFlip"]);if(!this.flipStatus&&"resetFlip"===i)return;this._actions.flip(i).then((function(e){var n=t._els.flipButton.classList;t.flipStatus=!1,n.remove("resetFlip"),r.default.forEach(["flipX","flipY"],(function(i){n.remove(i),e[i]&&(n.add(i),n.add("resetFlip"),t.flipStatus=!0)}))}))}}}]),t}(o.default);t.default=l},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.iconStyle,i=n.normal,r=n.active;return'\n    <ul id="tie-flip-button" class="tui-image-editor-submenu-item">\n        <li>\n            <div class="tui-image-editor-button flipX">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-flip-x" class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-flip-x" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Flip X")+'\n                </label>\n            </div>\n            <div class="tui-image-editor-button flipY">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-flip-y" class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-flip-y" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Flip Y")+'\n                </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div class="tui-image-editor-button resetFlip">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-flip-reset"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-flip-reset"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Reset")+"\n                </label>\n            </div>\n        </li>\n    </ul>\n"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=c(n(83)),o=c(n(84)),a=c(n(91)),s=n(72),l=n(73);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){var i=n.locale,o=n.iconStyle,s=n.menuBarPosition,c=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var u=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{locale:i,name:"rotate",iconStyle:o,menuBarPosition:s,templateHtml:a.default,usageStatistics:c}));return u._value=0,u._els={rotateButton:u.selector("#tie-retate-button"),rotateRange:new r.default(u.selector("#tie-rotate-range"),l.defaultRotateRangeValus),rotateRangeValue:u.selector("#tie-ratate-range-value")},u}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"setRangeBarAngle",value:function(e,t){var n=t;"rotate"===e&&(n=parseInt(this._els.rotateRangeValue.value,10)+t),this._els.rotateRangeValue.value=n,this._setRangeBarRatio(n)}},{key:"_setRangeBarRatio",value:function(e){this._els.rotateRange.value=e}},{key:"addEvent",value:function(e){this.actions=e,this._els.rotateButton.addEventListener("click",this._changeRotateForButton.bind(this)),this._els.rotateRange.on("change",this._changeRotateForRange.bind(this)),this._els.rotateRangeValue.setAttribute("readonly",!0)}},{key:"_changeRotateForRange",value:function(e,t){var n=(0,s.toInteger)(e);this._els.rotateRangeValue.value=n,this.actions.setAngle(n,!t),this._value=n}},{key:"_changeRotateForButton",value:function(e){var t=e.target.closest(".tui-image-editor-button"),n=this._els.rotateRangeValue.value;if(t){var i={clockwise:30,counterclockwise:-30}[this.getButtonType(t,["counterclockwise","clockwise"])],r=parseInt(n,10)+i;r>=-360&&r<=360&&this.actions.rotate(i)}}}]),t}(o.default);t.default=u},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.iconStyle,i=n.normal,r=n.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-retate-button">\n            <div class="tui-image-editor-button clockwise">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-rotate-clockwise"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-rotate-clockwise"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> 30 </label>\n            </div>\n            <div class="tui-image-editor-button counterclockwise">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-rotate-counterclockwise"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-rotate-counterclockwise"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> -30 </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-newline tui-image-editor-range-wrap">\n            <label class="range">'+t.localize("Range")+'</label>\n            <div id="tie-rotate-range"></div>\n            <input id="tie-ratate-range-value" class="tui-image-editor-range-value" value="0" />\n        </li>\n    </ul>\n'}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=u(n(83)),o=u(n(81)),a=u(n(84)),s=u(n(93)),l=n(72),c=n(73);function u(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){var i=n.locale,a=n.iconStyle,l=n.menuBarPosition,u=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var h=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{locale:i,name:"text",iconStyle:a,menuBarPosition:l,templateHtml:s.default,usageStatistics:u}));return h.effect={bold:!1,italic:!1,underline:!1},h.align="left",h._els={textEffectButton:h.selector("#tie-text-effect-button"),textAlignButton:h.selector("#tie-text-align-button"),textColorpicker:new o.default(h.selector("#tie-text-color"),"#ffbb3b",h.toggleDirection,h.usageStatistics),textRange:new r.default(h.selector("#tie-text-range"),c.defaultTextRangeValus),textRangeValue:h.selector("#tie-text-range-value")},h}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"addEvent",value:function(e){this.actions=e,this._els.textEffectButton.addEventListener("click",this._setTextEffectHandler.bind(this)),this._els.textAlignButton.addEventListener("click",this._setTextAlignHandler.bind(this)),this._els.textRange.on("change",this._changeTextRnageHandler.bind(this)),this._els.textRangeValue.value=this._els.textRange.value,this._els.textRangeValue.setAttribute("readonly",!0),this._els.textColorpicker.on("change",this._changeColorHandler.bind(this))}},{key:"changeStandbyMode",value:function(){this.actions.stopDrawingMode()}},{key:"changeStartMode",value:function(){this.actions.modeChange("text")}},{key:"_setTextEffectHandler",value:function(e){var t=e.target.closest(".tui-image-editor-button"),n=t.className.match(/(bold|italic|underline)/)[0],i={bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},underline:{textDecoration:"underline"}}[n];this.effect[n]=!this.effect[n],t.classList.toggle("active"),this.actions.changeTextStyle(i)}},{key:"_setTextAlignHandler",value:function(e){var t=e.target.closest(".tui-image-editor-button");if(t){var n=this.getButtonType(t,["left","center","right"]);e.currentTarget.classList.remove(this.align),this.align!==n&&e.currentTarget.classList.add(n),this.actions.changeTextStyle({textAlign:n}),this.align=n}}},{key:"_changeTextRnageHandler",value:function(e){e=(0,l.toInteger)(e),(0,l.toInteger)(this._els.textRangeValue.value)!==e&&(this.actions.changeTextStyle({fontSize:e}),this._els.textRangeValue.value=e)}},{key:"_changeColorHandler",value:function(e){e=e||"transparent",this.actions.changeTextStyle({fill:e})}},{key:"textColor",get:function(){return this._els.textColorpicker.color}},{key:"fontSize",get:function(){return this._els.textRange.value},set:function(e){this._els.textRange.value=e,this._els.textRangeValue.value=e}}]),t}(a.default);t.default=h},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.iconStyle,i=n.normal,r=n.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-text-effect-button">\n            <div class="tui-image-editor-button bold">\n                <div>\n                    <svg class="svg_ic-submenu">\n                    <use xlink:href="'+i.path+"#"+i.name+'-ic-text-bold" class="normal"/>\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-text-bold" class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Bold")+' </label>\n            </div>\n            <div class="tui-image-editor-button italic">\n                <div>\n                    <svg class="svg_ic-submenu">\n                    <use xlink:href="'+i.path+"#"+i.name+'-ic-text-italic" class="normal"/>\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-text-italic" class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Italic")+' </label>\n            </div>\n            <div class="tui-image-editor-button underline">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-text-underline"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-text-underline"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Underline")+' </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li id="tie-text-align-button">\n            <div class="tui-image-editor-button left">\n                <div>\n                    <svg class="svg_ic-submenu">\n                     <use xlink:href="'+i.path+"#"+i.name+'-ic-text-align-left"\n                        class="normal"/>\n                     <use xlink:href="'+r.path+"#"+r.name+'-ic-text-align-left"\n                        class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Left")+' </label>\n            </div>\n            <div class="tui-image-editor-button center">\n                <div>\n                    <svg class="svg_ic-submenu">\n                     <use xlink:href="'+i.path+"#"+i.name+'-ic-text-align-center"\n                        class="normal"/>\n                     <use xlink:href="'+r.path+"#"+r.name+'-ic-text-align-center"\n                        class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Center")+' </label>\n            </div>\n            <div class="tui-image-editor-button right">\n                <div>\n                    <svg class="svg_ic-submenu">\n                     <use xlink:href="'+i.path+"#"+i.name+'-ic-text-align-right"\n                        class="normal"/>\n                     <use xlink:href="'+r.path+"#"+r.name+'-ic-text-align-right"\n                        class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Right")+' </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div id="tie-text-color" title="'+t.localize("Color")+'"></div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-newline tui-image-editor-range-wrap">\n            <label class="range">'+t.localize("Text size")+'</label>\n            <div id="tie-text-range"></div>\n            <input id="tie-text-range-value" class="tui-image-editor-range-value" value="0" />\n        </li>\n    </ul>\n'}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(n(84)),o=s(n(72)),a=s(n(95));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){var i=n.locale,r=n.iconStyle,o=n.menuBarPosition,s=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{locale:i,name:"mask",iconStyle:r,menuBarPosition:o,templateHtml:a.default,usageStatistics:s}));return l._els={applyButton:l.selector("#tie-mask-apply"),maskImageButton:l.selector("#tie-mask-image-file")},l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"addEvent",value:function(e){this.actions=e,this._els.maskImageButton.addEventListener("change",this._loadMaskFile.bind(this)),this._els.applyButton.addEventListener("click",this._applyMask.bind(this))}},{key:"_applyMask",value:function(){this.actions.applyFilter(),this._els.applyButton.classList.remove("active")}},{key:"_loadMaskFile",value:function(e){var t=void 0;o.default.isSupportFileApi()||alert("This browser does not support file-api");var n=e.target.files[0];n&&(t=URL.createObjectURL(n),this.actions.loadImageFromURL(t,n),this._els.applyButton.classList.add("active"))}}]),t}(r.default);t.default=l},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.iconStyle,i=n.normal,r=n.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li>\n            <div class="tui-image-editor-button">\n                <div>\n                    <input type="file" accept="image/*" id="tie-mask-image-file">\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-mask-load" class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-mask-load" class="active"/>\n                    </svg>\n                </div>\n                <label> '+t.localize("Load Mask Image")+' </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li id="tie-mask-apply" class="tui-image-editor-newline apply" style="margin-top: 22px;margin-bottom: 5px">\n            <div class="tui-image-editor-button apply">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="'+i.path+"#"+i.name+'-ic-apply" class="normal"/>\n                    <use xlink:href="'+r.path+"#"+r.name+'-ic-apply" class="active"/>\n                </svg>\n                <label>\n                    '+t.localize("Apply")+"\n                </label>\n            </div>\n        </li>\n    </ul>\n"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=u(n(3)),o=u(n(81)),a=u(n(84)),s=u(n(97)),l=n(72),c=n(73);function u(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){var i=n.locale,r=n.iconStyle,a=n.menuBarPosition,l=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{locale:i,name:"icon",iconStyle:r,menuBarPosition:a,templateHtml:s.default,usageStatistics:l}));return c.iconType=null,c._iconMap={},c._els={registIconButton:c.selector("#tie-icon-image-file"),addIconButton:c.selector("#tie-icon-add-button"),iconColorpicker:new o.default(c.selector("#tie-icon-color"),"#ffbb3b",c.toggleDirection,c.usageStatistics)},c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"addEvent",value:function(e){this.actions=e,this._els.iconColorpicker.on("change",this._changeColorHandler.bind(this)),this._els.registIconButton.addEventListener("change",this._registeIconHandler.bind(this)),this._els.addIconButton.addEventListener("click",this._addIconHandler.bind(this))}},{key:"clearIconType",value:function(){this._els.addIconButton.classList.remove(this.iconType),this.iconType=null}},{key:"registDefaultIcon",value:function(){var e=this;r.default.forEach(c.defaultIconPath,(function(t,n){e.actions.registDefalutIcons(n,t)}))}},{key:"setIconPickerColor",value:function(e){this._els.iconColorpicker.color=e}},{key:"changeStandbyMode",value:function(){this.clearIconType(),this.actions.cancelAddIcon()}},{key:"_changeColorHandler",value:function(e){e=e||"transparent",this.actions.changeColor(e)}},{key:"_addIconHandler",value:function(e){var t=e.target.closest(".tui-image-editor-button");if(t){var n=t.getAttribute("data-icontype"),i=this._els.iconColorpicker.color;this.actions.discardSelection(),this.actions.changeSelectableAll(!1),this._els.addIconButton.classList.remove(this.iconType),this._els.addIconButton.classList.add(n),this.iconType===n?this.changeStandbyMode():(this.actions.addIcon(n,i),this.iconType=n)}}},{key:"_registeIconHandler",value:function(e){var t=void 0;l.isSupportFileApi||alert("This browser does not support file-api");var n=e.target.files[0];n&&(t=URL.createObjectURL(n),this.actions.registCustomIcon(t,n))}}]),t}(a.default);t.default=h},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.iconStyle,i=n.normal,r=n.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-icon-add-button">\n            <div class="tui-image-editor-button" data-icontype="icon-arrow">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-arrow"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-icon-arrow"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Arrow")+'\n                </label>\n            </div>\n            <div class="tui-image-editor-button" data-icontype="icon-arrow-2">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-arrow-2"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-icon-arrow-2"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Arrow-2")+'\n                </label>\n            </div>\n            <div class="tui-image-editor-button" data-icontype="icon-arrow-3">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-arrow-3"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-icon-arrow-3"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Arrow-3")+'\n                </label>\n            </div>\n            <div class="tui-image-editor-button" data-icontype="icon-star">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-star" class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-icon-star" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Star-1")+'\n                </label>\n            </div>\n            <div class="tui-image-editor-button" data-icontype="icon-star-2">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-star-2"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-icon-star-2"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Star-2")+'\n                </label>\n            </div>\n\n            <div class="tui-image-editor-button" data-icontype="icon-polygon">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-polygon"\n                            class="normal"/>\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-polygon"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Polygon")+'\n                </label>\n            </div>\n\n            <div class="tui-image-editor-button" data-icontype="icon-location">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-location"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-icon-location"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Location")+'\n                </label>\n            </div>\n\n            <div class="tui-image-editor-button" data-icontype="icon-heart">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-heart"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-icon-heart"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Heart")+'\n                </label>\n            </div>\n\n            <div class="tui-image-editor-button" data-icontype="icon-bubble">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-bubble"\n                            class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-icon-bubble"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Bubble")+'\n                </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li id="tie-icon-add-button">\n            <div class="tui-image-editor-button" style="margin:0">\n                <div>\n                    <input type="file" accept="image/*" id="tie-icon-image-file">\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-icon-load" class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-icon-load" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Custom icon")+'\n                </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div id="tie-icon-color" title="'+t.localize("Color")+'"></div>\n        </li>\n    </ul>\n'}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=u(n(72)),o=u(n(81)),a=u(n(83)),s=u(n(84)),l=u(n(99)),c=n(73);function u(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){var i=n.locale,r=n.iconStyle,s=n.menuBarPosition,u=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var h=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{locale:i,name:"draw",iconStyle:r,menuBarPosition:s,templateHtml:l.default,usageStatistics:u}));return h._els={lineSelectButton:h.selector("#tie-draw-line-select-button"),drawColorpicker:new o.default(h.selector("#tie-draw-color"),"#00a9ff",h.toggleDirection,h.usageStatistics),drawRange:new a.default(h.selector("#tie-draw-range"),c.defaultDrawRangeValus),drawRangeValue:h.selector("#tie-draw-range-value")},h.type=null,h.color=h._els.drawColorpicker.color,h.width=h._els.drawRange.value,h}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"addEvent",value:function(e){this.actions=e,this._els.lineSelectButton.addEventListener("click",this._changeDrawType.bind(this)),this._els.drawColorpicker.on("change",this._changeDrawColor.bind(this)),this._els.drawRange.on("change",this._changeDrawRange.bind(this)),this._els.drawRangeValue.value=this._els.drawRange.value,this._els.drawRangeValue.setAttribute("readonly",!0)}},{key:"setDrawMode",value:function(){this.actions.setDrawMode(this.type,{width:this.width,color:r.default.getRgb(this.color,.7)})}},{key:"changeStandbyMode",value:function(){this.type=null,this.actions.stopDrawingMode(),this.actions.changeSelectableAll(!0),this._els.lineSelectButton.classList.remove("free"),this._els.lineSelectButton.classList.remove("line")}},{key:"changeStartMode",value:function(){this.type="free",this._els.lineSelectButton.classList.add("free"),this.setDrawMode()}},{key:"_changeDrawType",value:function(e){var t=e.target.closest(".tui-image-editor-button");if(t){var n=this.getButtonType(t,["free","line"]);if(this.actions.discardSelection(),this.type===n)return void this.changeStandbyMode();this.changeStandbyMode(),this.type=n,this._els.lineSelectButton.classList.add(n),this.setDrawMode()}}},{key:"_changeDrawColor",value:function(e){this.color=e||"transparent",this.type?this.setDrawMode():this.changeStartMode()}},{key:"_changeDrawRange",value:function(e){e=r.default.toInteger(e),this._els.drawRangeValue.value=e,this.width=e,this.type?this.setDrawMode():this.changeStartMode()}}]),t}(s.default);t.default=h},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale,n=e.iconStyle,i=n.normal,r=n.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-draw-line-select-button">\n            <div class="tui-image-editor-button free">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-draw-free" class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-draw-free" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Free")+'\n                </label>\n            </div>\n            <div class="tui-image-editor-button line">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'+i.path+"#"+i.name+'-ic-draw-line" class="normal"/>\n                        <use xlink:href="'+r.path+"#"+r.name+'-ic-draw-line" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    '+t.localize("Straight")+'\n                </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div id="tie-draw-color" title="'+t.localize("Color")+'"></div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-newline tui-image-editor-range-wrap">\n            <label class="range">'+t.localize("Range")+'</label>\n            <div id="tie-draw-range"></div>\n            <input id="tie-draw-range-value" class="tui-image-editor-range-value" value="0" />\n        </li>\n    </ul>\n'}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=h(n(3)),o=h(n(81)),a=h(n(83)),s=h(n(84)),l=h(n(101)),c=n(72),u=n(73);function h(e){return e&&e.__esModule?e:{default:e}}var d=["add","diff","subtract","multiply","screen","lighten","darken"],f=["grayscale","invert","sepia","sepia2","blur","sharpen","emboss","remove-white","brightness","noise","pixelate","color-filter","tint","multiply","blend"],p={grayscale:"grayscale",invert:"invert",sepia:"sepia",sepia2:"vintage",blur:"blur",sharpen:"sharpen",emboss:"emboss",removeWhite:"removeColor",brightness:"brightness",contrast:"contrast",saturation:"saturation",vintage:"vintage",polaroid:"polaroid",noise:"noise",pixelate:"pixelate",colorFilter:"removeColor",tint:"blendColor",multiply:"blendColor",blend:"blendColor",hue:"hue",gamma:"gamma"},g=function(e){function t(e,n){var i=n.locale,r=n.iconStyle,o=n.menuBarPosition,a=n.usageStatistics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{locale:i,name:"filter",iconStyle:r,menuBarPosition:o,templateHtml:l.default,usageStatistics:a}));return s.selectBoxShow=!1,s.checkedMap={},s._makeControlElement(),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"addEvent",value:function(e){var t=this,n=e.applyFilter,i=this._changeRangeValue.bind(this,n);r.default.forEach(f,(function(e){var n=t.selector("#tie-"+e),r=(0,c.toCamelCase)(e);t.checkedMap[r]=n,n.addEventListener("change",(function(){return i(r)}))})),this._els.removewhiteDistanceRange.on("change",(function(){return i("removeWhite")})),this._els.colorfilterThresholeRange.on("change",(function(){return i("colorFilter")})),this._els.pixelateRange.on("change",(function(){return i("pixelate")})),this._els.noiseRange.on("change",(function(){return i("noise")})),this._els.brightnessRange.on("change",(function(){return i("brightness")})),this._els.blendType.addEventListener("change",(function(){return i("blend")})),this._els.filterBlendColor.on("change",(function(){return i("blend")})),this._els.filterMultiplyColor.on("change",(function(){return i("multiply")})),this._els.tintOpacity.on("change",(function(){return i("tint")})),this._els.filterTintColor.on("change",(function(){return i("tint")})),this._els.blendType.addEventListener("click",(function(e){return e.stopPropagation()})),this._els.filterMultiplyColor.on("changeShow",this.colorPickerChangeShow.bind(this)),this._els.filterTintColor.on("changeShow",this.colorPickerChangeShow.bind(this)),this._els.filterBlendColor.on("changeShow",this.colorPickerChangeShow.bind(this))}},{key:"_changeRangeValue",value:function(e,t){var n=this.checkedMap[t].checked,i=p[t],r=this.checkedMap[t].closest(".tui-image-editor-checkbox-group");r&&(n?r.classList.remove("tui-image-editor-disabled"):r.classList.add("tui-image-editor-disabled")),e(n,i,this._getFilterOption(t))}},{key:"_getFilterOption",value:function(e){var t={};switch(e){case"removeWhite":t.color="#FFFFFF",t.useAlpha=!1,t.distance=parseFloat(this._els.removewhiteDistanceRange.value);break;case"colorFilter":t.color="#FFFFFF",t.distance=parseFloat(this._els.colorfilterThresholeRange.value);break;case"pixelate":t.blocksize=(0,c.toInteger)(this._els.pixelateRange.value);break;case"noise":t.noise=(0,c.toInteger)(this._els.noiseRange.value);break;case"brightness":t.brightness=parseFloat(this._els.brightnessRange.value);break;case"blend":t.mode="add",t.color=this._els.filterBlendColor.color,t.mode=this._els.blendType.value;break;case"multiply":t.mode="multiply",t.color=this._els.filterMultiplyColor.color;break;case"tint":t.mode="tint",t.color=this._els.filterTintColor.color,t.alpha=this._els.tintOpacity.value}return t}},{key:"_makeControlElement",value:function(){var e=this.selector;this._els={removewhiteDistanceRange:new a.default(e("#tie-removewhite-distance-range"),u.defaultFilterRangeValus.removewhiteDistanceRange),brightnessRange:new a.default(e("#tie-brightness-range"),u.defaultFilterRangeValus.brightnessRange),noiseRange:new a.default(e("#tie-noise-range"),u.defaultFilterRangeValus.noiseRange),pixelateRange:new a.default(e("#tie-pixelate-range"),u.defaultFilterRangeValus.pixelateRange),colorfilterThresholeRange:new a.default(e("#tie-colorfilter-threshole-range"),u.defaultFilterRangeValus.colorfilterThresholeRange),filterTintColor:new o.default(e("#tie-filter-tint-color"),"#03bd9e",this.toggleDirection,this.usageStatistics),filterMultiplyColor:new o.default(e("#tie-filter-multiply-color"),"#515ce6",this.toggleDirection,this.usageStatistics),filterBlendColor:new o.default(e("#tie-filter-blend-color"),"#ffbb3b",this.toggleDirection,this.usageStatistics)},this._els.tintOpacity=this._pickerWithRange(this._els.filterTintColor.pickerControl),this._els.blendType=this._pickerWithSelectbox(this._els.filterBlendColor.pickerControl),this.colorPickerControls.push(this._els.filterTintColor),this.colorPickerControls.push(this._els.filterMultiplyColor),this.colorPickerControls.push(this._els.filterBlendColor)}},{key:"_pickerWithRange",value:function(e){var t=document.createElement("div"),n=document.createElement("label"),i=document.createElement("div");return i.id="tie-filter-tint-opacity",n.innerHTML="Opacity",t.appendChild(n),t.appendChild(i),e.appendChild(t),e.style.height="130px",new a.default(i,u.defaultFilterRangeValus.tintOpacityRange)}},{key:"_pickerWithSelectbox",value:function(e){var t=document.createElement("div"),n=document.createElement("select"),i=document.createElement("ul");return t.className="tui-image-editor-selectlist-wrap",i.className="tui-image-editor-selectlist",t.appendChild(n),t.appendChild(i),this._makeSelectOptionList(n),e.appendChild(t),e.style.height="130px",this._drawSelectOptionList(n,i),this._pickerWithSelectboxForAddEvent(n,i),n}},{key:"_drawSelectOptionList",value:function(e,t){var n=e.querySelectorAll("option");r.default.forEach(n,(function(e){var n=document.createElement("li");n.innerHTML=e.innerHTML,n.setAttribute("data-item",e.value),t.appendChild(n)}))}},{key:"_pickerWithSelectboxForAddEvent",value:function(e,t){var n=this;t.addEventListener("click",(function(i){var r=i.target.getAttribute("data-item"),o=document.createEvent("HTMLEvents");e.querySelector('[value="'+r+'"]').selected=!0,o.initEvent("change",!0,!0),e.dispatchEvent(o),n.selectBoxShow=!1,t.style.display="none"})),e.addEventListener("mousedown",(function(i){i.preventDefault(),n.selectBoxShow=!n.selectBoxShow,t.style.display=n.selectBoxShow?"block":"none",t.setAttribute("data-selectitem",e.value),t.querySelector("[data-item='"+e.value+"']").classList.add("active")}))}},{key:"_makeSelectOptionList",value:function(e){r.default.forEach(d,(function(t){var n=document.createElement("option");n.setAttribute("value",t),n.innerHTML=t.replace(/^[a-z]/,(function(e){return e.toUpperCase()})),e.appendChild(n)}))}}]),t}(s.default);t.default=g},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.locale;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li class="tui-image-editor-submenu-align">\n            <div class="tui-image-editor-checkbox-wrap fixed-width">\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-grayscale">\n                    <label for="tie-grayscale">'+t.localize("Grayscale")+'</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-invert">\n                    <label for="tie-invert">'+t.localize("Invert")+'</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-sepia">\n                    <label for="tie-sepia">'+t.localize("Sepia")+'</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-sepia2">\n                    <label for="tie-sepia2">'+t.localize("Sepia2")+'</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-blur">\n                    <label for="tie-blur">'+t.localize("Blur")+'</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-sharpen">\n                    <label for="tie-sharpen">'+t.localize("Sharpen")+'</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-emboss">\n                    <label for="tie-emboss">'+t.localize("Emboss")+'</label>\n                </div>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-submenu-align">\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled" style="margin-bottom: 7px;">\n                <div class="tui-image-editor-checkbox-wrap">\n                    <div class="tui-image-editor-checkbox">\n                        <input type="checkbox" id="tie-remove-white">\n                        <label for="tie-remove-white">'+t.localize("Remove White")+'</label>\n                    </div>\n                </div>\n                <div class="tui-image-editor-newline tui-image-editor-range-wrap short">\n                    <label>'+t.localize("Distance")+'</label>\n                    <div id="tie-removewhite-distance-range"></div>\n                </div>\n            </div>\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled">\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-brightness">\n                    <label for="tie-brightness">'+t.localize("Brightness")+'</label>\n                </div>\n                <div class="tui-image-editor-range-wrap short">\n                    <div id="tie-brightness-range"></div>\n                </div>\n            </div>\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled">\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-noise">\n                    <label for="tie-noise">'+t.localize("Noise")+'</label>\n                </div>\n                <div class="tui-image-editor-range-wrap short">\n                    <div id="tie-noise-range"></div>\n                </div>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-submenu-align">\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled">\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-pixelate">\n                    <label for="tie-pixelate">'+t.localize("Pixelate")+'</label>\n                </div>\n                <div class="tui-image-editor-range-wrap short">\n                    <div id="tie-pixelate-range"></div>\n                </div>\n            </div>\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled">\n                <div class="tui-image-editor-newline tui-image-editor-checkbox-wrap">\n                    <div class="tui-image-editor-checkbox">\n                        <input type="checkbox" id="tie-color-filter">\n                        <label for="tie-color-filter">'+t.localize("Color Filter")+'</label>\n                    </div>\n                </div>\n                <div class="tui-image-editor-newline tui-image-editor-range-wrap short">\n                    <label>'+t.localize("Threshold")+'</label>\n                    <div id="tie-colorfilter-threshole-range"></div>\n                </div>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div class="filter-color-item">\n                <div id="tie-filter-tint-color" title="'+t.localize("Tint")+'"></div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-tint">\n                    <label for="tie-tint"></label>\n                </div>\n            </div>\n            <div class="filter-color-item">\n                <div id="tie-filter-multiply-color" title="'+t.localize("Multiply")+'"></div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-multiply">\n                    <label for="tie-multiply"></label>\n                </div>\n            </div>\n            <div class="filter-color-item">\n                <div id="tie-filter-blend-color" title="'+t.localize("Blend")+'"></div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-blend">\n                    <label for="tie-blend"></label>\n                </div>\n            </div>\n        </li>\n    </ul>\n'}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._locale=t}return n(e,[{key:"localize",value:function(e){return this._locale[e]||e}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=a(n(72)),o=a(n(104));function a(e){return e&&e.__esModule?e:{default:e}}t.default={getActions:function(){return{main:this._mainAction(),shape:this._shapeAction(),crop:this._cropAction(),flip:this._flipAction(),rotate:this._rotateAction(),text:this._textAction(),mask:this._maskAction(),draw:this._drawAction(),icon:this._iconAction(),filter:this._filterAction()}},_mainAction:function(){var e=this,t=function(){"crop"===e.ui.submenu&&(e.stopDrawingMode(),e.ui.changeMenu("crop"))},n=function(t){var n;return n=t,"rotate"===e.ui.submenu&&e.ui.rotate.setRangeBarAngle("setAngle",n),t};return(0,i.extend)({initLoadImage:function(n,i){return e.loadImageFromURL(n,i).then((function(i){t(),e.ui.initializeImgUrl=n,e.ui.resizeEditor({imageSize:i}),e.clearUndoStack()}))},undo:function(){e.isEmptyUndoStack()||(t(),e.undo().then(n))},redo:function(){e.isEmptyRedoStack()||(t(),e.redo().then(n))},reset:function(){t(),e.loadImageFromURL(e.ui.initializeImgUrl,"resetImage").then((function(n){t(),e.ui.resizeEditor({imageSize:n}),e.clearUndoStack()}))},delete:function(){e.ui.changeDeleteButtonEnabled(!1),t(),e.removeActiveObject(),e.activeObjectId=null},deleteAll:function(){t(),e.clearObjects(),e.ui.changeDeleteButtonEnabled(!1),e.ui.changeDeleteAllButtonEnabled(!1)},load:function(n){r.default.isSupportFileApi()||alert("This browser does not support file-api"),e.ui.initializeImgUrl=URL.createObjectURL(n),e.loadImageFromFile(n).then((function(n){t(),e.clearUndoStack(),e.ui.activeMenuEvent(),e.ui.resizeEditor({imageSize:n})})).catch((function(e){return Promise.reject(e)}))},download:function(){var t=e.toDataURL(),n=e.getImageName(),i=void 0,o=void 0;r.default.isSupportFileApi()&&window.saveAs?(o=(i=r.default.base64ToBlob(t)).type.split("/")[1],n.split(".").pop()!==o&&(n+="."+o),saveAs(i,n)):window.open().document.body.innerHTML="<img src='"+t+"'>"}},this._commonAction())},_iconAction:function(){var e=this,t=void 0,n=void 0,r=void 0,a=void 0,s=void 0,l=void 0,c=void 0;this.on({iconCreateResize:function(t){var n=t.moveOriginPointer,i=(n.x-r)/s,o=(n.y-a)/l;e.setObjectPropertiesQuietly(c,{scaleX:Math.abs(2*i),scaleY:Math.abs(2*o)})},iconCreateEnd:function(){e.ui.icon.clearIconType(),e.changeSelectableAll(!0)}});var u=function(i,o){r=o.x,a=o.y,e.addIcon(t,{left:o.x,top:o.y,fill:n}).then((function(e){c=e.id,s=e.width,l=e.height}))};return(0,i.extend)({changeColor:function(t){e.activeObjectId&&e.changeIconColor(e.activeObjectId,t)},addIcon:function(i,r){t=i,n=r,e.changeCursor("crosshair"),e.off("mousedown"),e.once("mousedown",u.bind(e))},cancelAddIcon:function(){e.off("mousedown"),e.ui.icon.clearIconType(),e.changeSelectableAll(!0),e.changeCursor("default")},registDefalutIcons:function(t,n){var i={};i[t]=n,e.registerIcons(i)},registCustomIcon:function(t,n){(new o.default).imageToSVG(t,(function(t){var i=t.match(/path[^>]*d="([^"]*)"/)[1],r={};r[n.name]=i,e.registerIcons(r),e.addIcon(n.name,{left:100,top:100})}),o.default.tracerDefaultOption())}},this._commonAction())},_drawAction:function(){var e=this;return(0,i.extend)({setDrawMode:function(t,n){e.stopDrawingMode(),"free"===t?e.startDrawingMode("FREE_DRAWING",n):e.startDrawingMode("LINE_DRAWING",n)},setColor:function(t){e.setBrush({color:t})}},this._commonAction())},_maskAction:function(){var e=this;return(0,i.extend)({loadImageFromURL:function(t,n){return e.loadImageFromURL(e.toDataURL(),"FilterImage").then((function(){e.addImageObject(t).then((function(){URL.revokeObjectURL(n)}))}))},applyFilter:function(){e.applyFilter("mask",{maskObjId:e.activeObjectId})}},this._commonAction())},_textAction:function(){var e=this;return(0,i.extend)({changeTextStyle:function(t){e.activeObjectId&&e.changeTextStyle(e.activeObjectId,t)}},this._commonAction())},_rotateAction:function(){var e=this;return(0,i.extend)({rotate:function(t,n){e.rotate(t,n),e.ui.resizeEditor(),e.ui.rotate.setRangeBarAngle("rotate",t)},setAngle:function(t,n){e.setAngle(t,n),e.ui.resizeEditor(),e.ui.rotate.setRangeBarAngle("setAngle",t)}},this._commonAction())},_shapeAction:function(){var e=this;return(0,i.extend)({changeShape:function(t){e.activeObjectId&&e.changeShape(e.activeObjectId,t)},setDrawingShape:function(t){e.setDrawingShape(t)}},this._commonAction())},_cropAction:function(){var e=this;return(0,i.extend)({crop:function(){var t=e.getCropzoneRect();t&&e.crop(t).then((function(){e.stopDrawingMode(),e.ui.resizeEditor(),e.ui.changeMenu("crop")})).catch((function(e){return Promise.reject(e)}))},cancel:function(){e.stopDrawingMode(),e.ui.changeMenu("crop")},preset:function(t){switch(t){case"preset-square":e.setCropzoneRect(1);break;case"preset-3-2":e.setCropzoneRect(1.5);break;case"preset-4-3":e.setCropzoneRect(4/3);break;case"preset-5-4":e.setCropzoneRect(5/4);break;case"preset-7-5":e.setCropzoneRect(1.4);break;case"preset-16-9":e.setCropzoneRect(16/9);break;default:e.setCropzoneRect(),e.ui.crop.changeApplyButtonStatus(!1)}}},this._commonAction())},_flipAction:function(){var e=this;return(0,i.extend)({flip:function(t){return e[t]()}},this._commonAction())},_filterAction:function(){var e=this;return(0,i.extend)({applyFilter:function(t,n,i){t?e.applyFilter(n,i):e.hasFilter(n)&&e.removeFilter(n)}},this._commonAction())},setReAction:function(){var e=this;this.on({undoStackChanged:function(t){t?(e.ui.changeUndoButtonStatus(!0),e.ui.changeResetButtonStatus(!0)):(e.ui.changeUndoButtonStatus(!1),e.ui.changeResetButtonStatus(!1)),e.ui.resizeEditor()},redoStackChanged:function(t){t?e.ui.changeRedoButtonStatus(!0):e.ui.changeRedoButtonStatus(!1),e.ui.resizeEditor()},objectActivated:function(t){e.activeObjectId=t.id,e.ui.changeDeleteButtonEnabled(!0),e.ui.changeDeleteAllButtonEnabled(!0),"cropzone"===t.type?e.ui.crop.changeApplyButtonStatus(!0):["rect","circle","triangle"].indexOf(t.type)>-1?(e.stopDrawingMode(),"shape"!==e.ui.submenu&&e.ui.changeMenu("shape",!1,!1),e.ui.shape.setShapeStatus({strokeColor:t.stroke,strokeWidth:t.strokeWidth,fillColor:t.fill}),e.ui.shape.setMaxStrokeValue(Math.min(t.width,t.height))):"path"===t.type||"line"===t.type?"draw"!==e.ui.submenu&&(e.ui.changeMenu("draw",!1,!1),e.ui.draw.changeStandbyMode()):["i-text","text"].indexOf(t.type)>-1?"text"!==e.ui.submenu&&e.ui.changeMenu("text",!1,!1):"icon"===t.type&&(e.stopDrawingMode(),"icon"!==e.ui.submenu&&e.ui.changeMenu("icon",!1,!1),e.ui.icon.setIconPickerColor(t.fill))},addText:function(t){e.addText("Double Click",{position:t.originPosition,styles:{fill:e.ui.text.textColor,fontSize:r.default.toInteger(e.ui.text.fontSize),fontFamily:"Noto Sans"}}).then((function(){e.changeCursor("default")}))},addObjectAfter:function(t){["rect","circle","triangle"].indexOf(t.type)>-1&&(e.ui.shape.setMaxStrokeValue(Math.min(t.width,t.height)),e.ui.shape.changeStandbyMode())},objectScaled:function(t){if(["i-text","text"].indexOf(t.type)>-1)e.ui.text.fontSize=r.default.toInteger(t.fontSize);else if(["rect","circle","triangle"].indexOf(t.type)>=0){var n=t.width,i=t.height,o=e.ui.shape.getStrokeValue();n<o&&e.ui.shape.setStrokeValue(n),i<o&&e.ui.shape.setStrokeValue(i)}},selectionCleared:function(){e.activeObjectId=null,"text"===e.ui.submenu?e.changeCursor("text"):"draw"!==e.ui.submenu&&"crop"!==e.ui.submenu&&e.stopDrawingMode()}})},_commonAction:function(){var e=this;return{modeChange:function(t){switch(t){case"text":e._changeActivateMode("TEXT");break;case"crop":e.startDrawingMode("CROPPER");break;case"shape":e._changeActivateMode("SHAPE"),e.setDrawingShape(e.ui.shape.type,e.ui.shape.options)}},deactivateAll:this.deactivateAll.bind(this),changeSelectableAll:this.changeSelectableAll.bind(this),discardSelection:this.discardSelection.bind(this),stopDrawingMode:this.stopDrawingMode.bind(this)}},mixin:function(e){(0,i.extend)(e.prototype,this)}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.versionnumber="1.2.4",this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}]}return n(e,null,[{key:"tracerDefaultOption",value:function(){return{pathomit:100,ltres:.1,qtres:1,scale:1,strokewidth:5,viewbox:!1,linefilter:!0,desc:!1,rightangleenhance:!1,pal:[{r:0,g:0,b:0,a:255},{r:255,g:255,b:255,a:255}]}}}]),n(e,[{key:"imageToSVG",value:function(e,t,n){var i=this;n=this.checkoptions(n),this.loadImage(e,(function(e){t(i.imagedataToSVG(i.getImgdata(e),n))}),n)}},{key:"imagedataToSVG",value:function(e,t){t=this.checkoptions(t);var n=this.imagedataToTracedata(e,t);return this.getsvgstring(n,t)}},{key:"imageToTracedata",value:function(e,t,n){var i=this;n=this.checkoptions(n),this.loadImage(e,(function(e){t(i.imagedataToTracedata(i.getImgdata(e),n))}),n)}},{key:"imagedataToTracedata",value:function(e,t){t=this.checkoptions(t);var n=this.colorquantization(e,t),i=void 0;if(0===t.layering){i={layers:[],palette:n.palette,width:n.array[0].length-2,height:n.array.length-2};for(var r=0;r<n.palette.length;r+=1){var o=this.batchtracepaths(this.internodes(this.pathscan(this.layeringstep(n,r),t.pathomit),t),t.ltres,t.qtres);i.layers.push(o)}}else{var a=this.layering(n);t.layercontainerid&&this.drawLayers(a,this.specpalette,t.scale,t.layercontainerid);var s=this.batchpathscan(a,t.pathomit),l=this.batchinternodes(s,t);i={layers:this.batchtracelayers(l,t.ltres,t.qtres),palette:n.palette,width:e.width,height:e.height}}return i}},{key:"checkoptions",value:function(e){"string"==typeof(e=e||{})&&(e=e.toLowerCase(),e=this.optionpresets[e]?this.optionpresets[e]:{});for(var t=Object.keys(this.optionpresets.default),n=0;n<t.length;n+=1)e.hasOwnProperty(t[n])||(e[t[n]]=this.optionpresets.default[t[n]]);return e}},{key:"colorquantization",value:function(e,t){var n=[],i=0,r=void 0,o=void 0,a=void 0,s=[],l=e.width*e.height,c=void 0,u=void 0,h=void 0,d=void 0,f=void 0;for(u=0;u<e.height+2;u+=1)for(n[u]=[],c=0;c<e.width+2;c+=1)n[u][c]=-1;for(f=t.pal?t.pal:0===t.colorsampling?this.generatepalette(t.numberofcolors):1===t.colorsampling?this.samplepalette(t.numberofcolors,e):this.samplepalette2(t.numberofcolors,e),t.blurradius>0&&(e=this.blur(e,t.blurradius,t.blurdelta)),d=0;d<t.colorquantcycles;d+=1){if(d>0)for(h=0;h<f.length;h+=1)s[h].n>0&&(f[h]={r:Math.floor(s[h].r/s[h].n),g:Math.floor(s[h].g/s[h].n),b:Math.floor(s[h].b/s[h].n),a:Math.floor(s[h].a/s[h].n)}),s[h].n/l<t.mincolorratio&&d<t.colorquantcycles-1&&(f[h]={r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())});for(c=0;c<f.length;c+=1)s[c]={r:0,g:0,b:0,a:0,n:0};for(u=0;u<e.height;u+=1)for(c=0;c<e.width;c+=1){for(i=4*(u*e.width+c),a=0,o=1024,h=0;h<f.length;h+=1)(r=Math.abs(f[h].r-e.data[i])+Math.abs(f[h].g-e.data[i+1])+Math.abs(f[h].b-e.data[i+2])+Math.abs(f[h].a-e.data[i+3]))<o&&(o=r,a=h);s[a].r+=e.data[i],s[a].g+=e.data[i+1],s[a].b+=e.data[i+2],s[a].a+=e.data[i+3],s[a].n+=1,n[u+1][c+1]=a}}return{array:n,palette:f}}},{key:"samplepalette",value:function(e,t){for(var n=void 0,i=[],r=0;r<e;r+=1)n=4*Math.floor(Math.random()*t.data.length/4),i.push({r:t.data[n],g:t.data[n+1],b:t.data[n+2],a:t.data[n+3]});return i}},{key:"samplepalette2",value:function(e,t){for(var n=void 0,i=[],r=Math.ceil(Math.sqrt(e)),o=Math.ceil(e/r),a=t.width/(r+1),s=t.height/(o+1),l=0;l<o;l+=1)for(var c=0;c<r&&i.length!==e;c+=1)n=4*Math.floor((l+1)*s*t.width+(c+1)*a),i.push({r:t.data[n],g:t.data[n+1],b:t.data[n+2],a:t.data[n+3]});return i}},{key:"generatepalette",value:function(e){var t=[],n=void 0,i=void 0,r=void 0;if(e<8)for(var o=Math.floor(255/(e-1)),a=0;a<e;a+=1)t.push({r:a*o,g:a*o,b:a*o,a:255});else{var s=Math.floor(Math.pow(e,1/3)),l=Math.floor(255/(s-1)),c=e-s*s*s;for(n=0;n<s;n+=1)for(i=0;i<s;i+=1)for(r=0;r<s;r+=1)t.push({r:n*l,g:i*l,b:r*l,a:255});for(n=0;n<c;n+=1)t.push({r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())})}return t}},{key:"layering",value:function(e){var t=[],n=0,i=e.array.length,r=e.array[0].length,o=void 0,a=void 0,s=void 0,l=void 0,c=void 0,u=void 0,h=void 0,d=void 0,f=void 0,p=void 0,g=void 0;for(g=0;g<e.palette.length;g+=1)for(t[g]=[],p=0;p<i;p+=1)for(t[g][p]=[],f=0;f<r;f+=1)t[g][p][f]=0;for(p=1;p<i-1;p+=1)for(f=1;f<r-1;f+=1)n=e.array[p][f],o=e.array[p-1][f-1]===n?1:0,a=e.array[p-1][f]===n?1:0,s=e.array[p-1][f+1]===n?1:0,l=e.array[p][f-1]===n?1:0,c=e.array[p][f+1]===n?1:0,u=e.array[p+1][f-1]===n?1:0,h=e.array[p+1][f]===n?1:0,d=e.array[p+1][f+1]===n?1:0,t[n][p+1][f+1]=1+2*c+4*d+8*h,l||(t[n][p+1][f]=2+4*h+8*u),a||(t[n][p][f+1]=0+2*s+4*c+8),o||(t[n][p][f]=0+2*a+4+8*l);return t}},{key:"layeringstep",value:function(e,t){var n=[],i=e.array.length,r=e.array[0].length,o=void 0,a=void 0;for(a=0;a<i;a+=1)for(n[a]=[],o=0;o<r;o+=1)n[a][o]=0;for(a=1;a<i;a+=1)for(o=1;o<r;o+=1)n[a][o]=(e.array[a-1][o-1]===t?1:0)+(e.array[a-1][o]===t?2:0)+(e.array[a][o-1]===t?8:0)+(e.array[a][o]===t?4:0);return n}},{key:"pathscan",value:function(e,t){for(var n=[],i=0,r=0,o=0,a=0,s=e[0].length,l=e.length,c=0,u=!0,h=!1,d=void 0,f=0;f<l;f+=1)for(var p=0;p<s;p+=1)if(4===e[f][p]||11===e[f][p])for(o=p,a=f,n[i]={},n[i].points=[],n[i].boundingbox=[o,a,o,a],n[i].holechildren=[],u=!1,r=0,h=11===e[f][p],c=1;!u;){if(n[i].points[r]={},n[i].points[r].x=o-1,n[i].points[r].y=a-1,n[i].points[r].t=e[a][o],o-1<n[i].boundingbox[0]&&(n[i].boundingbox[0]=o-1),o-1>n[i].boundingbox[2]&&(n[i].boundingbox[2]=o-1),a-1<n[i].boundingbox[1]&&(n[i].boundingbox[1]=a-1),a-1>n[i].boundingbox[3]&&(n[i].boundingbox[3]=a-1),d=this.pathscan_combined_lookup[e[a][o]][c],e[a][o]=d[0],c=d[1],o+=d[2],a+=d[3],o-1===n[i].points[0].x&&a-1===n[i].points[0].y)if(u=!0,n[i].points.length<t)n.pop();else{if(n[i].isholepath=!!h,h){for(var g=0,v=[-1,-1,s+1,l+1],m=0;m<i;m++)!n[m].isholepath&&this.boundingboxincludes(n[m].boundingbox,n[i].boundingbox)&&this.boundingboxincludes(v,n[m].boundingbox)&&(g=m,v=n[m].boundingbox);n[g].holechildren.push(i)}i+=1}r+=1}return n}},{key:"boundingboxincludes",value:function(e,t){return e[0]<t[0]&&e[1]<t[1]&&e[2]>t[2]&&e[3]>t[3]}},{key:"batchpathscan",value:function(e,t){var n=[];for(var i in e)e.hasOwnProperty(i)&&(n[i]=this.pathscan(e[i],t));return n}},{key:"internodes",value:function(e,t){var n=[],i=0,r=0,o=0,a=0,s=0,l=void 0,c=void 0;for(l=0;l<e.length;l+=1)for(n[l]={},n[l].points=[],n[l].boundingbox=e[l].boundingbox,n[l].holechildren=e[l].holechildren,n[l].isholepath=e[l].isholepath,i=e[l].points.length,c=0;c<i;c+=1)r=(c+1)%i,o=(c+2)%i,a=(c-1+i)%i,s=(c-2+i)%i,t.rightangleenhance&&this.testrightangle(e[l],s,a,c,r,o)&&(n[l].points.length>0&&(n[l].points[n[l].points.length-1].linesegment=this.getdirection(n[l].points[n[l].points.length-1].x,n[l].points[n[l].points.length-1].y,e[l].points[c].x,e[l].points[c].y)),n[l].points.push({x:e[l].points[c].x,y:e[l].points[c].y,linesegment:this.getdirection(e[l].points[c].x,e[l].points[c].y,(e[l].points[c].x+e[l].points[r].x)/2,(e[l].points[c].y+e[l].points[r].y)/2)})),n[l].points.push({x:(e[l].points[c].x+e[l].points[r].x)/2,y:(e[l].points[c].y+e[l].points[r].y)/2,linesegment:this.getdirection((e[l].points[c].x+e[l].points[r].x)/2,(e[l].points[c].y+e[l].points[r].y)/2,(e[l].points[r].x+e[l].points[o].x)/2,(e[l].points[r].y+e[l].points[o].y)/2)});return n}},{key:"testrightangle",value:function(e,t,n,i,r,o){return e.points[i].x===e.points[t].x&&e.points[i].x===e.points[n].x&&e.points[i].y===e.points[r].y&&e.points[i].y===e.points[o].y||e.points[i].y===e.points[t].y&&e.points[i].y===e.points[n].y&&e.points[i].x===e.points[r].x&&e.points[i].x===e.points[o].x}},{key:"getdirection",value:function(e,t,n,i){return e<n?t<i?1:t>i?7:0:e>n?t<i?3:t>i?5:4:t<i?2:t>i?6:8}},{key:"batchinternodes",value:function(e,t){var n=[];for(var i in e)e.hasOwnProperty(i)&&(n[i]=this.internodes(e[i],t));return n}},{key:"tracepath",value:function(e,t,n){var i=0,r=void 0,o=void 0,a=void 0,s={segments:[]};for(s.boundingbox=e.boundingbox,s.holechildren=e.holechildren,s.isholepath=e.isholepath;i<e.points.length;){for(r=e.points[i].linesegment,o=-1,a=i+1;(e.points[a].linesegment===r||e.points[a].linesegment===o||-1===o)&&a<e.points.length-1;)e.points[a].linesegment!==r&&-1===o&&(o=e.points[a].linesegment),a+=1;a===e.points.length-1&&(a=0),s.segments=s.segments.concat(this.fitseq(e,t,n,i,a)),i=a>0?a:e.points.length}return s}},{key:"fitseq",value:function(e,t,n,i,r){if(r>e.points.length||r<0)return[];var o=i,a=0,s=!0,l=void 0,c=void 0,u=void 0,h=r-i;h<0&&(h+=e.points.length);for(var d=(e.points[r].x-e.points[i].x)/h,f=(e.points[r].y-e.points[i].y)/h,p=(i+1)%e.points.length,g=void 0;p!=r;)(g=p-i)<0&&(g+=e.points.length),l=e.points[i].x+d*g,c=e.points[i].y+f*g,(u=(e.points[p].x-l)*(e.points[p].x-l)+(e.points[p].y-c)*(e.points[p].y-c))>t&&(s=!1),u>a&&(o=p,a=u),p=(p+1)%e.points.length;if(s)return[{type:"L",x1:e.points[i].x,y1:e.points[i].y,x2:e.points[r].x,y2:e.points[r].y}];var v=o;s=!0,a=0;var m=(v-i)/h,b=(1-m)*(1-m),y=2*(1-m)*m,_=m*m,x=(b*e.points[i].x+_*e.points[r].x-e.points[v].x)/-y,w=(b*e.points[i].y+_*e.points[r].y-e.points[v].y)/-y;for(p=i+1;p!=r;)y=2*(1-(m=(p-i)/h))*m,_=m*m,l=(b=(1-m)*(1-m))*e.points[i].x+y*x+_*e.points[r].x,c=b*e.points[i].y+y*w+_*e.points[r].y,(u=(e.points[p].x-l)*(e.points[p].x-l)+(e.points[p].y-c)*(e.points[p].y-c))>n&&(s=!1),u>a&&(o=p,a=u),p=(p+1)%e.points.length;if(s)return[{type:"Q",x1:e.points[i].x,y1:e.points[i].y,x2:x,y2:w,x3:e.points[r].x,y3:e.points[r].y}];var C=v;return this.fitseq(e,t,n,i,C).concat(this.fitseq(e,t,n,C,r))}},{key:"batchtracepaths",value:function(e,t,n){var i=[];for(var r in e)e.hasOwnProperty(r)&&i.push(this.tracepath(e[r],t,n));return i}},{key:"batchtracelayers",value:function(e,t,n){var i=[];for(var r in e)e.hasOwnProperty(r)&&(i[r]=this.batchtracepaths(e[r],t,n));return i}},{key:"roundtodec",value:function(e,t){return Number(e.toFixed(t))}},{key:"svgpathstring",value:function(e,t,n,i){var r=e.layers[t],o=r[n],a="",s=void 0;if(i.linefilter&&o.segments.length<3)return a;if(a="<path "+(i.desc?'desc="l '+t+" p "+n+'" ':"")+this.tosvgcolorstr(e.palette[t],i)+'d="',-1===i.roundcoords){for(a+="M "+o.segments[0].x1*i.scale+" "+o.segments[0].y1*i.scale+" ",s=0;s<o.segments.length;s++)a+=o.segments[s].type+" "+o.segments[s].x2*i.scale+" "+o.segments[s].y2*i.scale+" ",o.segments[s].hasOwnProperty("x3")&&(a+=o.segments[s].x3*i.scale+" "+o.segments[s].y3*i.scale+" ");a+="Z "}else{for(a+="M "+this.roundtodec(o.segments[0].x1*i.scale,i.roundcoords)+" "+this.roundtodec(o.segments[0].y1*i.scale,i.roundcoords)+" ",s=0;s<o.segments.length;s++)a+=o.segments[s].type+" "+this.roundtodec(o.segments[s].x2*i.scale,i.roundcoords)+" "+this.roundtodec(o.segments[s].y2*i.scale,i.roundcoords)+" ",o.segments[s].hasOwnProperty("x3")&&(a+=this.roundtodec(o.segments[s].x3*i.scale,i.roundcoords)+" "+this.roundtodec(o.segments[s].y3*i.scale,i.roundcoords)+" ");a+="Z "}for(var l=0;l<o.holechildren.length;l++){var c=r[o.holechildren[l]];if(-1===i.roundcoords)for(c.segments[c.segments.length-1].hasOwnProperty("x3")?a+="M "+c.segments[c.segments.length-1].x3*i.scale+" "+c.segments[c.segments.length-1].y3*i.scale+" ":a+="M "+c.segments[c.segments.length-1].x2*i.scale+" "+c.segments[c.segments.length-1].y2*i.scale+" ",s=c.segments.length-1;s>=0;s--)a+=c.segments[s].type+" ",c.segments[s].hasOwnProperty("x3")&&(a+=c.segments[s].x2*i.scale+" "+c.segments[s].y2*i.scale+" "),a+=c.segments[s].x1*i.scale+" "+c.segments[s].y1*i.scale+" ";else for(c.segments[c.segments.length-1].hasOwnProperty("x3")?a+="M "+this.roundtodec(c.segments[c.segments.length-1].x3*i.scale)+" "+this.roundtodec(c.segments[c.segments.length-1].y3*i.scale)+" ":a+="M "+this.roundtodec(c.segments[c.segments.length-1].x2*i.scale)+" "+this.roundtodec(c.segments[c.segments.length-1].y2*i.scale)+" ",s=c.segments.length-1;s>=0;s--)a+=c.segments[s].type+" ",c.segments[s].hasOwnProperty("x3")&&(a+=this.roundtodec(c.segments[s].x2*i.scale)+" "+this.roundtodec(c.segments[s].y2*i.scale)+" "),a+=this.roundtodec(c.segments[s].x1*i.scale)+" "+this.roundtodec(c.segments[s].y1*i.scale)+" ";a+="Z "}if(a+='" />',i.lcpr||i.qcpr){for(s=0;s<o.segments.length;s++)o.segments[s].hasOwnProperty("x3")&&i.qcpr&&(a+='<circle cx="'+o.segments[s].x2*i.scale+'" cy="'+o.segments[s].y2*i.scale+'" r="'+i.qcpr+'" fill="cyan" stroke-width="'+.2*i.qcpr+'" stroke="black" />',a+='<circle cx="'+o.segments[s].x3*i.scale+'" cy="'+o.segments[s].y3*i.scale+'" r="'+i.qcpr+'" fill="white" stroke-width="'+.2*i.qcpr+'" stroke="black" />',a+='<line x1="'+o.segments[s].x1*i.scale+'" y1="'+o.segments[s].y1*i.scale+'" x2="'+o.segments[s].x2*i.scale+'" y2="'+o.segments[s].y2*i.scale+'" stroke-width="'+.2*i.qcpr+'" stroke="cyan" />',a+='<line x1="'+o.segments[s].x2*i.scale+'" y1="'+o.segments[s].y2*i.scale+'" x2="'+o.segments[s].x3*i.scale+'" y2="'+o.segments[s].y3*i.scale+'" stroke-width="'+.2*i.qcpr+'" stroke="cyan" />'),!o.segments[s].hasOwnProperty("x3")&&i.lcpr&&(a+='<circle cx="'+o.segments[s].x2*i.scale+'" cy="'+o.segments[s].y2*i.scale+'" r="'+i.lcpr+'" fill="white" stroke-width="'+.2*i.lcpr+'" stroke="black" />');for(l=0;l<o.holechildren.length;l++)for(c=r[o.holechildren[l]],s=0;s<c.segments.length;s++)c.segments[s].hasOwnProperty("x3")&&i.qcpr&&(a+='<circle cx="'+c.segments[s].x2*i.scale+'" cy="'+c.segments[s].y2*i.scale+'" r="'+i.qcpr+'" fill="cyan" stroke-width="'+.2*i.qcpr+'" stroke="black" />',a+='<circle cx="'+c.segments[s].x3*i.scale+'" cy="'+c.segments[s].y3*i.scale+'" r="'+i.qcpr+'" fill="white" stroke-width="'+.2*i.qcpr+'" stroke="black" />',a+='<line x1="'+c.segments[s].x1*i.scale+'" y1="'+c.segments[s].y1*i.scale+'" x2="'+c.segments[s].x2*i.scale+'" y2="'+c.segments[s].y2*i.scale+'" stroke-width="'+.2*i.qcpr+'" stroke="cyan" />',a+='<line x1="'+c.segments[s].x2*i.scale+'" y1="'+c.segments[s].y2*i.scale+'" x2="'+c.segments[s].x3*i.scale+'" y2="'+c.segments[s].y3*i.scale+'" stroke-width="'+.2*i.qcpr+'" stroke="cyan" />'),!c.segments[s].hasOwnProperty("x3")&&i.lcpr&&(a+='<circle cx="'+c.segments[s].x2*i.scale+'" cy="'+c.segments[s].y2*i.scale+'" r="'+i.lcpr+'" fill="white" stroke-width="'+.2*i.lcpr+'" stroke="black" />')}return a}},{key:"getsvgstring",value:function(e,t){t=this.checkoptions(t);for(var n=e.width*t.scale,i=e.height*t.scale,r="<svg "+(t.viewbox?'viewBox="0 0 '+n+" "+i+'" ':'width="'+n+'" height="'+i+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+this.versionnumber+'" >',o=0;o<e.layers.length;o+=1)for(var a=0;a<e.layers[o].length;a+=1)e.layers[o][a].isholepath||(r+=this.svgpathstring(e,o,a,t));return r+="</svg>"}},{key:"compareNumbers",value:function(e,t){return e-t}},{key:"torgbastr",value:function(e){return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"}},{key:"tosvgcolorstr",value:function(e,t){return'fill="rgb('+e.r+","+e.g+","+e.b+')" stroke="rgb('+e.r+","+e.g+","+e.b+')" stroke-width="'+t.strokewidth+'" opacity="'+e.a/255+'" '}},{key:"appendSVGString",value:function(e,t){var n=void 0;t?(n=document.getElementById(t))||((n=document.createElement("div")).id=t,document.body.appendChild(n)):(n=document.createElement("div"),document.body.appendChild(n)),n.innerHTML+=e}},{key:"blur",value:function(e,t,n){var i=void 0,r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,c=void 0,u=void 0,h=void 0,d={width:e.width,height:e.height,data:[]};if((t=Math.floor(t))<1)return e;t>5&&(t=5),(n=Math.abs(n))>1024&&(n=1024);var f=this.gks[t-1];for(r=0;r<e.height;r++)for(i=0;i<e.width;i++){for(s=0,l=0,c=0,u=0,h=0,o=-t;o<t+1;o++)i+o>0&&i+o<e.width&&(a=4*(r*e.width+i+o),s+=e.data[a]*f[o+t],l+=e.data[a+1]*f[o+t],c+=e.data[a+2]*f[o+t],u+=e.data[a+3]*f[o+t],h+=f[o+t]);a=4*(r*e.width+i),d.data[a]=Math.floor(s/h),d.data[a+1]=Math.floor(l/h),d.data[a+2]=Math.floor(c/h),d.data[a+3]=Math.floor(u/h)}var p=new Uint8ClampedArray(d.data);for(r=0;r<e.height;r++)for(i=0;i<e.width;i++){for(s=0,l=0,c=0,u=0,h=0,o=-t;o<t+1;o++)r+o>0&&r+o<e.height&&(s+=p[a=4*((r+o)*e.width+i)]*f[o+t],l+=p[a+1]*f[o+t],c+=p[a+2]*f[o+t],u+=p[a+3]*f[o+t],h+=f[o+t]);a=4*(r*e.width+i),d.data[a]=Math.floor(s/h),d.data[a+1]=Math.floor(l/h),d.data[a+2]=Math.floor(c/h),d.data[a+3]=Math.floor(u/h)}for(r=0;r<e.height;r++)for(i=0;i<e.width;i++)a=4*(r*e.width+i),Math.abs(d.data[a]-e.data[a])+Math.abs(d.data[a+1]-e.data[a+1])+Math.abs(d.data[a+2]-e.data[a+2])+Math.abs(d.data[a+3]-e.data[a+3])>n&&(d.data[a]=e.data[a],d.data[a+1]=e.data[a+1],d.data[a+2]=e.data[a+2],d.data[a+3]=e.data[a+3]);return d}},{key:"loadImage",value:function(e,t,n){var i=new Image;n&&n.corsenabled&&(i.crossOrigin="Anonymous"),i.src=e,i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height,e.getContext("2d").drawImage(i,0,0),t(e)}}},{key:"getImgdata",value:function(e){return e.getContext("2d").getImageData(0,0,e.width,e.height)}},{key:"drawLayers",value:function(e,t,n,i){n=n||1;var r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,c=void 0;for(l in i?(c=document.getElementById(i))||((c=document.createElement("div")).id=i,document.body.appendChild(c)):(c=document.createElement("div"),document.body.appendChild(c)),e)if(e.hasOwnProperty(l)){r=e[l][0].length,o=e[l].length;var u=document.createElement("canvas");u.width=r*n,u.height=o*n;var h=u.getContext("2d");for(s=0;s<o;s+=1)for(a=0;a<r;a+=1)h.fillStyle=this.torgbastr(t[e[l][s][a]%t.length]),h.fillRect(a*n,s*n,n,n);c.appendChild(u)}}}]),e}();t.default=i},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=S(n(3)),o=S(n(4)),a=S(n(106)),s=S(n(107)),l=S(n(109)),c=S(n(111)),u=S(n(112)),h=S(n(113)),d=S(n(114)),f=S(n(115)),p=S(n(116)),g=S(n(117)),v=S(n(123)),m=S(n(125)),b=S(n(127)),y=S(n(128)),_=S(n(129)),x=S(n(130)),w=S(n(73)),C=S(n(72));function S(e){return e&&e.__esModule?e:{default:e}}var k=w.default.componentNames,T=w.default.eventNames,E=w.default.drawingModes,M=w.default.fObjectOptions,O=r.default.extend,j=r.default.stamp,P=r.default.isArray,A=r.default.isString,D=r.default.forEachArray,L=r.default.forEachOwnProperties,I=r.default.CustomEvents,z=1e3,B=800,R={cssOnly:!0},F={backstoreOnly:!0},H=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.cssMaxWidth,r=n.cssMaxHeight,o=n.useItext,a=void 0!==o&&o,s=n.useDragAddIcon,l=void 0!==s&&s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasImage=null,this.cssMaxWidth=i||z,this.cssMaxHeight=r||B,this.useItext=a,this.useDragAddIcon=l,this.cropSelectionStyle={},this.imageName="",this._objects={},this._canvas=null,this._drawingMode=E.NORMAL,this._drawingModeMap={},this._componentMap={},this._handler={onMouseDown:this._onMouseDown.bind(this),onObjectAdded:this._onObjectAdded.bind(this),onObjectRemoved:this._onObjectRemoved.bind(this),onObjectMoved:this._onObjectMoved.bind(this),onObjectScaled:this._onObjectScaled.bind(this),onObjectSelected:this._onObjectSelected.bind(this),onPathCreated:this._onPathCreated.bind(this),onSelectionCleared:this._onSelectionCleared.bind(this),onSelectionCreated:this._onSelectionCreated.bind(this)},this._setObjectCachingToFalse(),this._setCanvasElement(t),this._createDrawingModeInstances(),this._createComponents(),this._attachCanvasEvents()}return i(e,[{key:"destroy",value:function(){var e=this._canvas.wrapperEl;this._canvas.clear(),e.parentNode.removeChild(e)}},{key:"deactivateAll",value:function(){return this._canvas.discardActiveObject(),this}},{key:"renderAll",value:function(){return this._canvas.renderAll(),this}},{key:"add",value:function(e){var t,n=[];P(e)?n=e:n.push(e),(t=this._canvas).add.apply(t,n)}},{key:"contains",value:function(e){return this._canvas.contains(e)}},{key:"getObjects",value:function(){return this._canvas.getObjects().slice()}},{key:"getObject",value:function(e){return this._objects[e]}},{key:"remove",value:function(e){this._canvas.remove(e)}},{key:"removeAll",value:function(e){var t=this._canvas,n=t.getObjects().slice();return t.remove.apply(t,this._canvas.getObjects()),e&&t.clear(),n}},{key:"removeObjectById",value:function(e){var t=[],n=this._canvas,i=this.getObject(e);return i&&i.isType("group")&&!i.isEmpty()?(n.discardActiveObject(),i.forEachObject((function(e){t.push(e),n.remove(e)}))):n.contains(i)&&(t.push(i),n.remove(i)),t}},{key:"getObjectId",value:function(e){var t=null;for(t in this._objects)if(this._objects.hasOwnProperty(t)&&e===this._objects[t])return t;return null}},{key:"getActiveObject",value:function(){return this._canvas._activeObject}},{key:"getActiveObjects",value:function(){var e=this._canvas._activeObject;return e&&"activeSelection"===e.type?e:null}},{key:"setActiveObject",value:function(e){this._canvas.setActiveObject(e)}},{key:"setCropSelectionStyle",value:function(e){this.cropSelectionStyle=e}},{key:"getComponent",value:function(e){return this._componentMap[e]}},{key:"getDrawingMode",value:function(){return this._drawingMode}},{key:"startDrawingMode",value:function(e,t){if(this._isSameDrawingMode(e))return!0;this.stopDrawingMode();var n=this._getDrawingModeInstance(e);return n&&n.start&&(n.start(this,t),this._drawingMode=e),!!n}},{key:"stopDrawingMode",value:function(){if(!this._isSameDrawingMode(E.NORMAL)){var e=this._getDrawingModeInstance(this.getDrawingMode());e&&e.end&&e.end(this),this._drawingMode=E.NORMAL}}},{key:"toDataURL",value:function(e){return this._canvas&&this._canvas.toDataURL(e)}},{key:"setCanvasImage",value:function(e,t){t&&j(t),this.imageName=e,this.canvasImage=t}},{key:"setCssMaxDimension",value:function(e){this.cssMaxWidth=e.width||this.cssMaxWidth,this.cssMaxHeight=e.height||this.cssMaxHeight}},{key:"adjustCanvasDimension",value:function(){var e=this.canvasImage.scale(1),t=e.getBoundingRect(),n=t.width,i=t.height,r=this._calcMaxDimension(n,i);this.setCanvasCssDimension({width:"100%",height:"100%","max-width":r.width+"px","max-height":r.height+"px"}),this.setCanvasBackstoreDimension({width:n,height:i}),this._canvas.centerObject(e)}},{key:"setCanvasCssDimension",value:function(e){this._canvas.setDimensions(e,R)}},{key:"setCanvasBackstoreDimension",value:function(e){this._canvas.setDimensions(e,F)}},{key:"setImageProperties",value:function(e,t){var n=this.canvasImage;n&&(n.set(e).setCoords(),t&&this._canvas.renderAll())}},{key:"getCanvasElement",value:function(){return this._canvas.getElement()}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getCanvasImage",value:function(){return this.canvasImage}},{key:"getImageName",value:function(){return this.imageName}},{key:"addImageObject",value:function(e){var t=this,n=this._callbackAfterLoadingImageObject.bind(this);return new o.default((function(i){a.default.Image.fromURL(e,(function(e){n(e),i(t.createObjectProperties(e))}),{crossOrigin:"Anonymous"})}))}},{key:"getCenter",value:function(){return this._canvas.getCenter()}},{key:"getCropzoneRect",value:function(){return this.getComponent(k.CROPPER).getCropzoneRect()}},{key:"setCropzoneRect",value:function(e){this.getComponent(k.CROPPER).setCropzoneRect(e)}},{key:"getCroppedImageData",value:function(e){return this.getComponent(k.CROPPER).getCroppedImageData(e)}},{key:"setBrush",value:function(e){var t=this._drawingMode,n=k.FREE_DRAWING;t===E.LINE&&(n=E.LINE),this.getComponent(n).setBrush(e)}},{key:"setDrawingShape",value:function(e,t){this.getComponent(k.SHAPE).setStates(e,t)}},{key:"registerPaths",value:function(e){this.getComponent(k.ICON).registerPaths(e)}},{key:"changeCursor",value:function(e){var t=this.getCanvas();t.defaultCursor=e,t.renderAll()}},{key:"hasFilter",value:function(e){return this.getComponent(k.FILTER).hasFilter(e)}},{key:"setSelectionStyle",value:function(e){O(M.SELECTION_STYLE,e)}},{key:"setObjectProperties",value:function(e,t){var n=this.getObject(e),i=O({},t);return n.set(i),n.setCoords(),this.getCanvas().renderAll(),i}},{key:"getObjectProperties",value:function(e,t){var n=this.getObject(e),i={};return A(t)?i[t]=n[t]:P(t)?D(t,(function(e){i[e]=n[e]})):L(t,(function(e,t){i[t]=n[t]})),i}},{key:"getObjectPosition",value:function(e,t,n){var i=this.getObject(e);return i?i.getPointByOrigin(t,n):null}},{key:"setObjectPosition",value:function(e,t){var n=this.getObject(e),i=t.x,r=t.y,o=t.originX,a=t.originY;if(!n)return!1;var s=n.getPointByOrigin(o,a),l=n.getPointByOrigin("center","center"),c=l.x-s.x,u=l.y-s.y;return n.set({left:i+c,top:r+u}),n.setCoords(),!0}},{key:"getCanvasSize",value:function(){var e=this.getCanvasImage();return{width:e?e.width:0,height:e?e.height:0}}},{key:"_getDrawingModeInstance",value:function(e){return this._drawingModeMap[e]}},{key:"_setObjectCachingToFalse",value:function(){a.default.Object.prototype.objectCaching=!1}},{key:"_setCanvasElement",value:function(e){var t=void 0,n=void 0;"CANVAS"!==(t=e.nodeType?e:document.querySelector(e)).nodeName.toUpperCase()&&(n=document.createElement("canvas"),t.appendChild(n)),this._canvas=new a.default.Canvas(n,{containerClass:"tui-image-editor-canvas-container",enableRetinaScaling:!1})}},{key:"_createDrawingModeInstances",value:function(){this._register(this._drawingModeMap,new m.default),this._register(this._drawingModeMap,new b.default),this._register(this._drawingModeMap,new y.default),this._register(this._drawingModeMap,new _.default),this._register(this._drawingModeMap,new x.default)}},{key:"_createComponents",value:function(){this._register(this._componentMap,new s.default(this)),this._register(this._componentMap,new l.default(this)),this._register(this._componentMap,new c.default(this)),this._register(this._componentMap,new u.default(this)),this._register(this._componentMap,new h.default(this)),this._register(this._componentMap,new d.default(this)),this._register(this._componentMap,new f.default(this)),this._register(this._componentMap,new p.default(this)),this._register(this._componentMap,new g.default(this)),this._register(this._componentMap,new v.default(this))}},{key:"_register",value:function(e,t){e[t.getName()]=t}},{key:"_isSameDrawingMode",value:function(e){return this.getDrawingMode()===e}},{key:"_calcMaxDimension",value:function(e,t){var n=this.cssMaxWidth/e,i=this.cssMaxHeight/t,r=Math.min(e,this.cssMaxWidth),o=Math.min(t,this.cssMaxHeight);return n<1&&n<i?(r=e*n,o=t*n):i<1&&i<n&&(r=e*i,o=t*i),{width:Math.floor(r),height:Math.floor(o)}}},{key:"_callbackAfterLoadingImageObject",value:function(e){var t=this.getCanvasImage().getCenterPoint();e.set(w.default.fObjectOptions.SELECTION_STYLE),e.set({left:t.x,top:t.y,crossOrigin:"Anonymous"}),this.getCanvas().add(e).setActiveObject(e)}},{key:"_attachCanvasEvents",value:function(){var e=this._canvas,t=this._handler;e.on({"mouse:down":t.onMouseDown,"object:added":t.onObjectAdded,"object:removed":t.onObjectRemoved,"object:moving":t.onObjectMoved,"object:scaling":t.onObjectScaled,"object:selected":t.onObjectSelected,"path:created":t.onPathCreated,"selection:cleared":t.onSelectionCleared,"selection:created":t.onSelectionCreated,"selection:updated":t.onObjectSelected})}},{key:"_onMouseDown",value:function(e){var t=this._canvas.getPointer(e.e);this.fire(T.MOUSE_DOWN,e.e,t)}},{key:"_onObjectAdded",value:function(e){var t=e.target;t.isType("cropzone")||this._addFabricObject(t)}},{key:"_onObjectRemoved",value:function(e){var t=e.target;this._removeFabricObject(j(t))}},{key:"_onObjectMoved",value:function(e){var t=e.target,n=this.createObjectProperties(t);this.fire(T.OBJECT_MOVED,n)}},{key:"_onObjectScaled",value:function(e){var t=e.target,n=this.createObjectProperties(t);this.fire(T.OBJECT_SCALED,n)}},{key:"_onObjectSelected",value:function(e){var t=e.target,n=this.createObjectProperties(t);this.fire(T.OBJECT_ACTIVATED,n)}},{key:"_onPathCreated",value:function(e){e.path.set(w.default.fObjectOptions.SELECTION_STYLE);var t=this.createObjectProperties(e.path);this.fire(T.ADD_OBJECT,t)}},{key:"_onSelectionCleared",value:function(){this.fire(T.SELECTION_CLEARED)}},{key:"_onSelectionCreated",value:function(e){this.fire(T.SELECTION_CREATED,e.target)}},{key:"discardSelection",value:function(){this._canvas.discardActiveObject(),this._canvas.renderAll()}},{key:"changeSelectableAll",value:function(e){this._canvas.forEachObject((function(t){t.selectable=e,t.hoverCursor=e?"move":"crosshair"}))}},{key:"createObjectProperties",value:function(e){var t={id:j(e),type:e.type};return O(t,C.default.getProperties(e,["left","top","width","height","fill","stroke","strokeWidth","opacity"])),["i-text","text"].indexOf(e.type)>-1&&O(t,this._createTextProperties(e,t)),t}},{key:"_createTextProperties",value:function(e){var t={};return O(t,C.default.getProperties(e,["text","fontFamily","fontSize","fontStyle","textAlign","textDecoration"])),t}},{key:"_addFabricObject",value:function(e){var t=j(e);return this._objects[t]=e,t}},{key:"_removeFabricObject",value:function(e){delete this._objects[e]}}]),e}();I.mixin(H),e.exports=H},function(e,t){e.exports=n},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(n(4)),o=s(n(108)),a=s(n(73));function s(e){return e&&e.__esModule?e:{default:e}}var l=a.default.componentNames,c=a.default.rejectMessages,u={padding:0,crossOrigin:"Anonymous"},h=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l.IMAGE_LOADER,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"load",value:function(e,t){var n=this,i=void 0;if(e||t)i=this._setBackgroundImage(t).then((function(t){return n.setCanvasImage(e,t),n.adjustCanvasDimension(),t}));else{var o=this.getCanvas();o.backgroundImage=null,o.renderAll(),i=new r.default((function(e){n.setCanvasImage("",null),e()}))}return i}},{key:"_setBackgroundImage",value:function(e){var t=this;return e?new r.default((function(n,i){var r=t.getCanvas();r.setBackgroundImage(e,(function(){var e=r.backgroundImage;e&&e.getElement()?n(e):i(c.loadingImageFailed)}),u)})):r.default.reject(c.loadImage)}}]),t}(o.default);e.exports=h},function(e,t){"use strict";var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.graphics=n}return n(e,[{key:"fire",value:function(){for(var e=this.graphics,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.graphics.fire.apply(e,n)}},{key:"setCanvasImage",value:function(e,t){this.graphics.setCanvasImage(e,t)}},{key:"getCanvasElement",value:function(){return this.graphics.getCanvasElement()}},{key:"getCanvas",value:function(){return this.graphics.getCanvas()}},{key:"getCanvasImage",value:function(){return this.graphics.getCanvasImage()}},{key:"getImageName",value:function(){return this.graphics.getImageName()}},{key:"getEditor",value:function(){return this.graphics.getEditor()}},{key:"getName",value:function(){return this.name}},{key:"setImageProperties",value:function(e,t){this.graphics.setImageProperties(e,t)}},{key:"setCanvasCssDimension",value:function(e){this.graphics.setCanvasCssDimension(e)}},{key:"setCanvasBackstoreDimension",value:function(e){this.graphics.setCanvasBackstoreDimension(e)}},{key:"adjustCanvasDimension",value:function(){this.graphics.adjustCanvasDimension()}}]),e}();e.exports=i},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=u(n(3)),o=u(n(106)),a=u(n(108)),s=u(n(110)),l=n(73),c=n(72);function u(e){return e&&e.__esModule?e:{default:e}}var h={top:-10,left:-10,height:1,width:1},d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l.componentNames.CROPPER,e));return n._cropzone=null,n._startX=null,n._startY=null,n._withShiftKey=!1,n._listeners={keydown:n._onKeyDown.bind(n),keyup:n._onKeyUp.bind(n),mousedown:n._onFabricMouseDown.bind(n),mousemove:n._onFabricMouseMove.bind(n),mouseup:n._onFabricMouseUp.bind(n)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(){if(!this._cropzone){var e=this.getCanvas();e.forEachObject((function(e){e.evented=!1})),this._cropzone=new s.default(e,{left:0,top:0,width:.5,height:.5,strokeWidth:0,cornerSize:10,cornerColor:"black",fill:"transparent",hasRotatingPoint:!1,hasBorders:!1,lockScalingFlip:!0,lockRotation:!0},this.graphics.cropSelectionStyle),e.discardActiveObject(),e.add(this._cropzone),e.on("mouse:down",this._listeners.mousedown),e.selection=!1,e.defaultCursor="crosshair",o.default.util.addListener(document,"keydown",this._listeners.keydown),o.default.util.addListener(document,"keyup",this._listeners.keyup)}}},{key:"end",value:function(){var e=this.getCanvas(),t=this._cropzone;t&&(e.remove(t),e.selection=!0,e.defaultCursor="default",e.off("mouse:down",this._listeners.mousedown),e.forEachObject((function(e){e.evented=!0})),this._cropzone=null,o.default.util.removeListener(document,"keydown",this._listeners.keydown),o.default.util.removeListener(document,"keyup",this._listeners.keyup))}},{key:"_onFabricMouseDown",value:function(e){var t=this.getCanvas();if(!e.target){t.selection=!1;var n=t.getPointer(e.e);this._startX=n.x,this._startY=n.y,t.on({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup})}}},{key:"_onFabricMouseMove",value:function(e){var t=this.getCanvas(),n=t.getPointer(e.e),i=n.x,r=n.y,o=this._cropzone;Math.abs(i-this._startX)+Math.abs(r-this._startY)>10&&(t.remove(o),o.set(this._calcRectDimensionFromPoint(i,r)),t.add(o),t.setActiveObject(o))}},{key:"_calcRectDimensionFromPoint",value:function(e,t){var n=this.getCanvas(),i=n.getWidth(),r=n.getHeight(),o=this._startX,a=this._startY,s=(0,c.clamp)(e,0,o),l=(0,c.clamp)(t,0,a),u=(0,c.clamp)(e,o,i)-s,h=(0,c.clamp)(t,a,r)-l;return this._withShiftKey&&(u>h?h=u:h>u&&(u=h),o>=e&&(s=o-u),a>=t&&(l=a-h)),{left:s,top:l,width:u,height:h}}},{key:"_onFabricMouseUp",value:function(){var e=this._cropzone,t=this._listeners,n=this.getCanvas();n.setActiveObject(e),n.off({"mouse:move":t.mousemove,"mouse:up":t.mouseup})}},{key:"getCroppedImageData",value:function(e){var t=this.getCanvas(),n=t.contains(this._cropzone);if(!e)return null;n&&t.remove(this._cropzone);var i={imageName:this.getImageName(),url:t.toDataURL(e)};return n&&t.add(this._cropzone),i}},{key:"getCropzoneRect",value:function(){var e=this._cropzone;return e.isValid()?{left:e.left,top:e.top,width:e.width,height:e.height}:null}},{key:"setCropzoneRect",value:function(e){var t=this.getCanvas(),n=this._cropzone;t.discardActiveObject(),t.selection=!1,t.remove(n),n.set(e?this._getPresetCropSizePosition(e):h),t.add(n),t.selection=!0,e&&t.setActiveObject(n)}},{key:"_getPresetCropSizePosition",value:function(e){var t=this.getCanvas(),n=t.getWidth(),i=t.getHeight(),o=n>=i?n:i,a=function(e,t){return e>t?t/e:1},s=o*e,l=o,c=a(s,n),u=r.default.map([s,l],(function(e){return e*c}));s=u[0];var h=a(l=u[1],i),d=r.default.map([s,l],(function(e){return e*h}));return s=d[0],{top:(i-(l=d[1]))/2,left:(n-s)/2,width:s,height:l}}},{key:"_onKeyDown",value:function(e){e.keyCode===l.keyCodes.SHIFT&&(this._withShiftKey=!0)}},{key:"_onKeyUp",value:function(e){e.keyCode===l.keyCodes.SHIFT&&(this._withShiftKey=!1)}}]),t}(a.default);e.exports=d},function(e,t,n){"use strict";var i=a(n(3)),r=a(n(106)),o=n(72);function a(e){return e&&e.__esModule?e:{default:e}}var s=r.default.util.createClass(r.default.Rect,{initialize:function(e,t,n){(t=i.default.extend(t,n)).type="cropzone",this.callSuper("initialize",t),this.canvas=e,this.options=t,this.on({moving:this._onMoving.bind(this),scaling:this._onScaling.bind(this)})},_renderCropzone:function(){var e=this.flipX?-1:1,t=this.flipY?-1:1,n=e/this.scaleX,i=t/this.scaleY,r=this.canvas.getContext();r.scale(n,i),this._fillOuterRect(r,"rgba(0, 0, 0, 0.5)"),this.options.lineWidth?(this._fillInnerRect(r),this._strokeBorder(r,"rgb(255, 255, 255)",{lineWidth:this.options.lineWidth})):(this._strokeBorder(r,"rgb(0, 0, 0)",{lineDashWidth:7}),this._strokeBorder(r,"rgb(255, 255, 255)",{lineDashWidth:7,lineDashOffset:7})),r.scale(1/n,1/i)},_render:function(){var e=this.canvas.getContext();this.callSuper("_render",e),this._renderCropzone()},_fillOuterRect:function(e,t){var n=this._getCoordinates(),i=n.x,r=n.y;e.save(),e.fillStyle=t,e.beginPath(),e.moveTo(i[0]-1,r[0]-1),e.lineTo(i[3]+1,r[0]-1),e.lineTo(i[3]+1,r[3]+1),e.lineTo(i[0]-1,r[3]+1),e.lineTo(i[0]-1,r[0]-1),e.closePath(),e.moveTo(i[1],r[1]),e.lineTo(i[1],r[2]),e.lineTo(i[2],r[2]),e.lineTo(i[2],r[1]),e.lineTo(i[1],r[1]),e.closePath(),e.fill(),e.restore()},_fillInnerRect:function(e){var t=this._getCoordinates(),n=t.x,i=t.y,r=this._caculateInnerPosition(n,(n[2]-n[1])/3),o=this._caculateInnerPosition(i,(i[2]-i[1])/3);e.save(),e.strokeStyle="rgba(255, 255, 255, 0.7)",e.lineWidth=this.options.lineWidth,e.beginPath(),e.moveTo(r[0],o[1]),e.lineTo(r[3],o[1]),e.moveTo(r[0],o[2]),e.lineTo(r[3],o[2]),e.moveTo(r[1],o[0]),e.lineTo(r[1],o[3]),e.moveTo(r[2],o[0]),e.lineTo(r[2],o[3]),e.stroke(),e.closePath(),e.restore()},_caculateInnerPosition:function(e,t){var n=[];return n[0]=e[1],n[1]=e[1]+t,n[2]=e[1]+2*t,n[3]=e[2],n},_getCoordinates:function(){var e=this.canvas,t=this.width,n=this.height,r=this.left,o=this.top,a=t/2,s=n/2,l=e.getHeight(),c=e.getWidth();return{x:i.default.map([-(a+r),-a,a,a+(c-r-t)],Math.ceil),y:i.default.map([-(s+o),-s,s,s+(l-o-n)],Math.ceil)}},_strokeBorder:function(e,t,n){var i=n.lineDashWidth,r=n.lineDashOffset,o=n.lineWidth,a=this.width/2,s=this.height/2;e.save(),e.strokeStyle=t,e.setLineDash&&e.setLineDash([i,i]),r&&(e.lineDashOffset=r),o&&(e.lineWidth=o),e.beginPath(),e.moveTo(-a,-s),e.lineTo(a,-s),e.lineTo(a,s),e.lineTo(-a,s),e.lineTo(-a,-s),e.stroke(),e.restore()},_onMoving:function(){var e=this.height,t=this.width,n=this.left,i=this.top,r=this.canvas.getWidth()-t,a=this.canvas.getHeight()-e;this.left=(0,o.clamp)(n,0,r),this.top=(0,o.clamp)(i,0,a)},_onScaling:function(e){var t=this.canvas.getPointer(e.e),n=this._calcScalingSizeFromPointer(t);this.scale(1).set(n)},_calcScalingSizeFromPointer:function(e){var t=e.x,n=e.y,i=this._calcTopLeftScalingSizeFromPointer(t,n),r=this._calcBottomRightScalingSizeFromPointer(t,n);return this._makeScalingSettings(i,r)},_calcTopLeftScalingSizeFromPointer:function(e,t){var n=this.getBoundingRect(!1,!0),i=n.height+this.top,r=n.width+this.left,a=(0,o.clamp)(t,0,i-1),s=(0,o.clamp)(e,0,r-1);return{top:a,left:s,width:r-s,height:i-a}},_calcBottomRightScalingSizeFromPointer:function(e,t){var n=this.canvas,i=n.width,r=n.height,a=this.left,s=this.top;return{width:(0,o.clamp)(e,a+1,i)-a,height:(0,o.clamp)(t,s+1,r)-s}},_makeScalingSettings:function(e,t){var n=e.width,i=e.height,r=t.height,o=t.width,a=e.left,s=e.top,l=void 0;switch(this.__corner){case"tl":l=e;break;case"tr":l={width:o,height:i,top:s};break;case"bl":l={width:n,height:r,left:a};break;case"br":l=t;break;case"ml":l={width:n,left:a};break;case"mt":l={height:i,top:s};break;case"mr":l={width:o};break;case"mb":l={height:r}}return l},isValid:function(){return this.left>=0&&this.top>=0&&this.width>0&&this.height>0}});e.exports=s},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=l(n(3)),o=l(n(4)),a=l(n(108)),s=l(n(73));function l(e){return e&&e.__esModule?e:{default:e}}var c=s.default.componentNames,u=s.default.rejectMessages,h=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,c.FLIP,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"getCurrentSetting",value:function(){var e=this.getCanvasImage();return{flipX:e.flipX,flipY:e.flipY}}},{key:"set",value:function(e){var t=this.getCurrentSetting(),n=t.flipX!==e.flipX,i=t.flipY!==e.flipY;return n||i?(r.default.extend(t,e),this.setImageProperties(t,!0),this._invertAngle(n,i),this._flipObjects(n,i),o.default.resolve({flipX:t.flipX,flipY:t.flipY,angle:this.getCanvasImage().angle})):o.default.reject(u.flip)}},{key:"_invertAngle",value:function(e,t){var n=this.getCanvasImage(),i=n.angle;e&&(i*=-1),t&&(i*=-1),n.rotate(parseFloat(i)).setCoords()}},{key:"_flipObjects",value:function(e,t){var n=this.getCanvas();e&&n.forEachObject((function(e){e.set({angle:parseFloat(-1*e.angle),flipX:!e.flipX,left:n.width-e.left}).setCoords()})),t&&n.forEachObject((function(e){e.set({angle:parseFloat(-1*e.angle),flipY:!e.flipY,top:n.height-e.top}).setCoords()})),n.renderAll()}},{key:"reset",value:function(){return this.set({flipX:!1,flipY:!1})}},{key:"flipX",value:function(){var e=this.getCurrentSetting();return this.set({flipX:!e.flipX,flipY:e.flipY})}},{key:"flipY",value:function(){var e=this.getCurrentSetting();return this.set({flipX:e.flipX,flipY:!e.flipY})}}]),t}(a.default);e.exports=h},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(n(106)),o=s(n(4)),a=s(n(108));function s(e){return e&&e.__esModule?e:{default:e}}var l=s(n(73)).default.componentNames,c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l.ROTATION,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"getCurrentAngle",value:function(){return this.getCanvasImage().angle}},{key:"setAngle",value:function(e){var t=this.getCurrentAngle()%360;e%=360;var n=this.getCanvasImage(),i=n.getCenterPoint();n.set({angle:e}).setCoords(),this.adjustCanvasDimension();var r=n.getCenterPoint();return this._rotateForEachObject(i,r,e-t),o.default.resolve(e)}},{key:"_rotateForEachObject",value:function(e,t,n){var i=this.getCanvas(),o=e.x-t.x,a=e.y-t.y;i.forEachObject((function(t){var i=t.getCenterPoint(),s=r.default.util.degreesToRadians(n),l=r.default.util.rotatePoint(i,e,s);t.set({left:l.x-o,top:l.y-a,angle:(t.angle+n)%360}),t.setCoords()})),i.renderAll()}},{key:"rotate",value:function(e){var t=this.getCurrentAngle();return this.setAngle(t+e)}}]),t}(a.default);e.exports=c},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(n(106)),o=s(n(108)),a=s(n(73));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.default.componentNames.FREE_DRAWING,e));return n.width=12,n.oColor=new r.default.Color("rgba(0, 0, 0, 0.5)"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(e){this.getCanvas().isDrawingMode=!0,this.setBrush(e)}},{key:"setBrush",value:function(e){var t=this.getCanvas().freeDrawingBrush;e=e||{},this.width=e.width||this.width,e.color&&(this.oColor=new r.default.Color(e.color)),t.width=this.width,t.color=this.oColor.toRgba()}},{key:"end",value:function(){this.getCanvas().isDrawingMode=!1}}]),t}(o.default);e.exports=l},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(n(106)),o=s(n(108)),a=s(n(73));function s(e){return e&&e.__esModule?e:{default:e}}var l=a.default.eventNames,c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.default.componentNames.LINE,e));return n._width=12,n._oColor=new r.default.Color("rgba(0, 0, 0, 0.5)"),n._listeners={mousedown:n._onFabricMouseDown.bind(n),mousemove:n._onFabricMouseMove.bind(n),mouseup:n._onFabricMouseUp.bind(n)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(e){var t=this.getCanvas();t.defaultCursor="crosshair",t.selection=!1,this.setBrush(e),t.forEachObject((function(e){e.set({evented:!1})})),t.on({"mouse:down":this._listeners.mousedown})}},{key:"setBrush",value:function(e){var t=this.getCanvas().freeDrawingBrush;e=e||{},this._width=e.width||this._width,e.color&&(this._oColor=new r.default.Color(e.color)),t.width=this._width,t.color=this._oColor.toRgba()}},{key:"end",value:function(){var e=this.getCanvas();e.defaultCursor="default",e.selection=!0,e.forEachObject((function(e){e.set({evented:!0})})),e.off("mouse:down",this._listeners.mousedown)}},{key:"_onFabricMouseDown",value:function(e){var t=this.getCanvas(),n=t.getPointer(e.e),i=[n.x,n.y,n.x,n.y];this._line=new r.default.Line(i,{stroke:this._oColor.toRgba(),strokeWidth:this._width,evented:!1}),this._line.set(a.default.fObjectOptions.SELECTION_STYLE),t.add(this._line),t.on({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup})}},{key:"_onFabricMouseMove",value:function(e){var t=this.getCanvas(),n=t.getPointer(e.e);this._line.set({x2:n.x,y2:n.y}),this._line.setCoords(),t.renderAll()}},{key:"_onFabricMouseUp",value:function(){var e=this.getCanvas(),t=this.graphics.createObjectProperties(this._line);this.fire(l.ADD_OBJECT,t),this._line=null,e.off({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup})}}]),t}(o.default);e.exports=c},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=u(n(106)),o=u(n(3)),a=u(n(4)),s=u(n(108)),l=u(n(73)),c=u(n(72));function u(e){return e&&e.__esModule?e:{default:e}}var h=l.default.eventNames,d={fill:"#000000",left:0,top:0},f={fill:"#000000",fontStyle:"normal",fontWeight:"normal",textAlign:"left",textDecoraiton:""},p=o.default.browser,g=c.default.makeStyleText({position:"absolute",padding:0,display:"none",border:"1px dotted red",overflow:"hidden",resize:"none",outline:"none","border-radius":0,"background-color":"transparent","-webkit-appearance":"none","z-index":9999,"white-space":"pre"}),v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l.default.componentNames.TEXT,e));return n._defaultStyles=d,n._isSelected=!1,n._selectedObj={},n._editingObj={},n._listeners={mousedown:n._onFabricMouseDown.bind(n),select:n._onFabricSelect.bind(n),selectClear:n._onFabricSelectClear.bind(n),scaling:n._onFabricScaling.bind(n)},n._textarea=null,n._ratio=1,n._lastClickTime=(new Date).getTime(),n._editingObjInfos={},n.isPrevEditing=!1,n.useItext=e.useItext,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(){var e=this.getCanvas();e.selection=!1,e.defaultCursor="text",e.on({"mouse:down":this._listeners.mousedown,"object:selected":this._listeners.select,"before:selection:cleared":this._listeners.selectClear,"object:scaling":this._listeners.scaling,"text:editing":this._listeners.modify}),this.useItext?e.forEachObject((function(e){"i-text"===e.type&&e.set({left:e.left-e.width/2,top:e.top-e.height/2,originX:"left",originY:"top"})})):this._createTextarea(),this.setCanvasRatio()}},{key:"end",value:function(){var e=this.getCanvas();e.selection=!0,e.defaultCursor="default",this.useItext?e.forEachObject((function(t){"i-text"===t.type&&(""===t.text?e.remove(t):t.set({left:t.left+t.width/2,top:t.top+t.height/2,originX:"center",originY:"center"}))})):(e.discardActiveObject(),this._removeTextarea()),e.off({"mouse:down":this._listeners.mousedown,"object:selected":this._listeners.select,"before:selection:cleared":this._listeners.selectClear,"object:scaling":this._listeners.scaling,"text:editing":this._listeners.modify})}},{key:"add",value:function(e,t){var n=this;return new a.default((function(i){var a=n.getCanvas(),s=null,c=l.default.fObjectOptions.SELECTION_STYLE,u=n._defaultStyles;n._setInitPos(t.position),t.styles&&(u=o.default.extend(u,t.styles)),n.useItext?(s=new r.default.IText(e,u),c=o.default.extend({},c,{originX:"left",originY:"top"})):s=new r.default.Text(e,u),s.set(c),s.on({mouseup:n._onFabricMouseUp.bind(n)}),a.add(s),a.getActiveObject()||a.setActiveObject(s),n.isPrevEditing=!0,i(n.graphics.createObjectProperties(s))}))}},{key:"change",value:function(e,t){var n=this;return new a.default((function(i){e.set("text",t),n.getCanvas().renderAll(),i()}))}},{key:"setStyle",value:function(e,t){var n=this;return new a.default((function(i){o.default.forEach(t,(function(n,i){e[i]===n&&(t[i]=f[i]||"")}),n),e.set(t),n.getCanvas().renderAll(),i()}))}},{key:"getText",value:function(e){return e.text}},{key:"setSelectedInfo",value:function(e,t){this._selectedObj=e,this._isSelected=t}},{key:"isSelected",value:function(){return this._isSelected}},{key:"getSelectedObj",value:function(){return this._selectedObj}},{key:"setCanvasRatio",value:function(){var e=this.getCanvasElement(),t=parseInt(e.style.maxWidth,10),n=e.width/t;this._ratio=n}},{key:"getCanvasRatio",value:function(){return this._ratio}},{key:"_setInitPos",value:function(e){e=e||this.getCanvasImage().getCenterPoint(),this._defaultStyles.left=e.x,this._defaultStyles.top=e.y}},{key:"_createTextarea",value:function(){var e=this.getCanvasElement().parentNode,t=document.createElement("textarea");t.className="tui-image-eidtor-textarea",t.setAttribute("style",g),t.setAttribute("wrap","off"),e.appendChild(t),this._textarea=t,this._listeners=o.default.extend(this._listeners,{input:this._onInput.bind(this),keydown:this._onKeyDown.bind(this),blur:this._onBlur.bind(this),scroll:this._onScroll.bind(this)}),p.msie&&9===p.version?r.default.util.addListener(t,"keydown",this._listeners.keydown):r.default.util.addListener(t,"input",this._listeners.input),r.default.util.addListener(t,"blur",this._listeners.blur),r.default.util.addListener(t,"scroll",this._listeners.scroll)}},{key:"_removeTextarea",value:function(){var e=this.getCanvasElement().parentNode,t=e.querySelector("textarea");e.removeChild(t),this._textarea=null,p.msie&&p.version<10?r.default.util.removeListener(t,"keydown",this._listeners.keydown):r.default.util.removeListener(t,"input",this._listeners.input),r.default.util.removeListener(t,"blur",this._listeners.blur),r.default.util.removeListener(t,"scroll",this._listeners.scroll)}},{key:"_onInput",value:function(){var e=this.getCanvasRatio(),t=this._editingObj,n=this._textarea.style;n.width=Math.ceil(t.width/e)+"px",n.height=Math.ceil(t.height/e)+"px"}},{key:"_onKeyDown",value:function(){var e=this,t=this.getCanvasRatio(),n=this._editingObj,i=this._textarea.style;setTimeout((function(){n.text(e._textarea.value),i.width=Math.ceil(n.width/t)+"px",i.height=Math.ceil(n.height/t)+"px"}),0)}},{key:"_onBlur",value:function(){var e=this.getCanvasRatio(),t=this._editingObj,n=this._editingObjInfos,i=this._textarea.value,r=t.width/e-n.width/e,a=t.height/e-n.height/e;if(1===e&&(r/=2,a/=2),this._textarea.style.display="none",t.set({left:n.left+r,top:n.top+a}),i.length){this.getCanvas().add(t);var s={id:o.default.stamp(t),type:t.type,text:i};this.fire(h.TEXT_CHANGED,s)}}},{key:"_onScroll",value:function(){this._textarea.scrollLeft=0,this._textarea.scrollTop=0}},{key:"_onFabricScaling",value:function(e){var t=e.target,n=t.fontSize*t.scaleY;t.fontSize=n,t.scaleX=1,t.scaleY=1}},{key:"_onFabricSelectClear",value:function(e){var t=this.getSelectedObj();this.isPrevEditing=!0,this.setSelectedInfo(e.target,!1),t&&""===t.text&&this.getCanvas().remove(t)}},{key:"_onFabricSelect",value:function(e){this.isPrevEditing=!0,this.setSelectedInfo(e.target,!0)}},{key:"_onFabricMouseDown",value:function(e){var t=e.target;t&&!t.isType("text")||(this.isPrevEditing?this.isPrevEditing=!1:this._fireAddText(e))}},{key:"_fireAddText",value:function(e){var t=e.target,n=e.e||{},i=this.getCanvas().getPointer(n);t||this.fire(h.ADD_TEXT,{originPosition:{x:i.x,y:i.y},clientPosition:{x:n.clientX||0,y:n.clientY||0}})}},{key:"_onFabricMouseUp",value:function(e){var t=e.target,n=(new Date).getTime();(t.isEditing||this._isDoubleClick(n))&&(this.useItext||this._changeToEditingMode(t),this.fire(h.TEXT_EDITING)),this._lastClickTime=n}},{key:"_isDoubleClick",value:function(e){return e-this._lastClickTime<500}},{key:"_changeToEditingMode",value:function(e){var t=this.getCanvasRatio(),n=this._textarea.style,i=this.getCanvas();this.isPrevEditing=!0,i.remove(e),i.discardActiveObject(),this._editingObj=e,this._textarea.value=e.text,this._editingObjInfos={left:e.left,top:e.top,width:e.width,height:e.height},n.display="block",n.left=e.oCoords.tl.x/t+"px",n.top=e.oCoords.tl.y/t+"px",n.width=Math.ceil(e.width/t)+"px",n.height=Math.ceil(e.height/t)+"px",n.transform="rotate("+e.angle+"deg)",n.color=e.fill,n["font-size"]=e.fontSize/t+"px",n["font-family"]=e.fontFamily,n["font-style"]=e.fontStyle,n["font-weight"]=e.fontWeight,n["text-align"]=e.textAlign,n["line-height"]=e.lineHeight+.1,n["transform-origin"]="left top",this._textarea.focus()}}]),t}(s.default);e.exports=v},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=c(n(106)),o=c(n(3)),a=c(n(4)),s=c(n(108)),l=c(n(73));function c(e){return e&&e.__esModule?e:{default:e}}var u=l.default.eventNames,h=l.default.rejectMessages,d={arrow:"M 0 90 H 105 V 120 L 160 60 L 105 0 V 30 H 0 Z",cancel:"M 0 30 L 30 60 L 0 90 L 30 120 L 60 90 L 90 120 L 120 90 L 90 60 L 120 30 L 90 0 L 60 30 L 30 0 Z"},f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l.default.componentNames.ICON,e));return n._oColor="#000000",n._pathMap=d,n.useDragAddIcon=e.useDragAddIcon,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"add",value:function(e,t){var n=this;return new a.default((function(i,r){var a=n.getCanvas(),s=n._pathMap[e],c=l.default.fObjectOptions.SELECTION_STYLE,u=Object.keys(l.default.defaultIconPath).indexOf(e)>=0,d=n.useDragAddIcon&&u,f=s?n._createIcon(s):null;f||r(h.invalidParameters),f.set(o.default.extend({type:"icon",fill:n._oColor},c,t,n.graphics.controlStyle)),a.add(f).setActiveObject(f),d&&n._addWithDragEvent(a),i(n.graphics.createObjectProperties(f))}))}},{key:"_addWithDragEvent",value:function(e){var t=this;e.on({"mouse:move":function(n){e.selection=!1,t.fire(u.ICON_CREATE_RESIZE,{moveOriginPointer:e.getPointer(n.e)})},"mouse:up":function(n){t.fire(u.ICON_CREATE_END,{moveOriginPointer:e.getPointer(n.e)}),e.defaultCursor="default",e.off("mouse:up"),e.off("mouse:move"),e.selection=!0}})}},{key:"registerPaths",value:function(e){var t=this;o.default.forEach(e,(function(e,n){t._pathMap[n]=e}),this)}},{key:"setColor",value:function(e,t){this._oColor=e,t&&"icon"===t.get("type")&&(t.set({fill:this._oColor}),this.getCanvas().renderAll())}},{key:"getColor",value:function(e){return e.fill}},{key:"_createIcon",value:function(e){return new r.default.Path(e)}}]),t}(s.default);e.exports=f},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(3),o=p(n(4)),a=p(n(106)),s=p(n(108)),l=p(n(118)),c=p(n(73)),u=p(n(119)),h=p(n(120)),d=p(n(121)),f=p(n(122));function p(e){return e&&e.__esModule?e:{default:e}}var g=c.default.rejectMessages,v=a.default.Image.filters;v.Mask=l.default,v.Blur=u.default,v.Sharpen=h.default,v.Emboss=d.default,v.ColorFilter=f.default;var m=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,c.default.componentNames.FILTER,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"add",value:function(e,t){var n=this;return new o.default((function(i,r){var o=n._getSourceImage(),a=n.getCanvas(),s=n._getFilter(o,e);s||(s=n._createFilter(o,e,t)),s||r(g.invalidParameters),n._changeFilterValues(s,t),n._apply(o,(function(){a.renderAll(),i({type:e,action:"add"})}))}))}},{key:"remove",value:function(e){var t=this;return new o.default((function(n,i){var r=t._getSourceImage(),o=t.getCanvas();r.filters.length||i(g.unsupportedOperation),t._removeFilter(r,e),t._apply(r,(function(){o.renderAll(),n({type:e,action:"remove"})}))}))}},{key:"hasFilter",value:function(e){return!!this._getFilter(this._getSourceImage(),e)}},{key:"getOptions",value:function(e){var t=this._getSourceImage(),n=this._getFilter(t,e);return n?(0,r.extend)({},n.options):null}},{key:"_changeFilterValues",value:function(e,t){(0,r.forEach)(t,(function(t,n){(0,r.isUndefined)(e[n])||(e[n]=t)})),(0,r.forEach)(e.options,(function(n,i){(0,r.isUndefined)(t[i])||(e.options[i]=t[i])}))}},{key:"_apply",value:function(e,t){e.filters.push(),e.applyFilters()&&t()}},{key:"_getSourceImage",value:function(){return this.getCanvasImage()}},{key:"_createFilter",value:function(e,t,n){var i=void 0,r=this._getFabricFilterType(t),o=a.default.Image.filters[r];return o&&((i=new o(n)).options=n,e.filters.push(i)),i}},{key:"_getFilter",value:function(e,t){var n=null;if(e){var i=this._getFabricFilterType(t),r=e.filters.length,o=void 0,a=void 0;for(a=0;a<r;a+=1)if((o=e.filters[a]).type===i){n=o;break}}return n}},{key:"_removeFilter",value:function(e,t){var n=this._getFabricFilterType(t);e.filters=(0,r.filter)(e.filters,(function(e){return e.type!==n}))}},{key:"_getFabricFilterType",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}]),t}(s.default);e.exports=m},function(e,t,n){"use strict";var i,r=n(106),o=(i=r)&&i.__esModule?i:{default:i},a=o.default.util.createClass(o.default.Image.filters.BlendImage,{applyTo:function(e){if(this.mask){var t=e.canvasEl,n=t.width,i=t.height,r=this._createCanvasOfMask(n,i),o=t.getContext("2d"),a=r.getContext("2d"),s=o.getImageData(0,0,n,i);this._drawMask(a,t,o),this._mapData(a,s,n,i),e.imageData=s}},_createCanvasOfMask:function(e,t){var n=o.default.util.createCanvasElement();return n.width=e,n.height=t,n},_drawMask:function(e){var t=this.mask,n=t.getElement(),i=t.angle,r=t.left,o=t.scaleX,a=t.scaleY,s=t.top;e.save(),e.translate(r,s),e.rotate(i*Math.PI/180),e.scale(o,a),e.drawImage(n,-n.width/2,-n.height/2),e.restore()},_mapData:function(e,t,n,i){for(var r=t.data,o=t.height,a=r,s=t.width*o*4,l=e.getImageData(0,0,n,i).data,c=0;c<s;c+=4)a[c+3]=l[c]}});e.exports=a},function(e,t,n){"use strict";var i,r=n(106),o=(i=r)&&i.__esModule?i:{default:i},a=o.default.util.createClass(o.default.Image.filters.Convolute,{type:"Blur",initialize:function(){this.matrix=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9]}});e.exports=a},function(e,t,n){"use strict";var i,r=n(106),o=(i=r)&&i.__esModule?i:{default:i},a=o.default.util.createClass(o.default.Image.filters.Convolute,{type:"Sharpen",initialize:function(){this.matrix=[0,-1,0,-1,5,-1,0,-1,0]}});e.exports=a},function(e,t,n){"use strict";var i,r=n(106),o=(i=r)&&i.__esModule?i:{default:i},a=o.default.util.createClass(o.default.Image.filters.Convolute,{type:"Emboss",initialize:function(){this.matrix=[1,1,1,1,.7,-1,-1,-1,-1]}});e.exports=a},function(e,t,n){"use strict";var i,r=n(106),o=(i=r)&&i.__esModule?i:{default:i},a=o.default.util.createClass(o.default.Image.filters.BaseFilter,{type:"ColorFilter",initialize:function(e){e||(e={}),this.color=e.color||"#FFFFFF",this.threshold=e.threshold||45,this.x=e.x||null,this.y=e.y||null},applyTo:function(e){var t,n=e.canvasEl,i=n.getContext("2d"),r=i.getImageData(0,0,n.width,n.height),a=r.data,s=this.threshold,l=o.default.Color.sourceFromHex(this.color),c=void 0;for(this.x&&this.y&&(l=this._getColor(r,this.x,this.y)),c=0,t=a.length;c<t;c+=4)this._isOutsideThreshold(a[c],l[0],s)||this._isOutsideThreshold(a[c+1],l[1],s)||this._isOutsideThreshold(a[c+2],l[2],s)||(a[c]=a[c+1]=a[c+2]=a[c+3]=0);i.putImageData(r,0,0)},_isOutsideThreshold:function(e,t,n){var i=e-t;return Math.abs(i)>n},_getColor:function(e,t,n){var i=[0,0,0,0],r=e.data,o=4*(e.width*n+t);return i[0]=r[o],i[1]=r[o+1],i[2]=r[o+2],i[3]=r[o+3],i}});e.exports=a},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=u(n(106)),o=u(n(4)),a=u(n(108)),s=u(n(73)),l=u(n(124)),c=n(3);function u(e){return e&&e.__esModule?e:{default:e}}var h=s.default.rejectMessages,d=s.default.eventNames,f=s.default.keyCodes,p="rect",g={strokeWidth:1,stroke:"#000000",fill:"#ffffff",width:1,height:1,rx:0,ry:0,lockSkewingX:!0,lockSkewingY:!0,lockUniScaling:!1,bringForward:!0,isRegular:!1},v=["rect","circle","triangle"],m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s.default.componentNames.SHAPE,e));return n._shapeObj=null,n._type=p,n._options=(0,c.extend)({},g),n._isSelected=!1,n._startPoint={},n._withShiftKey=!1,n._handlers={mousedown:n._onFabricMouseDown.bind(n),mousemove:n._onFabricMouseMove.bind(n),mouseup:n._onFabricMouseUp.bind(n),keydown:n._onKeyDown.bind(n),keyup:n._onKeyUp.bind(n)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(){var e=this.getCanvas();this._isSelected=!1,e.defaultCursor="crosshair",e.selection=!1,e.uniScaleTransform=!0,e.on({"mouse:down":this._handlers.mousedown}),r.default.util.addListener(document,"keydown",this._handlers.keydown),r.default.util.addListener(document,"keyup",this._handlers.keyup)}},{key:"end",value:function(){var e=this.getCanvas();this._isSelected=!1,e.defaultCursor="default",e.selection=!0,e.uniScaleTransform=!1,e.off({"mouse:down":this._handlers.mousedown}),r.default.util.removeListener(document,"keydown",this._handlers.keydown),r.default.util.removeListener(document,"keyup",this._handlers.keyup)}},{key:"setStates",value:function(e,t){this._type=e,t&&(this._options=(0,c.extend)(this._options,t))}},{key:"add",value:function(e,t){var n=this;return new o.default((function(i){var r=n.getCanvas();t=n._extendOptions(t);var o=n._createInstance(e,t);n._bindEventOnShape(o),r.add(o).setActiveObject(o),i(n.graphics.createObjectProperties(o))}))}},{key:"change",value:function(e,t){var n=this;return new o.default((function(i,r){(0,c.inArray)(e.get("type"),v)<0&&r(h.unsupportedType),e.set(t),n.getCanvas().renderAll(),i()}))}},{key:"_createInstance",value:function(e,t){var n=void 0;switch(e){case"rect":n=new r.default.Rect(t);break;case"circle":n=new r.default.Ellipse((0,c.extend)({type:"circle"},t));break;case"triangle":n=new r.default.Triangle(t);break;default:n={}}return n}},{key:"_extendOptions",value:function(e){var t=s.default.fObjectOptions.SELECTION_STYLE;return(e=(0,c.extend)({},g,this._options,t,e)).isRegular&&(e.lockUniScaling=!0),e}},{key:"_bindEventOnShape",value:function(e){var t=this,n=this.getCanvas();e.on({added:function(){t._shapeObj=this,l.default.setOrigins(t._shapeObj)},selected:function(){t._isSelected=!0,t._shapeObj=this,n.uniScaleTransform=!0,n.defaultCursor="default",l.default.setOrigins(t._shapeObj)},deselected:function(){t._isSelected=!1,t._shapeObj=null,n.defaultCursor="crosshair",n.uniScaleTransform=!1},modified:function(){var e=t._shapeObj;l.default.adjustOriginToCenter(e),l.default.setOrigins(e)},scaling:function(e){var i=n.getPointer(e.e),r=t._shapeObj;n.setCursor("crosshair"),l.default.resize(r,i,!0)}})}},{key:"_onFabricMouseDown",value:function(e){if(e.target||(this._isSelected=!1,this._shapeObj=!1),!this._isSelected&&!this._shapeObj){var t=this.getCanvas();this._startPoint=t.getPointer(e.e),t.on({"mouse:move":this._handlers.mousemove,"mouse:up":this._handlers.mouseup})}}},{key:"_onFabricMouseMove",value:function(e){var t=this,n=this.getCanvas(),i=n.getPointer(e.e),r=this._startPoint.x,o=this._startPoint.y,a=r-i.x,s=o-i.y,c=this._shapeObj;c?(this._shapeObj.set({isRegular:this._withShiftKey}),l.default.resize(c,i),n.renderAll()):this.add(this._type,{left:r,top:o,width:a,height:s}).then((function(e){t.fire(d.ADD_OBJECT,e)}))}},{key:"_onFabricMouseUp",value:function(){var e=this,t=this.getCanvas(),n=this._startPoint.x,i=this._startPoint.y,r=this._shapeObj;r?r&&(l.default.adjustOriginToCenter(r),this.fire(d.ADD_OBJECT_AFTER,this.graphics.createObjectProperties(r))):this.add(this._type,{left:n,top:i,width:20,height:20}).then((function(t){e.fire(d.ADD_OBJECT,t)})),t.off({"mouse:move":this._handlers.mousemove,"mouse:up":this._handlers.mouseup})}},{key:"_onKeyDown",value:function(e){e.keyCode===f.SHIFT&&(this._withShiftKey=!0,this._shapeObj&&(this._shapeObj.isRegular=!0))}},{key:"_onKeyUp",value:function(e){e.keyCode===f.SHIFT&&(this._withShiftKey=!1,this._shapeObj&&(this._shapeObj.isRegular=!1))}}]),t}(a.default);e.exports=m},function(e,t){"use strict";var n={rect:1,circle:2,triangle:1},i={rect:{w:"width",h:"height"},circle:{w:"rx",h:"ry"},triangle:{w:"width",h:"height"}};function r(e,t,n){var i=e.x,r=e.y,o=t.x,a=t.y,s=n*Math.PI/180;return{originX:i>(o-i)*Math.cos(s)-(a-r)*Math.sin(s)+i?"right":"left",originY:r>(o-i)*Math.sin(s)+(a-r)*Math.cos(s)+r?"bottom":"top"}}e.exports={setOrigins:function(e){var t=e.getPointByOrigin("left","top"),n=e.getPointByOrigin("right","top"),i=e.getPointByOrigin("right","bottom"),r=e.getPointByOrigin("left","bottom");e.origins={lt:t,rt:n,rb:i,lb:r}},resize:function(e,t,o){(function(e){return"center"===e.originX&&"center"===e.originY})(e)&&(function(e,t){var n=t.getPointByOrigin("center","center"),i=r(n,e,-t.angle),o=i.originX,a=i.originY,s=t.getPointByOrigin(o,a),l=t.left-(n.x-s.x),c=t.top-(n.x-s.y);t.set({originX:o,originY:a,left:l,top:c}),t.setCoords()}(t,e),function(e){var t=e.originX,n=e.originY,i=t.substring(0,1)+n.substring(0,1);e.startPoint=e.origins[i]}(e)),o?function(e){var t=e.type,n=e.scaleX,r=e.scaleY,o=i[t],a=e[o.w]*n,s=e[o.h]*r;if(e.isRegular){var l=Math.max(n,r);a=e[o.w]*l,s=e[o.h]*l}var c={hasControls:!1,hasBorders:!1,scaleX:1,scaleY:1};c[o.w]=a,c[o.h]=s,e.set(c)}(e):function(e,t){var r=t.type,o=t.strokeWidth,a=t.startPoint,s=n[r],l=i[r],c=!("triangle"!==t.type),u={},h=Math.abs(a.x-e.x)/s,d=Math.abs(a.y-e.y)/s;h>o&&(h-=o/s),d>o&&(d-=o/s),t.isRegular&&(h=d=Math.max(h,d),c&&(d=Math.sqrt(3)/2*h)),u[l.w]=h,u[l.h]=d,t.set(u)}(t,e),function(e,t){var n=t.startPoint,i=r(n,e,-t.angle),o=i.originX,a=i.originY;t.setPositionByOrigin(n,o,a)}(t,e)},adjustOriginToCenter:function(e){var t=e.getPointByOrigin("center","center"),n=e.originX,i=e.originY,r=e.getPointByOrigin(n,i),o=e.left+(t.x-r.x),a=e.top+(t.y-r.y);e.set({hasControls:!0,hasBorders:!0,originX:"center",originY:"center",left:o,top:a}),e.setCoords()}}},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(126)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.drawingModes,l=o.default.componentNames,c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s.CROPPER))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(e){e.getComponent(l.CROPPER).start()}},{key:"end",value:function(e){e.getComponent(l.CROPPER).end()}}]),t}(r.default);e.exports=c},function(e,t,n){"use strict";var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(71),a=(i=o)&&i.__esModule?i:{default:i},s=a.default.create,l=a.default.types,c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t}return r(e,[{key:"getName",value:function(){return this.name}},{key:"start",value:function(){throw new Error(s(l.UN_IMPLEMENTATION,"start"))}},{key:"stop",value:function(){throw new Error(s(l.UN_IMPLEMENTATION,"stop"))}}]),e}();e.exports=c},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(126)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.drawingModes,l=o.default.componentNames,c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s.FREE_DRAWING))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(e,t){e.getComponent(l.FREE_DRAWING).start(t)}},{key:"end",value:function(e){e.getComponent(l.FREE_DRAWING).end()}}]),t}(r.default);e.exports=c},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(126)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.drawingModes,l=o.default.componentNames,c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s.LINE_DRAWING))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(e,t){e.getComponent(l.LINE).start(t)}},{key:"end",value:function(e){e.getComponent(l.LINE).end()}}]),t}(r.default);e.exports=c},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(126)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.drawingModes,l=o.default.componentNames,c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s.SHAPE))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(e){e.getComponent(l.SHAPE).start()}},{key:"end",value:function(e){e.getComponent(l.SHAPE).end()}}]),t}(r.default);e.exports=c},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(126)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.drawingModes,l=o.default.componentNames,c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s.TEXT))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"start",value:function(e){e.getComponent(l.TEXT).start()}},{key:"end",value:function(e){e.getComponent(l.TEXT).end()}}]),t}(r.default);e.exports=c},function(e,t){},,function(e,t,n){"use strict";var i=a(n(69)),r=a(n(4)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.componentNames,l=o.default.commandNames,c=s.ICON,u={name:l.ADD_ICON,execute:function(e,t,n){var i=this;return e.getComponent(c).add(t,n).then((function(t){return i.undoData.object=e.getObject(t.id),t}))},undo:function(e){return e.remove(this.undoData.object),r.default.resolve()}};i.default.register(u),e.exports=u},function(e,t,n){"use strict";var i=o(n(69)),r=o(n(4));function o(e){return e&&e.__esModule?e:{default:e}}var a={name:o(n(73)).default.commandNames.ADD_IMAGE_OBJECT,execute:function(e,t){var n=this;return e.addImageObject(t).then((function(t){return n.undoData.object=e.getObject(t.id),t}))},undo:function(e){return e.remove(this.undoData.object),r.default.resolve()}};i.default.register(a),e.exports=a},function(e,t,n){"use strict";var i=a(n(69)),r=a(n(4)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.commandNames,l=o.default.rejectMessages,c={name:s.ADD_OBJECT,execute:function(e,t){return new r.default((function(n,i){e.contains(t)?i(l.addedObject):(e.add(t),n(t))}))},undo:function(e,t){return new r.default((function(n,i){e.contains(t)?(e.remove(t),n(t)):i(l.noObject)}))}};i.default.register(c),e.exports=c},function(e,t,n){"use strict";var i=a(n(69)),r=a(n(4)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.componentNames,l=o.default.commandNames,c=s.SHAPE,u={name:l.ADD_SHAPE,execute:function(e,t,n){var i=this;return e.getComponent(c).add(t,n).then((function(t){return i.undoData.object=e.getObject(t.id),t}))},undo:function(e){return e.remove(this.undoData.object),r.default.resolve()}};i.default.register(u),e.exports=u},function(e,t,n){"use strict";var i=a(n(69)),r=a(n(4)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.componentNames,l=o.default.commandNames,c=s.TEXT,u={name:l.ADD_TEXT,execute:function(e,t,n){var i=this;return e.getComponent(c).add(t,n).then((function(t){return i.undoData.object=e.getObject(t.id),t}))},undo:function(e){return e.remove(this.undoData.object),r.default.resolve()}};i.default.register(u),e.exports=u},function(e,t,n){"use strict";var i=o(n(69)),r=o(n(73));function o(e){return e&&e.__esModule?e:{default:e}}var a=r.default.componentNames,s=r.default.rejectMessages,l=r.default.commandNames,c=a.FILTER,u={name:l.APPLY_FILTER,execute:function(e,t,n){var i=e.getComponent(c);if("mask"===t){var r=e.getObject(n.maskObjId);if(!r||!r.isType("image"))return Promise.reject(s.invalidParameters);n={mask:r}}return"mask"===t?(this.undoData.object=n.mask,e.remove(n.mask)):this.undoData.options=i.getOptions(t),i.add(t,n)},undo:function(e,t){var n=e.getComponent(c);if("mask"===t){var i=this.undoData.object;return e.add(i),e.setActiveObject(i),n.remove(t)}return this.undoData.options?n.add(t,this.undoData.options):n.remove(t)}};i.default.register(u),e.exports=u},function(e,t,n){"use strict";var i=a(n(69)),r=a(n(4)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.componentNames,l=o.default.rejectMessages,c=o.default.commandNames,u=s.ICON,h={name:c.CHANGE_ICON_COLOR,execute:function(e,t,n){var i=this;return new r.default((function(r,o){var a=e.getComponent(u),s=e.getObject(t);s||o(l.noObject),i.undoData.object=s,i.undoData.color=a.getColor(s),a.setColor(n,s),r()}))},undo:function(e){var t=e.getComponent(u),n=this.undoData.object,i=n.object,o=n.color;return t.setColor(o,i),r.default.resolve()}};i.default.register(h),e.exports=h},function(e,t,n){"use strict";var i=s(n(3)),r=s(n(69)),o=s(n(4)),a=s(n(73));function s(e){return e&&e.__esModule?e:{default:e}}var l=a.default.componentNames,c=a.default.rejectMessages,u=a.default.commandNames,h=l.SHAPE,d={name:u.CHANGE_SHAPE,execute:function(e,t,n){var r=this,a=e.getComponent(h),s=e.getObject(t);return s?(this.undoData.object=s,this.undoData.options={},i.default.forEachOwnProperties(n,(function(e,t){r.undoData.options[t]=s[t]})),a.change(s,n)):o.default.reject(c.noObject)},undo:function(e){var t=e.getComponent(h),n=this.undoData,i=n.object,r=n.options;return t.change(i,r)}};r.default.register(d),e.exports=d},function(e,t,n){"use strict";var i=a(n(69)),r=a(n(4)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.componentNames,l=o.default.rejectMessages,c=o.default.commandNames,u=s.TEXT,h={name:c.CHANGE_TEXT,execute:function(e,t,n){var i=e.getComponent(u),o=e.getObject(t);return o?(this.undoData.object=o,this.undoData.text=i.getText(o),i.change(o,n)):r.default.reject(l.noObject)},undo:function(e){var t=e.getComponent(u),n=this.undoData,i=n.object,r=n.text;return t.change(i,r)}};i.default.register(h),e.exports=h},function(e,t,n){"use strict";var i=s(n(3)),r=s(n(69)),o=s(n(4)),a=s(n(73));function s(e){return e&&e.__esModule?e:{default:e}}var l=a.default.componentNames,c=a.default.rejectMessages,u=a.default.commandNames,h=l.TEXT,d={name:u.CHANGE_TEXT_STYLE,execute:function(e,t,n){var r=this,a=e.getComponent(h),s=e.getObject(t);return s?(this.undoData.object=s,this.undoData.styles={},i.default.forEachOwnProperties(n,(function(e,t){r.undoData.styles[t]=s[t]})),a.setStyle(s,n)):o.default.reject(c.noObject)},undo:function(e){var t=e.getComponent(h),n=this.undoData,i=n.object,r=n.styles;return t.setStyle(i,r)}};r.default.register(d),e.exports=d},function(e,t,n){"use strict";var i=o(n(69)),r=o(n(4));function o(e){return e&&e.__esModule?e:{default:e}}var a={name:o(n(73)).default.commandNames.CLEAR_OBJECTS,execute:function(e){var t=this;return new r.default((function(n){t.undoData.objects=e.removeAll(),n()}))},undo:function(e){return e.add(this.undoData.objects),r.default.resolve()}};i.default.register(a),e.exports=a},function(e,t,n){"use strict";var i=o(n(69)),r=o(n(73));function o(e){return e&&e.__esModule?e:{default:e}}var a=r.default.componentNames,s=r.default.commandNames,l=a.FLIP,c={name:s.FLIP_IMAGE,execute:function(e,t){var n=e.getComponent(l);return this.undoData.setting=n.getCurrentSetting(),n[t]()},undo:function(e){return e.getComponent(l).set(this.undoData.setting)}};i.default.register(c),e.exports=c},function(e,t,n){"use strict";var i=o(n(69)),r=o(n(73));function o(e){return e&&e.__esModule?e:{default:e}}var a=r.default.componentNames,s=r.default.commandNames,l=a.IMAGE_LOADER,c={name:s.LOAD_IMAGE,execute:function(e,t,n){var i=e.getComponent(l),r=i.getCanvasImage(),o=r?r.width:0,a=r?r.height:0,s=e.removeAll(!0).filter((function(e){return"cropzone"!==e.type}));return s.forEach((function(e){e.evented=!0})),this.undoData={name:i.getImageName(),image:r,objects:s},i.load(t,n).then((function(e){return{oldWidth:o,oldHeight:a,newWidth:e.width,newHeight:e.height}}))},undo:function(e){var t=e.getComponent(l),n=this.undoData,i=n.objects,r=n.name,o=n.image;return e.removeAll(!0),e.add(i),t.load(r,o)}};i.default.register(c),e.exports=c},function(e,t,n){"use strict";var i=o(n(69)),r=o(n(73));function o(e){return e&&e.__esModule?e:{default:e}}var a=r.default.componentNames,s=r.default.commandNames,l=a.FILTER,c={name:s.REMOVE_FILTER,execute:function(e,t){var n=e.getComponent(l);return this.undoData.options=n.getOptions(t),n.remove(t)},undo:function(e,t){var n=e.getComponent(l),i=this.undoData.options;return n.add(t,i)}};i.default.register(c),e.exports=c},function(e,t,n){"use strict";var i=a(n(69)),r=a(n(4)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.commandNames,l=o.default.rejectMessages,c={name:s.REMOVE_OBJECT,execute:function(e,t){var n=this;return new r.default((function(i,r){n.undoData.objects=e.removeObjectById(t),n.undoData.objects.length?i():r(l.noObject)}))},undo:function(e){return e.add(this.undoData.objects),r.default.resolve()}};i.default.register(c),e.exports=c},function(e,t,n){"use strict";var i=o(n(69)),r=o(n(4));function o(e){return e&&e.__esModule?e:{default:e}}var a={name:o(n(73)).default.commandNames.RESIZE_CANVAS_DIMENSION,execute:function(e,t){var n=this;return new r.default((function(i){n.undoData.size={width:e.cssMaxWidth,height:e.cssMaxHeight},e.setCssMaxDimension(t),e.adjustCanvasDimension(),i()}))},undo:function(e){return e.setCssMaxDimension(this.undoData.size),e.adjustCanvasDimension(),r.default.resolve()}};i.default.register(a),e.exports=a},function(e,t,n){"use strict";var i=o(n(69)),r=o(n(73));function o(e){return e&&e.__esModule?e:{default:e}}var a=r.default.componentNames,s=r.default.commandNames,l=a.ROTATION,c={name:s.ROTATE_IMAGE,execute:function(e,t,n,i){var r=e.getComponent(l);return i||(this.undoData.angle=r.getCurrentAngle()),r[t](n)},undo:function(e){var t=e.getComponent(l),n=this.args,i=n[1],r=n[2];return"setAngle"===i?t[i](this.undoData.angle):t.rotate(-r)}};i.default.register(c),e.exports=c},function(e,t,n){"use strict";var i=s(n(3)),r=s(n(69)),o=s(n(4)),a=s(n(73));function s(e){return e&&e.__esModule?e:{default:e}}var l=a.default.commandNames,c=a.default.rejectMessages,u={name:l.SET_OBJECT_PROPERTIES,execute:function(e,t,n){var r=this,a=e.getObject(t);return a?(this.undoData.props={},i.default.forEachOwnProperties(n,(function(e,t){r.undoData.props[t]=a[t]})),e.setObjectProperties(t,n),o.default.resolve()):o.default.reject(c.noObject)},undo:function(e,t){var n=this.undoData.props;return e.setObjectProperties(t,n),o.default.resolve()}};r.default.register(u),e.exports=u},function(e,t,n){"use strict";var i=a(n(69)),r=a(n(4)),o=a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s=o.default.commandNames,l=o.default.rejectMessages,c={name:s.SET_OBJECT_POSITION,execute:function(e,t,n){return e.getObject(t)?(this.undoData.objectId=t,this.undoData.props=e.getObjectProperties(t,["left","top"]),e.setObjectPosition(t,n),e.renderAll(),r.default.resolve()):r.default.reject(l.noObject)},undo:function(e){var t=this.undoData,n=t.objectId,i=t.props;return e.setObjectProperties(n,i),e.renderAll(),r.default.resolve()}};i.default.register(c),e.exports=c}])},e.exports=i(n(487),n(1143),n(1144).fabric)},1143:function(module,exports,__webpack_require__){var factory;window,factory=function(__WEBPACK_EXTERNAL_MODULE_tui_code_snippet__){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist",n(n.s=0)}({"./node_modules/webpack/buildin/global.js":function(module,exports){eval('var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function("return this")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === "object") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it\'s\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n//# sourceURL=webpack://tui.colorPicker/(webpack)/buildin/global.js?')},"./src/js/colorutil.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview Utility methods to manipulate colors\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar hexRX = /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i;\nvar colorutil = {\n  /**\n   * pad left zero characters.\n   * @param {number} number number value to pad zero.\n   * @param {number} length pad length to want.\n   * @returns {string} padded string.\n   */\n  leadingZero: function (number, length) {\n    var zero = '',\n        i = 0;\n\n    if ((number + '').length > length) {\n      return number + '';\n    }\n\n    for (; i < length - 1; i += 1) {\n      zero += '0';\n    }\n\n    return (zero + number).slice(length * -1);\n  },\n\n  /**\n   * Check validate of hex string value is RGB\n   * @param {string} str - rgb hex string\n   * @returns {boolean} return true when supplied str is valid RGB hex string\n   */\n  isValidRGB: function (str) {\n    return hexRX.test(str);\n  },\n  // @license RGB <-> HSV conversion utilities based off of http://www.cs.rit.edu/~ncs/color/t_convert.html\n\n  /**\n   * Convert color hex string to rgb number array\n   * @param {string} hexStr - hex string\n   * @returns {number[]} rgb numbers\n   */\n  hexToRGB: function (hexStr) {\n    var r, g, b;\n\n    if (!colorutil.isValidRGB(hexStr)) {\n      return false;\n    }\n\n    hexStr = hexStr.substring(1);\n    r = parseInt(hexStr.substr(0, 2), 16);\n    g = parseInt(hexStr.substr(2, 2), 16);\n    b = parseInt(hexStr.substr(4, 2), 16);\n    return [r, g, b];\n  },\n\n  /**\n   * Convert rgb number to hex string\n   * @param {number} r - red\n   * @param {number} g - green\n   * @param {number} b - blue\n   * @returns {string|boolean} return false when supplied rgb number is not valid. otherwise, converted hex string\n   */\n  rgbToHEX: function (r, g, b) {\n    var hexStr = '#' + colorutil.leadingZero(r.toString(16), 2) + colorutil.leadingZero(g.toString(16), 2) + colorutil.leadingZero(b.toString(16), 2);\n\n    if (colorutil.isValidRGB(hexStr)) {\n      return hexStr;\n    }\n\n    return false;\n  },\n\n  /**\n   * Convert rgb number to HSV value\n   * @param {number} r - red\n   * @param {number} g - green\n   * @param {number} b - blue\n   * @returns {number[]} hsv value\n   */\n  rgbToHSV: function (r, g, b) {\n    var max, min, h, s, v, d;\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    max = Math.max(r, g, b);\n    min = Math.min(r, g, b);\n    v = max;\n    d = max - min;\n    s = max === 0 ? 0 : d / max;\n\n    if (max === min) {\n      h = 0;\n    } else {\n      switch (max) {\n        case r:\n          h = (g - b) / d + (g < b ? 6 : 0);\n          break;\n\n        case g:\n          h = (b - r) / d + 2;\n          break;\n\n        case b:\n          h = (r - g) / d + 4;\n          break;\n        // no default\n      }\n\n      h /= 6;\n    }\n\n    return [Math.round(h * 360), Math.round(s * 100), Math.round(v * 100)];\n  },\n\n  /**\n   * Convert HSV number to RGB\n   * @param {number} h - hue\n   * @param {number} s - saturation\n   * @param {number} v - value\n   * @returns {number[]} rgb value\n   */\n  hsvToRGB: function (h, s, v) {\n    var r, g, b;\n    var i;\n    var f, p, q, t;\n    h = Math.max(0, Math.min(360, h));\n    s = Math.max(0, Math.min(100, s));\n    v = Math.max(0, Math.min(100, v));\n    s /= 100;\n    v /= 100;\n\n    if (s === 0) {\n      // Achromatic (grey)\n      r = g = b = v;\n      return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\n    }\n\n    h /= 60; // sector 0 to 5\n\n    i = Math.floor(h);\n    f = h - i; // factorial part of h\n\n    p = v * (1 - s);\n    q = v * (1 - s * f);\n    t = v * (1 - s * (1 - f));\n\n    switch (i) {\n      case 0:\n        r = v;\n        g = t;\n        b = p;\n        break;\n\n      case 1:\n        r = q;\n        g = v;\n        b = p;\n        break;\n\n      case 2:\n        r = p;\n        g = v;\n        b = t;\n        break;\n\n      case 3:\n        r = p;\n        g = q;\n        b = v;\n        break;\n\n      case 4:\n        r = t;\n        g = p;\n        b = v;\n        break;\n\n      default:\n        r = v;\n        g = p;\n        b = q;\n        break;\n    }\n\n    return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\n  }\n};\nmodule.exports = colorutil;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/colorutil.js?")},"./src/js/core/collection.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview Common collections.\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar snippet = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar util = snippet,\n    forEachProp = util.forEachOwnProperties,\n    forEachArr = util.forEachArray,\n    isFunc = util.isFunction,\n    isObj = util.isObject;\nvar aps = Array.prototype.slice;\n/**\n * Common collection.\n *\n * It need function for get model's unique id.\n *\n * if the function is not supplied then it use default function {@link Collection#getItemID}\n * @constructor\n * @param {function} [getItemIDFn] function for get model's id.\n * @ignore\n */\n\nfunction Collection(getItemIDFn) {\n  /**\n   * @type {object.<string, *>}\n   */\n  this.items = {};\n  /**\n   * @type {number}\n   */\n\n  this.length = 0;\n\n  if (isFunc(getItemIDFn)) {\n    /**\n     * @type {function}\n     */\n    this.getItemID = getItemIDFn;\n  }\n}\n/**********\n * static props\n **********/\n\n/**\n * Combind supplied function filters and condition.\n * @param {...function} filters - function filters\n * @returns {function} combined filter\n */\n\n\nCollection.and = function (filters) {\n  var cnt;\n  filters = aps.call(arguments);\n  cnt = filters.length;\n  return function (item) {\n    var i = 0;\n\n    for (; i < cnt; i += 1) {\n      if (!filters[i].call(null, item)) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n};\n/**\n * Combine multiple function filters with OR clause.\n * @param {...function} filters - function filters\n * @returns {function} combined filter\n */\n\n\nCollection.or = function (filters) {\n  var cnt;\n  filters = aps.call(arguments);\n  cnt = filters.length;\n  return function (item) {\n    var i = 1,\n        result = filters[0].call(null, item);\n\n    for (; i < cnt; i += 1) {\n      result = result || filters[i].call(null, item);\n    }\n\n    return result;\n  };\n};\n/**\n * Merge several collections.\n *\n * You can\\'t merge collections different _getEventID functions. Take case of use.\n * @param {...Collection} collections collection arguments to merge\n * @returns {Collection} merged collection.\n */\n// eslint-disable-next-line no-unused-vars\n\n\nCollection.merge = function (collections) {\n  // eslint-disable-line\n  var cols = aps.call(arguments),\n      newItems = {},\n      merged = new Collection(cols[0].getItemID),\n      extend = util.extend;\n  forEachArr(cols, function (col) {\n    extend(newItems, col.items);\n  });\n  merged.items = newItems;\n  merged.length = util.keys(merged.items).length;\n  return merged;\n};\n/**********\n * prototype props\n **********/\n\n/**\n * get model's unique id.\n * @param {object} item model instance.\n * @returns {number} model unique id.\n */\n\n\nCollection.prototype.getItemID = function (item) {\n  return item._id + '';\n};\n/**\n * add models.\n * @param {...*} item models to add this collection.\n */\n\n\nCollection.prototype.add = function (item) {\n  var id, ownItems;\n\n  if (arguments.length > 1) {\n    forEachArr(aps.call(arguments), function (o) {\n      this.add(o);\n    }, this);\n    return;\n  }\n\n  id = this.getItemID(item);\n  ownItems = this.items;\n\n  if (!ownItems[id]) {\n    this.length += 1;\n  }\n\n  ownItems[id] = item;\n};\n/**\n * remove models.\n * @param {...(object|string|number)} id model instance or unique id to delete.\n * @returns {array} deleted model list.\n */\n\n\nCollection.prototype.remove = function (id) {\n  var removed = [],\n      ownItems,\n      itemToRemove;\n\n  if (!this.length) {\n    return removed;\n  }\n\n  if (arguments.length > 1) {\n    removed = util.map(aps.call(arguments), function (id) {\n      return this.remove(id);\n    }, this);\n    return removed;\n  }\n\n  ownItems = this.items;\n\n  if (isObj(id)) {\n    id = this.getItemID(id);\n  }\n\n  if (!ownItems[id]) {\n    return removed;\n  }\n\n  this.length -= 1;\n  itemToRemove = ownItems[id];\n  delete ownItems[id];\n  return itemToRemove;\n};\n/**\n * remove all models in collection.\n */\n\n\nCollection.prototype.clear = function () {\n  this.items = {};\n  this.length = 0;\n};\n/**\n * check collection has specific model.\n * @param {(object|string|number|function)} id model instance or id or filter function to check\n * @returns {boolean} is has model?\n */\n\n\nCollection.prototype.has = function (id) {\n  var isFilter, has;\n\n  if (!this.length) {\n    return false;\n  }\n\n  isFilter = isFunc(id);\n  has = false;\n\n  if (isFilter) {\n    this.each(function (item) {\n      if (id(item) === true) {\n        has = true;\n        return false;\n      }\n\n      return true;\n    });\n  } else {\n    id = isObj(id) ? this.getItemID(id) : id;\n    has = util.isExisty(this.items[id]);\n  }\n\n  return has;\n};\n/**\n * invoke callback when model exist in collection.\n * @param {(string|number)} id model unique id.\n * @param {function} fn the callback.\n * @param {*} [context] callback context.\n */\n\n\nCollection.prototype.doWhenHas = function (id, fn, context) {\n  var item = this.items[id];\n\n  if (!util.isExisty(item)) {\n    return;\n  }\n\n  fn.call(context || this, item);\n};\n/**\n * Search model. and return new collection.\n * @param {function} filter filter function.\n * @returns {Collection} new collection with filtered models.\n * @example\n * collection.find(function(item) {\n *     return item.edited === true;\n * });\n *\n * function filter1(item) {\n *     return item.edited === false;\n * }\n *\n * function filter2(item) {\n *     return item.disabled === false;\n * }\n *\n * collection.find(Collection.and(filter1, filter2));\n *\n * collection.find(Collection.or(filter1, filter2));\n */\n\n\nCollection.prototype.find = function (filter) {\n  var result = new Collection();\n\n  if (this.hasOwnProperty('getItemID')) {\n    result.getItemID = this.getItemID;\n  }\n\n  this.each(function (item) {\n    if (filter(item) === true) {\n      result.add(item);\n    }\n  });\n  return result;\n};\n/**\n * Group element by specific key values.\n *\n * if key parameter is function then invoke it and use returned value.\n * @param {(string|number|function|array)} key key property or getter function. if string[] supplied, create each collection before grouping.\n * @param {function} [groupFunc] - function that return each group's key\n * @returns {object.<string, Collection>} grouped object\n * @example\n *\n * // pass `string`, `number`, `boolean` type value then group by property value.\n * collection.groupBy('gender');    // group by 'gender' property value.\n * collection.groupBy(50);          // group by '50' property value.\n *\n * // pass `function` then group by return value. each invocation `function` is called with `(item)`.\n * collection.groupBy(function(item) {\n *     if (item.score > 60) {\n *         return 'pass';\n *     }\n *     return 'fail';\n * });\n *\n * // pass `array` with first arguments then create each collection before grouping.\n * collection.groupBy(['go', 'ruby', 'javascript']);\n * // result: { 'go': empty Collection, 'ruby': empty Collection, 'javascript': empty Collection }\n *\n * // can pass `function` with `array` then group each elements.\n * collection.groupBy(['go', 'ruby', 'javascript'], function(item) {\n *     if (item.isFast) {\n *         return 'go';\n *     }\n *\n *     return item.name;\n * });\n */\n\n\nCollection.prototype.groupBy = function (key, groupFunc) {\n  var result = {},\n      collection,\n      baseValue,\n      keyIsFunc = isFunc(key),\n      getItemIDFn = this.getItemID;\n\n  if (util.isArray(key)) {\n    util.forEachArray(key, function (k) {\n      result[k + ''] = new Collection(getItemIDFn);\n    });\n\n    if (!groupFunc) {\n      return result;\n    }\n\n    key = groupFunc;\n    keyIsFunc = true;\n  }\n\n  this.each(function (item) {\n    if (keyIsFunc) {\n      baseValue = key(item);\n    } else {\n      baseValue = item[key];\n\n      if (isFunc(baseValue)) {\n        baseValue = baseValue.apply(item);\n      }\n    }\n\n    collection = result[baseValue];\n\n    if (!collection) {\n      collection = result[baseValue] = new Collection(getItemIDFn);\n    }\n\n    collection.add(item);\n  });\n  return result;\n};\n/**\n * Return single item in collection.\n *\n * Returned item is inserted in this collection firstly.\n * @returns {object} item.\n */\n\n\nCollection.prototype.single = function () {\n  var result;\n  this.each(function (item) {\n    result = item;\n    return false;\n  }, this);\n  return result;\n};\n/**\n * sort a basis of supplied compare function.\n * @param {function} compareFunction compareFunction\n * @returns {array} sorted array.\n */\n\n\nCollection.prototype.sort = function (compareFunction) {\n  var arr = [];\n  this.each(function (item) {\n    arr.push(item);\n  });\n\n  if (isFunc(compareFunction)) {\n    arr = arr.sort(compareFunction);\n  }\n\n  return arr;\n};\n/**\n * iterate each model element.\n *\n * when iteratee return false then break the loop.\n * @param {function} iteratee iteratee(item, index, items)\n * @param {*} [context] context\n */\n\n\nCollection.prototype.each = function (iteratee, context) {\n  forEachProp(this.items, iteratee, context || this);\n};\n/**\n * return new array with collection items.\n * @returns {array} new array.\n */\n\n\nCollection.prototype.toArray = function () {\n  if (!this.length) {\n    return [];\n  }\n\n  return util.map(this.items, function (item) {\n    return item;\n  });\n};\n\nmodule.exports = Collection;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/core/collection.js?")},"./src/js/core/domevent.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview Utility module for handling DOM events.\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar snippet = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar util = snippet,\n    browser = util.browser,\n    eventKey = '_evt',\n    DRAG = {\n  START: ['touchstart', 'mousedown'],\n  END: {\n    mousedown: 'mouseup',\n    touchstart: 'touchend',\n    pointerdown: 'touchend',\n    MSPointerDown: 'touchend'\n  },\n  MOVE: {\n    mousedown: 'mousemove',\n    touchstart: 'touchmove',\n    pointerdown: 'touchmove',\n    MSPointerDown: 'touchmove'\n  }\n};\nvar domevent = {\n  /**\n   * Bind dom events.\n   * @param {HTMLElement} obj HTMLElement to bind events.\n   * @param {(string|object)} types Space splitted events names or eventName:handler object.\n   * @param {*} fn handler function or context for handler method.\n   * @param {*} [context] context object for handler method.\n   */\n  on: function (obj, types, fn, context) {\n    if (util.isString(types)) {\n      util.forEach(types.split(' '), function (type) {\n        domevent._on(obj, type, fn, context);\n      });\n      return;\n    }\n\n    util.forEachOwnProperties(types, function (handler, type) {\n      domevent._on(obj, type, handler, fn);\n    });\n  },\n\n  /**\n   * DOM event binding.\n   * @param {HTMLElement} obj HTMLElement to bind events.\n   * @param {String} type The name of events.\n   * @param {*} fn handler function\n   * @param {*} [context] context object for handler method.\n   * @private\n   */\n  _on: function (obj, type, fn, context) {\n    var id, handler, originHandler;\n    id = type + util.stamp(fn) + (context ? '_' + util.stamp(context) : '');\n\n    if (obj[eventKey] && obj[eventKey][id]) {\n      return;\n    }\n\n    handler = function (e) {\n      fn.call(context || obj, e || window.event);\n    };\n\n    originHandler = handler;\n\n    if ('addEventListener' in obj) {\n      if (type === 'mouseenter' || type === 'mouseleave') {\n        handler = function (e) {\n          e = e || window.event;\n\n          if (!domevent._checkMouse(obj, e)) {\n            return;\n          }\n\n          originHandler(e);\n        };\n\n        obj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\n      } else {\n        if (type === 'mousewheel') {\n          obj.addEventListener('DOMMouseScroll', handler, false);\n        }\n\n        obj.addEventListener(type, handler, false);\n      }\n    } else if ('attachEvent' in obj) {\n      obj.attachEvent('on' + type, handler);\n    }\n\n    obj[eventKey] = obj[eventKey] || {};\n    obj[eventKey][id] = handler;\n  },\n\n  /**\n   * Unbind DOM Event handler.\n   * @param {HTMLElement} obj HTMLElement to unbind.\n   * @param {(string|object)} types Space splitted events names or eventName:handler object.\n   * @param {*} fn handler function or context for handler method.\n   * @param {*} [context] context object for handler method.\n   */\n  off: function (obj, types, fn, context) {\n    if (util.isString(types)) {\n      util.forEach(types.split(' '), function (type) {\n        domevent._off(obj, type, fn, context);\n      });\n      return;\n    }\n\n    util.forEachOwnProperties(types, function (handler, type) {\n      domevent._off(obj, type, handler, fn);\n    });\n  },\n\n  /**\n   * Unbind DOM event handler.\n   * @param {HTMLElement} obj HTMLElement to unbind.\n   * @param {String} type The name of event to unbind.\n   * @param {function()} fn Event handler that supplied when binding.\n   * @param {*} context context object that supplied when binding.\n   * @private\n   */\n  _off: function (obj, type, fn, context) {\n    var id = type + util.stamp(fn) + (context ? '_' + util.stamp(context) : ''),\n        handler = obj[eventKey] && obj[eventKey][id];\n\n    if (!handler) {\n      return;\n    }\n\n    if ('removeEventListener' in obj) {\n      if (type === 'mouseenter' || type === 'mouseleave') {\n        obj.removeEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\n      } else {\n        if (type === 'mousewheel') {\n          obj.removeEventListener('DOMMouseScroll', handler, false);\n        }\n\n        obj.removeEventListener(type, handler, false);\n      }\n    } else if ('detachEvent' in obj) {\n      try {\n        obj.detachEvent('on' + type, handler);\n      } catch (e) {} //eslint-disable-line\n\n    }\n\n    delete obj[eventKey][id];\n\n    if (util.keys(obj[eventKey]).length) {\n      return;\n    } // throw exception when deleting host object's property in below IE8\n\n\n    if (util.browser.msie && util.browser.version < 9) {\n      obj[eventKey] = null;\n      return;\n    }\n\n    delete obj[eventKey];\n  },\n\n  /**\n   * Bind DOM event. this event will unbind after invokes.\n   * @param {HTMLElement} obj HTMLElement to bind events.\n   * @param {(string|object)} types Space splitted events names or eventName:handler object.\n   * @param {*} fn handler function or context for handler method.\n   * @param {*} [context] context object for handler method.\n   */\n  once: function (obj, types, fn, context) {\n    var that = this;\n\n    if (util.isObject(types)) {\n      util.forEachOwnProperties(types, function (handler, type) {\n        domevent.once(obj, type, handler, fn);\n      });\n      return;\n    }\n\n    function onceHandler() {\n      fn.apply(context || obj, arguments);\n\n      that._off(obj, types, onceHandler, context);\n    }\n\n    domevent.on(obj, types, onceHandler, context);\n  },\n\n  /**\n   * Cancel event bubbling.\n   * @param {Event} e Event object.\n   */\n  stopPropagation: function (e) {\n    if (e.stopPropagation) {\n      e.stopPropagation();\n    } else {\n      e.cancelBubble = true;\n    }\n  },\n\n  /**\n   * Cancel browser default actions.\n   * @param {Event} e Event object.\n   */\n  preventDefault: function (e) {\n    if (e.preventDefault) {\n      e.preventDefault();\n    } else {\n      e.returnValue = false;\n    }\n  },\n\n  /**\n   * Syntatic sugar of stopPropagation and preventDefault\n   * @param {Event} e Event object.\n   */\n  stop: function (e) {\n    domevent.preventDefault(e);\n    domevent.stopPropagation(e);\n  },\n\n  /**\n   * Stop scroll events.\n   * @param {HTMLElement} el HTML element to prevent scroll.\n   */\n  disableScrollPropagation: function (el) {\n    domevent.on(el, 'mousewheel MozMousePixelScroll', domevent.stopPropagation);\n  },\n\n  /**\n   * Stop all events related with click.\n   * @param {HTMLElement} el HTML element to prevent all event related with click.\n   */\n  disableClickPropagation: function (el) {\n    domevent.on(el, DRAG.START.join(' ') + ' click dblclick', domevent.stopPropagation);\n  },\n\n  /**\n   * Get mouse position from mouse event.\n   *\n   * If supplied relatveElement parameter then return relative position based on element.\n   * @param {Event} mouseEvent Mouse event object\n   * @param {HTMLElement} relativeElement HTML element that calculate relative position.\n   * @returns {number[]} mouse position.\n   */\n  getMousePosition: function (mouseEvent, relativeElement) {\n    var rect;\n\n    if (!relativeElement) {\n      return [mouseEvent.clientX, mouseEvent.clientY];\n    }\n\n    rect = relativeElement.getBoundingClientRect();\n    return [mouseEvent.clientX - rect.left - relativeElement.clientLeft, mouseEvent.clientY - rect.top - relativeElement.clientTop];\n  },\n\n  /**\n   * Normalize mouse wheel event that different each browsers.\n   * @param {MouseEvent} e Mouse wheel event.\n   * @returns {Number} delta\n   */\n  getWheelDelta: function (e) {\n    var delta = 0;\n\n    if (e.wheelDelta) {\n      delta = e.wheelDelta / 120;\n    }\n\n    if (e.detail) {\n      delta = -e.detail / 3;\n    }\n\n    return delta;\n  },\n\n  /**\n   * prevent firing mouseleave event when mouse entered child elements.\n   * @param {HTMLElement} el HTML element\n   * @param {MouseEvent} e Mouse event\n   * @returns {Boolean} leave?\n   * @private\n   */\n  _checkMouse: function (el, e) {\n    var related = e.relatedTarget;\n\n    if (!related) {\n      return true;\n    }\n\n    try {\n      while (related && related !== el) {\n        related = related.parentNode;\n      }\n    } catch (err) {\n      return false;\n    }\n\n    return related !== el;\n  },\n\n  /**\n   * Trigger specific events to html element.\n   * @param {HTMLElement} obj HTMLElement\n   * @param {string} type Event type name\n   * @param {object} [eventData] Event data\n   */\n  trigger: function (obj, type, eventData) {\n    var rMouseEvent = /(mouse|click)/;\n\n    if (util.isUndefined(eventData) && rMouseEvent.exec(type)) {\n      eventData = domevent.mouseEvent(type);\n    }\n\n    if (obj.dispatchEvent) {\n      obj.dispatchEvent(eventData);\n    } else if (obj.fireEvent) {\n      obj.fireEvent('on' + type, eventData);\n    }\n  },\n\n  /**\n   * Create virtual mouse event.\n   *\n   * Tested at\n   *\n   * - IE7 ~ IE11\n   * - Chrome\n   * - Firefox\n   * - Safari\n   * @param {string} type Event type\n   * @param {object} [eventObj] Event data\n   * @returns {MouseEvent} Virtual mouse event.\n   */\n  mouseEvent: function (type, eventObj) {\n    var evt, e;\n    e = util.extend({\n      bubbles: true,\n      cancelable: type !== 'mousemove',\n      view: window,\n      wheelDelta: 0,\n      detail: 0,\n      screenX: 0,\n      screenY: 0,\n      clientX: 0,\n      clientY: 0,\n      ctrlKey: false,\n      altKey: false,\n      shiftKey: false,\n      metaKey: false,\n      button: 0,\n      relatedTarget: undefined // eslint-disable-line\n\n    }, eventObj); // prevent throw error when inserting wheelDelta property to mouse event on below IE8\n\n    if (browser.msie && browser.version < 9) {\n      delete e.wheelDelta;\n    }\n\n    if (typeof document.createEvent === 'function') {\n      evt = document.createEvent('MouseEvents');\n      evt.initMouseEvent(type, e.bubbles, e.cancelable, e.view, e.detail, e.screenX, e.screenY, e.clientX, e.clientY, e.ctrlKey, e.altKey, e.shiftKey, e.metaKey, e.button, document.body.parentNode);\n    } else if (document.createEventObject) {\n      evt = document.createEventObject();\n      util.forEach(e, function (value, propName) {\n        evt[propName] = value;\n      }, this);\n      evt.button = {\n        0: 1,\n        1: 4,\n        2: 2\n      }[evt.button] || evt.button;\n    }\n\n    return evt;\n  },\n\n  /**\n   * Normalize mouse event's button attributes.\n   *\n   * Can detect which button is clicked by this method.\n   *\n   * Meaning of return numbers\n   *\n   * - 0: primary mouse button\n   * - 1: wheel button or center button\n   * - 2: secondary mouse button\n   * @param {MouseEvent} mouseEvent - The mouse event object want to know.\n   * @returns {number} - The value of meaning which button is clicked?\n   */\n  getMouseButton: function (mouseEvent) {\n    var primary = '0,1,3,5,7';\n    var secondary = '2,6';\n    var wheel = '4';\n    var button, result;\n    /* istanbul ignore else */\n\n    if (document.implementation.hasFeature('MouseEvents', '2.0')) {\n      return mouseEvent.button;\n    }\n\n    button = mouseEvent.button + '';\n\n    if (~primary.indexOf(button)) {\n      result = 0;\n    } else if (~secondary.indexOf(button)) {\n      result = 2;\n    } else if (~wheel.indexOf(button)) {\n      result = 1;\n    }\n\n    return result;\n  }\n};\nmodule.exports = domevent;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/core/domevent.js?")},"./src/js/core/domutil.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview Utility modules for manipulate DOM elements.\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar snippet = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar domevent = __webpack_require__(/*! ./domevent */ \"./src/js/core/domevent.js\");\n\nvar Collection = __webpack_require__(/*! ./collection */ \"./src/js/core/collection.js\");\n\nvar util = snippet,\n    posKey = '_pos',\n    supportSelectStart = 'onselectstart' in document,\n    prevSelectStyle = '',\n    domutil,\n    userSelectProperty;\nvar CSS_AUTO_REGEX = /^auto$|^$|%/;\n\nfunction trim(str) {\n  return str.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n}\n\ndomutil = {\n  /**\n   * Create DOM element and return it.\n   * @param {string} tagName Tag name to append.\n   * @param {HTMLElement} [container] HTML element will be parent to created element.\n   * if not supplied, will use **document.body**\n   * @param {string} [className] Design class names to appling created element.\n   * @returns {HTMLElement} HTML element created.\n   */\n  appendHTMLElement: function (tagName, container, className) {\n    var el;\n    className = className || '';\n    el = document.createElement(tagName);\n    el.className = className;\n\n    if (container) {\n      container.appendChild(el);\n    } else {\n      document.body.appendChild(el);\n    }\n\n    return el;\n  },\n\n  /**\n   * Remove element from parent node.\n   * @param {HTMLElement} el - element to remove.\n   */\n  remove: function (el) {\n    if (el && el.parentNode) {\n      el.parentNode.removeChild(el);\n    }\n  },\n\n  /**\n   * Get element by id\n   * @param {string} id element id attribute\n   * @returns {HTMLElement} element\n   */\n  get: function (id) {\n    return document.getElementById(id);\n  },\n\n  /**\n   * Check supplied element is matched selector.\n   * @param {HTMLElement} el - element to check\n   * @param {string} selector - selector string to check\n   * @returns {boolean} match?\n   */\n  _matcher: function (el, selector) {\n    var cssClassSelector = /^\\./;\n    var idSelector = /^#/;\n    var result = el.nodeName.toLowerCase() === selector.toLowerCase();\n\n    if (cssClassSelector.test(selector)) {\n      result = domutil.hasClass(el, selector.replace('.', ''));\n    } else if (idSelector.test(selector)) {\n      result = el.id === selector.replace('#', '');\n    }\n\n    return result;\n  },\n\n  /**\n   * Find DOM element by specific selectors.\n   * below three selector only supported.\n   *\n   * 1. css selector\n   * 2. id selector\n   * 3. nodeName selector\n   * @param {string} selector selector\n   * @param {(HTMLElement|string)} [root] You can assign root element to find. if not supplied, document.body will use.\n   * @param {boolean|function} [multiple=false] - set true then return all elements that meet condition, if set function then use it filter function.\n   * @returns {HTMLElement} HTML element finded.\n   */\n  find: function (selector, root, multiple) {\n    var result = [],\n        found = false,\n        isFirst = util.isUndefined(multiple) || multiple === false,\n        isFilter = util.isFunction(multiple);\n\n    if (util.isString(root)) {\n      root = domutil.get(root);\n    }\n\n    root = root || window.document.body;\n\n    function recurse(el, selector) {\n      var childNodes = el.childNodes,\n          i = 0,\n          len = childNodes.length,\n          cursor;\n\n      for (; i < len; i += 1) {\n        cursor = childNodes[i];\n\n        if (cursor.nodeName === '#text') {\n          continue;\n        }\n\n        if (domutil._matcher(cursor, selector)) {\n          if (isFilter && multiple(cursor) || !isFilter) {\n            result.push(cursor);\n          }\n\n          if (isFirst) {\n            found = true;\n            break;\n          }\n        } else if (cursor.childNodes.length > 0) {\n          recurse(cursor, selector);\n\n          if (found) {\n            break;\n          }\n        }\n      }\n    }\n\n    recurse(root, selector);\n    return isFirst ? result[0] || null : result;\n  },\n\n  /**\n   * Find parent element recursively.\n   * @param {HTMLElement} el - base element to start find.\n   * @param {string} selector - selector string for find\n   * @returns {HTMLElement} - element finded or undefined.\n   */\n  closest: function (el, selector) {\n    var parent = el.parentNode;\n\n    if (domutil._matcher(el, selector)) {\n      return el;\n    }\n\n    while (parent && parent !== window.document.body) {\n      if (domutil._matcher(parent, selector)) {\n        return parent;\n      }\n\n      parent = parent.parentNode;\n    }\n  },\n\n  /**\n   * Return texts inside element.\n   * @param {HTMLElement} el target element\n   * @returns {string} text inside node\n   */\n  text: function (el) {\n    var ret = '',\n        i = 0,\n        nodeType = el.nodeType;\n\n    if (nodeType) {\n      if (nodeType === 1 || nodeType === 9 || nodeType === 11) {\n        // nodes that available contain other nodes\n        if (typeof el.textContent === 'string') {\n          return el.textContent;\n        }\n\n        for (el = el.firstChild; el; el = el.nextSibling) {\n          ret += domutil.text(el);\n        }\n      } else if (nodeType === 3 || nodeType === 4) {\n        // TEXT, CDATA SECTION\n        return el.nodeValue;\n      }\n    } else {\n      for (; el[i]; i += 1) {\n        ret += domutil.text(el[i]);\n      }\n    }\n\n    return ret;\n  },\n\n  /**\n   * Set data attribute to target element\n   * @param {HTMLElement} el - element to set data attribute\n   * @param {string} key - key\n   * @param {string|number} data - data value\n   */\n  setData: function (el, key, data) {\n    if ('dataset' in el) {\n      el.dataset[key] = data;\n      return;\n    }\n\n    el.setAttribute('data-' + key, data);\n  },\n\n  /**\n   * Get data value from data-attribute\n   * @param {HTMLElement} el - target element\n   * @param {string} key - key\n   * @returns {string} value\n   */\n  getData: function (el, key) {\n    if ('dataset' in el) {\n      return el.dataset[key];\n    }\n\n    return el.getAttribute('data-' + key);\n  },\n\n  /**\n   * Check element has specific design class name.\n   * @param {HTMLElement} el target element\n   * @param {string} name css class\n   * @returns {boolean} return true when element has that css class name\n   */\n  hasClass: function (el, name) {\n    var className;\n\n    if (!util.isUndefined(el.classList)) {\n      return el.classList.contains(name);\n    }\n\n    className = domutil.getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n  },\n\n  /**\n   * Add design class to HTML element.\n   * @param {HTMLElement} el target element\n   * @param {string} name css class name\n   */\n  addClass: function (el, name) {\n    var className;\n\n    if (!util.isUndefined(el.classList)) {\n      util.forEachArray(name.split(' '), function (value) {\n        el.classList.add(value);\n      });\n    } else if (!domutil.hasClass(el, name)) {\n      className = domutil.getClass(el);\n      domutil.setClass(el, (className ? className + ' ' : '') + name);\n    }\n  },\n\n  /**\n   *\n   * Overwrite design class to HTML element.\n   * @param {HTMLElement} el target element\n   * @param {string} name css class name\n   */\n  setClass: function (el, name) {\n    if (util.isUndefined(el.className.baseVal)) {\n      el.className = name;\n    } else {\n      el.className.baseVal = name;\n    }\n  },\n\n  /**\n   * Element에 cssClass속성을 제거하는 메서드\n   * Remove specific design class from HTML element.\n   * @param {HTMLElement} el target element\n   * @param {string} name class name to remove\n   */\n  removeClass: function (el, name) {\n    var removed = '';\n\n    if (!util.isUndefined(el.classList)) {\n      el.classList.remove(name);\n    } else {\n      removed = (' ' + domutil.getClass(el) + ' ').replace(' ' + name + ' ', ' ');\n      domutil.setClass(el, trim(removed));\n    }\n  },\n\n  /**\n   * Get HTML element's design classes.\n   * @param {HTMLElement} el target element\n   * @returns {string} element css class name\n   */\n  getClass: function (el) {\n    if (!el || !el.className) {\n      return '';\n    }\n\n    return util.isUndefined(el.className.baseVal) ? el.className : el.className.baseVal;\n  },\n\n  /**\n   * Get specific CSS style value from HTML element.\n   * @param {HTMLElement} el target element\n   * @param {string} style css attribute name\n   * @returns {(string|null)} css style value\n   */\n  getStyle: function (el, style) {\n    var value = el.style[style] || el.currentStyle && el.currentStyle[style],\n        css;\n\n    if ((!value || value === 'auto') && document.defaultView) {\n      css = document.defaultView.getComputedStyle(el, null);\n      value = css ? css[style] : null;\n    }\n\n    return value === 'auto' ? null : value;\n  },\n\n  /**\n   * get element's computed style values.\n   *\n   * in lower IE8. use polyfill function that return object. it has only one function 'getPropertyValue'\n   * @param {HTMLElement} el - element want to get style.\n   * @returns {object} virtual CSSStyleDeclaration object.\n   */\n  getComputedStyle: function (el) {\n    var defaultView = document.defaultView;\n\n    if (!defaultView || !defaultView.getComputedStyle) {\n      return {\n        getPropertyValue: function (prop) {\n          var re = /(\\-([a-z]){1})/g;\n\n          if (prop === 'float') {\n            prop = 'styleFloat';\n          }\n\n          if (re.test(prop)) {\n            prop = prop.replace(re, function () {\n              return arguments[2].toUpperCase();\n            });\n          }\n\n          return el.currentStyle[prop] ? el.currentStyle[prop] : null;\n        }\n      };\n    }\n\n    return document.defaultView.getComputedStyle(el);\n  },\n\n  /**\n   * Set position CSS style.\n   * @param {HTMLElement} el target element\n   * @param {number} [x=0] left pixel value.\n   * @param {number} [y=0] top pixel value.\n   */\n  setPosition: function (el, x, y) {\n    x = util.isUndefined(x) ? 0 : x;\n    y = util.isUndefined(y) ? 0 : y;\n    el[posKey] = [x, y];\n    el.style.left = x + 'px';\n    el.style.top = y + 'px';\n  },\n\n  /**\n   * Get position from HTML element.\n   * @param {HTMLElement} el target element\n   * @param {boolean} [clear=false] clear cache before calculating position.\n   * @returns {number[]} point\n   */\n  getPosition: function (el, clear) {\n    var left, top, bound;\n\n    if (clear) {\n      el[posKey] = null;\n    }\n\n    if (el[posKey]) {\n      return el[posKey];\n    }\n\n    left = 0;\n    top = 0;\n\n    if ((CSS_AUTO_REGEX.test(el.style.left) || CSS_AUTO_REGEX.test(el.style.top)) && 'getBoundingClientRect' in el) {\n      // 엘리먼트의 left또는 top이 'auto'일 때 수단\n      bound = el.getBoundingClientRect();\n      left = bound.left;\n      top = bound.top;\n    } else {\n      left = parseFloat(el.style.left || 0);\n      top = parseFloat(el.style.top || 0);\n    }\n\n    return [left, top];\n  },\n\n  /**\n   * Return element's size\n   * @param {HTMLElement} el target element\n   * @returns {number[]} width, height\n   */\n  getSize: function (el) {\n    var bound,\n        width = domutil.getStyle(el, 'width'),\n        height = domutil.getStyle(el, 'height');\n\n    if ((CSS_AUTO_REGEX.test(width) || CSS_AUTO_REGEX.test(height)) && 'getBoundingClientRect' in el) {\n      bound = el.getBoundingClientRect();\n      width = bound.width;\n      height = bound.height;\n    } else {\n      width = parseFloat(width || 0);\n      height = parseFloat(height || 0);\n    }\n\n    return [width, height];\n  },\n\n  /**\n   * Check specific CSS style is available.\n   * @param {array} props property name to testing\n   * @returns {(string|boolean)} return true when property is available\n   * @example\n   * var props = ['transform', '-webkit-transform'];\n   * domutil.testProp(props);    // 'transform'\n   */\n  testProp: function (props) {\n    var style = document.documentElement.style,\n        i = 0,\n        len = props.length;\n\n    for (; i < len; i += 1) {\n      if (props[i] in style) {\n        return props[i];\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * Get form data\n   * @param {HTMLFormElement} formElement - form element to extract data\n   * @returns {object} form data\n   */\n  getFormData: function (formElement) {\n    var groupedByName = new Collection(function () {\n      return this.length;\n    }),\n        noDisabledFilter = function (el) {\n      return !el.disabled;\n    },\n        output = {};\n\n    groupedByName.add.apply(groupedByName, domutil.find('input', formElement, noDisabledFilter).concat(domutil.find('select', formElement, noDisabledFilter)).concat(domutil.find('textarea', formElement, noDisabledFilter)));\n    groupedByName = groupedByName.groupBy(function (el) {\n      return el && el.getAttribute('name') || '_other';\n    });\n    util.forEach(groupedByName, function (elements, name) {\n      if (name === '_other') {\n        return;\n      }\n\n      elements.each(function (el) {\n        var nodeName = el.nodeName.toLowerCase(),\n            type = el.type,\n            result = [];\n\n        if (type === 'radio') {\n          result = [elements.find(function (el) {\n            return el.checked;\n          }).toArray().pop()];\n        } else if (type === 'checkbox') {\n          result = elements.find(function (el) {\n            return el.checked;\n          }).toArray();\n        } else if (nodeName === 'select') {\n          elements.find(function (el) {\n            return !!el.childNodes.length;\n          }).each(function (el) {\n            result = result.concat(domutil.find('option', el, function (opt) {\n              return opt.selected;\n            }));\n          });\n        } else {\n          result = elements.find(function (el) {\n            return el.value !== '';\n          }).toArray();\n        }\n\n        result = util.map(result, function (el) {\n          return el.value;\n        });\n\n        if (!result.length) {\n          result = '';\n        } else if (result.length === 1) {\n          result = result[0];\n        }\n\n        output[name] = result;\n      });\n    });\n    return output;\n  }\n};\nuserSelectProperty = domutil.testProp(['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n/**\n * Disable browser's text selection behaviors.\n * @method\n */\n\ndomutil.disableTextSelection = function () {\n  if (supportSelectStart) {\n    return function () {\n      domevent.on(window, 'selectstart', domevent.preventDefault);\n    };\n  }\n\n  return function () {\n    var style = document.documentElement.style;\n    prevSelectStyle = style[userSelectProperty];\n    style[userSelectProperty] = 'none';\n  };\n}();\n/**\n * Enable browser's text selection behaviors.\n * @method\n */\n\n\ndomutil.enableTextSelection = function () {\n  if (supportSelectStart) {\n    return function () {\n      domevent.off(window, 'selectstart', domevent.preventDefault);\n    };\n  }\n\n  return function () {\n    document.documentElement.style[userSelectProperty] = prevSelectStyle;\n  };\n}();\n/**\n * Disable browser's image drag behaviors.\n */\n\n\ndomutil.disableImageDrag = function () {\n  domevent.on(window, 'dragstart', domevent.preventDefault);\n};\n/**\n * Enable browser's image drag behaviors.\n */\n\n\ndomutil.enableImageDrag = function () {\n  domevent.off(window, 'dragstart', domevent.preventDefault);\n};\n/**\n * Replace matched property with template\n * @param {string} template - String of template\n * @param {Object} propObj - Properties\n * @returns {string} Replaced template string\n */\n\n\ndomutil.applyTemplate = function (template, propObj) {\n  var newTemplate = template.replace(/\\{\\{(\\w*)\\}\\}/g, function (value, prop) {\n    return propObj.hasOwnProperty(prop) ? propObj[prop] : '';\n  });\n  return newTemplate;\n};\n\nmodule.exports = domutil;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/core/domutil.js?")},"./src/js/core/drag.js":function(module,exports,__webpack_require__){"use strict";eval("/* WEBPACK VAR INJECTION */(function(global) {/**\n * @fileoverview General drag handler\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar util = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar domutil = __webpack_require__(/*! ./domutil */ \"./src/js/core/domutil.js\");\n\nvar domevent = __webpack_require__(/*! ./domevent */ \"./src/js/core/domevent.js\");\n/**\n * @constructor\n * @mixes CustomEvents\n * @param {object} options - options for drag handler\n * @param {number} [options.distance=10] - distance in pixels after mouse must move before dragging should start\n * @param {HTMLElement} container - container element to bind drag events\n * @ignore\n */\n\n\nfunction Drag(options, container) {\n  domevent.on(container, 'mousedown', this._onMouseDown, this);\n  this.options = util.extend({\n    distance: 10\n  }, options);\n  /**\n   * @type {HTMLElement}\n   */\n\n  this.container = container;\n  /**\n   * @type {boolean}\n   */\n\n  this._isMoved = false;\n  /**\n   * dragging distance in pixel between mousedown and firing dragStart events\n   * @type {number}\n   */\n\n  this._distance = 0;\n  /**\n   * @type {boolean}\n   */\n\n  this._dragStartFired = false;\n  /**\n   * @type {object}\n   */\n\n  this._dragStartEventData = null;\n}\n/**\n * Destroy method.\n */\n\n\nDrag.prototype.destroy = function () {\n  domevent.off(this.container, 'mousedown', this._onMouseDown, this);\n  this.options = this.container = this._isMoved = this._distance = this._dragStartFired = this._dragStartEventData = null;\n};\n/**\n * Toggle events for mouse dragging.\n * @param {boolean} toBind - bind events related with dragging when supplied \"true\"\n */\n\n\nDrag.prototype._toggleDragEvent = function (toBind) {\n  var container = this.container,\n      domMethod,\n      method;\n\n  if (toBind) {\n    domMethod = 'on';\n    method = 'disable';\n  } else {\n    domMethod = 'off';\n    method = 'enable';\n  }\n\n  domutil[method + 'TextSelection'](container);\n  domutil[method + 'ImageDrag'](container);\n  domevent[domMethod](global.document, {\n    mousemove: this._onMouseMove,\n    mouseup: this._onMouseUp\n  }, this);\n};\n/**\n * Normalize mouse event object.\n * @param {MouseEvent} mouseEvent - mouse event object.\n * @returns {object} normalized mouse event data.\n */\n\n\nDrag.prototype._getEventData = function (mouseEvent) {\n  return {\n    target: mouseEvent.target || mouseEvent.srcElement,\n    originEvent: mouseEvent\n  };\n};\n/**\n * MouseDown DOM event handler.\n * @param {MouseEvent} mouseDownEvent MouseDown event object.\n */\n\n\nDrag.prototype._onMouseDown = function (mouseDownEvent) {\n  // only primary button can start drag.\n  if (domevent.getMouseButton(mouseDownEvent) !== 0) {\n    return;\n  }\n\n  this._distance = 0;\n  this._dragStartFired = false;\n  this._dragStartEventData = this._getEventData(mouseDownEvent);\n\n  this._toggleDragEvent(true);\n};\n/**\n * MouseMove DOM event handler.\n * @emits Drag#drag\n * @emits Drag#dragStart\n * @param {MouseEvent} mouseMoveEvent MouseMove event object.\n */\n\n\nDrag.prototype._onMouseMove = function (mouseMoveEvent) {\n  var distance = this.options.distance; // prevent automatic scrolling.\n\n  domevent.preventDefault(mouseMoveEvent);\n  this._isMoved = true;\n\n  if (this._distance < distance) {\n    this._distance += 1;\n    return;\n  }\n\n  if (!this._dragStartFired) {\n    this._dragStartFired = true;\n    /**\n     * Drag starts events. cancelable.\n     * @event Drag#dragStart\n     * @type {object}\n     * @property {HTMLElement} target - target element in this event.\n     * @property {MouseEvent} originEvent - original mouse event object.\n     */\n\n    if (!this.invoke('dragStart', this._dragStartEventData)) {\n      this._toggleDragEvent(false);\n\n      return;\n    }\n  }\n  /**\n   * Events while dragging.\n   * @event Drag#drag\n   * @type {object}\n   * @property {HTMLElement} target - target element in this event.\n   * @property {MouseEvent} originEvent - original mouse event object.\n   */\n\n\n  this.fire('drag', this._getEventData(mouseMoveEvent));\n};\n/**\n * MouseUp DOM event handler.\n * @param {MouseEvent} mouseUpEvent MouseUp event object.\n * @emits Drag#dragEnd\n * @emits Drag#click\n */\n\n\nDrag.prototype._onMouseUp = function (mouseUpEvent) {\n  this._toggleDragEvent(false); // emit \"click\" event when not emitted drag event between mousedown and mouseup.\n\n\n  if (this._isMoved) {\n    this._isMoved = false;\n    /**\n     * Drag end events.\n     * @event Drag#dragEnd\n     * @type {MouseEvent}\n     * @property {HTMLElement} target - target element in this event.\n     * @property {MouseEvent} originEvent - original mouse event object.\n     */\n\n    this.fire('dragEnd', this._getEventData(mouseUpEvent));\n    return;\n  }\n  /**\n   * Click events.\n   * @event Drag#click\n   * @type {MouseEvent}\n   * @property {HTMLElement} target - target element in this event.\n   * @property {MouseEvent} originEvent - original mouse event object.\n   */\n\n\n  this.fire('click', this._getEventData(mouseUpEvent));\n};\n\nutil.CustomEvents.mixin(Drag);\nmodule.exports = Drag;\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../node_modules/webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\")))\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/core/drag.js?")},"./src/js/core/view.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview The base class of views.\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar util = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar domutil = __webpack_require__(/*! ./domutil */ \"./src/js/core/domutil.js\");\n\nvar Collection = __webpack_require__(/*! ./collection */ \"./src/js/core/collection.js\");\n/**\n * Base class of views.\n *\n * All views create own container element inside supplied container element.\n * @constructor\n * @param {options} options The object for describe view's specs.\n * @param {HTMLElement} container Default container element for view. you can use this element for this.container syntax.\n * @ignore\n */\n\n\nfunction View(options, container) {\n  var id = util.stamp(this);\n  options = options || {};\n\n  if (util.isUndefined(container)) {\n    container = domutil.appendHTMLElement('div');\n  }\n\n  domutil.addClass(container, 'tui-view-' + id);\n  /**\n   * unique id\n   * @type {number}\n   */\n\n  this.id = id;\n  /**\n   * base element of view.\n   * @type {HTMLDIVElement}\n   */\n\n  this.container = container;\n  /**\n   * child views.\n   * @type {Collection}\n   */\n\n  this.childs = new Collection(function (view) {\n    return util.stamp(view);\n  });\n  /**\n   * parent view instance.\n   * @type {View}\n   */\n\n  this.parent = null;\n}\n/**\n * Add child views.\n * @param {View} view The view instance to add.\n * @param {function} [fn] Function for invoke before add. parent view class is supplied first arguments.\n */\n\n\nView.prototype.addChild = function (view, fn) {\n  if (fn) {\n    fn.call(view, this);\n  } // add parent view\n\n\n  view.parent = this;\n  this.childs.add(view);\n};\n/**\n * Remove added child view.\n * @param {(number|View)} id View id or instance itself to remove.\n * @param {function} [fn] Function for invoke before remove. parent view class is supplied first arguments.\n */\n\n\nView.prototype.removeChild = function (id, fn) {\n  var view = util.isNumber(id) ? this.childs.items[id] : id;\n  id = util.stamp(view);\n\n  if (fn) {\n    fn.call(view, this);\n  }\n\n  this.childs.remove(id);\n};\n/**\n * Render view recursively.\n */\n\n\nView.prototype.render = function () {\n  this.childs.each(function (childView) {\n    childView.render();\n  });\n};\n/**\n * Invoke function recursively.\n * @param {function} fn - function to invoke child view recursively\n * @param {boolean} [skipThis=false] - set true then skip invoke with this(root) view.\n */\n\n\nView.prototype.recursive = function (fn, skipThis) {\n  if (!util.isFunction(fn)) {\n    return;\n  }\n\n  if (!skipThis) {\n    fn(this);\n  }\n\n  this.childs.each(function (childView) {\n    childView.recursive(fn);\n  });\n};\n/**\n * Resize view recursively to parent.\n */\n\n\nView.prototype.resize = function () {\n  var args = Array.prototype.slice.call(arguments),\n      parent = this.parent;\n\n  while (parent) {\n    if (util.isFunction(parent._onResize)) {\n      parent._onResize.apply(parent, args);\n    }\n\n    parent = parent.parent;\n  }\n};\n/**\n * Invoking method before destroying.\n */\n\n\nView.prototype._beforeDestroy = function () {};\n/**\n * Clear properties\n */\n\n\nView.prototype._destroy = function () {\n  this._beforeDestroy();\n\n  this.childs.clear();\n  this.container.innerHTML = '';\n  this.id = this.parent = this.childs = this.container = null;\n};\n/**\n * Destroy child view recursively.\n * @param {boolean} isChildView - Whether it is the child view or not\n */\n\n\nView.prototype.destroy = function (isChildView) {\n  this.childs.each(function (childView) {\n    childView.destroy(true);\n\n    childView._destroy();\n  });\n\n  if (isChildView) {\n    return;\n  }\n\n  this._destroy();\n};\n/**\n * Calculate view's container element bound.\n * @returns {object} The bound of container element.\n */\n\n\nView.prototype.getViewBound = function () {\n  var container = this.container,\n      position = domutil.getPosition(container),\n      size = domutil.getSize(container);\n  return {\n    x: position[0],\n    y: position[1],\n    width: size[0],\n    height: size[1]\n  };\n};\n\nmodule.exports = View;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/core/view.js?")},"./src/js/factory.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview ColorPicker factory module\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar util = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar colorutil = __webpack_require__(/*! ./colorutil */ \"./src/js/colorutil.js\");\n\nvar Layout = __webpack_require__(/*! ./layout */ \"./src/js/layout.js\");\n\nvar Palette = __webpack_require__(/*! ./palette */ \"./src/js/palette.js\");\n\nvar Slider = __webpack_require__(/*! ./slider */ \"./src/js/slider.js\");\n/**\n * Create an unique id for a color-picker instance.\n * @private\n */\n\n\nvar currentId = 0;\n\nfunction generateId() {\n  currentId += 1;\n  return currentId;\n}\n/**\n * @constructor\n * @param {object} options - options for colorpicker component\n *  @param {HTMLDivElement} options.container - container element\n *  @param {string} [options.color='#ffffff'] - default selected color\n *  @param {string[]} [options.preset] - color preset for palette (use base16 palette if not supplied)\n *  @param {string} [options.cssPrefix='tui-colorpicker-'] - css prefix text for each child elements\n *  @param {string} [options.detailTxt='Detail'] - text for detail button.\n *  @param {boolean} [options.usageStatistics=true] - Let us know the hostname. If you don't want to send the hostname, please set to false.\n * @example\n * var colorPicker = tui.colorPicker; // or require('tui-color-picker')\n *\n * var instance = colorPicker.create({\n *   container: document.getElementById('color-picker')\n * });\n */\n\n\nfunction ColorPicker(options) {\n  var layout;\n\n  if (!(this instanceof ColorPicker)) {\n    return new ColorPicker(options);\n  }\n  /**\n   * Option object\n   * @type {object}\n   * @private\n   */\n\n\n  options = this.options = util.extend({\n    container: null,\n    color: '#f8f8f8',\n    preset: ['#181818', '#282828', '#383838', '#585858', '#b8b8b8', '#d8d8d8', '#e8e8e8', '#f8f8f8', '#ab4642', '#dc9656', '#f7ca88', '#a1b56c', '#86c1b9', '#7cafc2', '#ba8baf', '#a16946'],\n    cssPrefix: 'tui-colorpicker-',\n    detailTxt: 'Detail',\n    id: generateId(),\n    usageStatistics: true\n  }, options);\n\n  if (!options.container) {\n    throw new Error('ColorPicker(): need container option.');\n  }\n  /**********\n   * Create layout view\n   **********/\n\n  /**\n   * @type {Layout}\n   * @private\n   */\n\n\n  layout = this.layout = new Layout(options, options.container);\n  /**********\n   * Create palette view\n   **********/\n\n  this.palette = new Palette(options, layout.container);\n  this.palette.on({\n    _selectColor: this._onSelectColorInPalette,\n    _toggleSlider: this._onToggleSlider\n  }, this);\n  /**********\n   * Create slider view\n   **********/\n\n  this.slider = new Slider(options, layout.container);\n  this.slider.on('_selectColor', this._onSelectColorInSlider, this);\n  /**********\n   * Add child views\n   **********/\n\n  layout.addChild(this.palette);\n  layout.addChild(this.slider);\n  this.render(options.color);\n\n  if (options.usageStatistics) {\n    util.sendHostname('color-picker', 'UA-129987462-1');\n  }\n}\n/**\n * Handler method for Palette#_selectColor event\n * @private\n * @fires ColorPicker#selectColor\n * @param {object} selectColorEventData - event data\n */\n\n\nColorPicker.prototype._onSelectColorInPalette = function (selectColorEventData) {\n  var color = selectColorEventData.color,\n      opt = this.options;\n\n  if (!colorutil.isValidRGB(color) && color !== '') {\n    this.render();\n    return;\n  }\n  /**\n   * @event ColorPicker#selectColor\n   * @type {object}\n   * @property {string} color - selected color (hex string)\n   * @property {string} origin - flags for represent the source of event fires.\n   */\n\n\n  this.fire('selectColor', {\n    color: color,\n    origin: 'palette'\n  });\n\n  if (opt.color === color) {\n    return;\n  }\n\n  opt.color = color;\n  this.render(color);\n};\n/**\n * Handler method for Palette#_toggleSlider event\n * @private\n */\n\n\nColorPicker.prototype._onToggleSlider = function () {\n  this.slider.toggle(!this.slider.isVisible());\n};\n/**\n * Handler method for Slider#_selectColor event\n * @private\n * @fires ColorPicker#selectColor\n * @param {object} selectColorEventData - event data\n */\n\n\nColorPicker.prototype._onSelectColorInSlider = function (selectColorEventData) {\n  var color = selectColorEventData.color,\n      opt = this.options;\n  /**\n   * @event ColorPicker#selectColor\n   * @type {object}\n   * @property {string} color - selected color (hex string)\n   * @property {string} origin - flags for represent the source of event fires.\n   * @ignore\n   */\n\n  this.fire('selectColor', {\n    color: color,\n    origin: 'slider'\n  });\n\n  if (opt.color === color) {\n    return;\n  }\n\n  opt.color = color;\n  this.palette.render(color);\n};\n/**********\n * PUBLIC API\n **********/\n\n/**\n * Set color to colorpicker instance.<br>\n * The string parameter must be hex color value\n * @param {string} hexStr - hex formatted color string\n * @example\n * instance.setColor('#ffff00');\n */\n\n\nColorPicker.prototype.setColor = function (hexStr) {\n  if (!colorutil.isValidRGB(hexStr)) {\n    throw new Error('ColorPicker#setColor(): need valid hex string color value');\n  }\n\n  this.options.color = hexStr;\n  this.render(hexStr);\n};\n/**\n * Get hex color string of current selected color in colorpicker instance.\n * @returns {string} hex string formatted color\n * @example\n * instance.setColor('#ffff00');\n * instance.getColor(); // '#ffff00';\n */\n\n\nColorPicker.prototype.getColor = function () {\n  return this.options.color;\n};\n/**\n * Toggle colorpicker element. set true then reveal colorpicker view.\n * @param {boolean} [isShow=false] - A flag to show\n * @example\n * instance.toggle(false); // hide\n * instance.toggle(); // hide\n * instance.toggle(true); // show\n */\n\n\nColorPicker.prototype.toggle = function (isShow) {\n  this.layout.container.style.display = !!isShow ? 'block' : 'none';\n};\n/**\n * Render colorpicker\n * @param {string} [color] - selected color\n * @ignore\n */\n\n\nColorPicker.prototype.render = function (color) {\n  this.layout.render(color || this.options.color);\n};\n/**\n * Destroy colorpicker instance.\n * @example\n * instance.destroy(); // DOM-element is removed\n */\n\n\nColorPicker.prototype.destroy = function () {\n  this.layout.destroy();\n  this.options.container.innerHTML = '';\n  this.layout = this.slider = this.palette = this.options = null;\n};\n\nutil.CustomEvents.mixin(ColorPicker);\nmodule.exports = ColorPicker;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/factory.js?")},"./src/js/index.js":function(module,exports,__webpack_require__){"use strict";eval('\n\nvar domutil = __webpack_require__(/*! ./core/domutil */ "./src/js/core/domutil.js");\n\nvar domevent = __webpack_require__(/*! ./core/domevent */ "./src/js/core/domevent.js");\n\nvar Collection = __webpack_require__(/*! ./core/collection */ "./src/js/core/collection.js");\n\nvar View = __webpack_require__(/*! ./core/view */ "./src/js/core/view.js");\n\nvar Drag = __webpack_require__(/*! ./core/drag */ "./src/js/core/drag.js");\n\nvar create = __webpack_require__(/*! ./factory */ "./src/js/factory.js");\n\nvar Palette = __webpack_require__(/*! ./palette */ "./src/js/palette.js");\n\nvar Slider = __webpack_require__(/*! ./slider */ "./src/js/slider.js");\n\nvar colorutil = __webpack_require__(/*! ./colorutil */ "./src/js/colorutil.js");\n\nvar svgvml = __webpack_require__(/*! ./svgvml */ "./src/js/svgvml.js");\n\nvar colorPicker = {\n  domutil: domutil,\n  domevent: domevent,\n  Collection: Collection,\n  View: View,\n  Drag: Drag,\n  create: create,\n  Palette: Palette,\n  Slider: Slider,\n  colorutil: colorutil,\n  svgvml: svgvml\n};\nmodule.exports = colorPicker;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/index.js?')},"./src/js/layout.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview ColorPicker layout module\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar util = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar domutil = __webpack_require__(/*! ./core/domutil */ \"./src/js/core/domutil.js\");\n\nvar View = __webpack_require__(/*! ./core/view */ \"./src/js/core/view.js\");\n/**\n * @constructor\n * @extends {View}\n * @param {object} options - option object\n *  @param {string} options.cssPrefix - css prefix for each child elements\n * @param {HTMLDivElement} container - container\n * @ignore\n */\n\n\nfunction Layout(options, container) {\n  /**\n   * option object\n   * @type {object}\n   */\n  this.options = util.extend({\n    cssPrefix: 'tui-colorpicker-'\n  }, options);\n  container = domutil.appendHTMLElement('div', container, this.options.cssPrefix + 'container');\n  View.call(this, options, container);\n  this.render();\n}\n\nutil.inherit(Layout, View);\n/**\n * @override\n * @param {string} [color] - selected color\n */\n\nLayout.prototype.render = function (color) {\n  this.recursive(function (view) {\n    view.render(color);\n  }, true);\n};\n\nmodule.exports = Layout;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/layout.js?")},"./src/js/palette.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview Color palette view\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar util = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar domutil = __webpack_require__(/*! ./core/domutil */ \"./src/js/core/domutil.js\");\n\nvar colorutil = __webpack_require__(/*! ./colorutil */ \"./src/js/colorutil.js\");\n\nvar domevent = __webpack_require__(/*! ./core/domevent */ \"./src/js/core/domevent.js\");\n\nvar View = __webpack_require__(/*! ./core/view */ \"./src/js/core/view.js\");\n\nvar tmpl = __webpack_require__(/*! ../template/palette */ \"./src/template/palette.js\");\n/**\n * @constructor\n * @extends {View}\n * @mixes CustomEvents\n * @param {object} options - options for color palette view\n *  @param {string[]} options.preset - color list\n * @param {HTMLDivElement} container - container element\n * @ignore\n */\n\n\nfunction Palette(options, container) {\n  /**\n   * option object\n   * @type {object}\n   */\n  this.options = util.extend({\n    cssPrefix: 'tui-colorpicker-',\n    preset: ['#181818', '#282828', '#383838', '#585858', '#B8B8B8', '#D8D8D8', '#E8E8E8', '#F8F8F8', '#AB4642', '#DC9656', '#F7CA88', '#A1B56C', '#86C1B9', '#7CAFC2', '#BA8BAF', '#A16946'],\n    detailTxt: 'Detail'\n  }, options);\n  container = domutil.appendHTMLElement('div', container, this.options.cssPrefix + 'palette-container');\n  View.call(this, options, container);\n}\n\nutil.inherit(Palette, View);\n/**\n * Mouse click event handler\n * @fires Palette#_selectColor\n * @fires Palette#_toggleSlider\n * @param {MouseEvent} clickEvent - mouse event object\n */\n\nPalette.prototype._onClick = function (clickEvent) {\n  var options = this.options,\n      target = clickEvent.srcElement || clickEvent.target,\n      eventData = {};\n\n  if (domutil.hasClass(target, options.cssPrefix + 'palette-button')) {\n    eventData.color = target.value;\n    /**\n     * @event Palette#_selectColor\n     * @type {object}\n     * @property {string} color - selected color value\n     */\n\n    this.fire('_selectColor', eventData);\n    return;\n  }\n\n  if (domutil.hasClass(target, options.cssPrefix + 'palette-toggle-slider')) {\n    /**\n     * @event Palette#_toggleSlider\n     */\n    this.fire('_toggleSlider');\n  }\n};\n/**\n * Textbox change event handler\n * @fires Palette#_selectColor\n * @param {Event} changeEvent - change event object\n */\n\n\nPalette.prototype._onChange = function (changeEvent) {\n  var options = this.options,\n      target = changeEvent.srcElement || changeEvent.target,\n      eventData = {};\n\n  if (domutil.hasClass(target, options.cssPrefix + 'palette-hex')) {\n    eventData.color = target.value;\n    /**\n     * @event Palette#_selectColor\n     * @type {object}\n     * @property {string} color - selected color value\n     */\n\n    this.fire('_selectColor', eventData);\n  }\n};\n/**\n * Invoke before destory\n * @override\n */\n\n\nPalette.prototype._beforeDestroy = function () {\n  this._toggleEvent(false);\n};\n/**\n * Toggle view DOM events\n * @param {boolean} [onOff=false] - true to bind event.\n */\n\n\nPalette.prototype._toggleEvent = function (onOff) {\n  var options = this.options,\n      container = this.container,\n      method = domevent[!!onOff ? 'on' : 'off'],\n      hexTextBox;\n  method(container, 'click', this._onClick, this);\n  hexTextBox = domutil.find('.' + options.cssPrefix + 'palette-hex', container);\n\n  if (hexTextBox) {\n    method(hexTextBox, 'change', this._onChange, this);\n  }\n};\n/**\n * Render palette\n * @override\n */\n\n\nPalette.prototype.render = function (color) {\n  var options = this.options,\n      html = '';\n\n  this._toggleEvent(false);\n\n  html = tmpl.layout.replace('{{colorList}}', util.map(options.preset, function (itemColor) {\n    var itemHtml = '';\n    var style = '';\n\n    if (colorutil.isValidRGB(itemColor)) {\n      style = domutil.applyTemplate(tmpl.itemStyle, {\n        color: itemColor\n      });\n    }\n\n    itemHtml = domutil.applyTemplate(tmpl.item, {\n      itemStyle: style,\n      itemClass: !itemColor ? ' ' + options.cssPrefix + 'color-transparent' : '',\n      color: itemColor,\n      cssPrefix: options.cssPrefix,\n      selected: itemColor === color ? ' ' + options.cssPrefix + 'selected' : ''\n    });\n    return itemHtml;\n  }).join(''));\n  html = domutil.applyTemplate(html, {\n    cssPrefix: options.cssPrefix,\n    detailTxt: options.detailTxt,\n    color: color\n  });\n  this.container.innerHTML = html;\n\n  this._toggleEvent(true);\n};\n\nutil.CustomEvents.mixin(Palette);\nmodule.exports = Palette;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/palette.js?")},"./src/js/slider.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview Slider view\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar util = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar domutil = __webpack_require__(/*! ./core/domutil */ \"./src/js/core/domutil.js\");\n\nvar domevent = __webpack_require__(/*! ./core/domevent */ \"./src/js/core/domevent.js\");\n\nvar svgvml = __webpack_require__(/*! ./svgvml */ \"./src/js/svgvml.js\");\n\nvar colorutil = __webpack_require__(/*! ./colorutil */ \"./src/js/colorutil.js\");\n\nvar View = __webpack_require__(/*! ./core/view */ \"./src/js/core/view.js\");\n\nvar Drag = __webpack_require__(/*! ./core/drag */ \"./src/js/core/drag.js\");\n\nvar tmpl = __webpack_require__(/*! ../template/slider */ \"./src/template/slider.js\"); // Limitation position of point element inside of colorslider and hue bar\n// Minimum value can to be negative because that using color point of handle element is center point. not left, top point.\n\n\nvar COLORSLIDER_POS_LIMIT_RANGE = [-7, 112];\nvar HUEBAR_POS_LIMIT_RANGE = [-3, 115];\nvar HUE_WHEEL_MAX = 359.99;\n/**\n * @constructor\n * @extends {View}\n * @mixes CustomEvents\n * @param {object} options - options for view\n *  @param {string} options.cssPrefix - design css prefix\n * @param {HTMLElement} container - container element\n * @ignore\n */\n\nfunction Slider(options, container) {\n  container = domutil.appendHTMLElement('div', container, options.cssPrefix + 'slider-container');\n  container.style.display = 'none';\n  View.call(this, options, container);\n  /**\n   * @type {object}\n   */\n\n  this.options = util.extend({\n    color: '#f8f8f8',\n    cssPrefix: 'tui-colorpicker-'\n  }, options);\n  /**\n   * Cache immutable data in click, drag events.\n   *\n   * (i.e. is event related with colorslider? or huebar?)\n   * @type {object}\n   * @property {boolean} isColorSlider\n   * @property {number[]} containerSize\n   */\n\n  this._dragDataCache = {};\n  /**\n   * Color slider handle element\n   * @type {SVG|VML}\n   */\n\n  this.sliderHandleElement = null;\n  /**\n   * hue bar handle element\n   * @type {SVG|VML}\n   */\n\n  this.huebarHandleElement = null;\n  /**\n   * Element that render base color in colorslider part\n   * @type {SVG|VML}\n   */\n\n  this.baseColorElement = null;\n  /**\n   * @type {Drag}\n   */\n\n  this.drag = new Drag({\n    distance: 0\n  }, container); // bind drag events\n\n  this.drag.on({\n    dragStart: this._onDragStart,\n    drag: this._onDrag,\n    dragEnd: this._onDragEnd,\n    click: this._onClick\n  }, this);\n}\n\nutil.inherit(Slider, View);\n/**\n * @override\n */\n\nSlider.prototype._beforeDestroy = function () {\n  this.drag.off();\n  this.drag = this.options = this._dragDataCache = this.sliderHandleElement = this.huebarHandleElement = this.baseColorElement = null;\n};\n/**\n * Toggle slider view\n * @param {boolean} onOff - set true then reveal slider view\n */\n\n\nSlider.prototype.toggle = function (onOff) {\n  this.container.style.display = !!onOff ? 'block' : 'none';\n};\n/**\n * Get slider display status\n * @returns {boolean} return true when slider is visible\n */\n\n\nSlider.prototype.isVisible = function () {\n  return this.container.style.display === 'block';\n};\n/**\n * Render slider view\n * @override\n * @param {string} colorStr - hex string color from parent view (Layout)\n */\n\n\nSlider.prototype.render = function (colorStr) {\n  var that = this,\n      container = that.container,\n      options = that.options,\n      html = tmpl.layout,\n      rgb,\n      hsv;\n\n  if (!colorutil.isValidRGB(colorStr)) {\n    return;\n  }\n\n  html = html.replace(/{{slider}}/, tmpl.slider);\n  html = html.replace(/{{huebar}}/, tmpl.huebar);\n  html = html.replace(/{{cssPrefix}}/g, options.cssPrefix);\n  html = html.replace(/{{id}}/g, options.id);\n  that.container.innerHTML = html;\n  that.sliderHandleElement = domutil.find('.' + options.cssPrefix + 'slider-handle', container);\n  that.huebarHandleElement = domutil.find('.' + options.cssPrefix + 'huebar-handle', container);\n  that.baseColorElement = domutil.find('.' + options.cssPrefix + 'slider-basecolor', container);\n  rgb = colorutil.hexToRGB(colorStr);\n  hsv = colorutil.rgbToHSV.apply(null, rgb);\n  this.moveHue(hsv[0], true);\n  this.moveSaturationAndValue(hsv[1], hsv[2], true);\n};\n/**\n * Move colorslider by newLeft(X), newTop(Y) value\n * @private\n * @param {number} newLeft - left pixel value to move handle\n * @param {number} newTop - top pixel value to move handle\n * @param {boolean} [silent=false] - set true then not fire custom event\n */\n\n\nSlider.prototype._moveColorSliderHandle = function (newLeft, newTop, silent) {\n  var handle = this.sliderHandleElement,\n      handleColor; // Check position limitation.\n\n  newTop = Math.max(COLORSLIDER_POS_LIMIT_RANGE[0], newTop);\n  newTop = Math.min(COLORSLIDER_POS_LIMIT_RANGE[1], newTop);\n  newLeft = Math.max(COLORSLIDER_POS_LIMIT_RANGE[0], newLeft);\n  newLeft = Math.min(COLORSLIDER_POS_LIMIT_RANGE[1], newLeft);\n  svgvml.setTranslateXY(handle, newLeft, newTop);\n  handleColor = newTop > 50 ? 'white' : 'black';\n  svgvml.setStrokeColor(handle, handleColor);\n\n  if (!silent) {\n    this.fire('_selectColor', {\n      color: colorutil.rgbToHEX.apply(null, this.getRGB())\n    });\n  }\n};\n/**\n * Move colorslider by supplied saturation and values.\n *\n * The movement of color slider handle follow HSV cylinder model. {@link https://en.wikipedia.org/wiki/HSL_and_HSV}\n * @param {number} saturation - the percent of saturation (0% ~ 100%)\n * @param {number} value - the percent of saturation (0% ~ 100%)\n * @param {boolean} [silent=false] - set true then not fire custom event\n */\n\n\nSlider.prototype.moveSaturationAndValue = function (saturation, value, silent) {\n  var absMin, maxValue, newLeft, newTop;\n  saturation = saturation || 0;\n  value = value || 0;\n  absMin = Math.abs(COLORSLIDER_POS_LIMIT_RANGE[0]);\n  maxValue = COLORSLIDER_POS_LIMIT_RANGE[1]; // subtract absMin value because current color position is not left, top of handle element.\n  // The saturation. from left 0 to right 100\n\n  newLeft = saturation * maxValue / 100 - absMin; // The Value. from top 100 to bottom 0. that why newTop subtract by maxValue.\n\n  newTop = maxValue - value * maxValue / 100 - absMin;\n\n  this._moveColorSliderHandle(newLeft, newTop, silent);\n};\n/**\n * Move color slider handle to supplied position\n *\n * The number of X, Y must be related value from color slider container\n * @private\n * @param {number} x - the pixel value to move handle\n * @param {number} y - the pixel value to move handle\n */\n\n\nSlider.prototype._moveColorSliderByPosition = function (x, y) {\n  var offset = COLORSLIDER_POS_LIMIT_RANGE[0];\n\n  this._moveColorSliderHandle(x + offset, y + offset);\n};\n/**\n * Get saturation and value value.\n * @returns {number[]} saturation and value\n */\n\n\nSlider.prototype.getSaturationAndValue = function () {\n  var absMin = Math.abs(COLORSLIDER_POS_LIMIT_RANGE[0]),\n      maxValue = absMin + COLORSLIDER_POS_LIMIT_RANGE[1],\n      position = svgvml.getTranslateXY(this.sliderHandleElement),\n      saturation,\n      value;\n  saturation = (position[1] + absMin) / maxValue * 100; // The value of HSV color model is inverted. top 100 ~ bottom 0. so subtract by 100\n\n  value = 100 - (position[0] + absMin) / maxValue * 100;\n  return [saturation, value];\n};\n/**\n * Move hue handle supplied pixel value\n * @private\n * @param {number} newTop - pixel to move hue handle\n * @param {boolean} [silent=false] - set true then not fire custom event\n */\n\n\nSlider.prototype._moveHueHandle = function (newTop, silent) {\n  var hueHandleElement = this.huebarHandleElement,\n      baseColorElement = this.baseColorElement,\n      newGradientColor,\n      hexStr;\n  newTop = Math.max(HUEBAR_POS_LIMIT_RANGE[0], newTop);\n  newTop = Math.min(HUEBAR_POS_LIMIT_RANGE[1], newTop);\n  svgvml.setTranslateY(hueHandleElement, newTop);\n  newGradientColor = colorutil.hsvToRGB(this.getHue(), 100, 100);\n  hexStr = colorutil.rgbToHEX.apply(null, newGradientColor);\n  svgvml.setGradientColorStop(baseColorElement, hexStr);\n\n  if (!silent) {\n    this.fire('_selectColor', {\n      color: colorutil.rgbToHEX.apply(null, this.getRGB())\n    });\n  }\n};\n/**\n * Move hue bar handle by supplied degree\n * @param {number} degree - (0 ~ 359.9 degree)\n * @param {boolean} [silent=false] - set true then not fire custom event\n */\n\n\nSlider.prototype.moveHue = function (degree, silent) {\n  var newTop = 0,\n      absMin,\n      maxValue;\n  absMin = Math.abs(HUEBAR_POS_LIMIT_RANGE[0]);\n  maxValue = absMin + HUEBAR_POS_LIMIT_RANGE[1];\n  degree = degree || 0;\n  newTop = maxValue * degree / HUE_WHEEL_MAX - absMin;\n\n  this._moveHueHandle(newTop, silent);\n};\n/**\n * Move hue bar handle by supplied percent\n * @private\n * @param {number} y - pixel value to move hue handle\n */\n\n\nSlider.prototype._moveHueByPosition = function (y) {\n  var offset = HUEBAR_POS_LIMIT_RANGE[0];\n\n  this._moveHueHandle(y + offset);\n};\n/**\n * Get huebar handle position by color degree\n * @returns {number} degree (0 ~ 359.9 degree)\n */\n\n\nSlider.prototype.getHue = function () {\n  var handle = this.huebarHandleElement,\n      position = svgvml.getTranslateXY(handle),\n      absMin,\n      maxValue;\n  absMin = Math.abs(HUEBAR_POS_LIMIT_RANGE[0]);\n  maxValue = absMin + HUEBAR_POS_LIMIT_RANGE[1]; // maxValue : 359.99 = pos.y : x\n\n  return (position[0] + absMin) * HUE_WHEEL_MAX / maxValue;\n};\n/**\n * Get HSV value from slider\n * @returns {number[]} hsv values\n */\n\n\nSlider.prototype.getHSV = function () {\n  var sv = this.getSaturationAndValue(),\n      h = this.getHue();\n  return [h].concat(sv);\n};\n/**\n * Get RGB value from slider\n * @returns {number[]} RGB value\n */\n\n\nSlider.prototype.getRGB = function () {\n  return colorutil.hsvToRGB.apply(null, this.getHSV());\n};\n/**********\n * Drag event handler\n **********/\n\n/**\n * Cache immutable data when dragging or click view\n * @param {object} event - Click, DragStart event.\n * @returns {object} cached data.\n */\n\n\nSlider.prototype._prepareColorSliderForMouseEvent = function (event) {\n  var options = this.options,\n      sliderPart = domutil.closest(event.target, '.' + options.cssPrefix + 'slider-part'),\n      cache;\n  cache = this._dragDataCache = {\n    isColorSlider: domutil.hasClass(sliderPart, options.cssPrefix + 'slider-left'),\n    parentElement: sliderPart\n  };\n  return cache;\n};\n/**\n * Click event handler\n * @param {object} clickEvent - Click event from Drag module\n */\n\n\nSlider.prototype._onClick = function (clickEvent) {\n  var cache = this._prepareColorSliderForMouseEvent(clickEvent),\n      mousePos = domevent.getMousePosition(clickEvent.originEvent, cache.parentElement);\n\n  if (cache.isColorSlider) {\n    this._moveColorSliderByPosition(mousePos[0], mousePos[1]);\n  } else {\n    this._moveHueByPosition(mousePos[1]);\n  }\n\n  this._dragDataCache = null;\n};\n/**\n * DragStart event handler\n * @param {object} dragStartEvent - dragStart event data from Drag#dragStart\n */\n\n\nSlider.prototype._onDragStart = function (dragStartEvent) {\n  this._prepareColorSliderForMouseEvent(dragStartEvent);\n};\n/**\n * Drag event handler\n * @param {Drag#drag} dragEvent - drag event data\n */\n\n\nSlider.prototype._onDrag = function (dragEvent) {\n  var cache = this._dragDataCache,\n      mousePos = domevent.getMousePosition(dragEvent.originEvent, cache.parentElement);\n\n  if (cache.isColorSlider) {\n    this._moveColorSliderByPosition(mousePos[0], mousePos[1]);\n  } else {\n    this._moveHueByPosition(mousePos[1]);\n  }\n};\n/**\n * Drag#dragEnd event handler\n */\n\n\nSlider.prototype._onDragEnd = function () {\n  this._dragDataCache = null;\n};\n\nutil.CustomEvents.mixin(Slider);\nmodule.exports = Slider;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/slider.js?")},"./src/js/svgvml.js":function(module,exports,__webpack_require__){"use strict";eval("/**\n * @fileoverview module for manipulate SVG or VML object\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar util = __webpack_require__(/*! tui-code-snippet */ \"tui-code-snippet\");\n\nvar PARSE_TRANSLATE_NUM_REGEX = /[\\.\\-0-9]+/g;\nvar SVG_HUE_HANDLE_RIGHT_POS = -6;\n/* istanbul ignore next */\n\nvar svgvml = {\n  /**\n   * Return true when browser is below IE8.\n   * @returns {boolean} is old browser?\n   */\n  isOldBrowser: function () {\n    var _isOldBrowser = svgvml._isOldBrowser;\n\n    if (!util.isExisty(_isOldBrowser)) {\n      svgvml._isOldBrowser = _isOldBrowser = util.browser.msie && util.browser.version < 9;\n    }\n\n    return _isOldBrowser;\n  },\n\n  /**\n   * Get translate transform value\n   * @param {SVG|VML} obj - svg or vml object that want to know translate x, y\n   * @returns {number[]} translated coordinates [x, y]\n   */\n  getTranslateXY: function (obj) {\n    var temp;\n\n    if (svgvml.isOldBrowser()) {\n      temp = obj.style;\n      return [parseFloat(temp.top), parseFloat(temp.left)];\n    }\n\n    temp = obj.getAttribute('transform');\n\n    if (!temp) {\n      return [0, 0];\n    }\n\n    temp = temp.match(PARSE_TRANSLATE_NUM_REGEX); // need caution for difference of VML, SVG coordinates system.\n    // translate command need X coords in first parameter. but VML is use CSS coordinate system(top, left)\n\n    return [parseFloat(temp[1]), parseFloat(temp[0])];\n  },\n\n  /**\n   * Set translate transform value\n   * @param {SVG|VML} obj - SVG or VML object to setting translate transform.\n   * @param {number} x - translate X value\n   * @param {number} y - translate Y value\n   */\n  setTranslateXY: function (obj, x, y) {\n    if (svgvml.isOldBrowser()) {\n      obj.style.left = x + 'px';\n      obj.style.top = y + 'px';\n    } else {\n      obj.setAttribute('transform', 'translate(' + x + ',' + y + ')');\n    }\n  },\n\n  /**\n   * Set translate only Y value\n   * @param {SVG|VML} obj - SVG or VML object to setting translate transform.\n   * @param {number} y - translate Y value\n   */\n  setTranslateY: function (obj, y) {\n    if (svgvml.isOldBrowser()) {\n      obj.style.top = y + 'px';\n    } else {\n      obj.setAttribute('transform', 'translate(' + SVG_HUE_HANDLE_RIGHT_POS + ',' + y + ')');\n    }\n  },\n\n  /**\n   * Set stroke color to SVG or VML object\n   * @param {SVG|VML} obj - SVG or VML object to setting stroke color\n   * @param {string} colorStr - color string\n   */\n  setStrokeColor: function (obj, colorStr) {\n    if (svgvml.isOldBrowser()) {\n      obj.strokecolor = colorStr;\n    } else {\n      obj.setAttribute('stroke', colorStr);\n    }\n  },\n\n  /**\n   * Set gradient stop color to SVG, VML object.\n   * @param {SVG|VML} obj - SVG, VML object to applying gradient stop color\n   * @param {string} colorStr - color string\n   */\n  setGradientColorStop: function (obj, colorStr) {\n    if (svgvml.isOldBrowser()) {\n      obj.color = colorStr;\n    } else {\n      obj.setAttribute('stop-color', colorStr);\n    }\n  }\n};\nmodule.exports = svgvml;\n\n//# sourceURL=webpack://tui.colorPicker/./src/js/svgvml.js?")},"./src/styl/tui-color-picker.styl":function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack://tui.colorPicker/./src/styl/tui-color-picker.styl?")},"./src/template/palette.js":function(module,exports,__webpack_require__){"use strict";eval('/**\n * @fileoverview Palette view template\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar layout = [\'<ul class="{{cssPrefix}}clearfix">{{colorList}}</ul>\', \'<div class="{{cssPrefix}}clearfix" style="overflow:hidden">\', \'<input type="button" class="{{cssPrefix}}palette-toggle-slider" value="{{detailTxt}}" />\', \'<input type="text" class="{{cssPrefix}}palette-hex" value="{{color}}" maxlength="7" />\', \'<span class="{{cssPrefix}}palette-preview" style="background-color:{{color}};color:{{color}}">{{color}}</span>\', \'</div>\'].join(\'\\n\');\nvar item = \'<li><input class="{{cssPrefix}}palette-button{{selected}}{{itemClass}}" type="button" style="{{itemStyle}}" title="{{color}}" value="{{color}}" /></li>\';\nvar itemStyle = \'background-color:{{color}};color:{{color}}\';\nmodule.exports = {\n  layout: layout,\n  item: item,\n  itemStyle: itemStyle\n};\n\n//# sourceURL=webpack://tui.colorPicker/./src/template/palette.js?')},"./src/template/slider.js":function(module,exports,__webpack_require__){"use strict";eval('/* WEBPACK VAR INJECTION */(function(global) {/**\n * @fileoverview Slider template\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\n */\n\n\nvar util = __webpack_require__(/*! tui-code-snippet */ "tui-code-snippet");\n\nvar layout = [\'<div class="{{cssPrefix}}slider-left {{cssPrefix}}slider-part">{{slider}}</div>\', \'<div class="{{cssPrefix}}slider-right {{cssPrefix}}slider-part">{{huebar}}</div>\'].join(\'\\n\');\nvar SVGSlider = [\'<svg class="{{cssPrefix}}svg {{cssPrefix}}svg-slider">\', \'<defs>\', \'<linearGradient id="{{cssPrefix}}svg-fill-color-{{id}}" x1="0%" y1="0%" x2="100%" y2="0%">\', \'<stop offset="0%" stop-color="rgb(255,255,255)" />\', \'<stop class="{{cssPrefix}}slider-basecolor" offset="100%" stop-color="rgb(255,0,0)" />\', \'</linearGradient>\', \'<linearGradient id="{{cssPrefix}}svn-fill-black-{{id}}" x1="0%" y1="0%" x2="0%" y2="100%">\', \'<stop offset="0%" style="stop-color:rgb(0,0,0);stop-opacity:0" />\', \'<stop offset="100%" style="stop-color:rgb(0,0,0);stop-opacity:1" />\', \'</linearGradient>\', \'</defs>\', \'<rect width="100%" height="100%" fill="url(#{{cssPrefix}}svg-fill-color-{{id}})"></rect>\', \'<rect width="100%" height="100%" fill="url(#{{cssPrefix}}svn-fill-black-{{id}})"></rect>\', \'<path transform="translate(0,0)" class="{{cssPrefix}}slider-handle" d="M0 7.5 L15 7.5 M7.5 15 L7.5 0 M2 7 a5.5 5.5 0 1 1 0 1 Z" stroke="black" stroke-width="0.75" fill="none" />\', \'</svg>\'].join(\'\\n\');\nvar VMLSlider = [\'<div class="{{cssPrefix}}vml-slider">\', \'<v:rect strokecolor="none" class="{{cssPrefix}}vml {{cssPrefix}}vml-slider-bg">\', \'<v:fill class="{{cssPrefix}}vml {{cssPrefix}}slider-basecolor" type="gradient" method="none" color="#ff0000" color2="#fff" angle="90" />\', \'</v:rect>\', \'<v:rect strokecolor="#ccc" class="{{cssPrefix}}vml {{cssPrefix}}vml-slider-bg">\', \'<v:fill type="gradient" method="none" color="black" color2="white" o:opacity2="0%" class="{{cssPrefix}}vml" />\', \'</v:rect>\', \'<v:shape class="{{cssPrefix}}vml {{cssPrefix}}slider-handle" coordsize="1 1" style="width:1px;height:1px;"\' + \'path="m 0,7 l 14,7 m 7,14 l 7,0 ar 12,12 2,2 z" filled="false" stroked="true" />\', \'</div>\'].join(\'\\n\');\nvar SVGHuebar = [\'<svg class="{{cssPrefix}}svg {{cssPrefix}}svg-huebar">\', \'<defs>\', \'<linearGradient id="g-{{id}}" x1="0%" y1="0%" x2="0%" y2="100%">\', \'<stop offset="0%" stop-color="rgb(255,0,0)" />\', \'<stop offset="16.666%" stop-color="rgb(255,255,0)" />\', \'<stop offset="33.333%" stop-color="rgb(0,255,0)" />\', \'<stop offset="50%" stop-color="rgb(0,255,255)" />\', \'<stop offset="66.666%" stop-color="rgb(0,0,255)" />\', \'<stop offset="83.333%" stop-color="rgb(255,0,255)" />\', \'<stop offset="100%" stop-color="rgb(255,0,0)" />\', \'</linearGradient>\', \'</defs>\', \'<rect width="18px" height="100%" fill="url(#g-{{id}})"></rect>\', \'<path transform="translate(-6,-3)" class="{{cssPrefix}}huebar-handle" d="M0 0 L4 4 L0 8 L0 0 Z" fill="black" stroke="none" />\', \'</svg>\'].join(\'\\n\');\nvar VMLHuebar = [\'<div class="{{cssPrefix}}vml-huebar">\', \'<v:rect strokecolor="#ccc" class="{{cssPrefix}}vml {{cssPrefix}}vml-huebar-bg">\', \'<v:fill type="gradient" method="none" colors="\' + \'0% rgb(255,0,0), 16.666% rgb(255,255,0), 33.333% rgb(0,255,0), 50% rgb(0,255,255), 66.666% rgb(0,0,255), 83.333% rgb(255,0,255), 100% rgb(255,0,0)\' + \'" angle="180" class="{{cssPrefix}}vml" />\', \'</v:rect>\', \'<v:shape class="{{cssPrefix}}vml {{cssPrefix}}huebar-handle" coordsize="1 1" style="width:1px;height:1px;position:absolute;z-index:1;right:22px;top:-3px;"\' + \'path="m 0,0 l 4,4 l 0,8 l 0,0 z" filled="true" fillcolor="black" stroked="false" />\', \'</div>\'].join(\'\\n\');\nvar isOldBrowser = util.browser.msie && util.browser.version < 9;\n\nif (isOldBrowser) {\n  global.document.namespaces.add(\'v\', \'urn:schemas-microsoft-com:vml\');\n}\n\nmodule.exports = {\n  layout: layout,\n  slider: isOldBrowser ? VMLSlider : SVGSlider,\n  huebar: isOldBrowser ? VMLHuebar : SVGHuebar\n};\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))\n\n//# sourceURL=webpack://tui.colorPicker/./src/template/slider.js?')},0:function(module,exports,__webpack_require__){eval('__webpack_require__(/*! ./src/styl/tui-color-picker.styl */"./src/styl/tui-color-picker.styl");\nmodule.exports = __webpack_require__(/*! ./src/js/index.js */"./src/js/index.js");\n\n\n//# sourceURL=webpack://tui.colorPicker/multi_./src/styl/tui-color-picker.styl_./src/js/index.js?')},"tui-code-snippet":function(module,exports){eval("module.exports = __WEBPACK_EXTERNAL_MODULE_tui_code_snippet__;\n\n//# sourceURL=webpack://tui.colorPicker/external_%7B%22commonjs%22:%22tui-code-snippet%22,%22commonjs2%22:%22tui-code-snippet%22,%22amd%22:%22tui-code-snippet%22,%22root%22:%5B%22tui%22,%22util%22%5D%7D?")}})},module.exports=factory(__webpack_require__(487))},1144:function(e,t,n){(function(e){var i,r,o,a,s,l,c,u,h,d,f,p,g,v,m,b,y,_,x,w,C,S,k=k||{version:"3.3.0"};if(t.fabric=k,"undefined"!=typeof document&&"undefined"!=typeof window)document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?k.document=document:k.document=document.implementation.createHTMLDocument(""),k.window=window;else{var T=new(n(1149).JSDOM)(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;k.document=T.document,k.jsdomImplForWrapper=n(1150).implForWrapper,k.nodeCanvas=n(1151).Canvas,k.window=T,DOMParser=k.window.DOMParser}function E(e,t){var n=e.canvas,i=t.targetCanvas,r=i.getContext("2d");r.translate(0,i.height),r.scale(1,-1);var o=n.height-i.height;r.drawImage(n,0,o,i.width,i.height,0,0,i.width,i.height)}function M(e,t){var n=t.targetCanvas.getContext("2d"),i=t.destinationWidth,r=t.destinationHeight,o=i*r*4,a=new Uint8Array(this.imageBuffer,0,o),s=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,i,r,e.RGBA,e.UNSIGNED_BYTE,a);var l=new ImageData(s,i,r);n.putImageData(l,0,0)}k.isTouchSupported="ontouchstart"in k.window||"ontouchstart"in k.document||k.window&&k.window.navigator&&k.window.navigator.maxTouchPoints>0,k.isLikelyNode=void 0!==e&&"undefined"==typeof window,k.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],k.DPI=96,k.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",k.fontPaths={},k.iMatrix=[1,0,0,1,0,0],k.perfLimitSizeTotal=2097152,k.maxCacheSideLimit=4096,k.minCacheSideLimit=256,k.charWidthsCache={},k.textureSize=2048,k.disableStyleCopyPaste=!1,k.enableGLFiltering=!0,k.devicePixelRatio=k.window.devicePixelRatio||k.window.webkitDevicePixelRatio||k.window.mozDevicePixelRatio||1,k.browserShadowBlurConstant=1,k.arcToSegmentsCache={},k.boundsOfCurveCache={},k.cachesBoundsOfCurve=!0,k.forceGLPutImageData=!1,k.initFilterBackend=function(){return k.enableGLFiltering&&k.isWebglSupported&&k.isWebglSupported(k.textureSize)?(k.maxTextureSize,new k.WebglFilterBackend({tileSize:k.textureSize})):k.Canvas2dFilterBackend?new k.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=k),function(){function e(e,t){if(this.__eventListeners[e]){var n=this.__eventListeners[e];t?n[n.indexOf(t)]=!1:k.util.array.fill(n,!1)}}function t(e,t){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var n in e)this.on(n,e[n]);else this.__eventListeners[e]||(this.__eventListeners[e]=[]),this.__eventListeners[e].push(t);return this}function n(t,n){if(!this.__eventListeners)return this;if(0===arguments.length)for(t in this.__eventListeners)e.call(this,t);else if(1===arguments.length&&"object"==typeof arguments[0])for(var i in t)e.call(this,i,t[i]);else e.call(this,t,n);return this}function i(e,t){if(!this.__eventListeners)return this;var n=this.__eventListeners[e];if(!n)return this;for(var i=0,r=n.length;i<r;i++)n[i]&&n[i].call(this,t||{});return this.__eventListeners[e]=n.filter((function(e){return!1!==e})),this}k.Observable={observe:t,stopObserving:n,fire:i,on:t,off:n,trigger:i}}(),k.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var e=0,t=arguments.length;e<t;e++)this._onObjectAdded(arguments[e]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(e,t,n){var i=this._objects;return n?i[t]=e:i.splice(t,0,e),this._onObjectAdded&&this._onObjectAdded(e),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var e,t=this._objects,n=!1,i=0,r=arguments.length;i<r;i++)-1!==(e=t.indexOf(arguments[i]))&&(n=!0,t.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&n&&this.requestRenderAll(),this},forEachObject:function(e,t){for(var n=this.getObjects(),i=0,r=n.length;i<r;i++)e.call(t,n[i],i,n);return this},getObjects:function(e){return void 0===e?this._objects.concat():this._objects.filter((function(t){return t.type===e}))},item:function(e){return this._objects[e]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(e){return this._objects.indexOf(e)>-1},complexity:function(){return this._objects.reduce((function(e,t){return e+=t.complexity?t.complexity():0}),0)}},k.CommonMethods={_setOptions:function(e){for(var t in e)this.set(t,e[t])},_initGradient:function(e,t){!e||!e.colorStops||e instanceof k.Gradient||this.set(t,new k.Gradient(e))},_initPattern:function(e,t,n){!e||!e.source||e instanceof k.Pattern?n&&n():this.set(t,new k.Pattern(e,n))},_initClipping:function(e){if(e.clipTo&&"string"==typeof e.clipTo){var t=k.util.getFunctionBody(e.clipTo);void 0!==t&&(this.clipTo=new Function("ctx",t))}},_setObject:function(e){for(var t in e)this._set(t,e[t])},set:function(e,t){return"object"==typeof e?this._setObject(e):"function"==typeof t&&"clipTo"!==e?this._set(e,t(this.get(e))):this._set(e,t),this},_set:function(e,t){this[e]=t},toggle:function(e){var t=this.get(e);return"boolean"==typeof t&&this.set(e,!t),this},get:function(e){return this[e]}},i=t,r=Math.sqrt,o=Math.atan2,a=Math.pow,s=Math.abs,l=Math.PI/180,c=Math.PI/2,k.util={cos:function(e){if(0===e)return 1;switch(e<0&&(e=-e),e/c){case 1:case 3:return 0;case 2:return-1}return Math.cos(e)},sin:function(e){if(0===e)return 0;var t=1;switch(e<0&&(t=-1),e/c){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(e)},removeFromArray:function(e,t){var n=e.indexOf(t);return-1!==n&&e.splice(n,1),e},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},degreesToRadians:function(e){return e*l},radiansToDegrees:function(e){return e/l},rotatePoint:function(e,t,n){e.subtractEquals(t);var i=k.util.rotateVector(e,n);return new k.Point(i.x,i.y).addEquals(t)},rotateVector:function(e,t){var n=k.util.sin(t),i=k.util.cos(t);return{x:e.x*i-e.y*n,y:e.x*n+e.y*i}},transformPoint:function(e,t,n){return n?new k.Point(t[0]*e.x+t[2]*e.y,t[1]*e.x+t[3]*e.y):new k.Point(t[0]*e.x+t[2]*e.y+t[4],t[1]*e.x+t[3]*e.y+t[5])},makeBoundingBoxFromPoints:function(e){var t=[e[0].x,e[1].x,e[2].x,e[3].x],n=k.util.array.min(t),i=k.util.array.max(t)-n,r=[e[0].y,e[1].y,e[2].y,e[3].y],o=k.util.array.min(r);return{left:n,top:o,width:i,height:k.util.array.max(r)-o}},invertTransform:function(e){var t=1/(e[0]*e[3]-e[1]*e[2]),n=[t*e[3],-t*e[1],-t*e[2],t*e[0]],i=k.util.transformPoint({x:e[4],y:e[5]},n,!0);return n[4]=-i.x,n[5]=-i.y,n},toFixed:function(e,t){return parseFloat(Number(e).toFixed(t))},parseUnit:function(e,t){var n=/\D{0,2}$/.exec(e),i=parseFloat(e);switch(t||(t=k.Text.DEFAULT_SVG_FONT_SIZE),n[0]){case"mm":return i*k.DPI/25.4;case"cm":return i*k.DPI/2.54;case"in":return i*k.DPI;case"pt":return i*k.DPI/72;case"pc":return i*k.DPI/72*12;case"em":return i*t;default:return i}},falseFunction:function(){return!1},getKlass:function(e,t){return e=k.util.string.camelize(e.charAt(0).toUpperCase()+e.slice(1)),k.util.resolveNamespace(t)[e]},getSvgAttributes:function(e){var t=["instantiated_by_use","style","id","class"];switch(e){case"linearGradient":t=t.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":t=t.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":t=t.concat(["offset","stop-color","stop-opacity"])}return t},resolveNamespace:function(e){if(!e)return k;var t,n=e.split("."),r=n.length,o=i||k.window;for(t=0;t<r;++t)o=o[n[t]];return o},loadImage:function(e,t,n,i){if(e){var r=k.util.createImage(),o=function(){t&&t.call(n,r),r=r.onload=r.onerror=null};r.onload=o,r.onerror=function(){k.log("Error loading "+r.src),t&&t.call(n,null,!0),r=r.onload=r.onerror=null},0!==e.indexOf("data")&&i&&(r.crossOrigin=i),"data:image/svg"===e.substring(0,14)&&(r.onload=null,k.util.loadImageInDom(r,o)),r.src=e}else t&&t.call(n,e)},loadImageInDom:function(e,t){var n=k.document.createElement("div");n.style.width=n.style.height="1px",n.style.left=n.style.top="-100%",n.style.position="absolute",n.appendChild(e),k.document.querySelector("body").appendChild(n),e.onload=function(){t(),n.parentNode.removeChild(n),n=null}},enlivenObjects:function(e,t,n,i){var r=[],o=0,a=(e=e||[]).length;function s(){++o===a&&t&&t(r.filter((function(e){return e})))}a?e.forEach((function(e,t){e&&e.type?k.util.getKlass(e.type,n).fromObject(e,(function(n,o){o||(r[t]=n),i&&i(e,n,o),s()})):s()})):t&&t(r)},enlivenPatterns:function(e,t){function n(){++r===o&&t&&t(i)}var i=[],r=0,o=(e=e||[]).length;o?e.forEach((function(e,t){e&&e.source?new k.Pattern(e,(function(e){i[t]=e,n()})):(i[t]=e,n())})):t&&t(i)},groupSVGElements:function(e,t,n){var i;return e&&1===e.length?e[0]:(t&&(t.width&&t.height?t.centerPoint={x:t.width/2,y:t.height/2}:(delete t.width,delete t.height)),i=new k.Group(e,t),void 0!==n&&(i.sourcePath=n),i)},populateWithProperties:function(e,t,n){if(n&&"[object Array]"===Object.prototype.toString.call(n))for(var i=0,r=n.length;i<r;i++)n[i]in e&&(t[n[i]]=e[n[i]])},drawDashedLine:function(e,t,n,i,a,s){var l=i-t,c=a-n,u=r(l*l+c*c),h=o(c,l),d=s.length,f=0,p=!0;for(e.save(),e.translate(t,n),e.moveTo(0,0),e.rotate(h),t=0;u>t;)(t+=s[f++%d])>u&&(t=u),e[p?"lineTo":"moveTo"](t,0),p=!p;e.restore()},createCanvasElement:function(){return k.document.createElement("canvas")},copyCanvasElement:function(e){var t=k.util.createCanvasElement();return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t},toDataURL:function(e,t,n){return e.toDataURL("image/"+t,n)},createImage:function(){return k.document.createElement("img")},clipContext:function(e,t){t.save(),t.beginPath(),e.clipTo(t),t.clip()},multiplyTransformMatrices:function(e,t,n){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],n?0:e[0]*t[4]+e[2]*t[5]+e[4],n?0:e[1]*t[4]+e[3]*t[5]+e[5]]},qrDecompose:function(e){var t=o(e[1],e[0]),n=a(e[0],2)+a(e[1],2),i=r(n),s=(e[0]*e[3]-e[2]*e[1])/i,c=o(e[0]*e[2]+e[1]*e[3],n);return{angle:t/l,scaleX:i,scaleY:s,skewX:c/l,skewY:0,translateX:e[4],translateY:e[5]}},customTransformMatrix:function(e,t,n){var i=[1,0,s(Math.tan(n*l)),1],r=[s(e),0,0,s(t)];return k.util.multiplyTransformMatrices(r,i,!0)},resetObjectTransform:function(e){e.scaleX=1,e.scaleY=1,e.skewX=0,e.skewY=0,e.flipX=!1,e.flipY=!1,e.rotate(0)},saveObjectTransform:function(e){return{scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,angle:e.angle,left:e.left,flipX:e.flipX,flipY:e.flipY,top:e.top}},getFunctionBody:function(e){return(String(e).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(e,t,n,i){i>0&&(t>i?t-=i:t=0,n>i?n-=i:n=0);var r,o=!0,a=e.getImageData(t,n,2*i||1,2*i||1),s=a.data.length;for(r=3;r<s&&!1!=(o=a.data[r]<=0);r+=4);return a=null,o},parsePreserveAspectRatioAttribute:function(e){var t,n="meet",i=e.split(" ");return i&&i.length&&("meet"!==(n=i.pop())&&"slice"!==n?(t=n,n="meet"):i.length&&(t=i.pop())),{meetOrSlice:n,alignX:"none"!==t?t.slice(1,4):"none",alignY:"none"!==t?t.slice(5,8):"none"}},clearFabricFontCache:function(e){(e=(e||"").toLowerCase())?k.charWidthsCache[e]&&delete k.charWidthsCache[e]:k.charWidthsCache={}},limitDimsByArea:function(e,t){var n=Math.sqrt(t*e),i=Math.floor(t/n);return{x:Math.floor(n),y:i}},capValue:function(e,t,n){return Math.max(e,Math.min(t,n))},findScaleToFit:function(e,t){return Math.min(t.width/e.width,t.height/e.height)},findScaleToCover:function(e,t){return Math.max(t.width/e.width,t.height/e.height)},matrixToSVG:function(e){return"matrix("+e.map((function(e){return k.util.toFixed(e,k.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"}},function(){var e=Array.prototype.join;function t(t,r,o,a,s,l,c){var u=e.call(arguments);if(k.arcToSegmentsCache[u])return k.arcToSegmentsCache[u];var h=Math.PI,d=c*h/180,f=k.util.sin(d),p=k.util.cos(d),g=0,v=0,m=-p*t*.5-f*r*.5,b=-p*r*.5+f*t*.5,y=(o=Math.abs(o))*o,_=(a=Math.abs(a))*a,x=b*b,w=m*m,C=y*_-y*x-_*w,S=0;if(C<0){var T=Math.sqrt(1-C/(y*_));o*=T,a*=T}else S=(s===l?-1:1)*Math.sqrt(C/(y*x+_*w));var E=S*o*b/a,M=-S*a*m/o,O=p*E-f*M+.5*t,j=f*E+p*M+.5*r,P=i(1,0,(m-E)/o,(b-M)/a),A=i((m-E)/o,(b-M)/a,(-m-E)/o,(-b-M)/a);0===l&&A>0?A-=2*h:1===l&&A<0&&(A+=2*h);for(var D=Math.ceil(Math.abs(A/h*2)),L=[],I=A/D,z=8/3*Math.sin(I/4)*Math.sin(I/4)/Math.sin(I/2),B=P+I,R=0;R<D;R++)L[R]=n(P,B,p,f,o,a,O,j,z,g,v),g=L[R][4],v=L[R][5],P=B,B+=I;return k.arcToSegmentsCache[u]=L,L}function n(e,t,n,i,r,o,a,s,l,c,u){var h=k.util.cos(e),d=k.util.sin(e),f=k.util.cos(t),p=k.util.sin(t),g=n*r*f-i*o*p+a,v=i*r*f+n*o*p+s;return[c+l*(-n*r*d-i*o*h),u+l*(-i*r*d+n*o*h),g+l*(n*r*p+i*o*f),v+l*(i*r*p-n*o*f),g,v]}function i(e,t,n,i){var r=Math.atan2(t,e),o=Math.atan2(i,n);return o>=r?o-r:2*Math.PI-(r-o)}function r(t,n,i,r,o,a,s,l){var c;if(k.cachesBoundsOfCurve&&(c=e.call(arguments),k.boundsOfCurveCache[c]))return k.boundsOfCurveCache[c];var u,h,d,f,p,g,v,m,b=Math.sqrt,y=Math.min,_=Math.max,x=Math.abs,w=[],C=[[],[]];h=6*t-12*i+6*o,u=-3*t+9*i-9*o+3*s,d=3*i-3*t;for(var S=0;S<2;++S)if(S>0&&(h=6*n-12*r+6*a,u=-3*n+9*r-9*a+3*l,d=3*r-3*n),x(u)<1e-12){if(x(h)<1e-12)continue;0<(f=-d/h)&&f<1&&w.push(f)}else(v=h*h-4*d*u)<0||(0<(p=(-h+(m=b(v)))/(2*u))&&p<1&&w.push(p),0<(g=(-h-m)/(2*u))&&g<1&&w.push(g));for(var T,E,M,O=w.length,j=O;O--;)T=(M=1-(f=w[O]))*M*M*t+3*M*M*f*i+3*M*f*f*o+f*f*f*s,C[0][O]=T,E=M*M*M*n+3*M*M*f*r+3*M*f*f*a+f*f*f*l,C[1][O]=E;C[0][j]=t,C[1][j]=n,C[0][j+1]=s,C[1][j+1]=l;var P=[{x:y.apply(null,C[0]),y:y.apply(null,C[1])},{x:_.apply(null,C[0]),y:_.apply(null,C[1])}];return k.cachesBoundsOfCurve&&(k.boundsOfCurveCache[c]=P),P}k.util.drawArc=function(e,n,i,r){for(var o=r[0],a=r[1],s=r[2],l=r[3],c=r[4],u=[[],[],[],[]],h=t(r[5]-n,r[6]-i,o,a,l,c,s),d=0,f=h.length;d<f;d++)u[d][0]=h[d][0]+n,u[d][1]=h[d][1]+i,u[d][2]=h[d][2]+n,u[d][3]=h[d][3]+i,u[d][4]=h[d][4]+n,u[d][5]=h[d][5]+i,e.bezierCurveTo.apply(e,u[d])},k.util.getBoundsOfArc=function(e,n,i,o,a,s,l,c,u){for(var h,d=0,f=0,p=[],g=t(c-e,u-n,i,o,s,l,a),v=0,m=g.length;v<m;v++)h=r(d,f,g[v][0],g[v][1],g[v][2],g[v][3],g[v][4],g[v][5]),p.push({x:h[0].x+e,y:h[0].y+n}),p.push({x:h[1].x+e,y:h[1].y+n}),d=g[v][4],f=g[v][5];return p},k.util.getBoundsOfCurve=r}(),function(){var e=Array.prototype.slice;function t(e,t,n){if(e&&0!==e.length){var i=e.length-1,r=t?e[i][t]:e[i];if(t)for(;i--;)n(e[i][t],r)&&(r=e[i][t]);else for(;i--;)n(e[i],r)&&(r=e[i]);return r}}k.util.array={fill:function(e,t){for(var n=e.length;n--;)e[n]=t;return e},invoke:function(t,n){for(var i=e.call(arguments,2),r=[],o=0,a=t.length;o<a;o++)r[o]=i.length?t[o][n].apply(t[o],i):t[o][n].call(t[o]);return r},min:function(e,n){return t(e,n,(function(e,t){return e<t}))},max:function(e,n){return t(e,n,(function(e,t){return e>=t}))}}}(),function(){function e(t,n,i){if(i)if(!k.isLikelyNode&&n instanceof Element)t=n;else if(n instanceof Array){t=[];for(var r=0,o=n.length;r<o;r++)t[r]=e({},n[r],i)}else if(n&&"object"==typeof n)for(var a in n)"canvas"===a?t[a]=e({},n[a]):n.hasOwnProperty(a)&&(t[a]=e({},n[a],i));else t=n;else for(var a in n)t[a]=n[a];return t}k.util.object={extend:e,clone:function(t,n){return e({},t,n)}},k.util.object.extend(k.util,k.Observable)}(),function(){function e(e,t){var n=e.charCodeAt(t);if(isNaN(n))return"";if(n<55296||n>57343)return e.charAt(t);if(55296<=n&&n<=56319){if(e.length<=t+1)throw"High surrogate without following low surrogate";var i=e.charCodeAt(t+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return e.charAt(t)+e.charAt(t+1)}if(0===t)throw"Low surrogate without preceding high surrogate";var r=e.charCodeAt(t-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1}k.util.string={camelize:function(e){return e.replace(/-+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))},capitalize:function(e,t){return e.charAt(0).toUpperCase()+(t?e.slice(1):e.slice(1).toLowerCase())},escapeXml:function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(t){var n,i=0,r=[];for(i=0;i<t.length;i++)!1!==(n=e(t,i))&&r.push(n);return r}}}(),function(){var e=Array.prototype.slice,t=function(){},n=function(){for(var e in{toString:1})if("toString"===e)return!1;return!0}(),i=function(e,t,i){for(var r in t)r in e.prototype&&"function"==typeof e.prototype[r]&&(t[r]+"").indexOf("callSuper")>-1?e.prototype[r]=function(e){return function(){var n=this.constructor.superclass;this.constructor.superclass=i;var r=t[e].apply(this,arguments);if(this.constructor.superclass=n,"initialize"!==e)return r}}(r):e.prototype[r]=t[r],n&&(t.toString!==Object.prototype.toString&&(e.prototype.toString=t.toString),t.valueOf!==Object.prototype.valueOf&&(e.prototype.valueOf=t.valueOf))};function r(){}function o(t){for(var n=null,i=this;i.constructor.superclass;){var r=i.constructor.superclass.prototype[t];if(i[t]!==r){n=r;break}i=i.constructor.superclass.prototype}return n?arguments.length>1?n.apply(this,e.call(arguments,1)):n.call(this):console.log("tried to callSuper "+t+", method not found in prototype chain",this)}k.util.createClass=function(){var n=null,a=e.call(arguments,0);function s(){this.initialize.apply(this,arguments)}"function"==typeof a[0]&&(n=a.shift()),s.superclass=n,s.subclasses=[],n&&(r.prototype=n.prototype,s.prototype=new r,n.subclasses.push(s));for(var l=0,c=a.length;l<c;l++)i(s,a[l],n);return s.prototype.initialize||(s.prototype.initialize=t),s.prototype.constructor=s,s.prototype.callSuper=o,s}}(),u=!!k.document.createElement("div").attachEvent,k.util.addListener=function(e,t,n,i){e&&e.addEventListener(t,n,!u&&i)},k.util.removeListener=function(e,t,n,i){e&&e.removeEventListener(t,n,!u&&i)},k.util.getPointer=function(e){var t=e.target,n=k.util.getScrollLeftTop(t),i=function(e){var t=e.changedTouches;return t&&t[0]?t[0]:e}(e);return{x:i.clientX+n.left,y:i.clientY+n.top}},h=k.document.createElement("div"),d="string"==typeof h.style.opacity,f="string"==typeof h.style.filter,p=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,g=function(e){return e},d?g=function(e,t){return e.style.opacity=t,e}:f&&(g=function(e,t){var n=e.style;return e.currentStyle&&!e.currentStyle.hasLayout&&(n.zoom=1),p.test(n.filter)?(t=t>=.9999?"":"alpha(opacity="+100*t+")",n.filter=n.filter.replace(p,t)):n.filter+=" alpha(opacity="+100*t+")",e}),k.util.setStyle=function(e,t){var n=e.style;if(!n)return e;if("string"==typeof t)return e.style.cssText+=";"+t,t.indexOf("opacity")>-1?g(e,t.match(/opacity:\s*(\d?\.?\d*)/)[1]):e;for(var i in t)"opacity"===i?g(e,t[i]):n["float"===i||"cssFloat"===i?void 0===n.styleFloat?"cssFloat":"styleFloat":i]=t[i];return e},function(){var e=Array.prototype.slice;var t,n,i,r,o=function(t){return e.call(t,0)};try{t=o(k.document.childNodes)instanceof Array}catch(e){}function a(e,t){var n=k.document.createElement(e);for(var i in t)"class"===i?n.className=t[i]:"for"===i?n.htmlFor=t[i]:n.setAttribute(i,t[i]);return n}function s(e){for(var t=0,n=0,i=k.document.documentElement,r=k.document.body||{scrollLeft:0,scrollTop:0};e&&(e.parentNode||e.host)&&((e=e.parentNode||e.host)===k.document?(t=r.scrollLeft||i.scrollLeft||0,n=r.scrollTop||i.scrollTop||0):(t+=e.scrollLeft||0,n+=e.scrollTop||0),1!==e.nodeType||"fixed"!==e.style.position););return{left:t,top:n}}t||(o=function(e){for(var t=new Array(e.length),n=e.length;n--;)t[n]=e[n];return t}),n=k.document.defaultView&&k.document.defaultView.getComputedStyle?function(e,t){var n=k.document.defaultView.getComputedStyle(e,null);return n?n[t]:void 0}:function(e,t){var n=e.style[t];return!n&&e.currentStyle&&(n=e.currentStyle[t]),n},i=k.document.documentElement.style,r="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"",k.util.makeElementUnselectable=function(e){return void 0!==e.onselectstart&&(e.onselectstart=k.util.falseFunction),r?e.style[r]="none":"string"==typeof e.unselectable&&(e.unselectable="on"),e},k.util.makeElementSelectable=function(e){return void 0!==e.onselectstart&&(e.onselectstart=null),r?e.style[r]="":"string"==typeof e.unselectable&&(e.unselectable=""),e},k.util.getScript=function(e,t){var n=k.document.getElementsByTagName("head")[0],i=k.document.createElement("script"),r=!0;i.onload=i.onreadystatechange=function(e){if(r){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;r=!1,t(e||k.window.event),i=i.onload=i.onreadystatechange=null}},i.src=e,n.appendChild(i)},k.util.getById=function(e){return"string"==typeof e?k.document.getElementById(e):e},k.util.toArray=o,k.util.makeElement=a,k.util.addClass=function(e,t){e&&-1===(" "+e.className+" ").indexOf(" "+t+" ")&&(e.className+=(e.className?" ":"")+t)},k.util.wrapElement=function(e,t,n){return"string"==typeof t&&(t=a(t,n)),e.parentNode&&e.parentNode.replaceChild(t,e),t.appendChild(e),t},k.util.getScrollLeftTop=s,k.util.getElementOffset=function(e){var t,i,r=e&&e.ownerDocument,o={left:0,top:0},a={left:0,top:0},l={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return a;for(var c in l)a[l[c]]+=parseInt(n(e,c),10)||0;return t=r.documentElement,void 0!==e.getBoundingClientRect&&(o=e.getBoundingClientRect()),i=s(e),{left:o.left+i.left-(t.clientLeft||0)+a.left,top:o.top+i.top-(t.clientTop||0)+a.top}},k.util.getElementStyle=n,k.util.getNodeCanvas=function(e){var t=k.jsdomImplForWrapper(e);return t._canvas||t._image},k.util.cleanUpJsdomNode=function(e){if(k.isLikelyNode){var t=k.jsdomImplForWrapper(e);t&&(t._image=null,t._canvas=null,t._currentSrc=null,t._attributes=null,t._classList=null)}}}(),function(){function e(){}k.util.request=function(t,n){n||(n={});var i=n.method?n.method.toUpperCase():"GET",r=n.onComplete||function(){},o=new k.window.XMLHttpRequest,a=n.body||n.parameters;return o.onreadystatechange=function(){4===o.readyState&&(r(o),o.onreadystatechange=e)},"GET"===i&&(a=null,"string"==typeof n.parameters&&(t=function(e,t){return e+(/\?/.test(e)?"&":"?")+t}(t,n.parameters))),o.open(i,t,!0),"POST"!==i&&"PUT"!==i||o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(a),o}}(),k.log=function(){},k.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach((function(e){void 0!==console[e]&&"function"==typeof console[e].apply&&(k[e]=function(){return console[e].apply(console,arguments)})})),function(){function e(){return!1}var t=k.window.requestAnimationFrame||k.window.webkitRequestAnimationFrame||k.window.mozRequestAnimationFrame||k.window.oRequestAnimationFrame||k.window.msRequestAnimationFrame||function(e){return k.window.setTimeout(e,1e3/60)},n=k.window.cancelAnimationFrame||k.window.clearTimeout;function i(){return t.apply(k.window,arguments)}k.util.animate=function(t){i((function(n){t||(t={});var r,o=n||+new Date,a=t.duration||500,s=o+a,l=t.onChange||e,c=t.abort||e,u=t.onComplete||e,h=t.easing||function(e,t,n,i){return-n*Math.cos(e/i*(Math.PI/2))+n+t},d="startValue"in t?t.startValue:0,f="endValue"in t?t.endValue:100,p=t.byValue||f-d;t.onStart&&t.onStart(),function e(n){if(c())u(f,1,1);else{var g=(r=n||+new Date)>s?a:r-o,v=g/a,m=h(g,d,p,a),b=Math.abs((m-d)/p);l(m,b,v),r>s?t.onComplete&&t.onComplete():i(e)}}(o)}))},k.util.requestAnimFrame=i,k.util.cancelAnimFrame=function(){return n.apply(k.window,arguments)}}(),k.util.animateColor=function(e,t,n,i){var r=new k.Color(e).getSource(),o=new k.Color(t).getSource();i=i||{},k.util.animate(k.util.object.extend(i,{duration:n||500,startValue:r,endValue:o,byValue:o,easing:function(e,t,n,r){var o,a,s,l,c=i.colorEasing?i.colorEasing(e,r):1-Math.cos(e/r*(Math.PI/2));return o=t,a=n,s=c,l="rgba("+parseInt(o[0]+s*(a[0]-o[0]),10)+","+parseInt(o[1]+s*(a[1]-o[1]),10)+","+parseInt(o[2]+s*(a[2]-o[2]),10),l+=","+(o&&a?parseFloat(o[3]+s*(a[3]-o[3])):1),l+=")"}}))},function(){function e(e,t,n,i){return e<Math.abs(t)?(e=t,i=n/4):i=0===t&&0===e?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(t/e),{a:e,c:t,p:n,s:i}}function t(e,t,n){return e.a*Math.pow(2,10*(t-=1))*Math.sin((t*n-e.s)*(2*Math.PI)/e.p)}function n(e,t,n,r){return n-i(r-e,0,n,r)+t}function i(e,t,n,i){return(e/=i)<1/2.75?n*(7.5625*e*e)+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t}k.util.ease={easeInQuad:function(e,t,n,i){return n*(e/=i)*e+t},easeOutQuad:function(e,t,n,i){return-n*(e/=i)*(e-2)+t},easeInOutQuad:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,n,i){return n*(e/=i)*e*e+t},easeOutCubic:function(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t},easeInOutCubic:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,n,i){return n*(e/=i)*e*e*e+t},easeOutQuart:function(e,t,n,i){return-n*((e=e/i-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,n,i){return n*(e/=i)*e*e*e*e+t},easeOutQuint:function(e,t,n,i){return n*((e=e/i-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,n,i){return-n*Math.cos(e/i*(Math.PI/2))+n+t},easeOutSine:function(e,t,n,i){return n*Math.sin(e/i*(Math.PI/2))+t},easeInOutSine:function(e,t,n,i){return-n/2*(Math.cos(Math.PI*e/i)-1)+t},easeInExpo:function(e,t,n,i){return 0===e?t:n*Math.pow(2,10*(e/i-1))+t},easeOutExpo:function(e,t,n,i){return e===i?t+n:n*(1-Math.pow(2,-10*e/i))+t},easeInOutExpo:function(e,t,n,i){return 0===e?t:e===i?t+n:(e/=i/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(2-Math.pow(2,-10*--e))+t},easeInCirc:function(e,t,n,i){return-n*(Math.sqrt(1-(e/=i)*e)-1)+t},easeOutCirc:function(e,t,n,i){return n*Math.sqrt(1-(e=e/i-1)*e)+t},easeInOutCirc:function(e,t,n,i){return(e/=i/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+t:n/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(n,i,r,o){var a=0;return 0===n?i:1===(n/=o)?i+r:(a||(a=.3*o),-t(e(r,r,a,1.70158),n,o)+i)},easeOutElastic:function(t,n,i,r){var o=0;if(0===t)return n;if(1===(t/=r))return n+i;o||(o=.3*r);var a=e(i,i,o,1.70158);return a.a*Math.pow(2,-10*t)*Math.sin((t*r-a.s)*(2*Math.PI)/a.p)+a.c+n},easeInOutElastic:function(n,i,r,o){var a=0;if(0===n)return i;if(2===(n/=o/2))return i+r;a||(a=o*(.3*1.5));var s=e(r,r,a,1.70158);return n<1?-.5*t(s,n,o)+i:s.a*Math.pow(2,-10*(n-=1))*Math.sin((n*o-s.s)*(2*Math.PI)/s.p)*.5+s.c+i},easeInBack:function(e,t,n,i,r){return void 0===r&&(r=1.70158),n*(e/=i)*e*((r+1)*e-r)+t},easeOutBack:function(e,t,n,i,r){return void 0===r&&(r=1.70158),n*((e=e/i-1)*e*((r+1)*e+r)+1)+t},easeInOutBack:function(e,t,n,i,r){return void 0===r&&(r=1.70158),(e/=i/2)<1?n/2*(e*e*((1+(r*=1.525))*e-r))+t:n/2*((e-=2)*e*((1+(r*=1.525))*e+r)+2)+t},easeInBounce:n,easeOutBounce:i,easeInOutBounce:function(e,t,r,o){return e<o/2?.5*n(2*e,0,r,o)+t:.5*i(2*e-o,0,r,o)+.5*r+t}}}(),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.util.object.clone,r=t.util.toFixed,o=t.util.parseUnit,a=t.util.multiplyTransformMatrices,s={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform"},l={stroke:"strokeOpacity",fill:"fillOpacity"};function c(e){return e in s?s[e]:e}function u(e,n,i,r){var s,l="[object Array]"===Object.prototype.toString.call(n);if("fill"!==e&&"stroke"!==e||"none"!==n)if("vector-effect"===e)n="non-scaling-stroke"===n;else if("strokeDashArray"===e)n="none"===n?null:n.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===e)n=i&&i.transformMatrix?a(i.transformMatrix,t.parseTransformAttribute(n)):t.parseTransformAttribute(n);else if("visible"===e)n="none"!==n&&"hidden"!==n,i&&!1===i.visible&&(n=!1);else if("opacity"===e)n=parseFloat(n),i&&void 0!==i.opacity&&(n*=i.opacity);else if("textAnchor"===e)n="start"===n?"left":"end"===n?"right":"center";else if("charSpacing"===e)s=o(n,r)/r*1e3;else if("paintFirst"===e){var c=n.indexOf("fill"),u=n.indexOf("stroke");n="fill";c>-1&&u>-1&&u<c?n="stroke":-1===c&&u>-1&&(n="stroke")}else{if("href"===e||"xlink:href"===e)return n;s=l?n.map(o):o(n,r)}else n="";return!l&&isNaN(s)?n:s}function h(e){return new RegExp("^("+e.join("|")+")\\b","i")}function d(e,t){var n,i,r,o,a=[];for(r=0,o=t.length;r<o;r++)n=t[r],i=e.getElementsByTagName(n),a=a.concat(Array.prototype.slice.call(i));return a}function f(e,t){var n,i=!0;return(n=p(e,t.pop()))&&t.length&&(i=function(e,t){var n,i=!0;for(;e.parentNode&&1===e.parentNode.nodeType&&t.length;)i&&(n=t.pop()),e=e.parentNode,i=p(e,n);return 0===t.length}(e,t)),n&&i&&0===t.length}function p(e,t){var n,i,r=e.nodeName,o=e.getAttribute("class"),a=e.getAttribute("id");if(n=new RegExp("^"+r,"i"),t=t.replace(n,""),a&&t.length&&(n=new RegExp("#"+a+"(?![a-zA-Z\\-]+)","i"),t=t.replace(n,"")),o&&t.length)for(i=(o=o.split(" ")).length;i--;)n=new RegExp("\\."+o[i]+"(?![a-zA-Z\\-]+)","i"),t=t.replace(n,"");return 0===t.length}function g(e,t){var n;if(e.getElementById&&(n=e.getElementById(t)),n)return n;var i,r,o,a=e.getElementsByTagName("*");for(r=0,o=a.length;r<o;r++)if(t===(i=a[r]).getAttribute("id"))return i}t.svgValidTagNamesRegEx=h(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),t.svgViewBoxElementsRegEx=h(["symbol","image","marker","pattern","view","svg"]),t.svgInvalidAncestorsRegEx=h(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),t.svgValidParentsRegEx=h(["symbol","g","a","svg","clipPath","defs"]),t.cssRules={},t.gradientDefs={},t.clipPaths={},t.parseTransformAttribute=function(){function e(e,n,i){e[i]=Math.tan(t.util.degreesToRadians(n[0]))}var n=t.iMatrix,i=t.reNum,r="(?:\\s+,?\\s*|,\\s*)",o="(?:"+("(?:(matrix)\\s*\\(\\s*("+i+")"+r+"("+i+")"+r+"("+i+")"+r+"("+i+")"+r+"("+i+")"+r+"("+i+")\\s*\\))")+"|"+("(?:(translate)\\s*\\(\\s*("+i+")(?:"+r+"("+i+"))?\\s*\\))")+"|"+("(?:(scale)\\s*\\(\\s*("+i+")(?:"+r+"("+i+"))?\\s*\\))")+"|"+("(?:(rotate)\\s*\\(\\s*("+i+")(?:"+r+"("+i+")"+r+"("+i+"))?\\s*\\))")+"|"+("(?:(skewX)\\s*\\(\\s*("+i+")\\s*\\))")+"|"+("(?:(skewY)\\s*\\(\\s*("+i+")\\s*\\))")+")",a=new RegExp("^\\s*(?:"+("(?:"+o+"(?:"+r+"*"+o+")*)")+"?)\\s*$"),s=new RegExp(o,"g");return function(i){var r=n.concat(),l=[];if(!i||i&&!a.test(i))return r;i.replace(s,(function(i){var a=new RegExp(o).exec(i).filter((function(e){return!!e})),s=a[1],c=a.slice(2).map(parseFloat);switch(s){case"translate":!function(e,t){e[4]=t[0],2===t.length&&(e[5]=t[1])}(r,c);break;case"rotate":c[0]=t.util.degreesToRadians(c[0]),function(e,n){var i=t.util.cos(n[0]),r=t.util.sin(n[0]),o=0,a=0;3===n.length&&(o=n[1],a=n[2]),e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=o-(i*o-r*a),e[5]=a-(r*o+i*a)}(r,c);break;case"scale":!function(e,t){var n=t[0],i=2===t.length?t[1]:t[0];e[0]=n,e[3]=i}(r,c);break;case"skewX":e(r,c,2);break;case"skewY":e(r,c,1);break;case"matrix":r=c}l.push(r.concat()),r=n.concat()}));for(var c=l[0];l.length>1;)l.shift(),c=t.util.multiplyTransformMatrices(c,l[0]);return c}}();var v=new RegExp("^\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*$");function m(e){var n,i,r,a,s,l,c=e.getAttribute("viewBox"),u=1,h=1,d=e.getAttribute("width"),f=e.getAttribute("height"),p=e.getAttribute("x")||0,g=e.getAttribute("y")||0,m=e.getAttribute("preserveAspectRatio")||"",b=!c||!t.svgViewBoxElementsRegEx.test(e.nodeName)||!(c=c.match(v)),y=!d||!f||"100%"===d||"100%"===f,_=b&&y,x={},w="",C=0,S=0;if(x.width=0,x.height=0,x.toBeParsed=_,_)return x;if(b)return x.width=o(d),x.height=o(f),x;if(n=-parseFloat(c[1]),i=-parseFloat(c[2]),r=parseFloat(c[3]),a=parseFloat(c[4]),y?(x.width=r,x.height=a):(x.width=o(d),x.height=o(f),u=x.width/r,h=x.height/a),"none"!==(m=t.util.parsePreserveAspectRatioAttribute(m)).alignX&&("meet"===m.meetOrSlice&&(h=u=u>h?h:u),"slice"===m.meetOrSlice&&(h=u=u>h?u:h),C=x.width-r*u,S=x.height-a*u,"Mid"===m.alignX&&(C/=2),"Mid"===m.alignY&&(S/=2),"Min"===m.alignX&&(C=0),"Min"===m.alignY&&(S=0)),1===u&&1===h&&0===n&&0===i&&0===p&&0===g)return x;if((p||g)&&(w=" translate("+o(p)+" "+o(g)+") "),s=w+" matrix("+u+" 0 0 "+h+" "+(n*u+C)+" "+(i*h+S)+") ",x.viewboxTransform=t.parseTransformAttribute(s),"svg"===e.nodeName){for(l=e.ownerDocument.createElement("g");e.firstChild;)l.appendChild(e.firstChild);e.appendChild(l)}else s=(l=e).getAttribute("transform")+s;return l.setAttribute("transform",s),x}function b(e,t){var n=g(e,t.getAttribute("xlink:href").substr(1));if(n&&n.getAttribute("xlink:href")&&b(e,n),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach((function(e){t.hasAttribute(e)||t.setAttribute(e,n.getAttribute(e))})),!t.children.length)for(var i=n.cloneNode(!0);i.firstChild;)t.appendChild(i.firstChild);t.removeAttribute("xlink:href")}t.parseSVGDocument=function(e,n,r,o){if(e){!function(e){for(var t=d(e,["use","svg:use"]),n=0;t.length&&n<t.length;){var i,r,o,a,s=t[n],l=(s.getAttribute("xlink:href")||s.getAttribute("href")).substr(1),c=s.getAttribute("x")||0,u=s.getAttribute("y")||0,h=g(e,l).cloneNode(!0),f=(h.getAttribute("transform")||"")+" translate("+c+", "+u+")",p=t.length;if(m(h),/^svg$/i.test(h.nodeName)){var v=h.ownerDocument.createElement("g");for(r=0,a=(o=h.attributes).length;r<a;r++)i=o.item(r),v.setAttribute(i.nodeName,i.nodeValue);for(;h.firstChild;)v.appendChild(h.firstChild);h=v}for(r=0,a=(o=s.attributes).length;r<a;r++)"x"!==(i=o.item(r)).nodeName&&"y"!==i.nodeName&&"xlink:href"!==i.nodeName&&"href"!==i.nodeName&&("transform"===i.nodeName?f=i.nodeValue+" "+f:h.setAttribute(i.nodeName,i.nodeValue));h.setAttribute("transform",f),h.setAttribute("instantiated_by_use","1"),h.removeAttribute("id"),s.parentNode.replaceChild(h,s),t.length===p&&n++}}(e);var a,s,l=t.Object.__uid++,c=m(e),u=t.util.toArray(e.getElementsByTagName("*"));if(c.crossOrigin=o&&o.crossOrigin,c.svgUid=l,0===u.length&&t.isLikelyNode){var h=[];for(a=0,s=(u=e.selectNodes('//*[name(.)!="svg"]')).length;a<s;a++)h[a]=u[a];u=h}var f=u.filter((function(e){return m(e),t.svgValidTagNamesRegEx.test(e.nodeName.replace("svg:",""))&&!function(e,t){for(;e&&(e=e.parentNode);)if(e.nodeName&&t.test(e.nodeName.replace("svg:",""))&&!e.getAttribute("instantiated_by_use"))return!0;return!1}(e,t.svgInvalidAncestorsRegEx)}));if(!f||f&&!f.length)n&&n([],{});else{var p={};u.filter((function(e){return"clipPath"===e.nodeName.replace("svg:","")})).forEach((function(e){var n=e.getAttribute("id");p[n]=t.util.toArray(e.getElementsByTagName("*")).filter((function(e){return t.svgValidTagNamesRegEx.test(e.nodeName.replace("svg:",""))}))})),t.gradientDefs[l]=t.getGradientDefs(e),t.cssRules[l]=t.getCSSRules(e),t.clipPaths[l]=p,t.parseElements(f,(function(e,i){n&&(n(e,c,i,u),delete t.gradientDefs[l],delete t.cssRules[l],delete t.clipPaths[l])}),i(c),r,o)}}};var y=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+t.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+t.reNum+"))?\\s+(.*)");n(t,{parseFontDeclaration:function(e,t){var n=e.match(y);if(n){var i=n[1],r=n[3],a=n[4],s=n[5],l=n[6];i&&(t.fontStyle=i),r&&(t.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),a&&(t.fontSize=o(a)),l&&(t.fontFamily=l),s&&(t.lineHeight="normal"===s?1:s)}},getGradientDefs:function(e){var t,n=d(e,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),i=0,r={};for(i=n.length;i--;)(t=n[i]).getAttribute("xlink:href")&&b(e,t),r[t.getAttribute("id")]=t;return r},parseAttributes:function(e,i,a){if(e){var s,h,d,p={};void 0===a&&(a=e.getAttribute("svgUid")),e.parentNode&&t.svgValidParentsRegEx.test(e.parentNode.nodeName)&&(p=t.parseAttributes(e.parentNode,i,a));var g=i.reduce((function(t,n){return(s=e.getAttribute(n))&&(t[n]=s),t}),{});g=n(g,n(function(e,n){var i={};for(var r in t.cssRules[n])if(f(e,r.split(" ")))for(var o in t.cssRules[n][r])i[o]=t.cssRules[n][r][o];return i}(e,a),t.parseStyleAttribute(e))),h=d=p.fontSize||t.Text.DEFAULT_SVG_FONT_SIZE,g["font-size"]&&(g["font-size"]=h=o(g["font-size"],d));var v,m,b={};for(var y in g)m=u(v=c(y),g[y],p,h),b[v]=m;b&&b.font&&t.parseFontDeclaration(b.font,b);var _=n(p,b);return t.svgValidParentsRegEx.test(e.nodeName)?_:function(e){for(var n in l)if(void 0!==e[l[n]]&&""!==e[n]){if(void 0===e[n]){if(!t.Object.prototype[n])continue;e[n]=t.Object.prototype[n]}if(0!==e[n].indexOf("url(")){var i=new t.Color(e[n]);e[n]=i.setAlpha(r(i.getAlpha()*e[l[n]],2)).toRgba()}}return e}(_)}},parseElements:function(e,n,i,r,o){new t.ElementsParser(e,n,i,r,o).parse()},parseStyleAttribute:function(e){var t={},n=e.getAttribute("style");return n?("string"==typeof n?function(e,t){var n,i;e.replace(/;\s*$/,"").split(";").forEach((function(e){var r=e.split(":");n=r[0].trim().toLowerCase(),i=r[1].trim(),t[n]=i}))}(n,t):function(e,t){var n,i;for(var r in e)void 0!==e[r]&&(n=r.toLowerCase(),i=e[r],t[n]=i)}(n,t),t):t},parsePointsAttribute:function(e){if(!e)return null;var t,n,i=[];for(t=0,n=(e=(e=e.replace(/,/g," ").trim()).split(/\s+/)).length;t<n;t+=2)i.push({x:parseFloat(e[t]),y:parseFloat(e[t+1])});return i},getCSSRules:function(e){var n,i,r=e.getElementsByTagName("style"),o={};for(n=0,i=r.length;n<i;n++){var a=r[n].textContent||r[n].text;""!==(a=a.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&a.match(/[^{]*\{[\s\S]*?\}/g).map((function(e){return e.trim()})).forEach((function(e){var r=e.match(/([\s\S]*?)\s*\{([^}]*)\}/),a={},s=r[2].trim().replace(/;$/,"").split(/\s*;\s*/);for(n=0,i=s.length;n<i;n++){var l=s[n].split(/\s*:\s*/),c=l[0],u=l[1];a[c]=u}(e=r[1]).split(",").forEach((function(e){""!==(e=e.replace(/^svg/i,"").trim())&&(o[e]?t.util.object.extend(o[e],a):o[e]=t.util.object.clone(a))}))}))}return o},loadSVGFromURL:function(e,n,i,r){e=e.replace(/^\n\s*/,"").trim(),new t.util.request(e,{method:"get",onComplete:function(e){var o=e.responseXML;o&&!o.documentElement&&t.window.ActiveXObject&&e.responseText&&((o=new ActiveXObject("Microsoft.XMLDOM")).async="false",o.loadXML(e.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));if(!o||!o.documentElement)return n&&n(null),!1;t.parseSVGDocument(o.documentElement,(function(e,t,i,r){n&&n(e,t,i,r)}),i,r)}})},loadSVGFromString:function(e,n,i,r){var o;if(e=e.trim(),void 0!==t.window.DOMParser){var a=new t.window.DOMParser;a&&a.parseFromString&&(o=a.parseFromString(e,"text/xml"))}else t.window.ActiveXObject&&((o=new ActiveXObject("Microsoft.XMLDOM")).async="false",o.loadXML(e.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));t.parseSVGDocument(o.documentElement,(function(e,t,i,r){n(e,t,i,r)}),i,r)}})}(t),k.ElementsParser=function(e,t,n,i,r){this.elements=e,this.callback=t,this.options=n,this.reviver=i,this.svgUid=n&&n.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g},(v=k.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},v.createObjects=function(){var e=this;this.elements.forEach((function(t,n){t.setAttribute("svgUid",e.svgUid),e.createObject(t,n)}))},v.findTag=function(e){return k[k.util.string.capitalize(e.tagName.replace("svg:",""))]},v.createObject=function(e,t){var n=this.findTag(e);if(n&&n.fromElement)try{n.fromElement(e,this.createCallback(t,e),this.options)}catch(e){k.log(e)}else this.checkIfDone()},v.createCallback=function(e,t){var n=this;return function(i){var r;n.resolveGradient(i,"fill"),n.resolveGradient(i,"stroke"),i instanceof k.Image&&i._originalElement&&(r=i.parsePreserveAspectRatioAttribute(t)),i._removeTransformMatrix(r),n.resolveClipPath(i),n.reviver&&n.reviver(t,i),n.instances[e]=i,n.checkIfDone()}},v.extractPropertyDefinition=function(e,t,n){var i=e[t];if(/^url\(/.test(i)){var r=this.regexUrl.exec(i)[1];return this.regexUrl.lastIndex=0,k[n][this.svgUid][r]}},v.resolveGradient=function(e,t){var n=this.extractPropertyDefinition(e,t,"gradientDefs");n&&e.set(t,k.Gradient.fromElement(n,e))},v.createClipPathCallback=function(e,t){return function(e){e._removeTransformMatrix(),e.fillRule=e.clipRule,t.push(e)}},v.resolveClipPath=function(e){var t,n,i,r,o=this.extractPropertyDefinition(e,"clipPath","clipPaths");if(o){i=[],n=k.util.invertTransform(e.calcTransformMatrix());for(var a=0;a<o.length;a++)t=o[a],this.findTag(t).fromElement(t,this.createClipPathCallback(e,i),this.options);o=1===i.length?i[0]:new k.Group(i),r=k.util.multiplyTransformMatrices(n,o.calcTransformMatrix());var s=k.util.qrDecompose(r);o.flipX=!1,o.flipY=!1,o.set("scaleX",s.scaleX),o.set("scaleY",s.scaleY),o.angle=s.angle,o.skewX=s.skewX,o.skewY=0,o.setPositionByOrigin({x:s.translateX,y:s.translateY},"center","center"),e.clipPath=o}},v.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter((function(e){return null!=e})),this.callback(this.instances,this.elements))},function(e){"use strict";var t=e.fabric||(e.fabric={});function n(e,t){this.x=e,this.y=t}t.Point?t.warn("fabric.Point is already defined"):(t.Point=n,n.prototype={type:"point",constructor:n,add:function(e){return new n(this.x+e.x,this.y+e.y)},addEquals:function(e){return this.x+=e.x,this.y+=e.y,this},scalarAdd:function(e){return new n(this.x+e,this.y+e)},scalarAddEquals:function(e){return this.x+=e,this.y+=e,this},subtract:function(e){return new n(this.x-e.x,this.y-e.y)},subtractEquals:function(e){return this.x-=e.x,this.y-=e.y,this},scalarSubtract:function(e){return new n(this.x-e,this.y-e)},scalarSubtractEquals:function(e){return this.x-=e,this.y-=e,this},multiply:function(e){return new n(this.x*e,this.y*e)},multiplyEquals:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return new n(this.x/e,this.y/e)},divideEquals:function(e){return this.x/=e,this.y/=e,this},eq:function(e){return this.x===e.x&&this.y===e.y},lt:function(e){return this.x<e.x&&this.y<e.y},lte:function(e){return this.x<=e.x&&this.y<=e.y},gt:function(e){return this.x>e.x&&this.y>e.y},gte:function(e){return this.x>=e.x&&this.y>=e.y},lerp:function(e,t){return void 0===t&&(t=.5),t=Math.max(Math.min(1,t),0),new n(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)},distanceFrom:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},midPointFrom:function(e){return this.lerp(e)},min:function(e){return new n(Math.min(this.x,e.x),Math.min(this.y,e.y))},max:function(e){return new n(Math.max(this.x,e.x),Math.max(this.y,e.y))},toString:function(){return this.x+","+this.y},setXY:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setFromPoint:function(e){return this.x=e.x,this.y=e.y,this},swap:function(e){var t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n},clone:function(){return new n(this.x,this.y)}})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={});function n(e){this.status=e,this.points=[]}t.Intersection?t.warn("fabric.Intersection is already defined"):(t.Intersection=n,t.Intersection.prototype={constructor:n,appendPoint:function(e){return this.points.push(e),this},appendPoints:function(e){return this.points=this.points.concat(e),this}},t.Intersection.intersectLineLine=function(e,i,r,o){var a,s=(o.x-r.x)*(e.y-r.y)-(o.y-r.y)*(e.x-r.x),l=(i.x-e.x)*(e.y-r.y)-(i.y-e.y)*(e.x-r.x),c=(o.y-r.y)*(i.x-e.x)-(o.x-r.x)*(i.y-e.y);if(0!==c){var u=s/c,h=l/c;0<=u&&u<=1&&0<=h&&h<=1?(a=new n("Intersection")).appendPoint(new t.Point(e.x+u*(i.x-e.x),e.y+u*(i.y-e.y))):a=new n}else a=new n(0===s||0===l?"Coincident":"Parallel");return a},t.Intersection.intersectLinePolygon=function(e,t,i){var r,o,a,s,l=new n,c=i.length;for(s=0;s<c;s++)r=i[s],o=i[(s+1)%c],a=n.intersectLineLine(e,t,r,o),l.appendPoints(a.points);return l.points.length>0&&(l.status="Intersection"),l},t.Intersection.intersectPolygonPolygon=function(e,t){var i,r=new n,o=e.length;for(i=0;i<o;i++){var a=e[i],s=e[(i+1)%o],l=n.intersectLinePolygon(a,s,t);r.appendPoints(l.points)}return r.points.length>0&&(r.status="Intersection"),r},t.Intersection.intersectPolygonRectangle=function(e,i,r){var o=i.min(r),a=i.max(r),s=new t.Point(a.x,o.y),l=new t.Point(o.x,a.y),c=n.intersectLinePolygon(o,s,e),u=n.intersectLinePolygon(s,a,e),h=n.intersectLinePolygon(a,l,e),d=n.intersectLinePolygon(l,o,e),f=new n;return f.appendPoints(c.points),f.appendPoints(u.points),f.appendPoints(h.points),f.appendPoints(d.points),f.points.length>0&&(f.status="Intersection"),f})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={});function n(e){e?this._tryParsingColor(e):this.setSource([0,0,0,1])}function i(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}t.Color?t.warn("fabric.Color is already defined."):(t.Color=n,t.Color.prototype={_tryParsingColor:function(e){var t;e in n.colorNameMap&&(e=n.colorNameMap[e]),"transparent"===e&&(t=[255,255,255,0]),t||(t=n.sourceFromHex(e)),t||(t=n.sourceFromRgb(e)),t||(t=n.sourceFromHsl(e)),t||(t=[0,0,0,1]),t&&this.setSource(t)},_rgbToHsl:function(e,n,i){e/=255,n/=255,i/=255;var r,o,a,s=t.util.array.max([e,n,i]),l=t.util.array.min([e,n,i]);if(a=(s+l)/2,s===l)r=o=0;else{var c=s-l;switch(o=a>.5?c/(2-s-l):c/(s+l),s){case e:r=(n-i)/c+(n<i?6:0);break;case n:r=(i-e)/c+2;break;case i:r=(e-n)/c+4}r/=6}return[Math.round(360*r),Math.round(100*o),Math.round(100*a)]},getSource:function(){return this._source},setSource:function(e){this._source=e},toRgb:function(){var e=this.getSource();return"rgb("+e[0]+","+e[1]+","+e[2]+")"},toRgba:function(){var e=this.getSource();return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")"},toHsl:function(){var e=this.getSource(),t=this._rgbToHsl(e[0],e[1],e[2]);return"hsl("+t[0]+","+t[1]+"%,"+t[2]+"%)"},toHsla:function(){var e=this.getSource(),t=this._rgbToHsl(e[0],e[1],e[2]);return"hsla("+t[0]+","+t[1]+"%,"+t[2]+"%,"+e[3]+")"},toHex:function(){var e,t,n,i=this.getSource();return e=1===(e=i[0].toString(16)).length?"0"+e:e,t=1===(t=i[1].toString(16)).length?"0"+t:t,n=1===(n=i[2].toString(16)).length?"0"+n:n,e.toUpperCase()+t.toUpperCase()+n.toUpperCase()},toHexa:function(){var e,t=this.getSource();return e=1===(e=(e=Math.round(255*t[3])).toString(16)).length?"0"+e:e,this.toHex()+e.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(e){var t=this.getSource();return t[3]=e,this.setSource(t),this},toGrayscale:function(){var e=this.getSource(),t=parseInt((.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),10),n=e[3];return this.setSource([t,t,t,n]),this},toBlackWhite:function(e){var t=this.getSource(),n=(.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),i=t[3];return e=e||127,n=Number(n)<Number(e)?0:255,this.setSource([n,n,n,i]),this},overlayWith:function(e){e instanceof n||(e=new n(e));var t,i=[],r=this.getAlpha(),o=this.getSource(),a=e.getSource();for(t=0;t<3;t++)i.push(Math.round(.5*o[t]+.5*a[t]));return i[3]=r,this.setSource(i),this}},t.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,t.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,t.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,t.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},t.Color.fromRgb=function(e){return n.fromSource(n.sourceFromRgb(e))},t.Color.sourceFromRgb=function(e){var t=e.match(n.reRGBa);if(t){var i=parseInt(t[1],10)/(/%$/.test(t[1])?100:1)*(/%$/.test(t[1])?255:1),r=parseInt(t[2],10)/(/%$/.test(t[2])?100:1)*(/%$/.test(t[2])?255:1),o=parseInt(t[3],10)/(/%$/.test(t[3])?100:1)*(/%$/.test(t[3])?255:1);return[parseInt(i,10),parseInt(r,10),parseInt(o,10),t[4]?parseFloat(t[4]):1]}},t.Color.fromRgba=n.fromRgb,t.Color.fromHsl=function(e){return n.fromSource(n.sourceFromHsl(e))},t.Color.sourceFromHsl=function(e){var t=e.match(n.reHSLa);if(t){var r,o,a,s=(parseFloat(t[1])%360+360)%360/360,l=parseFloat(t[2])/(/%$/.test(t[2])?100:1),c=parseFloat(t[3])/(/%$/.test(t[3])?100:1);if(0===l)r=o=a=c;else{var u=c<=.5?c*(l+1):c+l-c*l,h=2*c-u;r=i(h,u,s+1/3),o=i(h,u,s),a=i(h,u,s-1/3)}return[Math.round(255*r),Math.round(255*o),Math.round(255*a),t[4]?parseFloat(t[4]):1]}},t.Color.fromHsla=n.fromHsl,t.Color.fromHex=function(e){return n.fromSource(n.sourceFromHex(e))},t.Color.sourceFromHex=function(e){if(e.match(n.reHex)){var t=e.slice(e.indexOf("#")+1),i=3===t.length||4===t.length,r=8===t.length||4===t.length,o=i?t.charAt(0)+t.charAt(0):t.substring(0,2),a=i?t.charAt(1)+t.charAt(1):t.substring(2,4),s=i?t.charAt(2)+t.charAt(2):t.substring(4,6),l=r?i?t.charAt(3)+t.charAt(3):t.substring(6,8):"FF";return[parseInt(o,16),parseInt(a,16),parseInt(s,16),parseFloat((parseInt(l,16)/255).toFixed(2))]}},t.Color.fromSource=function(e){var t=new n;return t.setSource(e),t})}(t),function(){function e(e){var t,n,i,r,o=e.getAttribute("style"),a=e.getAttribute("offset")||0;if(a=(a=parseFloat(a)/(/%$/.test(a)?100:1))<0?0:a>1?1:a,o){var s=o.split(/\s*;\s*/);for(""===s[s.length-1]&&s.pop(),r=s.length;r--;){var l=s[r].split(/\s*:\s*/),c=l[0].trim(),u=l[1].trim();"stop-color"===c?t=u:"stop-opacity"===c&&(i=u)}}return t||(t=e.getAttribute("stop-color")||"rgb(0,0,0)"),i||(i=e.getAttribute("stop-opacity")),n=(t=new k.Color(t)).getAlpha(),i=isNaN(parseFloat(i))?1:parseFloat(i),i*=n,{offset:a,color:t.toRgb(),opacity:i}}var t=k.util.object.clone;function n(e,t,n){var i,r=0,o=1,a="";for(var s in t)"Infinity"===t[s]?t[s]=1:"-Infinity"===t[s]&&(t[s]=0),i=parseFloat(t[s],10),o="string"==typeof t[s]&&/^(\d+\.\d+)%|(\d+)%$/.test(t[s])?.01:1,"x1"===s||"x2"===s||"r2"===s?(o*="objectBoundingBox"===n?e.width:1,r="objectBoundingBox"===n&&e.left||0):"y1"!==s&&"y2"!==s||(o*="objectBoundingBox"===n?e.height:1,r="objectBoundingBox"===n&&e.top||0),t[s]=i*o+r;if("ellipse"===e.type&&null!==t.r2&&"objectBoundingBox"===n&&e.rx!==e.ry){var l=e.ry/e.rx;a=" scale(1, "+l+")",t.y1&&(t.y1/=l),t.y2&&(t.y2/=l)}return a}k.Gradient=k.util.createClass({offsetX:0,offsetY:0,initialize:function(e){e||(e={});var t={};this.id=k.Object.__uid++,this.type=e.type||"linear",t={x1:e.coords.x1||0,y1:e.coords.y1||0,x2:e.coords.x2||0,y2:e.coords.y2||0},"radial"===this.type&&(t.r1=e.coords.r1||0,t.r2=e.coords.r2||0),this.coords=t,this.colorStops=e.colorStops.slice(),e.gradientTransform&&(this.gradientTransform=e.gradientTransform),this.offsetX=e.offsetX||this.offsetX,this.offsetY=e.offsetY||this.offsetY},addColorStop:function(e){for(var t in e){var n=new k.Color(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(e){var t={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return k.util.populateWithProperties(this,t,e),t},toSVG:function(e,n){var i,r,o,a,s=t(this.coords,!0),l=(n=n||{},t(this.colorStops,!0)),c=s.r1>s.r2,u=this.gradientTransform?this.gradientTransform.concat():k.iMatrix.concat(),h=e.width/2-this.offsetX,d=e.height/2-this.offsetY,f=!!n.additionalTransform;if(l.sort((function(e,t){return e.offset-t.offset})),"path"===e.type&&(h-=e.pathOffset.x,d-=e.pathOffset.y),u[4]-=h,u[5]-=d,a='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"',a+=' gradientTransform="'+(f?n.additionalTransform+" ":"")+k.util.matrixToSVG(u)+'" ',"linear"===this.type?o=["<linearGradient ",a,' x1="',s.x1,'" y1="',s.y1,'" x2="',s.x2,'" y2="',s.y2,'">\n']:"radial"===this.type&&(o=["<radialGradient ",a,' cx="',c?s.x1:s.x2,'" cy="',c?s.y1:s.y2,'" r="',c?s.r1:s.r2,'" fx="',c?s.x2:s.x1,'" fy="',c?s.y2:s.y1,'">\n']),"radial"===this.type){if(c)for((l=l.concat()).reverse(),i=0,r=l.length;i<r;i++)l[i].offset=1-l[i].offset;var p=Math.min(s.r1,s.r2);if(p>0){var g=p/Math.max(s.r1,s.r2);for(i=0,r=l.length;i<r;i++)l[i].offset+=g*(1-l[i].offset)}}for(i=0,r=l.length;i<r;i++){var v=l[i];o.push("<stop ",'offset="',100*v.offset+"%",'" style="stop-color:',v.color,void 0!==v.opacity?";stop-opacity: "+v.opacity:";",'"/>\n')}return o.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),o.join("")},toLive:function(e){var t,n,i,r=k.util.object.clone(this.coords);if(this.type){for("linear"===this.type?t=e.createLinearGradient(r.x1,r.y1,r.x2,r.y2):"radial"===this.type&&(t=e.createRadialGradient(r.x1,r.y1,r.r1,r.x2,r.y2,r.r2)),n=0,i=this.colorStops.length;n<i;n++){var o=this.colorStops[n].color,a=this.colorStops[n].opacity,s=this.colorStops[n].offset;void 0!==a&&(o=new k.Color(o).setAlpha(a).toRgba()),t.addColorStop(s,o)}return t}}}),k.util.object.extend(k.Gradient,{fromElement:function(t,i){var r,o,a,s,l=t.getElementsByTagName("stop"),c=t.getAttribute("gradientUnits")||"objectBoundingBox",u=t.getAttribute("gradientTransform"),h=[];for("linear"===(r="linearGradient"===t.nodeName||"LINEARGRADIENT"===t.nodeName?"linear":"radial")?o=function(e){return{x1:e.getAttribute("x1")||0,y1:e.getAttribute("y1")||0,x2:e.getAttribute("x2")||"100%",y2:e.getAttribute("y2")||0}}(t):"radial"===r&&(o=function(e){return{x1:e.getAttribute("fx")||e.getAttribute("cx")||"50%",y1:e.getAttribute("fy")||e.getAttribute("cy")||"50%",r1:0,x2:e.getAttribute("cx")||"50%",y2:e.getAttribute("cy")||"50%",r2:e.getAttribute("r")||"50%"}}(t)),s=l.length;s--;)h.push(e(l[s]));a=n(i,o,c);var d=new k.Gradient({type:r,coords:o,colorStops:h,offsetX:-i.left,offsetY:-i.top});return(u||""!==a)&&(d.gradientTransform=k.parseTransformAttribute((u||"")+a)),d},forObject:function(e,t){return t||(t={}),n(e,t.coords,"userSpaceOnUse"),new k.Gradient(t)}})}(),function(){"use strict";var e=k.util.toFixed;k.Pattern=k.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(e,t){if(e||(e={}),this.id=k.Object.__uid++,this.setOptions(e),!e.source||e.source&&"string"!=typeof e.source)t&&t(this);else if(void 0!==k.util.getFunctionBody(e.source))this.source=new Function(k.util.getFunctionBody(e.source)),t&&t(this);else{var n=this;this.source=k.util.createImage(),k.util.loadImage(e.source,(function(e){n.source=e,t&&t(n)}),null,this.crossOrigin)}},toObject:function(t){var n,i,r=k.Object.NUM_FRACTION_DIGITS;return"function"==typeof this.source?n=String(this.source):"string"==typeof this.source.src?n=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(n=this.source.toDataURL()),i={type:"pattern",source:n,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:e(this.offsetX,r),offsetY:e(this.offsetY,r),patternTransform:this.patternTransform?this.patternTransform.concat():null},k.util.populateWithProperties(this,i,t),i},toSVG:function(e){var t="function"==typeof this.source?this.source():this.source,n=t.width/e.width,i=t.height/e.height,r=this.offsetX/e.width,o=this.offsetY/e.height,a="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(i=1,o&&(i+=Math.abs(o))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(n=1,r&&(n+=Math.abs(r))),t.src?a=t.src:t.toDataURL&&(a=t.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+r+'" y="'+o+'" width="'+n+'" height="'+i+'">\n<image x="0" y="0" width="'+t.width+'" height="'+t.height+'" xlink:href="'+a+'"></image>\n</pattern>\n'},setOptions:function(e){for(var t in e)this[t]=e[t]},toLive:function(e){var t="function"==typeof this.source?this.source():this.source;if(!t)return"";if(void 0!==t.src){if(!t.complete)return"";if(0===t.naturalWidth||0===t.naturalHeight)return""}return e.createPattern(t,this.repeat)}})}(),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.toFixed;t.Shadow?t.warn("fabric.Shadow is already defined."):(t.Shadow=t.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(e){for(var n in"string"==typeof e&&(e=this._parseShadow(e)),e)this[n]=e[n];this.id=t.Object.__uid++},_parseShadow:function(e){var n=e.trim(),i=t.Shadow.reOffsetsAndBlur.exec(n)||[];return{color:(n.replace(t.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseInt(i[1],10)||0,offsetY:parseInt(i[2],10)||0,blur:parseInt(i[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(e){var i=40,r=40,o=t.Object.NUM_FRACTION_DIGITS,a=t.util.rotateVector({x:this.offsetX,y:this.offsetY},t.util.degreesToRadians(-e.angle)),s=new t.Color(this.color);return e.width&&e.height&&(i=100*n((Math.abs(a.x)+this.blur)/e.width,o)+20,r=100*n((Math.abs(a.y)+this.blur)/e.height,o)+20),e.flipX&&(a.x*=-1),e.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+r+'%" height="'+(100+2*r)+'%" x="-'+i+'%" width="'+(100+2*i)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+n(this.blur?this.blur/2:0,o)+'"></feGaussianBlur>\n\t<feOffset dx="'+n(a.x,o)+'" dy="'+n(a.y,o)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+s.toRgb()+'" flood-opacity="'+s.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var e={},n=t.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach((function(t){this[t]!==n[t]&&(e[t]=this[t])}),this),e}}),t.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/)}(t),function(){"use strict";if(k.StaticCanvas)k.warn("fabric.StaticCanvas is already defined.");else{var e=k.util.object.extend,t=k.util.getElementOffset,n=k.util.removeFromArray,i=k.util.toFixed,r=k.util.transformPoint,o=k.util.invertTransform,a=k.util.getNodeCanvas,s=k.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");k.StaticCanvas=k.util.createClass(k.CommonMethods,{initialize:function(e,t){t||(t={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(e,t)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:k.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,onBeforeScaleRotate:function(){},enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(e,t){var n=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(e),this._initOptions(t),this._setImageSmoothing(),this.interactive||this._initRetinaScaling(),t.overlayImage&&this.setOverlayImage(t.overlayImage,n),t.backgroundImage&&this.setBackgroundImage(t.backgroundImage,n),t.backgroundColor&&this.setBackgroundColor(t.backgroundColor,n),t.overlayColor&&this.setOverlayColor(t.overlayColor,n),this.calcOffset()},_isRetinaScaling:function(){return 1!==k.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?k.devicePixelRatio:1},_initRetinaScaling:function(){this._isRetinaScaling()&&(this.lowerCanvasEl.setAttribute("width",this.width*k.devicePixelRatio),this.lowerCanvasEl.setAttribute("height",this.height*k.devicePixelRatio),this.contextContainer.scale(k.devicePixelRatio,k.devicePixelRatio))},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(e,t,n){return this.__setBgOverlayImage("overlayImage",e,t,n)},setBackgroundImage:function(e,t,n){return this.__setBgOverlayImage("backgroundImage",e,t,n)},setOverlayColor:function(e,t){return this.__setBgOverlayColor("overlayColor",e,t)},setBackgroundColor:function(e,t){return this.__setBgOverlayColor("backgroundColor",e,t)},_setImageSmoothing:function(){var e=this.getContext();e.imageSmoothingEnabled=e.imageSmoothingEnabled||e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled||e.oImageSmoothingEnabled,e.imageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(e,t,n,i){return"string"==typeof t?k.util.loadImage(t,(function(t){if(t){var r=new k.Image(t,i);this[e]=r,r.canvas=this}n&&n(t)}),this,i&&i.crossOrigin):(i&&t.setOptions(i),this[e]=t,t&&(t.canvas=this),n&&n(t)),this},__setBgOverlayColor:function(e,t,n){return this[e]=t,this._initGradient(t,e),this._initPattern(t,e,n),this},_createCanvasElement:function(){var e=s();if(!e)throw l;if(e.style||(e.style={}),void 0===e.getContext)throw l;return e},_initOptions:function(e){var t=this.lowerCanvasEl;this._setOptions(e),this.width=this.width||parseInt(t.width,10)||0,this.height=this.height||parseInt(t.height,10)||0,this.lowerCanvasEl.style&&(t.width=this.width,t.height=this.height,t.style.width=this.width+"px",t.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(e){e&&e.getContext?this.lowerCanvasEl=e:this.lowerCanvasEl=k.util.getById(e)||this._createCanvasElement(),k.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(e,t){return this.setDimensions({width:e},t)},setHeight:function(e,t){return this.setDimensions({height:e},t)},setDimensions:function(e,t){var n;for(var i in t=t||{},e)n=e[i],t.cssOnly||(this._setBackstoreDimension(i,e[i]),n+="px",this.hasLostContext=!0),t.backstoreOnly||this._setCssDimension(i,n);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(),this._initRetinaScaling(),this._setImageSmoothing(),this.calcOffset(),t.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(e,t){return this.lowerCanvasEl[e]=t,this.upperCanvasEl&&(this.upperCanvasEl[e]=t),this.cacheCanvasEl&&(this.cacheCanvasEl[e]=t),this[e]=t,this},_setCssDimension:function(e,t){return this.lowerCanvasEl.style[e]=t,this.upperCanvasEl&&(this.upperCanvasEl.style[e]=t),this.wrapperEl&&(this.wrapperEl.style[e]=t),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(e){var t,n,i,r=this._activeObject;for(this.viewportTransform=e,n=0,i=this._objects.length;n<i;n++)(t=this._objects[n]).group||t.setCoords(!1,!0);return r&&"activeSelection"===r.type&&r.setCoords(!1,!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(e,t){var n=e,i=this.viewportTransform.slice(0);e=r(e,o(this.viewportTransform)),i[0]=t,i[3]=t;var a=r(e,i);return i[4]+=n.x-a.x,i[5]+=n.y-a.y,this.setViewportTransform(i)},setZoom:function(e){return this.zoomToPoint(new k.Point(0,0),e),this},absolutePan:function(e){var t=this.viewportTransform.slice(0);return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)},relativePan:function(e){return this.absolutePan(new k.Point(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(e){this.stateful&&e.setupState(),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added")},_onObjectRemoved:function(e){this.fire("object:removed",{target:e}),e.fire("removed"),delete e.canvas},clearContext:function(e){return e.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var e=this.contextContainer;return this.renderCanvas(e,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=k.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var e={},t=this.width,n=this.height,i=o(this.viewportTransform);return e.tl=r({x:0,y:0},i),e.br=r({x:t,y:n},i),e.tr=new k.Point(e.br.x,e.tl.y),e.bl=new k.Point(e.tl.x,e.br.y),this.vptCoords=e,e},cancelRequestedRender:function(){this.isRendering&&(k.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(e,t){var n=this.viewportTransform,i=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(e),this.fire("before:render",{ctx:e}),this.clipTo&&k.util.clipContext(this,e),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),this.clipTo&&e.restore(),i&&(i.canvas=this,i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e)),this._renderOverlay(e),this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),this.fire("after:render",{ctx:e})},drawClipPathOnCanvas:function(e){var t=this.viewportTransform,n=this.clipPath;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5]),e.globalCompositeOperation="destination-in",n.transform(e),e.scale(1/n.zoomX,1/n.zoomY),e.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),e.restore()},_renderObjects:function(e,t){var n,i;for(n=0,i=t.length;n<i;++n)t[n]&&t[n].render(e)},_renderBackgroundOrOverlay:function(e,t){var n=this[t+"Color"],i=this[t+"Image"],r=this.viewportTransform,o=this[t+"Vpt"];if(n||i){if(n){e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=n.toLive?n.toLive(e,this):n,o&&e.transform(r[0],r[1],r[2],r[3],r[4]+(n.offsetX||0),r[5]+(n.offsetY||0));var a=n.gradientTransform||n.patternTransform;a&&e.transform(a[0],a[1],a[2],a[3],a[4],a[5]),e.fill(),e.restore()}i&&(e.save(),o&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i.render(e),e.restore())}},_renderBackground:function(e){this._renderBackgroundOrOverlay(e,"background")},_renderOverlay:function(e){this._renderBackgroundOrOverlay(e,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(e){return this._centerObject(e,new k.Point(this.getCenter().left,e.getCenterPoint().y))},centerObjectV:function(e){return this._centerObject(e,new k.Point(e.getCenterPoint().x,this.getCenter().top))},centerObject:function(e){var t=this.getCenter();return this._centerObject(e,new k.Point(t.left,t.top))},viewportCenterObject:function(e){var t=this.getVpCenter();return this._centerObject(e,t)},viewportCenterObjectH:function(e){var t=this.getVpCenter();return this._centerObject(e,new k.Point(t.x,e.getCenterPoint().y)),this},viewportCenterObjectV:function(e){var t=this.getVpCenter();return this._centerObject(e,new k.Point(e.getCenterPoint().x,t.y))},getVpCenter:function(){var e=this.getCenter(),t=o(this.viewportTransform);return r({x:e.left,y:e.top},t)},_centerObject:function(e,t){return e.setPositionByOrigin(t,"center","center"),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(e){return this.toDatalessObject(e)},toObject:function(e){return this._toObjectMethod("toObject",e)},toDatalessObject:function(e){return this._toObjectMethod("toDatalessObject",e)},_toObjectMethod:function(t,n){var i=this.clipPath,r={version:k.version,objects:this._toObjects(t,n)};return i&&(r.clipPath=this._toObject(this.clipPath,t,n)),e(r,this.__serializeBgOverlay(t,n)),k.util.populateWithProperties(this,r,n),r},_toObjects:function(e,t){return this._objects.filter((function(e){return!e.excludeFromExport})).map((function(n){return this._toObject(n,e,t)}),this)},_toObject:function(e,t,n){var i;this.includeDefaultValues||(i=e.includeDefaultValues,e.includeDefaultValues=!1);var r=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=i),r},__serializeBgOverlay:function(e,t){var n={},i=this.backgroundImage,r=this.overlayImage;return this.backgroundColor&&(n.background=this.backgroundColor.toObject?this.backgroundColor.toObject(t):this.backgroundColor),this.overlayColor&&(n.overlay=this.overlayColor.toObject?this.overlayColor.toObject(t):this.overlayColor),i&&!i.excludeFromExport&&(n.backgroundImage=this._toObject(i,e,t)),r&&!r.excludeFromExport&&(n.overlayImage=this._toObject(r,e,t)),n},svgViewportTransformation:!0,toSVG:function(e,t){e||(e={}),e.reviver=t;var n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push("</g>\n"),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")},_setSVGPreamble:function(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(e,t){var n,r=t.width||this.width,o=t.height||this.height,a='viewBox="0 0 '+this.width+" "+this.height+'" ',s=k.Object.NUM_FRACTION_DIGITS;t.viewBox?a='viewBox="'+t.viewBox.x+" "+t.viewBox.y+" "+t.viewBox.width+" "+t.viewBox.height+'" ':this.svgViewportTransformation&&(n=this.viewportTransform,a='viewBox="'+i(-n[4]/n[0],s)+" "+i(-n[5]/n[3],s)+" "+i(this.width/n[0],s)+" "+i(this.height/n[3],s)+'" '),e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',o,'" ',a,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",k.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),"</defs>\n")},createSVGClipPathMarkup:function(e){var t=this.clipPath;return t?(t.clipPathId="CLIPPATH_"+k.Object.__uid++,'<clipPath id="'+t.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(e.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var e=this;return["background","overlay"].map((function(t){var n=e[t+"Color"];if(n&&n.toLive){var i=e[t+"Vpt"],r=e.viewportTransform,o={width:e.width/(i?r[0]:1),height:e.height/(i?r[3]:1)};return n.toSVG(o,{additionalTransform:i?k.util.matrixToSVG(r):""})}})).join("")},createSVGFontFacesMarkup:function(){var e,t,n,i,r,o,a,s,l="",c={},u=k.fontPaths,h=this._objects;for(a=0,s=h.length;a<s;a++)if(t=(e=h[a]).fontFamily,-1!==e.type.indexOf("text")&&!c[t]&&u[t]&&(c[t]=!0,e.styles))for(r in n=e.styles)for(o in i=n[r])!c[t=i[o].fontFamily]&&u[t]&&(c[t]=!0);for(var d in c)l+=["\t\t@font-face {\n","\t\t\tfont-family: '",d,"';\n","\t\t\tsrc: url('",u[d],"');\n","\t\t}\n"].join("");return l&&(l=['\t<style type="text/css">',"<![CDATA[\n",l,"]]>","</style>\n"].join("")),l},_setSVGObjects:function(e,t){var n,i,r,o=this._objects;for(i=0,r=o.length;i<r;i++)(n=o[i]).excludeFromExport||this._setSVGObject(e,n,t)},_setSVGObject:function(e,t,n){e.push(t.toSVG(n))},_setSVGBgOverlayImage:function(e,t,n){this[t]&&!this[t].excludeFromExport&&this[t].toSVG&&e.push(this[t].toSVG(n))},_setSVGBgOverlayColor:function(e,t){var n=this[t+"Color"],i=this.viewportTransform,r=this.width,o=this.height;if(n)if(n.toLive){var a=n.repeat,s=k.util.invertTransform(i),l=this[t+"Vpt"]?k.util.matrixToSVG(s):"";e.push('<rect transform="'+l+" translate(",r/2,",",o/2,')"',' x="',n.offsetX-r/2,'" y="',n.offsetY-o/2,'" ','width="',"repeat-y"===a||"no-repeat"===a?n.source.width:r,'" height="',"repeat-x"===a||"no-repeat"===a?n.source.height:o,'" fill="url(#SVGID_'+n.id+')"',"></rect>\n")}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',"></rect>\n")},sendToBack:function(e){if(!e)return this;var t,i,r,o=this._activeObject;if(e===o&&"activeSelection"===e.type)for(t=(r=o._objects).length;t--;)i=r[t],n(this._objects,i),this._objects.unshift(i);else n(this._objects,e),this._objects.unshift(e);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(e){if(!e)return this;var t,i,r,o=this._activeObject;if(e===o&&"activeSelection"===e.type)for(r=o._objects,t=0;t<r.length;t++)i=r[t],n(this._objects,i),this._objects.push(i);else n(this._objects,e),this._objects.push(e);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(e,t){if(!e)return this;var i,r,o,a,s,l=this._activeObject,c=0;if(e===l&&"activeSelection"===e.type)for(s=l._objects,i=0;i<s.length;i++)r=s[i],(o=this._objects.indexOf(r))>0+c&&(a=o-1,n(this._objects,r),this._objects.splice(a,0,r)),c++;else 0!==(o=this._objects.indexOf(e))&&(a=this._findNewLowerIndex(e,o,t),n(this._objects,e),this._objects.splice(a,0,e));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(e,t,n){var i,r;if(n)for(i=t,r=t-1;r>=0;--r){if(e.intersectsWithObject(this._objects[r])||e.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(e)){i=r;break}}else i=t-1;return i},bringForward:function(e,t){if(!e)return this;var i,r,o,a,s,l=this._activeObject,c=0;if(e===l&&"activeSelection"===e.type)for(i=(s=l._objects).length;i--;)r=s[i],(o=this._objects.indexOf(r))<this._objects.length-1-c&&(a=o+1,n(this._objects,r),this._objects.splice(a,0,r)),c++;else(o=this._objects.indexOf(e))!==this._objects.length-1&&(a=this._findNewUpperIndex(e,o,t),n(this._objects,e),this._objects.splice(a,0,e));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(e,t,n){var i,r,o;if(n)for(i=t,r=t+1,o=this._objects.length;r<o;++r){if(e.intersectsWithObject(this._objects[r])||e.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(e)){i=r;break}}else i=t+1;return i},moveTo:function(e,t){return n(this._objects,e),this._objects.splice(t,0,e),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(k.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(e){e.dispose&&e.dispose()})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,k.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),e(k.StaticCanvas.prototype,k.Observable),e(k.StaticCanvas.prototype,k.Collection),e(k.StaticCanvas.prototype,k.DataURLExporter),e(k.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(e){var t=s();if(!t||!t.getContext)return null;var n=t.getContext("2d");if(!n)return null;switch(e){case"setLineDash":return void 0!==n.setLineDash;default:return null}}}),k.StaticCanvas.prototype.toJSON=k.StaticCanvas.prototype.toObject,k.isLikelyNode&&(k.StaticCanvas.prototype.createPNGStream=function(){var e=a(this.lowerCanvasEl);return e&&e.createPNGStream()},k.StaticCanvas.prototype.createJPEGStream=function(e){var t=a(this.lowerCanvasEl);return t&&t.createJPEGStream(e)})}}(),k.BaseBrush=k.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,setShadow:function(e){return this.shadow=new k.Shadow(e),this},_setBrushStyles:function(){var e=this.canvas.contextTop;e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,k.StaticCanvas.supports("setLineDash")&&e.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(e){var t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])},_setShadow:function(){if(this.shadow){var e=this.canvas.contextTop,t=this.canvas.getZoom();e.shadowColor=this.shadow.color,e.shadowBlur=this.shadow.blur*t,e.shadowOffsetX=this.shadow.offsetX*t,e.shadowOffsetY=this.shadow.offsetY*t}},needsFullRender:function(){return new k.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0}}),k.PencilBrush=k.util.createClass(k.BaseBrush,{decimate:.4,initialize:function(e){this.canvas=e,this._points=[]},_drawSegment:function(e,t,n){var i=t.midPointFrom(n);return e.quadraticCurveTo(t.x,t.y,i.x,i.y),i},onMouseDown:function(e,t){this.canvas._isMainEvent(t.e)&&(this._prepareForDrawing(e),this._captureDrawingPath(e),this._render())},onMouseMove:function(e,t){if(this.canvas._isMainEvent(t.e)&&this._captureDrawingPath(e)&&this._points.length>1)if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var n=this._points,i=n.length,r=this.canvas.contextTop;this._saveAndTransform(r),this.oldEnd&&(r.beginPath(),r.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(r,n[i-2],n[i-1],!0),r.stroke(),r.restore()}},onMouseUp:function(e){return!this.canvas._isMainEvent(e.e)||(this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(e){var t=new k.Point(e.x,e.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(e){return!(this._points.length>1&&e.eq(this._points[this._points.length-1])||(this._points.push(e),0))},_reset:function(){this._points=[],this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(e){var t=new k.Point(e.x,e.y);return this._addPoint(t)},_render:function(){var e,t,n=this.canvas.contextTop,i=this._points[0],r=this._points[1];if(this._saveAndTransform(n),n.beginPath(),2===this._points.length&&i.x===r.x&&i.y===r.y){var o=this.width/1e3;i=new k.Point(i.x,i.y),r=new k.Point(r.x,r.y),i.x-=o,r.x+=o}for(n.moveTo(i.x,i.y),e=1,t=this._points.length;e<t;e++)this._drawSegment(n,i,r),i=this._points[e],r=this._points[e+1];n.lineTo(i.x,i.y),n.stroke(),n.restore()},convertPointsToSVGPath:function(e){var t,n=[],i=this.width/1e3,r=new k.Point(e[0].x,e[0].y),o=new k.Point(e[1].x,e[1].y),a=e.length,s=1,l=0,c=a>2;for(c&&(s=e[2].x<o.x?-1:e[2].x===o.x?0:1,l=e[2].y<o.y?-1:e[2].y===o.y?0:1),n.push("M ",r.x-s*i," ",r.y-l*i," "),t=1;t<a;t++){if(!r.eq(o)){var u=r.midPointFrom(o);n.push("Q ",r.x," ",r.y," ",u.x," ",u.y," ")}r=e[t],t+1<e.length&&(o=e[t+1])}return c&&(s=r.x>e[t-2].x?1:r.x===e[t-2].x?0:-1,l=r.y>e[t-2].y?1:r.y===e[t-2].y?0:-1),n.push("L ",r.x+s*i," ",r.y+l*i),n},createPath:function(e){var t=new k.Path(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.setShadow(this.shadow)),t},decimatePoints:function(e,t){if(e.length<=2)return e;var n,i=this.canvas.getZoom(),r=Math.pow(t/i,2),o=e.length-1,a=e[0],s=[a];for(n=1;n<o;n++)Math.pow(a.x-e[n].x,2)+Math.pow(a.y-e[n].y,2)>=r&&(a=e[n],s.push(a));return 1===s.length&&s.push(new k.Point(s[0].x,s[0].y)),s},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"!==e){var t=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.add(t),this.canvas.renderAll(),t.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:t})}else this.canvas.requestRenderAll()}}),k.CircleBrush=k.util.createClass(k.BaseBrush,{width:10,initialize:function(e){this.canvas=e,this.points=[]},drawDot:function(e){var t=this.addPoint(e),n=this.canvas.contextTop;this._saveAndTransform(n),this.dot(n,t),n.restore()},dot:function(e,t){e.fillStyle=t.fill,e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!1),e.closePath(),e.fill()},onMouseDown:function(e){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)},_render:function(){var e,t,n=this.canvas.contextTop,i=this.points;for(this._saveAndTransform(n),e=0,t=i.length;e<t;e++)this.dot(n,i[e]);n.restore()},onMouseMove:function(e){this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(e),this._render()):this.drawDot(e)},onMouseUp:function(){var e,t,n=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var i=[];for(e=0,t=this.points.length;e<t;e++){var r=this.points[e],o=new k.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&o.setShadow(this.shadow),i.push(o)}var a=new k.Group(i);a.canvas=this.canvas,this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=n,this.canvas.requestRenderAll()},addPoint:function(e){var t=new k.Point(e.x,e.y),n=k.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,i=new k.Color(this.color).setAlpha(k.util.getRandomInt(0,100)/100).toRgba();return t.radius=n,t.fill=i,this.points.push(t),t}}),k.SprayBrush=k.util.createClass(k.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e,this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.render(this.sprayChunkPoints)},onMouseMove:function(e){this.addSprayChunk(e),this.render(this.sprayChunkPoints)},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var t=[],n=0,i=this.sprayChunks.length;n<i;n++)for(var r=this.sprayChunks[n],o=0,a=r.length;o<a;o++){var s=new k.Rect({width:r[o].width,height:r[o].width,left:r[o].x+1,top:r[o].y+1,originX:"center",originY:"center",fill:this.color});t.push(s)}this.optimizeOverlapping&&(t=this._getOptimizedRects(t));var l=new k.Group(t);this.shadow&&l.setShadow(this.shadow),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},_getOptimizedRects:function(e){var t,n,i,r={};for(n=0,i=e.length;n<i;n++)r[t=e[n].left+""+e[n].top]||(r[t]=e[n]);var o=[];for(t in r)o.push(r[t]);return o},render:function(e){var t,n,i=this.canvas.contextTop;for(i.fillStyle=this.color,this._saveAndTransform(i),t=0,n=e.length;t<n;t++){var r=e[t];void 0!==r.opacity&&(i.globalAlpha=r.opacity),i.fillRect(r.x,r.y,r.width,r.width)}i.restore()},_render:function(){var e,t,n=this.canvas.contextTop;for(n.fillStyle=this.color,this._saveAndTransform(n),e=0,t=this.sprayChunks.length;e<t;e++)this.render(this.sprayChunks[e]);n.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];var t,n,i,r,o=this.width/2;for(r=0;r<this.density;r++){t=k.util.getRandomInt(e.x-o,e.x+o),n=k.util.getRandomInt(e.y-o,e.y+o),i=this.dotWidthVariance?k.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var a=new k.Point(t,n);a.width=i,this.randomOpacity&&(a.opacity=k.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}}),k.PatternBrush=k.util.createClass(k.PencilBrush,{getPatternSrc:function(){var e=k.util.createCanvasElement(),t=e.getContext("2d");return e.width=e.height=25,t.fillStyle=this.color,t.beginPath(),t.arc(10,10,10,0,2*Math.PI,!1),t.closePath(),t.fill(),e},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(e){var t=this.callSuper("createPath",e),n=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new k.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-n.x,offsetY:-n.y}),t}}),function(){var e=k.util.getPointer,t=k.util.degreesToRadians,n=k.util.radiansToDegrees,i=Math.atan2,r=Math.abs,o=k.StaticCanvas.supports("setLineDash");for(var a in k.Canvas=k.util.createClass(k.StaticCanvas,{initialize:function(e,t){t||(t={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(e,t),this._initInteractive(),this._createCacheCanvas()},uniScaleTransform:!1,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=k.PencilBrush&&new k.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var e,t,n,i=this.getActiveObjects();if(i.length>0&&!this.preserveObjectStacking){t=[],n=[];for(var r=0,o=this._objects.length;r<o;r++)e=this._objects[r],-1===i.indexOf(e)?t.push(e):n.push(e);i.length>1&&(this._activeObject._objects=n),t.push.apply(t,n)}else t=this._objects;return t},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&this.renderTopLayer(this.contextTop);var e=this.contextContainer;return this.renderCanvas(e,this._chooseObjectsToRender()),this},renderTopLayer:function(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()},renderTop:function(){var e=this.contextTop;return this.clearContext(e),this.renderTopLayer(e),this.fire("after:render"),this},_resetCurrentTransform:function(){var e=this._currentTransform;e.target.set({scaleX:e.original.scaleX,scaleY:e.original.scaleY,skewX:e.original.skewX,skewY:e.original.skewY,left:e.original.left,top:e.original.top}),this._shouldCenterTransform(e.target)?("center"!==e.originX&&("right"===e.originX?e.mouseXSign=-1:e.mouseXSign=1),"center"!==e.originY&&("bottom"===e.originY?e.mouseYSign=-1:e.mouseYSign=1),e.originX="center",e.originY="center"):(e.originX=e.original.originX,e.originY=e.original.originY)},containsPoint:function(e,t,n){var i,r=n||this.getPointer(e,!0);return i=t.group&&t.group===this._activeObject&&"activeSelection"===t.group.type?this._normalizePointer(t.group,r):{x:r.x,y:r.y},t.containsPoint(i)||t._findTargetCorner(r)},_normalizePointer:function(e,t){var n=e.calcTransformMatrix(),i=k.util.invertTransform(n),r=this.restorePointerVpt(t);return k.util.transformPoint(r,i)},isTargetTransparent:function(e,t,n){if(e.shouldCache()&&e._cacheCanvas&&e!==this._activeObject){var i=this._normalizePointer(e,{x:t,y:n}),r=Math.max(e.cacheTranslationX+i.x*e.zoomX,0),o=Math.max(e.cacheTranslationY+i.y*e.zoomY,0);return k.util.isTransparent(e._cacheContext,Math.round(r),Math.round(o),this.targetFindTolerance)}var a=this.contextCache,s=e.selectionBackgroundColor,l=this.viewportTransform;return e.selectionBackgroundColor="",this.clearContext(a),a.save(),a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),e.render(a),a.restore(),e===this._activeObject&&e._renderControls(a,{hasBorders:!1,transparentCorners:!1},{hasBorders:!1}),e.selectionBackgroundColor=s,k.util.isTransparent(a,t,n,this.targetFindTolerance)},_isSelectionKeyPressed:function(e){return"[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find((function(t){return!0===e[t]})):e[this.selectionKey]},_shouldClearSelection:function(e,t){var n=this.getActiveObjects(),i=this._activeObject;return!t||t&&i&&n.length>1&&-1===n.indexOf(t)&&i!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&i&&i!==t},_shouldCenterTransform:function(e){if(e){var t,n=this._currentTransform;return"scale"===n.action||"scaleX"===n.action||"scaleY"===n.action?t=this.centeredScaling||e.centeredScaling:"rotate"===n.action&&(t=this.centeredRotation||e.centeredRotation),t?!n.altKey:n.altKey}},_getOriginFromCorner:function(e,t){var n={x:e.originX,y:e.originY};return"ml"===t||"tl"===t||"bl"===t?n.x="right":"mr"!==t&&"tr"!==t&&"br"!==t||(n.x="left"),"tl"===t||"mt"===t||"tr"===t?n.y="bottom":"bl"!==t&&"mb"!==t&&"br"!==t||(n.y="top"),n},_getActionFromCorner:function(e,t,n){if(!t||!e)return"drag";switch(t){case"mtr":return"rotate";case"ml":case"mr":return n[this.altActionKey]?"skewY":"scaleX";case"mt":case"mb":return n[this.altActionKey]?"skewX":"scaleY";default:return"scale"}},_setupCurrentTransform:function(e,n,i){if(n){var r=this.getPointer(e),o=n._findTargetCorner(this.getPointer(e,!0)),a=this._getActionFromCorner(i,o,e,n),s=this._getOriginFromCorner(n,o);this._currentTransform={target:n,action:a,corner:o,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:r.x-n.left,offsetY:r.y-n.top,originX:s.x,originY:s.y,ex:r.x,ey:r.y,lastX:r.x,lastY:r.y,theta:t(n.angle),width:n.width*n.scaleX,mouseXSign:1,mouseYSign:1,shiftKey:e.shiftKey,altKey:e[this.centeredKey],original:k.util.saveObjectTransform(n)},this._currentTransform.original.originX=s.x,this._currentTransform.original.originY=s.y,this._resetCurrentTransform(),this._beforeTransform(e)}},_translateObject:function(e,t){var n=this._currentTransform,i=n.target,r=e-n.offsetX,o=t-n.offsetY,a=!i.get("lockMovementX")&&i.left!==r,s=!i.get("lockMovementY")&&i.top!==o;return a&&i.set("left",r),s&&i.set("top",o),a||s},_changeSkewTransformOrigin:function(e,t,n){var i="originX",r={0:"center"},o=t.target.skewX,a="left",s="right",l="mt"===t.corner||"ml"===t.corner?1:-1,c=1;e=e>0?1:-1,"y"===n&&(o=t.target.skewY,a="top",s="bottom",i="originY"),r[-1]=a,r[1]=s,t.target.flipX&&(c*=-1),t.target.flipY&&(c*=-1),0===o?(t.skewSign=-l*e*c,t[i]=r[-e]):(o=o>0?1:-1,t.skewSign=o,t[i]=r[o*l*c])},_skewObject:function(e,t,n){var i,r=this._currentTransform,o=r.target,a=o.get("lockSkewingX"),s=o.get("lockSkewingY");if(a&&"x"===n||s&&"y"===n)return!1;var l,c,u=o.getCenterPoint(),h=o.toLocalPoint(new k.Point(e,t),"center","center")[n],d=o.toLocalPoint(new k.Point(r.lastX,r.lastY),"center","center")[n],f=o._getTransformedDimensions();return this._changeSkewTransformOrigin(h-d,r,n),l=o.toLocalPoint(new k.Point(e,t),r.originX,r.originY)[n],c=o.translateToOriginPoint(u,r.originX,r.originY),i=this._setObjectSkew(l,r,n,f),r.lastX=e,r.lastY=t,o.setPositionByOrigin(c,r.originX,r.originY),i},_setObjectSkew:function(e,t,n,i){var r,o,a,s,l,c,u,h,d,f,p=t.target,g=t.skewSign;return"x"===n?(l="y",c="Y",u="X",d=0,f=p.skewY):(l="x",c="X",u="Y",d=p.skewX,f=0),s=p._getTransformedDimensions(d,f),(h=2*Math.abs(e)-s[n])<=2?r=0:(r=g*Math.atan(h/p["scale"+u]/(s[l]/p["scale"+c])),r=k.util.radiansToDegrees(r)),o=p["skew"+u]!==r,p.set("skew"+u,r),0!==p["skew"+c]&&(a=p._getTransformedDimensions(),r=i[l]/a[l]*p["scale"+c],p.set("scale"+c,r)),o},_scaleObject:function(e,t,n){var i=this._currentTransform,r=i.target,o=r.lockScalingX,a=r.lockScalingY,s=r.lockScalingFlip;if(o&&a)return!1;var l,c=r.translateToOriginPoint(r.getCenterPoint(),i.originX,i.originY),u=r.toLocalPoint(new k.Point(e,t),i.originX,i.originY),h=r._getTransformedDimensions();return this._setLocalMouse(u,i),l=this._setObjectScale(u,i,o,a,n,s,h),r.setPositionByOrigin(c,i.originX,i.originY),l},_setObjectScale:function(e,t,n,i,r,o,a){var s=t.target,l=!1,c=!1,u=!1,h=e.x*s.scaleX/a.x,d=e.y*s.scaleY/a.y,f=s.scaleX!==h,p=s.scaleY!==d;if(t.newScaleX=h,t.newScaleY=d,"x"===r&&s instanceof k.Textbox){var g=s.width*(e.x/a.x);return g>=s.getMinWidth()&&(u=g!==s.width,s.set("width",g),u)}return o&&h<=0&&h<s.scaleX&&(l=!0,e.x=0),o&&d<=0&&d<s.scaleY&&(c=!0,e.y=0),"equally"!==r||n||i?r?"x"!==r||s.get("lockUniScaling")?"y"!==r||s.get("lockUniScaling")||c||i||s.set("scaleY",d)&&(u=p):l||n||s.set("scaleX",h)&&(u=f):(l||n||s.set("scaleX",h)&&(u=u||f),c||i||s.set("scaleY",d)&&(u=u||p)):u=this._scaleObjectEqually(e,s,t,a),l||c||this._flipObject(t,r),u},_scaleObjectEqually:function(e,t,n,i){var r,o,a,s=e.y+e.x,l=i.y*n.original.scaleY/t.scaleY+i.x*n.original.scaleX/t.scaleX,c=e.x<0?-1:1,u=e.y<0?-1:1;return o=c*Math.abs(n.original.scaleX*s/l),a=u*Math.abs(n.original.scaleY*s/l),r=o!==t.scaleX||a!==t.scaleY,t.set("scaleX",o),t.set("scaleY",a),r},_flipObject:function(e,t){e.newScaleX<0&&"y"!==t&&("left"===e.originX?e.originX="right":"right"===e.originX&&(e.originX="left")),e.newScaleY<0&&"x"!==t&&("top"===e.originY?e.originY="bottom":"bottom"===e.originY&&(e.originY="top"))},_setLocalMouse:function(e,t){var n=t.target,i=this.getZoom(),o=n.padding/i;"right"===t.originX?e.x*=-1:"center"===t.originX&&(e.x*=2*t.mouseXSign,e.x<0&&(t.mouseXSign=-t.mouseXSign)),"bottom"===t.originY?e.y*=-1:"center"===t.originY&&(e.y*=2*t.mouseYSign,e.y<0&&(t.mouseYSign=-t.mouseYSign)),r(e.x)>o?e.x<0?e.x+=o:e.x-=o:e.x=0,r(e.y)>o?e.y<0?e.y+=o:e.y-=o:e.y=0},_rotateObject:function(e,t){var r=this._currentTransform,o=r.target,a=o.translateToOriginPoint(o.getCenterPoint(),r.originX,r.originY);if(o.lockRotation)return!1;var s=i(r.ey-a.y,r.ex-a.x),l=i(t-a.y,e-a.x),c=n(l-s+r.theta),u=!0;if(o.snapAngle>0){var h=o.snapAngle,d=o.snapThreshold||h,f=Math.ceil(c/h)*h,p=Math.floor(c/h)*h;Math.abs(c-p)<d?c=p:Math.abs(c-f)<d&&(c=f)}return c<0&&(c=360+c),c%=360,o.angle===c?u=!1:(o.angle=c,o.setPositionByOrigin(a,r.originX,r.originY)),u},setCursor:function(e){this.upperCanvasEl.style.cursor=e},_drawSelection:function(e){var t=this._groupSelector,n=t.left,i=t.top,a=r(n),s=r(i);if(this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(t.ex-(n>0?0:-n),t.ey-(i>0?0:-i),a,s)),this.selectionLineWidth&&this.selectionBorderColor)if(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1&&!o){var l=t.ex+.5-(n>0?0:a),c=t.ey+.5-(i>0?0:s);e.beginPath(),k.util.drawDashedLine(e,l,c,l+a,c,this.selectionDashArray),k.util.drawDashedLine(e,l,c+s-1,l+a,c+s-1,this.selectionDashArray),k.util.drawDashedLine(e,l,c,l,c+s,this.selectionDashArray),k.util.drawDashedLine(e,l+a-1,c,l+a-1,c+s,this.selectionDashArray),e.closePath(),e.stroke()}else k.Object.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(t.ex+.5-(n>0?0:a),t.ey+.5-(i>0?0:s),a,s)},findTarget:function(e,t){if(!this.skipTargetFind){var n,i,r=this.getPointer(e,!0),o=this._activeObject,a=this.getActiveObjects();if(this.targets=[],a.length>1&&!t&&o===this._searchPossibleTargets([o],r))return o;if(1===a.length&&o._findTargetCorner(r))return o;if(1===a.length&&o===this._searchPossibleTargets([o],r)){if(!this.preserveObjectStacking)return o;n=o,i=this.targets,this.targets=[]}var s=this._searchPossibleTargets(this._objects,r);return e[this.altSelectionKey]&&s&&n&&s!==n&&(s=n,this.targets=i),s}},_checkTarget:function(e,t,n){if(t&&t.visible&&t.evented&&this.containsPoint(null,t,e)){if(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing)return!0;if(!this.isTargetTransparent(t,n.x,n.y))return!0}},_searchPossibleTargets:function(e,t){for(var n,i,r=e.length;r--;){var o=e[r],a=o.group&&"activeSelection"!==o.group.type?this._normalizePointer(o.group,t):t;if(this._checkTarget(a,o,t)){(n=e[r]).subTargetCheck&&n instanceof k.Group&&(i=this._searchPossibleTargets(n._objects,t))&&this.targets.push(i);break}}return n},restorePointerVpt:function(e){return k.util.transformPoint(e,k.util.invertTransform(this.viewportTransform))},getPointer:function(t,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var i,r=e(t),o=this.upperCanvasEl,a=o.getBoundingClientRect(),s=a.width||0,l=a.height||0;return s&&l||("top"in a&&"bottom"in a&&(l=Math.abs(a.top-a.bottom)),"right"in a&&"left"in a&&(s=Math.abs(a.right-a.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,n||(r=this.restorePointerVpt(r)),i=0===s||0===l?{width:1,height:1}:{width:o.width/s,height:o.height/l},{x:r.x*i.width,y:r.y*i.height}},_createUpperCanvas:function(){var e=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl?this.upperCanvasEl.className="":this.upperCanvasEl=this._createCanvasElement(),k.util.addClass(this.upperCanvasEl,"upper-canvas "+e),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=k.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),k.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),k.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(e){var t=this.width||e.width,n=this.height||e.height;k.util.setStyle(e,{position:"absolute",width:t+"px",height:n+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),e.width=t,e.height=n,k.util.makeElementUnselectable(e)},_copyCanvasStyle:function(e,t){t.style.cssText=e.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var e=this._activeObject;return e?"activeSelection"===e.type&&e._objects?e._objects.slice(0):[e]:[]},_onObjectRemoved:function(e){e===this._activeObject&&(this.fire("before:selection:cleared",{target:e}),this._discardActiveObject(),this.fire("selection:cleared",{target:e}),e.fire("deselected")),this._hoveredTarget===e&&(this._hoveredTarget=null),this.callSuper("_onObjectRemoved",e)},_fireSelectionEvents:function(e,t){var n=!1,i=this.getActiveObjects(),r=[],o=[],a={e:t};e.forEach((function(e){-1===i.indexOf(e)&&(n=!0,e.fire("deselected",a),o.push(e))})),i.forEach((function(t){-1===e.indexOf(t)&&(n=!0,t.fire("selected",a),r.push(t))})),e.length>0&&i.length>0?(a.selected=r,a.deselected=o,a.updated=r[0]||o[0],a.target=this._activeObject,n&&this.fire("selection:updated",a)):i.length>0?(1===i.length&&(a.target=r[0],this.fire("object:selected",a)),a.selected=r,a.target=this._activeObject,this.fire("selection:created",a)):e.length>0&&(a.deselected=o,this.fire("selection:cleared",a))},setActiveObject:function(e,t){var n=this.getActiveObjects();return this._setActiveObject(e,t),this._fireSelectionEvents(n,t),this},_setActiveObject:function(e,t){return this._activeObject!==e&&(!!this._discardActiveObject(t,e)&&(!e.onSelect({e:t})&&(this._activeObject=e,!0)))},_discardActiveObject:function(e,t){var n=this._activeObject;if(n){if(n.onDeselect({e:e,object:t}))return!1;this._activeObject=null}return!0},discardActiveObject:function(e){var t=this.getActiveObjects(),n=this.getActiveObject();return t.length&&this.fire("before:selection:cleared",{target:n,e:e}),this._discardActiveObject(e),this._fireSelectionEvents(t,e),this},dispose:function(){var e=this.wrapperEl;return this.removeListeners(),e.removeChild(this.upperCanvasEl),e.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(e){k.util.cleanUpJsdomNode(this[e]),this[e]=void 0}.bind(this)),e.parentNode&&e.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,k.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(e){var t=this._activeObject;t&&t._renderControls(e)},_toObject:function(e,t,n){var i=this._realizeGroupTransformOnObject(e),r=this.callSuper("_toObject",e,t,n);return this._unwindGroupTransformOnObject(e,i),r},_realizeGroupTransformOnObject:function(e){if(e.group&&"activeSelection"===e.group.type&&this._activeObject===e.group){var t={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach((function(n){t[n]=e[n]})),this._activeObject.realizeTransform(e),t}return null},_unwindGroupTransformOnObject:function(e,t){t&&e.set(t)},_setSVGObject:function(e,t,n){var i=this._realizeGroupTransformOnObject(t);this.callSuper("_setSVGObject",e,t,n),this._unwindGroupTransformOnObject(t,i)},setViewportTransform:function(e){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),k.StaticCanvas.prototype.setViewportTransform.call(this,e)}}),k.StaticCanvas)"prototype"!==a&&(k.Canvas[a]=k.StaticCanvas[a])}(),function(){var e={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},t=k.util.addListener,n=k.util.removeListener,i={passive:!1};function r(e,t){return e.button&&e.button===t-1}k.util.object.extend(k.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(e,t){var n=this.upperCanvasEl,r=this._getEventPrefix();e(k.window,"resize",this._onResize),e(n,r+"down",this._onMouseDown),e(n,r+"move",this._onMouseMove,i),e(n,r+"out",this._onMouseOut),e(n,r+"enter",this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"dblclick",this._onDoubleClick),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,i),"undefined"!=typeof eventjs&&t in eventjs&&(eventjs[t](n,"gesture",this._onGesture),eventjs[t](n,"drag",this._onDrag),eventjs[t](n,"orientation",this._onOrientationChange),eventjs[t](n,"shake",this._onShake),eventjs[t](n,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(n,"remove");var e=this._getEventPrefix();n(k.document,e+"up",this._onMouseUp),n(k.document,"touchend",this._onTouchEnd,i),n(k.document,e+"move",this._onMouseMove,i),n(k.document,"touchmove",this._onMouseMove,i)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._simpleEventHandler.bind(this,"drop"),this.eventsBound=!0)},_onGesture:function(e,t){this.__onTransformGesture&&this.__onTransformGesture(e,t)},_onDrag:function(e,t){this.__onDrag&&this.__onDrag(e,t)},_onMouseWheel:function(e){this.__onMouseWheel(e)},_onMouseOut:function(e){var t=this._hoveredTarget;this.fire("mouse:out",{target:t,e:e}),this._hoveredTarget=null,t&&t.fire("mouseout",{e:e}),this._iTextInstances&&this._iTextInstances.forEach((function(e){e.isEditing&&e.hiddenTextarea.focus()}))},_onMouseEnter:function(e){this.currentTransform||this.findTarget(e)||(this.fire("mouse:over",{target:null,e:e}),this._hoveredTarget=null)},_onOrientationChange:function(e,t){this.__onOrientationChange&&this.__onOrientationChange(e,t)},_onShake:function(e,t){this.__onShake&&this.__onShake(e,t)},_onLongPress:function(e,t){this.__onLongPress&&this.__onLongPress(e,t)},_onDragOver:function(e){e.preventDefault();var t=this._simpleEventHandler("dragover",e);this._fireEnterLeaveEvents(t,e)},_onContextMenu:function(e){return this.stopContextMenu&&(e.stopPropagation(),e.preventDefault()),!1},_onDoubleClick:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData(e)},getPointerId:function(e){var t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1},_isMainEvent:function(e){return!0===e.isPrimary||!1!==e.isPrimary&&("touchend"===e.type&&0===e.touches.length||(!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId))},_onTouchStart:function(e){e.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),this._resetTransformEventData();var r=this.upperCanvasEl,o=this._getEventPrefix();t(k.document,"touchend",this._onTouchEnd,i),t(k.document,"touchmove",this._onMouseMove,i),n(r,o+"down",this._onMouseDown)},_onMouseDown:function(e){this.__onMouseDown(e),this._resetTransformEventData();var r=this.upperCanvasEl,o=this._getEventPrefix();n(r,o+"move",this._onMouseMove,i),t(k.document,o+"up",this._onMouseUp),t(k.document,o+"move",this._onMouseMove,i)},_onTouchEnd:function(e){if(!(e.touches.length>0)){this.__onMouseUp(e),this._resetTransformEventData(),this.mainTouchId=null;var r=this._getEventPrefix();n(k.document,"touchend",this._onTouchEnd,i),n(k.document,"touchmove",this._onMouseMove,i);var o=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){t(o.upperCanvasEl,r+"down",o._onMouseDown),o._willAddMouseDown=0}),400)}},_onMouseUp:function(e){this.__onMouseUp(e),this._resetTransformEventData();var r=this.upperCanvasEl,o=this._getEventPrefix();this._isMainEvent(e)&&(n(k.document,o+"up",this._onMouseUp),n(k.document,o+"move",this._onMouseMove,i),t(r,o+"move",this._onMouseMove,i))},_onMouseMove:function(e){!this.allowTouchScrolling&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)},_onResize:function(){this.calcOffset()},_shouldRender:function(e){var t=this._activeObject;return!!(!!t!=!!e||t&&e&&t!==e)||(t&&t.isEditing,!1)},__onMouseUp:function(e){var t,n=this._currentTransform,i=this._groupSelector,o=!1,a=!i||0===i.left&&0===i.top;if(this._cacheTransformEventData(e),t=this._target,this._handleEvent(e,"up:before"),!r(e,3))return r(e,2)?(this.fireMiddleClick&&this._handleEvent(e,"up",2,a),void this._resetTransformEventData()):void(this.isDrawingMode&&this._isCurrentlyDrawing?this._onMouseUpInDrawingMode(e):this._isMainEvent(e)&&(n&&(this._finalizeCurrentTransform(e),o=n.actionPerformed),a||(this._maybeGroupObjects(e),o||(o=this._shouldRender(t))),t&&(t.isMoving=!1),this._setCursorFromEvent(e,t),this._handleEvent(e,"up",1,a),this._groupSelector=null,this._currentTransform=null,t&&(t.__corner=0),o?this.requestRenderAll():a||this.renderTop()));this.fireRightClick&&this._handleEvent(e,"up",3,a)},_simpleEventHandler:function(e,t){var n=this.findTarget(t),i=this.targets,r={e:t,target:n,subTargets:i};if(this.fire(e,r),n&&n.fire(e,r),!i)return n;for(var o=0;o<i.length;o++)i[o].fire(e,r);return n},_handleEvent:function(e,t,n,i){var r=this._target,o=this.targets||[],a={e:e,target:r,subTargets:o,button:n||1,isClick:i||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};this.fire("mouse:"+t,a),r&&r.fire("mouse"+t,a);for(var s=0;s<o.length;s++)o[s].fire("mouse"+t,a)},_finalizeCurrentTransform:function(e){var t,n=this._currentTransform,i=n.target,r={e:e,target:i,transform:n};i._scaling&&(i._scaling=!1),i.setCoords(),(n.actionPerformed||this.stateful&&i.hasStateChanged())&&(n.actionPerformed&&(t=this._addEventOptions(r,n),this._fire(t,r)),this._fire("modified",r))},_addEventOptions:function(e,t){var n,i;switch(t.action){case"scaleX":n="scaled",i="x";break;case"scaleY":n="scaled",i="y";break;case"skewX":n="skewed",i="x";break;case"skewY":n="skewed",i="y";break;case"scale":n="scaled",i="equally";break;case"rotate":n="rotated";break;case"drag":n="moved"}return e.by=i,n},_onMouseDownInDrawingMode:function(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(e).requestRenderAll(),this.clipTo&&k.util.clipContext(this,this.contextTop);var t=this.getPointer(e);this.freeDrawingBrush.onMouseDown(t,{e:e,pointer:t}),this._handleEvent(e,"down")},_onMouseMoveInDrawingMode:function(e){if(this._isCurrentlyDrawing){var t=this.getPointer(e);this.freeDrawingBrush.onMouseMove(t,{e:e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")},_onMouseUpInDrawingMode:function(e){this.clipTo&&this.contextTop.restore();var t=this.getPointer(e);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:e,pointer:t}),this._handleEvent(e,"up")},__onMouseDown:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"down:before");var t=this._target;if(r(e,3))this.fireRightClick&&this._handleEvent(e,"down",3);else if(r(e,2))this.fireMiddleClick&&this._handleEvent(e,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(e);else if(this._isMainEvent(e)&&!this._currentTransform){var n=this._pointer;this._previousPointer=n;var i=this._shouldRender(t),o=this._shouldGroup(e,t);if(this._shouldClearSelection(e,t)?this.discardActiveObject(e):o&&(this._handleGrouping(e,t),t=this._activeObject),!this.selection||t&&(t.selectable||t.isEditing||t===this._activeObject)||(this._groupSelector={ex:n.x,ey:n.y,top:0,left:0}),t){var a=t===this._activeObject;t.selectable&&this.setActiveObject(t,e),t!==this._activeObject||!t.__corner&&o||this._setupCurrentTransform(e,t,a)}this._handleEvent(e,"down"),(i||o)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(e){this._resetTransformEventData(),this._pointer=this.getPointer(e,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)||null},_beforeTransform:function(e){var t=this._currentTransform;this.stateful&&t.target.saveState(),this.fire("before:transform",{e:e,transform:t}),t.corner&&this.onBeforeScaleRotate(t.target)},__onMouseMove:function(e){var t,n;if(this._handleEvent(e,"move:before"),this._cacheTransformEventData(e),this.isDrawingMode)this._onMouseMoveInDrawingMode(e);else if(this._isMainEvent(e)){var i=this._groupSelector;i?(n=this._pointer,i.left=n.x-i.ex,i.top=n.y-i.ey,this.renderTop()):this._currentTransform?this._transformObject(e):(t=this.findTarget(e)||null,this._setCursorFromEvent(e,t),this._fireOverOutEvents(t,e)),this._handleEvent(e,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(e,t){this.fireSyntheticInOutEvents(e,t,{targetName:"_hoveredTarget",canvasEvtOut:"mouse:out",evtOut:"mouseout",canvasEvtIn:"mouse:over",evtIn:"mouseover"})},_fireEnterLeaveEvents:function(e,t){this.fireSyntheticInOutEvents(e,t,{targetName:"_draggedoverTarget",evtOut:"dragleave",evtIn:"dragenter"})},fireSyntheticInOutEvents:function(e,t,n){var i,r,o,a=this[n.targetName],s=a!==e,l=n.canvasEvtIn,c=n.canvasEvtOut;s&&(i={e:t,target:e,previousTarget:a},r={e:t,target:a,nextTarget:e},this[n.targetName]=e),o=e&&s,a&&s&&(c&&this.fire(c,r),a.fire(n.evtOut,r)),o&&(l&&this.fire(l,i),e.fire(n.evtIn,i))},__onMouseWheel:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()},_transformObject:function(e){var t=this.getPointer(e),n=this._currentTransform;n.reset=!1,n.target.isMoving=!0,n.shiftKey=e.shiftKey,n.altKey=e[this.centeredKey],this._beforeScaleTransform(e,n),this._performTransformAction(e,n,t),n.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(e,t,n){var i=n.x,r=n.y,o=t.action,a=!1,s={target:t.target,e:e,transform:t,pointer:n};"rotate"===o?(a=this._rotateObject(i,r))&&this._fire("rotating",s):"scale"===o?(a=this._onScale(e,t,i,r))&&this._fire("scaling",s):"scaleX"===o?(a=this._scaleObject(i,r,"x"))&&this._fire("scaling",s):"scaleY"===o?(a=this._scaleObject(i,r,"y"))&&this._fire("scaling",s):"skewX"===o?(a=this._skewObject(i,r,"x"))&&this._fire("skewing",s):"skewY"===o?(a=this._skewObject(i,r,"y"))&&this._fire("skewing",s):(a=this._translateObject(i,r))&&(this._fire("moving",s),this.setCursor(s.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a},_fire:function(e,t){this.fire("object:"+e,t),t.target.fire(e,t)},_beforeScaleTransform:function(e,t){if("scale"===t.action||"scaleX"===t.action||"scaleY"===t.action){var n=this._shouldCenterTransform(t.target);(n&&("center"!==t.originX||"center"!==t.originY)||!n&&"center"===t.originX&&"center"===t.originY)&&(this._resetCurrentTransform(),t.reset=!0)}},_onScale:function(e,t,n,i){return this._isUniscalePossible(e,t.target)?(t.currentAction="scale",this._scaleObject(n,i)):(t.reset||"scale"!==t.currentAction||this._resetCurrentTransform(),t.currentAction="scaleEqually",this._scaleObject(n,i,"equally"))},_isUniscalePossible:function(e,t){return(e[this.uniScaleKey]||this.uniScaleTransform)&&!t.get("lockUniScaling")},_setCursorFromEvent:function(e,t){if(!t)return this.setCursor(this.defaultCursor),!1;var n=t.hoverCursor||this.hoverCursor,i=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,r=(!i||!i.contains(t))&&t._findTargetCorner(this.getPointer(e,!0));r?this.setCursor(this.getCornerCursor(r,t,e)):this.setCursor(n)},getCornerCursor:function(t,n,i){return this.actionIsDisabled(t,n,i)?this.notAllowedCursor:t in e?this._getRotatedCornerCursor(t,n,i):"mtr"===t&&n.hasRotatingPoint?this.rotationCursor:this.defaultCursor},actionIsDisabled:function(e,t,n){return"mt"===e||"mb"===e?n[this.altActionKey]?t.lockSkewingX:t.lockScalingY:"ml"===e||"mr"===e?n[this.altActionKey]?t.lockSkewingY:t.lockScalingX:"mtr"===e?t.lockRotation:this._isUniscalePossible(n,t)?t.lockScalingX&&t.lockScalingY:t.lockScalingX||t.lockScalingY},_getRotatedCornerCursor:function(t,n,i){var r=Math.round(n.angle%360/45);return r<0&&(r+=8),r+=e[t],i[this.altActionKey]&&e[t]%2==0&&(r+=2),r%=8,this.cursorMap[r]}})}(),m=Math.min,b=Math.max,k.util.object.extend(k.Canvas.prototype,{_shouldGroup:function(e,t){var n=this._activeObject;return n&&this._isSelectionKeyPressed(e)&&t&&t.selectable&&this.selection&&(n!==t||"activeSelection"===n.type)&&!t.onSelect({e:e})},_handleGrouping:function(e,t){var n=this._activeObject;n.__corner||(t!==n||(t=this.findTarget(e,!0))&&t.selectable)&&(n&&"activeSelection"===n.type?this._updateActiveSelection(t,e):this._createActiveSelection(t,e))},_updateActiveSelection:function(e,t){var n=this._activeObject,i=n._objects.slice(0);n.contains(e)?(n.removeWithUpdate(e),this._hoveredTarget=e,1===n.size()&&this._setActiveObject(n.item(0),t)):(n.addWithUpdate(e),this._hoveredTarget=n),this._fireSelectionEvents(i,t)},_createActiveSelection:function(e,t){var n=this.getActiveObjects(),i=this._createGroup(e);this._hoveredTarget=i,this._setActiveObject(i,t),this._fireSelectionEvents(n,t)},_createGroup:function(e){var t=this._objects,n=t.indexOf(this._activeObject)<t.indexOf(e)?[this._activeObject,e]:[e,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new k.ActiveSelection(n,{canvas:this})},_groupSelectedObjects:function(e){var t,n=this._collectObjects(e);1===n.length?this.setActiveObject(n[0],e):n.length>1&&(t=new k.ActiveSelection(n.reverse(),{canvas:this}),this.setActiveObject(t,e))},_collectObjects:function(e){for(var t,n=[],i=this._groupSelector.ex,r=this._groupSelector.ey,o=i+this._groupSelector.left,a=r+this._groupSelector.top,s=new k.Point(m(i,o),m(r,a)),l=new k.Point(b(i,o),b(r,a)),c=!this.selectionFullyContained,u=i===o&&r===a,h=this._objects.length;h--&&!((t=this._objects[h])&&t.selectable&&t.visible&&(c&&t.intersectsWithRect(s,l)||t.isContainedWithinRect(s,l)||c&&t.containsPoint(s)||c&&t.containsPoint(l))&&(n.push(t),u)););return n.length>1&&(n=n.filter((function(t){return!t.onSelect({e:e})}))),n},_maybeGroupObjects:function(e){this.selection&&this._groupSelector&&this._groupSelectedObjects(e),this.setCursor(this.defaultCursor),this._groupSelector=null}}),k.util.object.extend(k.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var t=e.format||"png",n=e.quality||1,i=(e.multiplier||1)*(e.enableRetinaScaling?this.getRetinaScaling():1),r=this.toCanvasElement(i,e);return k.util.toDataURL(r,t,n)},toCanvasElement:function(e,t){e=e||1;var n=((t=t||{}).width||this.width)*e,i=(t.height||this.height)*e,r=this.getZoom(),o=this.width,a=this.height,s=r*e,l=this.viewportTransform,c=(l[4]-(t.left||0))*e,u=(l[5]-(t.top||0))*e,h=this.interactive,d=[s,0,0,s,c,u],f=this.enableRetinaScaling,p=k.util.createCanvasElement(),g=this.contextTop;return p.width=n,p.height=i,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=d,this.width=n,this.height=i,this.calcViewportBoundaries(),this.renderCanvas(p.getContext("2d"),this._objects),this.viewportTransform=l,this.width=o,this.height=a,this.calcViewportBoundaries(),this.interactive=h,this.enableRetinaScaling=f,this.contextTop=g,p}}),k.util.object.extend(k.StaticCanvas.prototype,{loadFromDatalessJSON:function(e,t,n){return this.loadFromJSON(e,t,n)},loadFromJSON:function(e,t,n){if(e){var i="string"==typeof e?JSON.parse(e):k.util.object.clone(e),r=this,o=i.clipPath,a=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete i.clipPath,this._enlivenObjects(i.objects,(function(e){r.clear(),r._setBgOverlay(i,(function(){o?r._enlivenObjects([o],(function(n){r.clipPath=n[0],r.__setupCanvas.call(r,i,e,a,t)})):r.__setupCanvas.call(r,i,e,a,t)}))}),n),this}},__setupCanvas:function(e,t,n,i){var r=this;t.forEach((function(e,t){r.insertAt(e,t)})),this.renderOnAddRemove=n,delete e.objects,delete e.backgroundImage,delete e.overlayImage,delete e.background,delete e.overlay,this._setOptions(e),this.renderAll(),i&&i()},_setBgOverlay:function(e,t){var n={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(e.backgroundImage||e.overlayImage||e.background||e.overlay){var i=function(){n.backgroundImage&&n.overlayImage&&n.backgroundColor&&n.overlayColor&&t&&t()};this.__setBgOverlay("backgroundImage",e.backgroundImage,n,i),this.__setBgOverlay("overlayImage",e.overlayImage,n,i),this.__setBgOverlay("backgroundColor",e.background,n,i),this.__setBgOverlay("overlayColor",e.overlay,n,i)}else t&&t()},__setBgOverlay:function(e,t,n,i){var r=this;if(!t)return n[e]=!0,void(i&&i());"backgroundImage"===e||"overlayImage"===e?k.util.enlivenObjects([t],(function(t){r[e]=t[0],n[e]=!0,i&&i()})):this["set"+k.util.string.capitalize(e,!0)](t,(function(){n[e]=!0,i&&i()}))},_enlivenObjects:function(e,t,n){e&&0!==e.length?k.util.enlivenObjects(e,(function(e){t&&t(e)}),null,n):t&&t([])},_toDataURL:function(e,t){this.clone((function(n){t(n.toDataURL(e))}))},_toDataURLWithMultiplier:function(e,t,n){this.clone((function(i){n(i.toDataURLWithMultiplier(e,t))}))},clone:function(e,t){var n=JSON.stringify(this.toJSON(t));this.cloneWithoutData((function(t){t.loadFromJSON(n,(function(){e&&e(t)}))}))},cloneWithoutData:function(e){var t=k.util.createCanvasElement();t.width=this.width,t.height=this.height;var n=new k.Canvas(t);n.clipTo=this.clipTo,this.backgroundImage?(n.setBackgroundImage(this.backgroundImage.src,(function(){n.renderAll(),e&&e(n)})),n.backgroundImageOpacity=this.backgroundImageOpacity,n.backgroundImageStretch=this.backgroundImageStretch):e&&e(n)}}),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.util.object.clone,r=t.util.toFixed,o=t.util.string.capitalize,a=t.util.degreesToRadians,s=t.StaticCanvas.supports("setLineDash"),l=!t.isLikelyNode;t.Object||(t.Object=t.util.createClass(t.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",borderDashArray:null,cornerColor:"rgba(102,153,255,0.5)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:l,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow clipTo visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(e){e&&this.setOptions(e)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=t.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(e){var n=t.perfLimitSizeTotal,i=e.width,r=e.height,o=t.maxCacheSideLimit,a=t.minCacheSideLimit;if(i<=o&&r<=o&&i*r<=n)return i<a&&(e.width=a),r<a&&(e.height=a),e;var s=i/r,l=t.util.limitDimsByArea(s,n),c=t.util.capValue,u=c(a,l.x,o),h=c(a,l.y,o);return i>u&&(e.zoomX/=i/u,e.width=u,e.capped=!0),r>h&&(e.zoomY/=r/h,e.height=h,e.capped=!0),e},_getCacheCanvasDimensions:function(){var e=this.getTotalObjectScaling(),t=this._getTransformedDimensions(0,0),n=t.x*e.scaleX/this.scaleX,i=t.y*e.scaleY/this.scaleY;return{width:n+2,height:i+2,zoomX:e.scaleX,zoomY:e.scaleY,x:n,y:i}},_updateCacheCanvas:function(){var e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){var n=e._currentTransform.target,i=e._currentTransform.action;if(this===n&&i.slice&&"scale"===i.slice(0,5))return!1}var r,o,a=this._cacheCanvas,s=this._limitCacheSize(this._getCacheCanvasDimensions()),l=t.minCacheSideLimit,c=s.width,u=s.height,h=s.zoomX,d=s.zoomY,f=c!==this.cacheWidth||u!==this.cacheHeight,p=this.zoomX!==h||this.zoomY!==d,g=f||p,v=0,m=0,b=!1;if(f){var y=this._cacheCanvas.width,_=this._cacheCanvas.height,x=c>y||u>_;b=x||(c<.9*y||u<.9*_)&&y>l&&_>l,x&&!s.capped&&(c>l||u>l)&&(v=.1*c,m=.1*u)}return!!g&&(b?(a.width=Math.ceil(c+v),a.height=Math.ceil(u+m)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,a.width,a.height)),r=s.x/2,o=s.y/2,this.cacheTranslationX=Math.round(a.width/2-r)+r,this.cacheTranslationY=Math.round(a.height/2-o)+o,this.cacheWidth=c,this.cacheHeight=u,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(h,d),this.zoomX=h,this.zoomY=d,!0)},setOptions:function(e){this._setOptions(e),this._initGradient(e.fill,"fill"),this._initGradient(e.stroke,"stroke"),this._initClipping(e),this._initPattern(e.fill,"fill"),this._initPattern(e.stroke,"stroke")},transform:function(e){var t;t=this.group&&!this.group._transformDone?this.calcTransformMatrix():this.calcOwnMatrix(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])},toObject:function(e){var n=t.Object.NUM_FRACTION_DIGITS,i={type:this.type,version:t.version,originX:this.originX,originY:this.originY,left:r(this.left,n),top:r(this.top,n),width:r(this.width,n),height:r(this.height,n),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,n),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:r(this.strokeMiterLimit,n),scaleX:r(this.scaleX,n),scaleY:r(this.scaleY,n),angle:r(this.angle,n),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,n),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,transformMatrix:this.transformMatrix?this.transformMatrix.concat():null,skewX:r(this.skewX,n),skewY:r(this.skewY,n)};return this.clipPath&&(i.clipPath=this.clipPath.toObject(e),i.clipPath.inverted=this.clipPath.inverted,i.clipPath.absolutePositioned=this.clipPath.absolutePositioned),t.util.populateWithProperties(this,i,e),this.includeDefaultValues||(i=this._removeDefaultValues(i)),i},toDatalessObject:function(e){return this.toObject(e)},_removeDefaultValues:function(e){var n=t.util.getKlass(e.type).prototype;return n.stateProperties.forEach((function(t){"left"!==t&&"top"!==t&&(e[t]===n[t]&&delete e[t],"[object Array]"===Object.prototype.toString.call(e[t])&&"[object Array]"===Object.prototype.toString.call(n[t])&&0===e[t].length&&0===n[t].length&&delete e[t])})),e},toString:function(){return"#<fabric."+o(this.type)+">"},getObjectScaling:function(){var e=this.scaleX,t=this.scaleY;if(this.group){var n=this.group.getObjectScaling();e*=n.scaleX,t*=n.scaleY}return{scaleX:e,scaleY:t}},getTotalObjectScaling:function(){var e=this.getObjectScaling(),t=e.scaleX,n=e.scaleY;if(this.canvas){var i=this.canvas.getZoom(),r=this.canvas.getRetinaScaling();t*=i*r,n*=i*r}return{scaleX:t,scaleY:n}},getObjectOpacity:function(){var e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e},_set:function(e,n){var i="scaleX"===e||"scaleY"===e,r=this[e]!==n,o=!1;return i&&(n=this._constrainScale(n)),"scaleX"===e&&n<0?(this.flipX=!this.flipX,n*=-1):"scaleY"===e&&n<0?(this.flipY=!this.flipY,n*=-1):"shadow"!==e||!n||n instanceof t.Shadow?"dirty"===e&&this.group&&this.group.set("dirty",n):n=new t.Shadow(n),this[e]=n,r&&(o=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(e)>-1?(this.dirty=!0,o&&this.group.set("dirty",!0)):o&&this.stateProperties.indexOf(e)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:t.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||0===this.width&&0===this.height&&0===this.strokeWidth||!this.visible},render:function(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e,this),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),this.clipTo&&t.util.clipContext(this,e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(e),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),this.clipTo&&e.restore(),e.restore())},renderCache:function(e){e=e||{},this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,e.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!=typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(e){var n=this.clipPath;if(e.save(),n.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",n.absolutePositioned){var i=t.util.invertTransform(this.calcTransformMatrix());e.transform(i[0],i[1],i[2],i[3],i[4],i[5])}n.transform(e),e.scale(1/n.zoomX,1/n.zoomY),e.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),e.restore()},drawObject:function(e,t){var n=this.fill,i=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):(this._renderBackground(e),this._setStrokeStyles(e,this),this._setFillStyles(e,this)),this._render(e),this._drawClipPath(e),this.fill=n,this.stroke=i},_drawClipPath:function(e){var t=this.clipPath;t&&(t.canvas=this.canvas,t.shouldCache(),t._transformDone=!0,t.renderCache({forClipping:!0}),this.drawClipPathOnCache(e))},drawCacheOnCanvas:function(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(e){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!e&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!e){var t=this.cacheWidth/this.zoomX,n=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-t/2,-n/2,t,n)}return!0}return!1},_renderBackground:function(e){if(this.backgroundColor){var t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}},_setOpacity:function(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity},_setStrokeStyles:function(e,t){t.stroke&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,e.strokeStyle=t.stroke.toLive?t.stroke.toLive(e,this):t.stroke)},_setFillStyles:function(e,t){t.fill&&(e.fillStyle=t.fill.toLive?t.fill.toLive(e,this):t.fill)},_setClippingProperties:function(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"},_setLineDash:function(e,t,n){t&&(1&t.length&&t.push.apply(t,t),s?e.setLineDash(t):n&&n(e),this.strokeUniform&&e.setLineDash(e.getLineDash().map((function(t){return t*e.lineWidth}))))},_renderControls:function(e,n){var i,r,o,s=this.getViewportTransform(),l=this.calcTransformMatrix();r=void 0!==(n=n||{}).hasBorders?n.hasBorders:this.hasBorders,o=void 0!==n.hasControls?n.hasControls:this.hasControls,l=t.util.multiplyTransformMatrices(s,l),i=t.util.qrDecompose(l),e.save(),e.translate(i.translateX,i.translateY),e.lineWidth=1*this.borderScaleFactor,this.group||(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),n.forActiveSelection?(e.rotate(a(i.angle)),r&&this.drawBordersInGroup(e,i,n)):(e.rotate(a(this.angle)),r&&this.drawBorders(e,n)),o&&this.drawControls(e,n),e.restore()},_setShadow:function(e){if(this.shadow){var n,i=this.shadow,r=this.canvas,o=r&&r.viewportTransform[0]||1,a=r&&r.viewportTransform[3]||1;n=i.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),r&&r._isRetinaScaling()&&(o*=t.devicePixelRatio,a*=t.devicePixelRatio),e.shadowColor=i.color,e.shadowBlur=i.blur*t.browserShadowBlurConstant*(o+a)*(n.scaleX+n.scaleY)/4,e.shadowOffsetX=i.offsetX*o*n.scaleX,e.shadowOffsetY=i.offsetY*a*n.scaleY}},_removeShadow:function(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)},_applyPatternGradientTransform:function(e,t){if(!t||!t.toLive)return{offsetX:0,offsetY:0};var n=t.gradientTransform||t.patternTransform,i=-this.width/2+t.offsetX||0,r=-this.height/2+t.offsetY||0;return e.translate(i,r),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:i,offsetY:r}},_renderPaintInOrder:function(e){"stroke"===this.paintFirst?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))},_render:function(){},_renderFill:function(e){this.fill&&(e.save(),this._applyPatternGradientTransform(e,this.fill),"evenodd"===this.fillRule?e.fill("evenodd"):e.fill(),e.restore())},_renderStroke:function(e){this.stroke&&0!==this.strokeWidth&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform&&e.scale(1/this.scaleX,1/this.scaleY),this._setLineDash(e,this.strokeDashArray,this._renderDashedStroke),this._applyPatternGradientTransform(e,this.stroke),e.stroke(),e.restore())},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var e=t.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",e.scaleX),this.set("scaleY",e.scaleY),this.angle=e.angle,this.skewX=e.skewX,this.skewY=0}},_removeTransformMatrix:function(e){var n=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),n=t.util.transformPoint(n,this.transformMatrix)),this.transformMatrix=null,e&&(this.scaleX*=e.scaleX,this.scaleY*=e.scaleY,this.cropX=e.cropX,this.cropY=e.cropY,n.x+=e.offsetLeft,n.y+=e.offsetTop,this.width=e.width,this.height=e.height),this.setPositionByOrigin(n,"center","center")},clone:function(e,n){var i=this.toObject(n);this.constructor.fromObject?this.constructor.fromObject(i,e):t.Object._fromObject("Object",i,e)},cloneAsImage:function(e,n){var i=this.toCanvasElement(n);return e&&e(new t.Image(i)),this},toCanvasElement:function(e){e||(e={});var n=t.util,i=n.saveObjectTransform(this),r=this.shadow,o=Math.abs,a=(e.multiplier||1)*(e.enableRetinaScaling?t.devicePixelRatio:1);e.withoutTransform&&n.resetObjectTransform(this),e.withoutShadow&&(this.shadow=null);var s,l,c=t.util.createCanvasElement(),u=this.getBoundingRect(!0,!0),h=this.shadow,d={x:0,y:0};h&&(l=h.blur,s=h.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),d.x=2*Math.round(o(h.offsetX)+l)*o(s.scaleX),d.y=2*Math.round(o(h.offsetY)+l)*o(s.scaleY)),c.width=u.width+d.x,c.height=u.height+d.y,c.width+=c.width%2?2-c.width%2:0,c.height+=c.height%2?2-c.height%2:0;var f=new t.StaticCanvas(c,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===e.format&&(f.backgroundColor="#fff"),this.setPositionByOrigin(new t.Point(f.width/2,f.height/2),"center","center");var p=this.canvas;f.add(this);var g=f.toCanvasElement(a||1,e);return this.shadow=r,this.canvas=p,this.set(i).setCoords(),f._objects=[],f.dispose(),f=null,g},toDataURL:function(e){return e||(e={}),t.util.toDataURL(this.toCanvasElement(e),e.format||"png",e.quality||1)},isType:function(e){return this.type===e},complexity:function(){return 1},toJSON:function(e){return this.toObject(e)},setGradient:function(e,n){n||(n={});var i={colorStops:[]};return i.type=n.type||(n.r1||n.r2?"radial":"linear"),i.coords={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2},(n.r1||n.r2)&&(i.coords.r1=n.r1,i.coords.r2=n.r2),i.gradientTransform=n.gradientTransform,t.Gradient.prototype.addColorStop.call(i,n.colorStops),this.set(e,t.Gradient.forObject(this,i))},setPatternFill:function(e,n){return this.set("fill",new t.Pattern(e,n))},setShadow:function(e){return this.set("shadow",e?new t.Shadow(e):null)},setColor:function(e){return this.set("fill",e),this},rotate:function(e){var t=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return t&&this._setOriginToCenter(),this.set("angle",e),t&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(e,n){n=n||this.canvas.getPointer(e);var i=new t.Point(n.x,n.y),r=this._getLeftTopCoords();return this.angle&&(i=t.util.rotatePoint(i,r,a(-this.angle))),{x:i.x-r.x,y:i.y-r.y}},_setupCompositeOperation:function(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}}),t.util.createAccessors&&t.util.createAccessors(t.Object),n(t.Object.prototype,t.Observable),t.Object.NUM_FRACTION_DIGITS=2,t.Object._fromObject=function(e,n,r,o){var a=t[e];n=i(n,!0),t.util.enlivenPatterns([n.fill,n.stroke],(function(e){void 0!==e[0]&&(n.fill=e[0]),void 0!==e[1]&&(n.stroke=e[1]),t.util.enlivenObjects([n.clipPath],(function(e){n.clipPath=e[0];var t=o?new a(n[o],n):new a(n);r&&r(t)}))}))},t.Object.__uid=0)}(t),y=k.util.degreesToRadians,_={left:-.5,center:0,right:.5},x={top:-.5,center:0,bottom:.5},k.util.object.extend(k.Object.prototype,{translateToGivenOrigin:function(e,t,n,i,r){var o,a,s,l=e.x,c=e.y;return"string"==typeof t?t=_[t]:t-=.5,"string"==typeof i?i=_[i]:i-=.5,"string"==typeof n?n=x[n]:n-=.5,"string"==typeof r?r=x[r]:r-=.5,a=r-n,((o=i-t)||a)&&(s=this._getTransformedDimensions(),l=e.x+o*s.x,c=e.y+a*s.y),new k.Point(l,c)},translateToCenterPoint:function(e,t,n){var i=this.translateToGivenOrigin(e,t,n,"center","center");return this.angle?k.util.rotatePoint(i,e,y(this.angle)):i},translateToOriginPoint:function(e,t,n){var i=this.translateToGivenOrigin(e,"center","center",t,n);return this.angle?k.util.rotatePoint(i,e,y(this.angle)):i},getCenterPoint:function(){var e=new k.Point(this.left,this.top);return this.translateToCenterPoint(e,this.originX,this.originY)},getPointByOrigin:function(e,t){var n=this.getCenterPoint();return this.translateToOriginPoint(n,e,t)},toLocalPoint:function(e,t,n){var i,r,o=this.getCenterPoint();return i=void 0!==t&&void 0!==n?this.translateToGivenOrigin(o,"center","center",t,n):new k.Point(this.left,this.top),r=new k.Point(e.x,e.y),this.angle&&(r=k.util.rotatePoint(r,o,-y(this.angle))),r.subtractEquals(i)},setPositionByOrigin:function(e,t,n){var i=this.translateToCenterPoint(e,t,n),r=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",r.x),this.set("top",r.y)},adjustPosition:function(e){var t,n,i=y(this.angle),r=this.getScaledWidth(),o=k.util.cos(i)*r,a=k.util.sin(i)*r;t="string"==typeof this.originX?_[this.originX]:this.originX-.5,n="string"==typeof e?_[e]:e-.5,this.left+=o*(n-t),this.top+=a*(n-t),this.setCoords(),this.originX=e},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var e=this.getCenterPoint();this.originX="center",this.originY="center",this.left=e.x,this.top=e.y},_resetOrigin:function(){var e=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=e.x,this.top=e.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var e=k.util.degreesToRadians,t=k.util.multiplyTransformMatrices,n=k.util.transformPoint;k.util.object.extend(k.Object.prototype,{oCoords:null,aCoords:null,ownMatrixCache:null,matrixCache:null,getCoords:function(e,t){this.oCoords||this.setCoords();var n=e?this.aCoords:this.oCoords;return function(e){return[new k.Point(e.tl.x,e.tl.y),new k.Point(e.tr.x,e.tr.y),new k.Point(e.br.x,e.br.y),new k.Point(e.bl.x,e.bl.y)]}(t?this.calcCoords(e):n)},intersectsWithRect:function(e,t,n,i){var r=this.getCoords(n,i);return"Intersection"===k.Intersection.intersectPolygonRectangle(r,e,t).status},intersectsWithObject:function(e,t,n){return"Intersection"===k.Intersection.intersectPolygonPolygon(this.getCoords(t,n),e.getCoords(t,n)).status||e.isContainedWithinObject(this,t,n)||this.isContainedWithinObject(e,t,n)},isContainedWithinObject:function(e,t,n){for(var i=this.getCoords(t,n),r=0,o=e._getImageLines(n?e.calcCoords(t):t?e.aCoords:e.oCoords);r<4;r++)if(!e.containsPoint(i[r],o))return!1;return!0},isContainedWithinRect:function(e,t,n,i){var r=this.getBoundingRect(n,i);return r.left>=e.x&&r.left+r.width<=t.x&&r.top>=e.y&&r.top+r.height<=t.y},containsPoint:function(e,t,n,i){t=t||this._getImageLines(i?this.calcCoords(n):n?this.aCoords:this.oCoords);var r=this._findCrossPoints(e,t);return 0!==r&&r%2==1},isOnScreen:function(e){if(!this.canvas)return!1;for(var t,n=this.canvas.vptCoords.tl,i=this.canvas.vptCoords.br,r=this.getCoords(!0,e),o=0;o<4;o++)if((t=r[o]).x<=i.x&&t.x>=n.x&&t.y<=i.y&&t.y>=n.y)return!0;return!!this.intersectsWithRect(n,i,!0,e)||this._containsCenterOfCanvas(n,i,e)},_containsCenterOfCanvas:function(e,t,n){var i={x:(e.x+t.x)/2,y:(e.y+t.y)/2};return!!this.containsPoint(i,null,!0,n)},isPartiallyOnScreen:function(e){if(!this.canvas)return!1;var t=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br;return!!this.intersectsWithRect(t,n,!0,e)||this._containsCenterOfCanvas(t,n,e)},_getImageLines:function(e){return{topline:{o:e.tl,d:e.tr},rightline:{o:e.tr,d:e.br},bottomline:{o:e.br,d:e.bl},leftline:{o:e.bl,d:e.tl}}},_findCrossPoints:function(e,t){var n,i,r,o=0;for(var a in t)if(!((r=t[a]).o.y<e.y&&r.d.y<e.y||r.o.y>=e.y&&r.d.y>=e.y||(r.o.x===r.d.x&&r.o.x>=e.x?i=r.o.x:(0,n=(r.d.y-r.o.y)/(r.d.x-r.o.x),i=-(e.y-0*e.x-(r.o.y-n*r.o.x))/(0-n)),i>=e.x&&(o+=1),2!==o)))break;return o},getBoundingRect:function(e,t){var n=this.getCoords(e,t);return k.util.makeBoundingBoxFromPoints(n)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:0===e?1e-4:e},scale:function(e){return this._set("scaleX",e),this._set("scaleY",e),this.setCoords()},scaleToWidth:function(e,t){var n=this.getBoundingRect(t).width/this.getScaledWidth();return this.scale(e/this.width/n)},scaleToHeight:function(e,t){var n=this.getBoundingRect(t).height/this.getScaledHeight();return this.scale(e/this.height/n)},calcCoords:function(i){var r=this._calcRotateMatrix(),o=this._calcTranslateMatrix(),a=t(o,r),s=this.getViewportTransform(),l=i?a:t(s,a),c=this._getTransformedDimensions(),u=c.x/2,h=c.y/2,d=n({x:-u,y:-h},l),f=n({x:u,y:-h},l),p=n({x:-u,y:h},l),g=n({x:u,y:h},l);if(!i){var v=this.padding,m=e(this.angle),b=k.util.cos(m),y=k.util.sin(m),_=b*v,x=y*v,w=_+x,C=_-x;v&&(d.x-=C,d.y-=w,f.x+=w,f.y-=C,p.x-=w,p.y+=C,g.x+=C,g.y+=w);var S=new k.Point((d.x+p.x)/2,(d.y+p.y)/2),T=new k.Point((f.x+d.x)/2,(f.y+d.y)/2),E=new k.Point((g.x+f.x)/2,(g.y+f.y)/2),M=new k.Point((g.x+p.x)/2,(g.y+p.y)/2),O=new k.Point(T.x+y*this.rotatingPointOffset,T.y-b*this.rotatingPointOffset)}var j={tl:d,tr:f,br:g,bl:p};return i||(j.ml=S,j.mt=T,j.mr=E,j.mb=M,j.mtr=O),j},setCoords:function(e,t){return this.oCoords=this.calcCoords(e),t||(this.aCoords=this.calcCoords(!0)),e||this._setCornerCoords&&this._setCornerCoords(),this},_calcRotateMatrix:function(){if(this.angle){var t=e(this.angle),n=k.util.cos(t),i=k.util.sin(t);return[n,i,-i,n,0,0]}return k.iMatrix.concat()},_calcTranslateMatrix:function(){var e=this.getCenterPoint();return[1,0,0,1,e.x,e.y]},transformMatrixKey:function(e){var t="";return!e&&this.group&&(t=this.group.transformMatrixKey(e)+"_"),t+this.top+"_"+this.left+"_"+this.scaleX+"_"+this.scaleY+"_"+this.skewX+"_"+this.skewY+"_"+this.angle+"_"+this.originX+"_"+this.originY+"_"+this.width+"_"+this.height+"_"+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(e){if(e)return this.calcOwnMatrix();var n=this.transformMatrixKey(),i=this.matrixCache||(this.matrixCache={});if(i.key===n)return i.value;var r=this.calcOwnMatrix();return this.group&&(r=t(this.group.calcTransformMatrix(),r)),i.key=n,i.value=r,r},calcOwnMatrix:function(){var e=this.transformMatrixKey(!0),n=this.ownMatrixCache||(this.ownMatrixCache={});if(n.key===e)return n.value;var i,r=this._calcTranslateMatrix(),o=this._calcDimensionsTransformMatrix(this.skewX,this.skewY,!0);return this.angle&&(i=this._calcRotateMatrix(),r=t(r,i)),r=t(r,o),n.key=e,n.value=r,r},_calcDimensionsTransformMatrix:function(n,i,r){var o,a=[this.scaleX*(r&&this.flipX?-1:1),0,0,this.scaleY*(r&&this.flipY?-1:1),0,0];return n&&(o=[1,0,Math.tan(e(n)),1],a=t(a,o,!0)),i&&(o=[1,Math.tan(e(i)),0,1],a=t(a,o,!0)),a},_getNonTransformedDimensions:function(){var e=this.strokeWidth;return{x:this.width+e,y:this.height+e}},_getTransformedDimensions:function(e,t){void 0===e&&(e=this.skewX),void 0===t&&(t=this.skewY);var n,i,r=this._getNonTransformedDimensions(),o=0===e&&0===t;if(this.strokeUniform?(n=this.width,i=this.height):(n=r.x,i=r.y),o)return this._finalizeDimensions(n*this.scaleX,i*this.scaleY);var a,s,l=[{x:-(n/=2),y:-(i/=2)},{x:n,y:-i},{x:-n,y:i},{x:n,y:i}],c=this._calcDimensionsTransformMatrix(e,t,!1);for(a=0;a<l.length;a++)l[a]=k.util.transformPoint(l[a],c);return s=k.util.makeBoundingBoxFromPoints(l),this._finalizeDimensions(s.width,s.height)},_finalizeDimensions:function(e,t){return this.strokeUniform?{x:e+this.strokeWidth,y:t+this.strokeWidth}:{x:e,y:t}},_calculateCurrentDimensions:function(){var e=this.getViewportTransform(),t=this._getTransformedDimensions();return k.util.transformPoint(t,e,!0).scalarAdd(2*this.padding)}})}(),k.util.object.extend(k.Object.prototype,{sendToBack:function(){return this.group?k.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?k.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(e){return this.group?k.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas.sendBackwards(this,e),this},bringForward:function(e){return this.group?k.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas.bringForward(this,e),this},moveTo:function(e){return this.group&&"activeSelection"!==this.group.type?k.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas.moveTo(this,e),this}}),function(){function e(e,t){if(t){if(t.toLive)return e+": url(#SVGID_"+t.id+"); ";var n=new k.Color(t),i=e+": "+n.toRgb()+"; ",r=n.getAlpha();return 1!==r&&(i+=e+"-opacity: "+r.toString()+"; "),i}return e+": none; "}var t=k.util.toFixed;k.util.object.extend(k.Object.prototype,{getSvgStyles:function(t){var n=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):"none",o=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",s=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=void 0!==this.opacity?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=t?"":this.getSvgFilter(),d=e("fill",this.fill);return[e("stroke",this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",s,"; ","stroke-miterlimit: ",l,"; ",d,"fill-rule: ",n,"; ","opacity: ",c,";",h,u].join("")},getSvgSpanStyles:function(t,n){var i=t.fontFamily?"font-family: "+(-1===t.fontFamily.indexOf("'")&&-1===t.fontFamily.indexOf('"')?"'"+t.fontFamily+"'":t.fontFamily)+"; ":"",r=t.strokeWidth?"stroke-width: "+t.strokeWidth+"; ":"",o=(i=i,t.fontSize?"font-size: "+t.fontSize+"px; ":""),a=t.fontStyle?"font-style: "+t.fontStyle+"; ":"",s=t.fontWeight?"font-weight: "+t.fontWeight+"; ":"",l=t.fill?e("fill",t.fill):"",c=t.stroke?e("stroke",t.stroke):"",u=this.getSvgTextDecoration(t);return u&&(u="text-decoration: "+u+"; "),[c,r,i,o,a,s,u,l,t.deltaY?"baseline-shift: "+-t.deltaY+"; ":"",n?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(e){return"overline"in e||"underline"in e||"linethrough"in e?(e.overline?"overline ":"")+(e.underline?"underline ":"")+(e.linethrough?"line-through ":""):""},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(e,t){var n=e?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+k.util.matrixToSVG(n)+(t||"")+this.getSvgTransformMatrix()+'" '},getSvgTransformMatrix:function(){return this.transformMatrix?" "+k.util.matrixToSVG(this.transformMatrix):""},_setSVGBg:function(e){if(this.backgroundColor){var n=k.Object.NUM_FRACTION_DIGITS;e.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',t(-this.width/2,n),'" y="',t(-this.height/2,n),'" width="',t(this.width,n),'" height="',t(this.height,n),'"></rect>\n')}},toSVG:function(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})},toClipPathSVG:function(e){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})},_createBaseClipPathSVGMarkup:function(e,t){var n=(t=t||{}).reviver,i=t.additionalTransform||"",r=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),o=e.indexOf("COMMON_PARTS");return e[o]=r,n?n(e.join("")):e.join("")},_createBaseSVGMarkup:function(e,t){var n,i,r=(t=t||{}).noStyle,o=t.reviver,a=r?"":'style="'+this.getSvgStyles()+'" ',s=t.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,h=this.stroke,d=this.fill,f=this.shadow,p=[],g=e.indexOf("COMMON_PARTS"),v=t.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+k.Object.__uid++,i='<clipPath id="'+l.clipPathId+'" >\n'+l.toClipPathSVG(o)+"</clipPath>\n"),u&&p.push("<g ",s,this.getSvgCommons()," >\n"),p.push("<g ",this.getSvgTransform(!1),u?"":s+this.getSvgCommons()," >\n"),n=[a,c,r?"":this.addPaintOrder()," ",v?'transform="'+v+'" ':""].join(""),e[g]=n,d&&d.toLive&&p.push(d.toSVG(this)),h&&h.toLive&&p.push(h.toSVG(this)),f&&p.push(f.toSVG(this)),l&&p.push(i),p.push(e.join("")),p.push("</g>\n"),u&&p.push("</g>\n"),o?o(p.join("")):p.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var e=k.util.object.extend;function t(t,n,i){var r={};i.forEach((function(e){r[e]=t[e]})),e(t[n],r,!0)}k.util.object.extend(k.Object.prototype,{hasStateChanged:function(e){var t="_"+(e=e||"stateProperties");return Object.keys(this[t]).length<this[e].length||!function e(t,n,i){if(t===n)return!0;if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(var r=0,o=t.length;r<o;r++)if(!e(t[r],n[r]))return!1;return!0}if(t&&"object"==typeof t){var a,s=Object.keys(t);if(!n||"object"!=typeof n||!i&&s.length!==Object.keys(n).length)return!1;for(r=0,o=s.length;r<o;r++)if("canvas"!==(a=s[r])&&!e(t[a],n[a]))return!1;return!0}}(this[t],this,!0)},saveState:function(e){var n=e&&e.propertySet||"stateProperties",i="_"+n;return this[i]?(t(this,i,this[n]),e&&e.stateProperties&&t(this,i,e.stateProperties),this):this.setupState(e)},setupState:function(e){var t=(e=e||{}).propertySet||"stateProperties";return e.propertySet=t,this["_"+t]={},this.saveState(e),this}})}(),function(){var e=k.util.degreesToRadians;k.util.object.extend(k.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(e){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var t,n,i=e.x,r=e.y;for(var o in this.__corner=0,this.oCoords)if(this.isControlVisible(o)&&("mtr"!==o||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==o&&"mr"!==o&&"mb"!==o&&"ml"!==o)&&(n=this._getImageLines(this.oCoords[o].corner),0!==(t=this._findCrossPoints({x:i,y:r},n))&&t%2==1))return this.__corner=o,o;return!1},_setCornerCoords:function(){var t,n,i=this.oCoords,r=e(45-this.angle),o=.707106*this.cornerSize,a=o*k.util.cos(r),s=o*k.util.sin(r);for(var l in i)t=i[l].x,n=i[l].y,i[l].corner={tl:{x:t-s,y:n-a},tr:{x:t+a,y:n-s},bl:{x:t-a,y:n+s},br:{x:t+s,y:n+a}}},drawSelectionBackground:function(t){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;t.save();var n=this.getCenterPoint(),i=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return t.translate(n.x,n.y),t.scale(1/r[0],1/r[3]),t.rotate(e(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-i.x/2,-i.y/2,i.x,i.y),t.restore(),this},drawBorders:function(e,t){t=t||{};var n=this._calculateCurrentDimensions(),i=1/this.borderScaleFactor,r=n.x+i,o=n.y+i,a=void 0!==t.hasRotatingPoint?t.hasRotatingPoint:this.hasRotatingPoint,s=void 0!==t.hasControls?t.hasControls:this.hasControls,l=void 0!==t.rotatingPointOffset?t.rotatingPointOffset:this.rotatingPointOffset;if(e.save(),e.strokeStyle=t.borderColor||this.borderColor,this._setLineDash(e,t.borderDashArray||this.borderDashArray,null),e.strokeRect(-r/2,-o/2,r,o),a&&this.isControlVisible("mtr")&&s){var c=-o/2;e.beginPath(),e.moveTo(0,c),e.lineTo(0,c-l),e.stroke()}return e.restore(),this},drawBordersInGroup:function(e,t,n){n=n||{};var i=this._getNonTransformedDimensions(),r=k.util.customTransformMatrix(t.scaleX,t.scaleY,t.skewX),o=k.util.transformPoint(i,r),a=1/this.borderScaleFactor,s=o.x+a,l=o.y+a;return e.save(),this._setLineDash(e,n.borderDashArray||this.borderDashArray,null),e.strokeStyle=n.borderColor||this.borderColor,e.strokeRect(-s/2,-l/2,s,l),e.restore(),this},drawControls:function(e,t){t=t||{};var n=this._calculateCurrentDimensions(),i=n.x,r=n.y,o=t.cornerSize||this.cornerSize,a=-(i+o)/2,s=-(r+o)/2,l=void 0!==t.transparentCorners?t.transparentCorners:this.transparentCorners,c=void 0!==t.hasRotatingPoint?t.hasRotatingPoint:this.hasRotatingPoint,u=l?"stroke":"fill";return e.save(),e.strokeStyle=e.fillStyle=t.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=t.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,t.cornerDashArray||this.cornerDashArray,null),this._drawControl("tl",e,u,a,s,t),this._drawControl("tr",e,u,a+i,s,t),this._drawControl("bl",e,u,a,s+r,t),this._drawControl("br",e,u,a+i,s+r,t),this.get("lockUniScaling")||(this._drawControl("mt",e,u,a+i/2,s,t),this._drawControl("mb",e,u,a+i/2,s+r,t),this._drawControl("mr",e,u,a+i,s+r/2,t),this._drawControl("ml",e,u,a,s+r/2,t)),c&&this._drawControl("mtr",e,u,a+i/2,s-this.rotatingPointOffset,t),e.restore(),this},_drawControl:function(e,t,n,i,r,o){if(o=o||{},this.isControlVisible(e)){var a=this.cornerSize,s=!this.transparentCorners&&this.cornerStrokeColor;switch(o.cornerStyle||this.cornerStyle){case"circle":t.beginPath(),t.arc(i+a/2,r+a/2,a/2,0,2*Math.PI,!1),t[n](),s&&t.stroke();break;default:this.transparentCorners||t.clearRect(i,r,a,a),t[n+"Rect"](i,r,a,a),s&&t.strokeRect(i,r,a,a)}}},isControlVisible:function(e){return this._getControlsVisibility()[e]},setControlVisible:function(e,t){return this._getControlsVisibility()[e]=t,this},setControlsVisibility:function(e){for(var t in e||(e={}),e)this.setControlVisible(t,e[t]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility},onDeselect:function(){},onSelect:function(){}})}(),k.util.object.extend(k.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,t){var n=function(){},i=(t=t||{}).onComplete||n,r=t.onChange||n,o=this;return k.util.animate({startValue:e.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(t){e.set("left",t),o.requestRenderAll(),r()},onComplete:function(){e.setCoords(),i()}}),this},fxCenterObjectV:function(e,t){var n=function(){},i=(t=t||{}).onComplete||n,r=t.onChange||n,o=this;return k.util.animate({startValue:e.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(t){e.set("top",t),o.requestRenderAll(),r()},onComplete:function(){e.setCoords(),i()}}),this},fxRemove:function(e,t){var n=function(){},i=(t=t||{}).onComplete||n,r=t.onChange||n,o=this;return k.util.animate({startValue:e.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(t){e.set("opacity",t),o.requestRenderAll(),r()},onComplete:function(){o.remove(e),i()}}),this}}),k.util.object.extend(k.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var e,t,n=[];for(e in arguments[0])n.push(e);for(var i=0,r=n.length;i<r;i++)e=n[i],t=i!==r-1,this._animate(e,arguments[0][e],arguments[1],t)}else this._animate.apply(this,arguments);return this},_animate:function(e,t,n,i){var r,o=this;t=t.toString(),n=n?k.util.object.clone(n):{},~e.indexOf(".")&&(r=e.split("."));var a=r?this.get(r[0])[r[1]]:this.get(e);"from"in n||(n.from=a),t=~t.indexOf("=")?a+parseFloat(t.replace("=","")):parseFloat(t),k.util.animate({startValue:n.from,endValue:t,byValue:n.by,easing:n.easing,duration:n.duration,abort:n.abort&&function(){return n.abort.call(o)},onChange:function(t,a,s){r?o[r[0]][r[1]]=t:o.set(e,t),i||n.onChange&&n.onChange(t,a,s)},onComplete:function(e,t,r){i||(o.setCoords(),n.onComplete&&n.onComplete(e,t,r))}})}}),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.util.object.clone,r={x1:1,x2:1,y1:1,y2:1},o=t.StaticCanvas.supports("setLineDash");function a(e,t){var n=e.origin,i=e.axis1,r=e.axis2,o=e.dimension,a=t.nearest,s=t.center,l=t.farthest;return function(){switch(this.get(n)){case a:return Math.min(this.get(i),this.get(r));case s:return Math.min(this.get(i),this.get(r))+.5*this.get(o);case l:return Math.max(this.get(i),this.get(r))}}}t.Line?t.warn("fabric.Line is already defined"):(t.Line=t.util.createClass(t.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:t.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(e,t){e||(e=[0,0,0,0]),this.callSuper("initialize",t),this.set("x1",e[0]),this.set("y1",e[1]),this.set("x2",e[2]),this.set("y2",e[3]),this._setWidthHeight(t)},_setWidthHeight:function(e){e||(e={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in e?e.left:this._getLeftToOriginX(),this.top="top"in e?e.top:this._getTopToOriginY()},_set:function(e,t){return this.callSuper("_set",e,t),void 0!==r[e]&&this._setWidthHeight(),this},_getLeftToOriginX:a({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:a({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(e){if(e.beginPath(),!this.strokeDashArray||this.strokeDashArray&&o){var t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2)}e.lineWidth=this.strokeWidth;var n=e.strokeStyle;e.strokeStyle=this.stroke||e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n},_renderDashedStroke:function(e){var n=this.calcLinePoints();e.beginPath(),t.util.drawDashedLine(e,n.x1,n.y1,n.x2,n.y2,this.strokeDashArray),e.closePath()},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(e){return n(this.callSuper("toObject",e),this.calcLinePoints())},_getNonTransformedDimensions:function(){var e=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(e.y-=this.strokeWidth),0===this.height&&(e.x-=this.strokeWidth)),e},calcLinePoints:function(){var e=this.x1<=this.x2?-1:1,t=this.y1<=this.y2?-1:1,n=e*this.width*.5,i=t*this.height*.5;return{x1:n,x2:e*this.width*-.5,y1:i,y2:t*this.height*-.5}},_toSVG:function(){var e=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',e.x1,'" y1="',e.y1,'" x2="',e.x2,'" y2="',e.y2,'" />\n']}}),t.Line.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),t.Line.fromElement=function(e,i,r){r=r||{};var o=t.parseAttributes(e,t.Line.ATTRIBUTE_NAMES),a=[o.x1||0,o.y1||0,o.x2||0,o.y2||0];i(new t.Line(a,n(o,r)))},t.Line.fromObject=function(e,n){var r=i(e,!0);r.points=[e.x1,e.y1,e.x2,e.y2],t.Object._fromObject("Line",r,(function(e){delete e.points,n&&n(e)}),"points")})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=Math.PI;t.Circle?t.warn("fabric.Circle is already defined."):(t.Circle=t.util.createClass(t.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*n,cacheProperties:t.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(e,t){return this.callSuper("_set",e,t),"radius"===e&&this.setRadius(t),this},toObject:function(e){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(e))},_toSVG:function(){var e,i=(this.endAngle-this.startAngle)%(2*n);if(0===i)e=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var r=t.util.cos(this.startAngle)*this.radius,o=t.util.sin(this.startAngle)*this.radius,a=t.util.cos(this.endAngle)*this.radius,s=t.util.sin(this.endAngle)*this.radius,l=i>n?"1":"0";e=['<path d="M '+r+" "+o," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+a+" "+s,'" ',"COMMON_PARTS"," />\n"]}return e},_render:function(e){e.beginPath(),e.arc(0,0,this.radius,this.startAngle,this.endAngle,!1),this._renderPaintInOrder(e)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(e){return this.radius=e,this.set("width",2*e).set("height",2*e)}}),t.Circle.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),t.Circle.fromElement=function(e,n){var i,r=t.parseAttributes(e,t.Circle.ATTRIBUTE_NAMES);if(!("radius"in(i=r)&&i.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");r.left=(r.left||0)-r.radius,r.top=(r.top||0)-r.radius,n(new t.Circle(r))},t.Circle.fromObject=function(e,n){return t.Object._fromObject("Circle",e,n)})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={});t.Triangle?t.warn("fabric.Triangle is already defined"):(t.Triangle=t.util.createClass(t.Object,{type:"triangle",width:100,height:100,_render:function(e){var t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)},_renderDashedStroke:function(e){var n=this.width/2,i=this.height/2;e.beginPath(),t.util.drawDashedLine(e,-n,i,0,-i,this.strokeDashArray),t.util.drawDashedLine(e,0,-i,n,i,this.strokeDashArray),t.util.drawDashedLine(e,n,i,-n,i,this.strokeDashArray),e.closePath()},_toSVG:function(){var e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-e+" "+t,"0 "+-t,e+" "+t].join(","),'" />']}}),t.Triangle.fromObject=function(e,n){return t.Object._fromObject("Triangle",e,n)})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=2*Math.PI;t.Ellipse?t.warn("fabric.Ellipse is already defined."):(t.Ellipse=t.util.createClass(t.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(e){this.callSuper("initialize",e),this.set("rx",e&&e.rx||0),this.set("ry",e&&e.ry||0)},_set:function(e,t){switch(this.callSuper("_set",e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(e){return this.callSuper("toObject",["rx","ry"].concat(e))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,n,!1),e.restore(),this._renderPaintInOrder(e)}}),t.Ellipse.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),t.Ellipse.fromElement=function(e,n){var i=t.parseAttributes(e,t.Ellipse.ATTRIBUTE_NAMES);i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,n(new t.Ellipse(i))},t.Ellipse.fromObject=function(e,n){return t.Object._fromObject("Ellipse",e,n)})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Rect?t.warn("fabric.Rect is already defined"):(t.Rect=t.util.createClass(t.Object,{stateProperties:t.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(e){this.callSuper("initialize",e),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(e){var t=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,r=this.height,o=-this.width/2,a=-this.height/2,s=0!==t||0!==n,l=.4477152502;e.beginPath(),e.moveTo(o+t,a),e.lineTo(o+i-t,a),s&&e.bezierCurveTo(o+i-l*t,a,o+i,a+l*n,o+i,a+n),e.lineTo(o+i,a+r-n),s&&e.bezierCurveTo(o+i,a+r-l*n,o+i-l*t,a+r,o+i-t,a+r),e.lineTo(o+t,a+r),s&&e.bezierCurveTo(o+l*t,a+r,o,a+r-l*n,o,a+r-n),e.lineTo(o,a+n),s&&e.bezierCurveTo(o,a+l*n,o+l*t,a,o+t,a),e.closePath(),this._renderPaintInOrder(e)},_renderDashedStroke:function(e){var n=-this.width/2,i=-this.height/2,r=this.width,o=this.height;e.beginPath(),t.util.drawDashedLine(e,n,i,n+r,i,this.strokeDashArray),t.util.drawDashedLine(e,n+r,i,n+r,i+o,this.strokeDashArray),t.util.drawDashedLine(e,n+r,i+o,n,i+o,this.strokeDashArray),t.util.drawDashedLine(e,n,i+o,n,i,this.strokeDashArray),e.closePath()},toObject:function(e){return this.callSuper("toObject",["rx","ry"].concat(e))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),t.Rect.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),t.Rect.fromElement=function(e,i,r){if(!e)return i(null);r=r||{};var o=t.parseAttributes(e,t.Rect.ATTRIBUTE_NAMES);o.left=o.left||0,o.top=o.top||0,o.height=o.height||0,o.width=o.width||0;var a=new t.Rect(n(r?t.util.object.clone(r):{},o));a.visible=a.visible&&a.width>0&&a.height>0,i(a)},t.Rect.fromObject=function(e,n){return t.Object._fromObject("Rect",e,n)})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.util.array.min,r=t.util.array.max,o=t.util.toFixed;t.Polyline?t.warn("fabric.Polyline is already defined"):(t.Polyline=t.util.createClass(t.Object,{type:"polyline",points:null,cacheProperties:t.Object.prototype.cacheProperties.concat("points"),initialize:function(e,t){t=t||{},this.points=e||[],this.callSuper("initialize",t),this._setPositionDimensions(t)},_setPositionDimensions:function(e){var t,n=this._calcDimensions(e);this.width=n.width,this.height=n.height,e.fromSVG||(t=this.translateToGivenOrigin({x:n.left-this.strokeWidth/2,y:n.top-this.strokeWidth/2},"left","top",this.originX,this.originY)),void 0===e.left&&(this.left=e.fromSVG?n.left:t.x),void 0===e.top&&(this.top=e.fromSVG?n.top:t.y),this.pathOffset={x:n.left+this.width/2,y:n.top+this.height/2}},_calcDimensions:function(){var e=this.points,t=i(e,"x")||0,n=i(e,"y")||0;return{left:t,top:n,width:(r(e,"x")||0)-t,height:(r(e,"y")||0)-n}},toObject:function(e){return n(this.callSuper("toObject",e),{points:this.points.concat()})},_toSVG:function(){for(var e=[],n=this.pathOffset.x,i=this.pathOffset.y,r=t.Object.NUM_FRACTION_DIGITS,a=0,s=this.points.length;a<s;a++)e.push(o(this.points[a].x-n,r),",",o(this.points[a].y-i,r)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',e.join(""),'" />\n']},commonRender:function(e){var t,n=this.points.length,i=this.pathOffset.x,r=this.pathOffset.y;if(!n||isNaN(this.points[n-1].y))return!1;e.beginPath(),e.moveTo(this.points[0].x-i,this.points[0].y-r);for(var o=0;o<n;o++)t=this.points[o],e.lineTo(t.x-i,t.y-r);return!0},_render:function(e){this.commonRender(e)&&this._renderPaintInOrder(e)},_renderDashedStroke:function(e){var n,i;e.beginPath();for(var r=0,o=this.points.length;r<o;r++)n=this.points[r],i=this.points[r+1]||n,t.util.drawDashedLine(e,n.x,n.y,i.x,i.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),t.Polyline.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polyline.fromElementGenerator=function(e){return function(i,r,o){if(!i)return r(null);o||(o={});var a=t.parsePointsAttribute(i.getAttribute("points")),s=t.parseAttributes(i,t[e].ATTRIBUTE_NAMES);s.fromSVG=!0,r(new t[e](a,n(s,o)))}},t.Polyline.fromElement=t.Polyline.fromElementGenerator("Polyline"),t.Polyline.fromObject=function(e,n){return t.Object._fromObject("Polyline",e,n,"points")})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={});t.Polygon?t.warn("fabric.Polygon is already defined"):(t.Polygon=t.util.createClass(t.Polyline,{type:"polygon",_render:function(e){this.commonRender(e)&&(e.closePath(),this._renderPaintInOrder(e))},_renderDashedStroke:function(e){this.callSuper("_renderDashedStroke",e),e.closePath()}}),t.Polygon.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polygon.fromElement=t.Polyline.fromElementGenerator("Polygon"),t.Polygon.fromObject=function(e,n){return t.Object._fromObject("Polygon",e,n,"points")})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.array.min,i=t.util.array.max,r=t.util.object.extend,o=Object.prototype.toString,a=t.util.drawArc,s=t.util.toFixed,l={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};t.Path?t.warn("fabric.Path is already defined"):(t.Path=t.util.createClass(t.Object,{type:"path",path:null,cacheProperties:t.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:t.Object.prototype.stateProperties.concat("path"),initialize:function(e,n){n=n||{},this.callSuper("initialize",n),e||(e=[]);var i="[object Array]"===o.call(e);this.path=i?e:e.match&&e.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(i||(this.path=this._parsePath()),t.Polyline.prototype._setPositionDimensions.call(this,n))},_renderPathCommands:function(e){var t,n,i,r=null,o=0,s=0,l=0,c=0,u=0,h=0,d=-this.pathOffset.x,f=-this.pathOffset.y;e.beginPath();for(var p=0,g=this.path.length;p<g;++p){switch((t=this.path[p])[0]){case"l":l+=t[1],c+=t[2],e.lineTo(l+d,c+f);break;case"L":l=t[1],c=t[2],e.lineTo(l+d,c+f);break;case"h":l+=t[1],e.lineTo(l+d,c+f);break;case"H":l=t[1],e.lineTo(l+d,c+f);break;case"v":c+=t[1],e.lineTo(l+d,c+f);break;case"V":c=t[1],e.lineTo(l+d,c+f);break;case"m":o=l+=t[1],s=c+=t[2],e.moveTo(l+d,c+f);break;case"M":o=l=t[1],s=c=t[2],e.moveTo(l+d,c+f);break;case"c":n=l+t[5],i=c+t[6],u=l+t[3],h=c+t[4],e.bezierCurveTo(l+t[1]+d,c+t[2]+f,u+d,h+f,n+d,i+f),l=n,c=i;break;case"C":l=t[5],c=t[6],u=t[3],h=t[4],e.bezierCurveTo(t[1]+d,t[2]+f,u+d,h+f,l+d,c+f);break;case"s":n=l+t[3],i=c+t[4],null===r[0].match(/[CcSs]/)?(u=l,h=c):(u=2*l-u,h=2*c-h),e.bezierCurveTo(u+d,h+f,l+t[1]+d,c+t[2]+f,n+d,i+f),u=l+t[1],h=c+t[2],l=n,c=i;break;case"S":n=t[3],i=t[4],null===r[0].match(/[CcSs]/)?(u=l,h=c):(u=2*l-u,h=2*c-h),e.bezierCurveTo(u+d,h+f,t[1]+d,t[2]+f,n+d,i+f),l=n,c=i,u=t[1],h=t[2];break;case"q":n=l+t[3],i=c+t[4],u=l+t[1],h=c+t[2],e.quadraticCurveTo(u+d,h+f,n+d,i+f),l=n,c=i;break;case"Q":n=t[3],i=t[4],e.quadraticCurveTo(t[1]+d,t[2]+f,n+d,i+f),l=n,c=i,u=t[1],h=t[2];break;case"t":n=l+t[1],i=c+t[2],null===r[0].match(/[QqTt]/)?(u=l,h=c):(u=2*l-u,h=2*c-h),e.quadraticCurveTo(u+d,h+f,n+d,i+f),l=n,c=i;break;case"T":n=t[1],i=t[2],null===r[0].match(/[QqTt]/)?(u=l,h=c):(u=2*l-u,h=2*c-h),e.quadraticCurveTo(u+d,h+f,n+d,i+f),l=n,c=i;break;case"a":a(e,l+d,c+f,[t[1],t[2],t[3],t[4],t[5],t[6]+l+d,t[7]+c+f]),l+=t[6],c+=t[7];break;case"A":a(e,l+d,c+f,[t[1],t[2],t[3],t[4],t[5],t[6]+d,t[7]+f]),l=t[6],c=t[7];break;case"z":case"Z":l=o,c=s,e.closePath()}r=t}},_render:function(e){this._renderPathCommands(e),this._renderPaintInOrder(e)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(e){return r(this.callSuper("toObject",e),{path:this.path.map((function(e){return e.slice()}))})},toDatalessObject:function(e){var t=this.toObject(["sourcePath"].concat(e));return t.sourcePath&&delete t.path,t},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',this.path.map((function(e){return e.join(" ")})).join(" "),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var e=t.Object.NUM_FRACTION_DIGITS;return" translate("+s(-this.pathOffset.x,e)+", "+s(-this.pathOffset.y,e)+")"},toClipPathSVG:function(e){var t=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})},toSVG:function(e){var t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})},complexity:function(){return this.path.length},_parsePath:function(){for(var e,t,n,i,r,o=[],a=[],s=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,u=0,h=this.path.length;u<h;u++){for(i=(e=this.path[u]).slice(1).trim(),a.length=0;n=s.exec(i);)a.push(n[0]);r=[e.charAt(0)];for(var d=0,f=a.length;d<f;d++)t=parseFloat(a[d]),isNaN(t)||r.push(t);var p=r[0],g=l[p.toLowerCase()],v=c[p]||p;if(r.length-1>g)for(var m=1,b=r.length;m<b;m+=g)o.push([p].concat(r.slice(m,m+g))),p=v;else o.push(r)}return o},_calcDimensions:function(){for(var e,r,o,a,s=[],l=[],c=null,u=0,h=0,d=0,f=0,p=0,g=0,v=0,m=this.path.length;v<m;++v){switch((e=this.path[v])[0]){case"l":d+=e[1],f+=e[2],a=[];break;case"L":d=e[1],f=e[2],a=[];break;case"h":d+=e[1],a=[];break;case"H":d=e[1],a=[];break;case"v":f+=e[1],a=[];break;case"V":f=e[1],a=[];break;case"m":u=d+=e[1],h=f+=e[2],a=[];break;case"M":u=d=e[1],h=f=e[2],a=[];break;case"c":r=d+e[5],o=f+e[6],p=d+e[3],g=f+e[4],a=t.util.getBoundsOfCurve(d,f,d+e[1],f+e[2],p,g,r,o),d=r,f=o;break;case"C":p=e[3],g=e[4],a=t.util.getBoundsOfCurve(d,f,e[1],e[2],p,g,e[5],e[6]),d=e[5],f=e[6];break;case"s":r=d+e[3],o=f+e[4],null===c[0].match(/[CcSs]/)?(p=d,g=f):(p=2*d-p,g=2*f-g),a=t.util.getBoundsOfCurve(d,f,p,g,d+e[1],f+e[2],r,o),p=d+e[1],g=f+e[2],d=r,f=o;break;case"S":r=e[3],o=e[4],null===c[0].match(/[CcSs]/)?(p=d,g=f):(p=2*d-p,g=2*f-g),a=t.util.getBoundsOfCurve(d,f,p,g,e[1],e[2],r,o),d=r,f=o,p=e[1],g=e[2];break;case"q":r=d+e[3],o=f+e[4],p=d+e[1],g=f+e[2],a=t.util.getBoundsOfCurve(d,f,p,g,p,g,r,o),d=r,f=o;break;case"Q":p=e[1],g=e[2],a=t.util.getBoundsOfCurve(d,f,p,g,p,g,e[3],e[4]),d=e[3],f=e[4];break;case"t":r=d+e[1],o=f+e[2],null===c[0].match(/[QqTt]/)?(p=d,g=f):(p=2*d-p,g=2*f-g),a=t.util.getBoundsOfCurve(d,f,p,g,p,g,r,o),d=r,f=o;break;case"T":r=e[1],o=e[2],null===c[0].match(/[QqTt]/)?(p=d,g=f):(p=2*d-p,g=2*f-g),a=t.util.getBoundsOfCurve(d,f,p,g,p,g,r,o),d=r,f=o;break;case"a":a=t.util.getBoundsOfArc(d,f,e[1],e[2],e[3],e[4],e[5],e[6]+d,e[7]+f),d+=e[6],f+=e[7];break;case"A":a=t.util.getBoundsOfArc(d,f,e[1],e[2],e[3],e[4],e[5],e[6],e[7]),d=e[6],f=e[7];break;case"z":case"Z":d=u,f=h}c=e,a.forEach((function(e){s.push(e.x),l.push(e.y)})),s.push(d),l.push(f)}var b=n(s)||0,y=n(l)||0;return{left:b,top:y,width:(i(s)||0)-b,height:(i(l)||0)-y}}}),t.Path.fromObject=function(e,n){if("string"==typeof e.sourcePath){var i=e.sourcePath;t.loadSVGFromURL(i,(function(t){var i=t[0];i.setOptions(e),n&&n(i)}))}else t.Object._fromObject("Path",e,n,"path")},t.Path.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(["d"]),t.Path.fromElement=function(e,n,i){var o=t.parseAttributes(e,t.Path.ATTRIBUTE_NAMES);o.fromSVG=!0,n(new t.Path(o.d,r(o,i)))})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.array.min,i=t.util.array.max;t.Group||(t.Group=t.util.createClass(t.Object,t.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(e,t,n){t=t||{},this._objects=[],n&&this.callSuper("initialize",t),this._objects=e||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;if(n)this._updateObjectsACoords();else{var r=t&&t.centerPoint;void 0!==t.originX&&(this.originX=t.originX),void 0!==t.originY&&(this.originY=t.originY),r||this._calcBounds(),this._updateObjectsCoords(r),delete t.centerPoint,this.callSuper("initialize",t)}this.setCoords()},_updateObjectsACoords:function(){for(var e=this._objects.length;e--;)this._objects[e].setCoords(!0,!0)},_updateObjectsCoords:function(e){e=e||this.getCenterPoint();for(var t=this._objects.length;t--;)this._updateObjectCoords(this._objects[t],e)},_updateObjectCoords:function(e,t){var n=e.left,i=e.top;e.set({left:n-t.x,top:i-t.y}),e.group=this,e.setCoords(!0,!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(e){return this._restoreObjectsState(),t.util.resetObjectTransform(this),e&&(this._objects.push(e),e.group=this,e._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},removeWithUpdate:function(e){return this._restoreObjectsState(),t.util.resetObjectTransform(this),this.remove(e),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(e){this.dirty=!0,e.group=this,e._set("canvas",this.canvas)},_onObjectRemoved:function(e){this.dirty=!0,delete e.group},_set:function(e,n){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(e,n);if("canvas"===e)for(;i--;)this._objects[i]._set(e,n);t.Object.prototype._set.call(this,e,n)},toObject:function(e){var n=this.includeDefaultValues,i=this._objects.map((function(t){var i=t.includeDefaultValues;t.includeDefaultValues=n;var r=t.toObject(e);return t.includeDefaultValues=i,r})),r=t.Object.prototype.toObject.call(this,e);return r.objects=i,r},toDatalessObject:function(e){var n,i=this.sourcePath;if(i)n=i;else{var r=this.includeDefaultValues;n=this._objects.map((function(t){var n=t.includeDefaultValues;t.includeDefaultValues=r;var i=t.toDatalessObject(e);return t.includeDefaultValues=n,i}))}var o=t.Object.prototype.toDatalessObject.call(this,e);return o.objects=n,o},render:function(e){this._transformDone=!0,this.callSuper("render",e),this._transformDone=!1},shouldCache:function(){var e=t.Object.prototype.shouldCache.call(this);if(e)for(var n=0,i=this._objects.length;n<i;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1;return e},willDrawShadow:function(){if(this.shadow)return t.Object.prototype.willDrawShadow.call(this);for(var e=0,n=this._objects.length;e<n;e++)if(this._objects[e].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(e){for(var t=0,n=this._objects.length;t<n;t++)this._objects[t].render(e);this._drawClipPath(e)},isCacheDirty:function(e){if(this.callSuper("isCacheDirty",e))return!0;if(!this.statefullCache)return!1;for(var t=0,n=this._objects.length;t<n;t++)if(this._objects[t].isCacheDirty(!0)){if(this._cacheCanvas){var i=this.cacheWidth/this.zoomX,r=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-i/2,-r/2,i,r)}return!0}return!1},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(e){var n=e.calcTransformMatrix(),i=t.util.qrDecompose(n),r=new t.Point(i.translateX,i.translateY);return e.flipX=!1,e.flipY=!1,e.set("scaleX",i.scaleX),e.set("scaleY",i.scaleY),e.skewX=i.skewX,e.skewY=i.skewY,e.angle=i.angle,e.setPositionByOrigin(r,"center","center"),e},_restoreObjectState:function(e){return this.realizeTransform(e),e.setCoords(),delete e.group,this},destroy:function(){return this._objects.forEach((function(e){e.set("dirty",!0)})),this._restoreObjectsState()},toActiveSelection:function(){if(this.canvas){var e=this._objects,n=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var r=new t.ActiveSelection([]);return r.set(i),r.type="activeSelection",n.remove(this),e.forEach((function(e){e.group=r,e.dirty=!0,n.add(e)})),r.canvas=n,r._objects=e,n._activeObject=r,r.setCoords(),r}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject((function(e){e.setCoords(!0,!0)})),this},_calcBounds:function(e){for(var t,n,i,r=[],o=[],a=["tr","br","bl","tl"],s=0,l=this._objects.length,c=a.length;s<l;++s)for((t=this._objects[s]).setCoords(!0),i=0;i<c;i++)n=a[i],r.push(t.oCoords[n].x),o.push(t.oCoords[n].y);this._getBounds(r,o,e)},_getBounds:function(e,r,o){var a=new t.Point(n(e),n(r)),s=new t.Point(i(e),i(r)),l=a.y||0,c=a.x||0,u=s.x-a.x||0,h=s.y-a.y||0;this.width=u,this.height=h,o||this.setPositionByOrigin({x:c,y:l},"left","top")},_toSVG:function(e){for(var t=["<g ","COMMON_PARTS"," >\n"],n=0,i=this._objects.length;n<i;n++)t.push("\t\t",this._objects[n].toSVG(e));return t.push("</g>\n"),t},getSvgStyles:function(){var e=void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")},toClipPathSVG:function(e){for(var t=[],n=0,i=this._objects.length;n<i;n++)t.push("\t",this._objects[n].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}}),t.Group.fromObject=function(e,n){t.util.enlivenObjects(e.objects,(function(i){t.util.enlivenObjects([e.clipPath],(function(r){var o=t.util.object.clone(e,!0);o.clipPath=r[0],delete o.objects,n&&n(new t.Group(i,o,!0))}))}))})}(t),function(e){"use strict";var t=e.fabric||(e.fabric={});t.ActiveSelection||(t.ActiveSelection=t.util.createClass(t.Group,{type:"activeSelection",initialize:function(e,n){n=n||{},this._objects=e||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;n.originX&&(this.originX=n.originX),n.originY&&(this.originY=n.originY),this._calcBounds(),this._updateObjectsCoords(),t.Object.prototype.initialize.call(this,n),this.setCoords()},toGroup:function(){var e=this._objects.concat();this._objects=[];var n=t.Object.prototype.toObject.call(this),i=new t.Group([]);if(delete n.type,i.set(n),e.forEach((function(e){e.canvas.remove(e),e.group=i})),i._objects=e,!this.canvas)return i;var r=this.canvas;return r.add(i),r._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",e,t),void 0===(n=n||{}).hasControls&&(n.hasControls=!1),void 0===n.hasRotatingPoint&&(n.hasRotatingPoint=!1),n.forActiveSelection=!0;for(var i=0,r=this._objects.length;i<r;i++)this._objects[i]._renderControls(e,n);e.restore()}}),t.ActiveSelection.fromObject=function(e,n){t.util.enlivenObjects(e.objects,(function(i){delete e.objects,n&&n(new t.ActiveSelection(i,e,!0))}))})}(t),function(e){"use strict";var t=k.util.object.extend;e.fabric||(e.fabric={}),e.fabric.Image?k.warn("fabric.Image is already defined."):(k.Image=k.util.createClass(k.Object,{type:"image",crossOrigin:"",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:k.Object.prototype.stateProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,initialize:function(e,t){t||(t={}),this.filters=[],this.cacheKey="texture"+k.Object.__uid++,this.callSuper("initialize",t),this._initElement(e,t)},getElement:function(){return this._element||{}},setElement:function(e,t){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=e,this._originalElement=e,this._initConfig(t),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(e){var t=k.filterBackend;t&&t.evictCachesForKey&&t.evictCachesForKey(e)},dispose:function(){this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(e){k.util.cleanUpJsdomNode(this[e]),this[e]=void 0}.bind(this))},setCrossOrigin:function(e){return this.crossOrigin=e,this._element.crossOrigin=e,this},getOriginalSize:function(){var e=this.getElement();return{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}},_stroke:function(e){if(this.stroke&&0!==this.strokeWidth){var t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}},_renderDashedStroke:function(e){var t=-this.width/2,n=-this.height/2,i=this.width,r=this.height;e.save(),this._setStrokeStyles(e,this),e.beginPath(),k.util.drawDashedLine(e,t,n,t+i,n,this.strokeDashArray),k.util.drawDashedLine(e,t+i,n,t+i,n+r,this.strokeDashArray),k.util.drawDashedLine(e,t+i,n+r,t,n+r,this.strokeDashArray),k.util.drawDashedLine(e,t,n+r,t,n,this.strokeDashArray),e.closePath(),e.restore()},toObject:function(e){var n=[];this.filters.forEach((function(e){e&&n.push(e.toObject())}));var i=t(this.callSuper("toObject",["crossOrigin","cropX","cropY"].concat(e)),{src:this.getSrc(),filters:n});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var e,t=[],n=[],i=-this.width/2,r=-this.height/2,o="";if(this.hasCrop()){var a=k.Object.__uid++;t.push('<clipPath id="imageCrop_'+a+'">\n','\t<rect x="'+i+'" y="'+r+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),o=' clip-path="url(#imageCrop_'+a+')" '}if(n.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',i-this.cropX,'" y="',r-this.cropY,'" width="',this._element.width||this._element.naturalWidth,'" height="',this._element.height||this._element.height,'"',o,"></image>\n"),this.stroke||this.strokeDashArray){var s=this.fill;this.fill=null,e=["\t<rect ",'x="',i,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=s}return t="fill"!==this.paintFirst?t.concat(e,n):t.concat(n,e)},getSrc:function(e){var t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src"):t.src:this.src||""},setSrc:function(e,t,n){return k.util.loadImage(e,(function(e){this.setElement(e,n),this._setWidthHeight(),t&&t(this)}),this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),i=n.scaleX,r=n.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||i>t&&r>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=r);k.filterBackend||(k.filterBackend=k.initFilterBackend());var a=k.util.createCanvasElement(),s=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,l=o.width,c=o.height;a.width=l,a.height=c,this._element=a,this._lastScaleX=e.scaleX=i,this._lastScaleY=e.scaleY=r,k.filterBackend.applyFilters([e],o,l,c,this._element,s),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height},applyFilters:function(e){if(e=(e=e||this.filters||[]).filter((function(e){return e&&!e.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===e.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var t=this._originalElement,n=t.naturalWidth||t.width,i=t.naturalHeight||t.height;if(this._element===this._originalElement){var r=k.util.createCanvasElement();r.width=n,r.height=i,this._element=r,this._filteredEl=r}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,i),this._lastScaleX=1,this._lastScaleY=1;return k.filterBackend||(k.filterBackend=k.initFilterBackend()),k.filterBackend.applyFilters(e,this._originalElement,n,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(e){!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(e){var t=this._element,n=this.width,i=this.height,r=Math.min(t.naturalWidth||t.width,n*this._filterScalingX),o=Math.min(t.naturalHeight||t.height,i*this._filterScalingY),a=-n/2,s=-i/2,l=Math.max(0,this.cropX*this._filterScalingX),c=Math.max(0,this.cropY*this._filterScalingY);t&&e.drawImage(t,l,c,r,o,a,s,n,i)},_needsResize:function(){var e=this.getTotalObjectScaling();return e.scaleX!==this._lastScaleX||e.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(e,t){this.setElement(k.util.getById(e),t),k.util.addClass(this.getElement(),k.Image.CSS_CANVAS)},_initConfig:function(e){e||(e={}),this.setOptions(e),this._setWidthHeight(e),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(e,t){e&&e.length?k.util.enlivenObjects(e,(function(e){t&&t(e)}),"fabric.Image.filters"):t&&t()},_setWidthHeight:function(e){e||(e={});var t=this.getElement();this.width=e.width||t.naturalWidth||t.width||0,this.height=e.height||t.naturalHeight||t.height||0},parsePreserveAspectRatioAttribute:function(){var e,t=k.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),n=this._element.width,i=this._element.height,r=1,o=1,a=0,s=0,l=0,c=0,u=this.width,h=this.height,d={width:u,height:h};return!t||"none"===t.alignX&&"none"===t.alignY?(r=u/n,o=h/i):("meet"===t.meetOrSlice&&(e=(u-n*(r=o=k.util.findScaleToFit(this._element,d)))/2,"Min"===t.alignX&&(a=-e),"Max"===t.alignX&&(a=e),e=(h-i*o)/2,"Min"===t.alignY&&(s=-e),"Max"===t.alignY&&(s=e)),"slice"===t.meetOrSlice&&(e=n-u/(r=o=k.util.findScaleToCover(this._element,d)),"Mid"===t.alignX&&(l=e/2),"Max"===t.alignX&&(l=e),e=i-h/o,"Mid"===t.alignY&&(c=e/2),"Max"===t.alignY&&(c=e),n=u/r,i=h/o)),{width:n,height:i,scaleX:r,scaleY:o,offsetLeft:a,offsetTop:s,cropX:l,cropY:c}}}),k.Image.CSS_CANVAS="canvas-img",k.Image.prototype.getSvgSrc=k.Image.prototype.getSrc,k.Image.fromObject=function(e,t){var n=k.util.object.clone(e);k.util.loadImage(n.src,(function(e,i){i?t&&t(null,i):k.Image.prototype._initFilters.call(n,n.filters,(function(i){n.filters=i||[],k.Image.prototype._initFilters.call(n,[n.resizeFilter],(function(i){n.resizeFilter=i[0],k.util.enlivenObjects([n.clipPath],(function(i){n.clipPath=i[0];var r=new k.Image(e,n);t(r)}))}))}))}),null,n.crossOrigin)},k.Image.fromURL=function(e,t,n){k.util.loadImage(e,(function(e){t&&t(new k.Image(e,n))}),null,n&&n.crossOrigin)},k.Image.ATTRIBUTE_NAMES=k.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin".split(" ")),k.Image.fromElement=function(e,n,i){var r=k.parseAttributes(e,k.Image.ATTRIBUTE_NAMES);k.Image.fromURL(r["xlink:href"],n,t(i?k.util.object.clone(i):{},r))})}(t),k.util.object.extend(k.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.angle%360;return e>0?90*Math.round((e-1)/90):90*Math.round(e/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten()),this},fxStraighten:function(e){var t=function(){},n=(e=e||{}).onComplete||t,i=e.onChange||t,r=this;return k.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(e){r.rotate(e),i()},onComplete:function(){r.setCoords(),n()}}),this}}),k.util.object.extend(k.StaticCanvas.prototype,{straightenObject:function(e){return e.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(e){return e.fxStraighten({onChange:this.requestRenderAllBound}),this}}),function(){"use strict";function e(e,t){var n="precision "+t+" float;\nvoid main(){}",i=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(i,n),e.compileShader(i),!!e.getShaderParameter(i,e.COMPILE_STATUS)}function t(e){e&&e.tileSize&&(this.tileSize=e.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}k.isWebglSupported=function(t){if(k.isLikelyNode)return!1;t=t||k.WebglFilterBackend.prototype.tileSize;var n=document.createElement("canvas"),i=n.getContext("webgl")||n.getContext("experimental-webgl"),r=!1;if(i){k.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),r=k.maxTextureSize>=t;for(var o=["highp","mediump","lowp"],a=0;a<3;a++)if(e(i,o[a])){k.webGlPrecision=o[a];break}}return this.isSupported=r,r},k.WebglFilterBackend=t,t.prototype={tileSize:2048,resources:{},setupGLContext:function(e,t){this.dispose(),this.createWebGLCanvas(e,t),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(e,t)},chooseFastestCopyGLTo2DMethod:function(e,t){var n,i=void 0!==window.performance;try{new ImageData(1,1),n=!0}catch(e){n=!1}var r="undefined"!=typeof ArrayBuffer,o="undefined"!=typeof Uint8ClampedArray;if(i&&n&&r&&o){var a=k.util.createCanvasElement(),s=new ArrayBuffer(e*t*4);if(k.forceGLPutImageData)return this.imageBuffer=s,void(this.copyGLTo2D=M);var l,c,u={imageBuffer:s,destinationWidth:e,destinationHeight:t,targetCanvas:a};a.width=e,a.height=t,l=window.performance.now(),E.call(u,this.gl,u),c=window.performance.now()-l,l=window.performance.now(),M.call(u,this.gl,u),c>window.performance.now()-l?(this.imageBuffer=s,this.copyGLTo2D=M):this.copyGLTo2D=E}},createWebGLCanvas:function(e,t){var n=k.util.createCanvasElement();n.width=e,n.height=t;var i={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},r=n.getContext("webgl",i);r||(r=n.getContext("experimental-webgl",i)),r&&(r.clearColor(0,0,0,0),this.canvas=n,this.gl=r)},applyFilters:function(e,t,n,i,r,o){var a,s=this.gl;o&&(a=this.getCachedTexture(o,t));var l={originalWidth:t.width||t.originalWidth,originalHeight:t.height||t.originalHeight,sourceWidth:n,sourceHeight:i,destinationWidth:n,destinationHeight:i,context:s,sourceTexture:this.createTexture(s,n,i,!a&&t),targetTexture:this.createTexture(s,n,i),originalTexture:a||this.createTexture(s,n,i,!a&&t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},c=s.createFramebuffer();return s.bindFramebuffer(s.FRAMEBUFFER,c),e.forEach((function(e){e&&e.applyTo(l)})),function(e){var t=e.targetCanvas,n=t.width,i=t.height,r=e.destinationWidth,o=e.destinationHeight;n===r&&i===o||(t.width=r,t.height=o)}(l),this.copyGLTo2D(s,l),s.bindTexture(s.TEXTURE_2D,null),s.deleteTexture(l.sourceTexture),s.deleteTexture(l.targetTexture),s.deleteFramebuffer(c),r.getContext("2d").setTransform(1,0,0,1,0,0),l},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(e,t,n,i){var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),r},getCachedTexture:function(e,t){if(this.textureCache[e])return this.textureCache[e];var n=this.createTexture(this.gl,t.width,t.height,t);return this.textureCache[e]=n,n},evictCachesForKey:function(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])},copyGLTo2D:E,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var e=this.gl,t={renderer:"",vendor:""};if(!e)return t;var n=e.getExtension("WEBGL_debug_renderer_info");if(n){var i=e.getParameter(n.UNMASKED_RENDERER_WEBGL),r=e.getParameter(n.UNMASKED_VENDOR_WEBGL);i&&(t.renderer=i.toLowerCase()),r&&(t.vendor=r.toLowerCase())}return this.gpuInfo=t,t}}}(),function(){"use strict";var e=function(){};function t(){}k.Canvas2dFilterBackend=t,t.prototype={evictCachesForKey:e,dispose:e,clearWebGLCaches:e,resources:{},applyFilters:function(e,t,n,i,r){var o=r.getContext("2d");o.drawImage(t,0,0,n,i);var a={sourceWidth:n,sourceHeight:i,imageData:o.getImageData(0,0,n,i),originalEl:t,originalImageData:o.getImageData(0,0,n,i),canvasEl:r,ctx:o,filterBackend:this};return e.forEach((function(e){e.applyTo(a)})),a.imageData.width===n&&a.imageData.height===i||(r.width=a.imageData.width,r.height=a.imageData.height),o.putImageData(a.imageData,0,0),a}}}(),k.Image=k.Image||{},k.Image.filters=k.Image.filters||{},k.Image.filters.BaseFilter=k.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(e){e&&this.setOptions(e)},setOptions:function(e){for(var t in e)this[t]=e[t]},createProgram:function(e,t,n){t=t||this.fragmentSource,n=n||this.vertexSource,"highp"!==k.webGlPrecision&&(t=t.replace(/precision highp float/g,"precision "+k.webGlPrecision+" float"));var i=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+e.getShaderInfoLog(i));var r=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+e.getShaderInfoLog(r));var o=e.createProgram();if(e.attachShader(o,i),e.attachShader(o,r),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+e.getProgramInfoLog(o));var a=this.getAttributeLocations(e,o),s=this.getUniformLocations(e,o)||{};return s.uStepW=e.getUniformLocation(o,"uStepW"),s.uStepH=e.getUniformLocation(o,"uStepH"),{program:o,attributeLocations:a,uniformLocations:s}},getAttributeLocations:function(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(e,t,n){var i=t.aPosition,r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)},_setupFrameBuffer:function(e){var t,n,i=e.context;e.passes>1?(t=e.destinationWidth,n=e.destinationHeight,e.sourceWidth===t&&e.sourceHeight===n||(i.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(i,t,n)),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e.targetTexture,0)):(i.bindFramebuffer(i.FRAMEBUFFER,null),i.finish())},_swapTextures:function(e){e.passes--,e.pass++;var t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t},isNeutralState:function(){var e=this.mainParameter,t=k.Image.filters[this.type].prototype;if(e){if(Array.isArray(t[e])){for(var n=t[e].length;n--;)if(this[e][n]!==t[e][n])return!1;return!0}return t[e]===this[e]}return!1},applyTo:function(e){e.webgl?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},retrieveShader:function(e){return e.programCache.hasOwnProperty(this.type)||(e.programCache[this.type]=this.createProgram(e.context)),e.programCache[this.type]},applyToWebGL:function(e){var t=e.context,n=this.retrieveShader(e);0===e.pass&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)},unbindAdditionalTexture:function(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(e){this[this.mainParameter]=e},sendUniformData:function(){},createHelpLayer:function(e){if(!e.helpLayer){var t=document.createElement("canvas");t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}},toObject:function(){var e={type:this.type},t=this.mainParameter;return t&&(e[t]=this[t]),e},toJSON:function(){return this.toObject()}}),k.Image.filters.BaseFilter.fromObject=function(e,t){var n=new k.Image.filters[e.type](e);return t&&t(n),n},function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.ColorMatrix=i(n.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(e){this.callSuper("initialize",e),this.matrix=this.matrix.slice(0)},applyTo2d:function(e){var t,n,i,r,o,a=e.imageData.data,s=a.length,l=this.matrix,c=this.colorsOnly;for(o=0;o<s;o+=4)t=a[o],n=a[o+1],i=a[o+2],c?(a[o]=t*l[0]+n*l[1]+i*l[2]+255*l[4],a[o+1]=t*l[5]+n*l[6]+i*l[7]+255*l[9],a[o+2]=t*l[10]+n*l[11]+i*l[12]+255*l[14]):(r=a[o+3],a[o]=t*l[0]+n*l[1]+i*l[2]+r*l[3]+255*l[4],a[o+1]=t*l[5]+n*l[6]+i*l[7]+r*l[8]+255*l[9],a[o+2]=t*l[10]+n*l[11]+i*l[12]+r*l[13]+255*l[14],a[o+3]=t*l[15]+n*l[16]+i*l[17]+r*l[18]+255*l[19])},getUniformLocations:function(e,t){return{uColorMatrix:e.getUniformLocation(t,"uColorMatrix"),uConstants:e.getUniformLocation(t,"uConstants")}},sendUniformData:function(e,t){var n=this.matrix,i=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],r=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,i),e.uniform4fv(t.uConstants,r)}}),t.Image.filters.ColorMatrix.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Brightness=i(n.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(e){if(0!==this.brightness){var t,n=e.imageData.data,i=n.length,r=Math.round(255*this.brightness);for(t=0;t<i;t+=4)n[t]=n[t]+r,n[t+1]=n[t+1]+r,n[t+2]=n[t+2]+r}},getUniformLocations:function(e,t){return{uBrightness:e.getUniformLocation(t,"uBrightness")}},sendUniformData:function(e,t){e.uniform1f(t.uBrightness,this.brightness)}}),t.Image.filters.Brightness.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.Image.filters,r=t.util.createClass;i.Convolute=r(i.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(e){var t=Math.sqrt(this.matrix.length),n=this.type+"_"+t+"_"+(this.opaque?1:0),i=this.fragmentSource[n];return e.programCache.hasOwnProperty(n)||(e.programCache[n]=this.createProgram(e.context,i)),e.programCache[n]},applyTo2d:function(e){var t,n,i,r,o,a,s,l,c,u,h,d,f,p=e.imageData,g=p.data,v=this.matrix,m=Math.round(Math.sqrt(v.length)),b=Math.floor(m/2),y=p.width,_=p.height,x=e.ctx.createImageData(y,_),w=x.data,C=this.opaque?1:0;for(h=0;h<_;h++)for(u=0;u<y;u++){for(o=4*(h*y+u),t=0,n=0,i=0,r=0,f=0;f<m;f++)for(d=0;d<m;d++)a=u+d-b,(s=h+f-b)<0||s>_||a<0||a>y||(l=4*(s*y+a),c=v[f*m+d],t+=g[l]*c,n+=g[l+1]*c,i+=g[l+2]*c,C||(r+=g[l+3]*c));w[o]=t,w[o+1]=n,w[o+2]=i,w[o+3]=C?g[o+3]:r}e.imageData=x},getUniformLocations:function(e,t){return{uMatrix:e.getUniformLocation(t,"uMatrix"),uOpaque:e.getUniformLocation(t,"uOpaque"),uHalfSize:e.getUniformLocation(t,"uHalfSize"),uSize:e.getUniformLocation(t,"uSize")}},sendUniformData:function(e,t){e.uniform1fv(t.uMatrix,this.matrix)},toObject:function(){return n(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),t.Image.filters.Convolute.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Grayscale=i(n.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(e){var t,n,i=e.imageData.data,r=i.length,o=this.mode;for(t=0;t<r;t+=4)"average"===o?n=(i[t]+i[t+1]+i[t+2])/3:"lightness"===o?n=(Math.min(i[t],i[t+1],i[t+2])+Math.max(i[t],i[t+1],i[t+2]))/2:"luminosity"===o&&(n=.21*i[t]+.72*i[t+1]+.07*i[t+2]),i[t]=n,i[t+1]=n,i[t+2]=n},retrieveShader:function(e){var t=this.type+"_"+this.mode;if(!e.programCache.hasOwnProperty(t)){var n=this.fragmentSource[this.mode];e.programCache[t]=this.createProgram(e.context,n)}return e.programCache[t]},getUniformLocations:function(e,t){return{uMode:e.getUniformLocation(t,"uMode")}},sendUniformData:function(e,t){e.uniform1i(t.uMode,1)},isNeutralState:function(){return!1}}),t.Image.filters.Grayscale.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Invert=i(n.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(e){var t,n=e.imageData.data,i=n.length;for(t=0;t<i;t+=4)n[t]=255-n[t],n[t+1]=255-n[t+1],n[t+2]=255-n[t+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(e,t){return{uInvert:e.getUniformLocation(t,"uInvert")}},sendUniformData:function(e,t){e.uniform1i(t.uInvert,this.invert)}}),t.Image.filters.Invert.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.Image.filters,r=t.util.createClass;i.Noise=r(i.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(e){if(0!==this.noise){var t,n,i=e.imageData.data,r=i.length,o=this.noise;for(t=0,r=i.length;t<r;t+=4)n=(.5-Math.random())*o,i[t]+=n,i[t+1]+=n,i[t+2]+=n}},getUniformLocations:function(e,t){return{uNoise:e.getUniformLocation(t,"uNoise"),uSeed:e.getUniformLocation(t,"uSeed")}},sendUniformData:function(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())},toObject:function(){return n(this.callSuper("toObject"),{noise:this.noise})}}),t.Image.filters.Noise.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Pixelate=i(n.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(e){var t,n,i,r,o,a,s,l,c,u,h,d=e.imageData,f=d.data,p=d.height,g=d.width;for(n=0;n<p;n+=this.blocksize)for(i=0;i<g;i+=this.blocksize)for(r=f[t=4*n*g+4*i],o=f[t+1],a=f[t+2],s=f[t+3],u=Math.min(n+this.blocksize,p),h=Math.min(i+this.blocksize,g),l=n;l<u;l++)for(c=i;c<h;c++)f[t=4*l*g+4*c]=r,f[t+1]=o,f[t+2]=a,f[t+3]=s},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(e,t){return{uBlocksize:e.getUniformLocation(t,"uBlocksize"),uStepW:e.getUniformLocation(t,"uStepW"),uStepH:e.getUniformLocation(t,"uStepH")}},sendUniformData:function(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}),t.Image.filters.Pixelate.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.Image.filters,r=t.util.createClass;i.RemoveColor=r(i.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(e){var n,i,r,o,a=e.imageData.data,s=255*this.distance,l=new t.Color(this.color).getSource(),c=[l[0]-s,l[1]-s,l[2]-s],u=[l[0]+s,l[1]+s,l[2]+s];for(n=0;n<a.length;n+=4)i=a[n],r=a[n+1],o=a[n+2],i>c[0]&&r>c[1]&&o>c[2]&&i<u[0]&&r<u[1]&&o<u[2]&&(a[n+3]=0)},getUniformLocations:function(e,t){return{uLow:e.getUniformLocation(t,"uLow"),uHigh:e.getUniformLocation(t,"uHigh")}},sendUniformData:function(e,n){var i=new t.Color(this.color).getSource(),r=parseFloat(this.distance),o=[0+i[0]/255-r,0+i[1]/255-r,0+i[2]/255-r,1],a=[i[0]/255+r,i[1]/255+r,i[2]/255+r,1];e.uniform4fv(n.uLow,o),e.uniform4fv(n.uHigh,a)},toObject:function(){return n(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),t.Image.filters.RemoveColor.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass,r={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var o in r)n[o]=i(n.ColorMatrix,{type:o,matrix:r[o],mainParameter:!1,colorsOnly:!0}),t.Image.filters[o].fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric,n=t.Image.filters,i=t.util.createClass;n.BlendColor=i(n.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(e){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[e]+"}\n}"},retrieveShader:function(e){var t,n=this.type+"_"+this.mode;return e.programCache.hasOwnProperty(n)||(t=this.buildSource(this.mode),e.programCache[n]=this.createProgram(e.context,t)),e.programCache[n]},applyTo2d:function(e){var n,i,r,o,a,s,l,c=e.imageData.data,u=c.length,h=1-this.alpha;n=(l=new t.Color(this.color).getSource())[0]*this.alpha,i=l[1]*this.alpha,r=l[2]*this.alpha;for(var d=0;d<u;d+=4)switch(o=c[d],a=c[d+1],s=c[d+2],this.mode){case"multiply":c[d]=o*n/255,c[d+1]=a*i/255,c[d+2]=s*r/255;break;case"screen":c[d]=255-(255-o)*(255-n)/255,c[d+1]=255-(255-a)*(255-i)/255,c[d+2]=255-(255-s)*(255-r)/255;break;case"add":c[d]=o+n,c[d+1]=a+i,c[d+2]=s+r;break;case"diff":case"difference":c[d]=Math.abs(o-n),c[d+1]=Math.abs(a-i),c[d+2]=Math.abs(s-r);break;case"subtract":c[d]=o-n,c[d+1]=a-i,c[d+2]=s-r;break;case"darken":c[d]=Math.min(o,n),c[d+1]=Math.min(a,i),c[d+2]=Math.min(s,r);break;case"lighten":c[d]=Math.max(o,n),c[d+1]=Math.max(a,i),c[d+2]=Math.max(s,r);break;case"overlay":c[d]=n<128?2*o*n/255:255-2*(255-o)*(255-n)/255,c[d+1]=i<128?2*a*i/255:255-2*(255-a)*(255-i)/255,c[d+2]=r<128?2*s*r/255:255-2*(255-s)*(255-r)/255;break;case"exclusion":c[d]=n+o-2*n*o/255,c[d+1]=i+a-2*i*a/255,c[d+2]=r+s-2*r*s/255;break;case"tint":c[d]=n+o*h,c[d+1]=i+a*h,c[d+2]=r+s*h}},getUniformLocations:function(e,t){return{uColor:e.getUniformLocation(t,"uColor")}},sendUniformData:function(e,n){var i=new t.Color(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,e.uniform4fv(n.uColor,i)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendColor.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric,n=t.Image.filters,i=t.util.createClass;n.BlendImage=i(n.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(e){var t=this.type+"_"+this.mode,n=this.fragmentSource[this.mode];return e.programCache.hasOwnProperty(t)||(e.programCache[t]=this.createProgram(e.context,n)),e.programCache[t]},applyToWebGL:function(e){var t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),this.callSuper("applyToWebGL",e),this.unbindAdditionalTexture(t,t.TEXTURE1)},createTexture:function(e,t){return e.getCachedTexture(t.cacheKey,t._element)},calculateMatrix:function(){var e=this.image,t=e._element.width,n=e._element.height;return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]},applyTo2d:function(e){var n,i,r,o,a,s,l,c,u,h,d,f=e.imageData,p=e.filterBackend.resources,g=f.data,v=g.length,m=f.width,b=f.height,y=this.image;p.blendImage||(p.blendImage=t.util.createCanvasElement()),h=(u=p.blendImage).getContext("2d"),u.width!==m||u.height!==b?(u.width=m,u.height=b):h.clearRect(0,0,m,b),h.setTransform(y.scaleX,0,0,y.scaleY,y.left,y.top),h.drawImage(y._element,0,0,m,b),d=h.getImageData(0,0,m,b).data;for(var _=0;_<v;_+=4)switch(a=g[_],s=g[_+1],l=g[_+2],c=g[_+3],n=d[_],i=d[_+1],r=d[_+2],o=d[_+3],this.mode){case"multiply":g[_]=a*n/255,g[_+1]=s*i/255,g[_+2]=l*r/255,g[_+3]=c*o/255;break;case"mask":g[_+3]=o}},getUniformLocations:function(e,t){return{uTransformMatrix:e.getUniformLocation(t,"uTransformMatrix"),uImage:e.getUniformLocation(t,"uImage")}},sendUniformData:function(e,t){var n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendImage.fromObject=function(e,n){t.Image.fromObject(e.image,(function(i){var r=t.util.object.clone(e);r.image=i,n(new t.Image.filters.BlendImage(r))}))}}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=Math.pow,i=Math.floor,r=Math.sqrt,o=Math.abs,a=Math.round,s=Math.sin,l=Math.ceil,c=t.Image.filters,u=t.util.createClass;c.Resize=u(c.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(e,t){return{uDelta:e.getUniformLocation(t,"uDelta"),uTaps:e.getUniformLocation(t,"uTaps")}},sendUniformData:function(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)},retrieveShader:function(e){var t=this.getFilterWindow(),n=this.type+"_"+t;if(!e.programCache.hasOwnProperty(n)){var i=this.generateShader(t);e.programCache[n]=this.createProgram(e.context,i)}return e.programCache[n]},getFilterWindow:function(){var e=this.tempScale;return Math.ceil(this.lanczosLobes/e)},getTaps:function(){for(var e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),i=new Array(n),r=1;r<=n;r++)i[r-1]=e(r*t);return i},generateShader:function(e){for(var t=new Array(e),n=this.fragmentSourceTOP,i=1;i<=e;i++)t[i-1]=i+".0 * uDelta";return n+="uniform float uTaps["+e+"];\n",n+="void main() {\n",n+="  vec4 color = texture2D(uTexture, vTexCoord);\n",n+="  float sum = 1.0;\n",t.forEach((function(e,t){n+="  color += texture2D(uTexture, vTexCoord + "+e+") * uTaps["+t+"];\n",n+="  color += texture2D(uTexture, vTexCoord - "+e+") * uTaps["+t+"];\n",n+="  sum += 2.0 * uTaps["+t+"];\n"})),n+="  gl_FragColor = color / sum;\n",n+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(e){e.webgl?(e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e),e.sourceHeight=e.destinationHeight):this.applyTo2d(e)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(e){return function(t){if(t>=e||t<=-e)return 0;if(t<1.1920929e-7&&t>-1.1920929e-7)return 1;var n=(t*=Math.PI)/e;return s(t)/t*s(n)/n}},applyTo2d:function(e){var t=e.imageData,n=this.scaleX,i=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/i;var r,o=t.width,s=t.height,l=a(o*n),c=a(s*i);"sliceHack"===this.resizeType?r=this.sliceByTwo(e,o,s,l,c):"hermite"===this.resizeType?r=this.hermiteFastResize(e,o,s,l,c):"bilinear"===this.resizeType?r=this.bilinearFiltering(e,o,s,l,c):"lanczos"===this.resizeType&&(r=this.lanczosResize(e,o,s,l,c)),e.imageData=r},sliceByTwo:function(e,n,r,o,a){var s,l,c=e.imageData,u=!1,h=!1,d=.5*n,f=.5*r,p=t.filterBackend.resources,g=0,v=0,m=n,b=0;for(p.sliceByTwo||(p.sliceByTwo=document.createElement("canvas")),((s=p.sliceByTwo).width<1.5*n||s.height<r)&&(s.width=1.5*n,s.height=r),(l=s.getContext("2d")).clearRect(0,0,1.5*n,r),l.putImageData(c,0,0),o=i(o),a=i(a);!u||!h;)n=d,r=f,o<i(.5*d)?d=i(.5*d):(d=o,u=!0),a<i(.5*f)?f=i(.5*f):(f=a,h=!0),l.drawImage(s,g,v,n,r,m,b,d,f),g=m,v=b,b+=f;return l.getImageData(g,v,o,a)},lanczosResize:function(e,t,a,s,c){var u=e.imageData.data,h=e.ctx.createImageData(s,c),d=h.data,f=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,g=this.rcpScaleY,v=2/this.rcpScaleX,m=2/this.rcpScaleY,b=l(p*this.lanczosLobes/2),y=l(g*this.lanczosLobes/2),_={},x={},w={};return function e(l){var C,S,k,T,E,M,O,j,P,A,D;for(x.x=(l+.5)*p,w.x=i(x.x),C=0;C<c;C++){for(x.y=(C+.5)*g,w.y=i(x.y),E=0,M=0,O=0,j=0,P=0,S=w.x-b;S<=w.x+b;S++)if(!(S<0||S>=t)){A=i(1e3*o(S-x.x)),_[A]||(_[A]={});for(var L=w.y-y;L<=w.y+y;L++)L<0||L>=a||(D=i(1e3*o(L-x.y)),_[A][D]||(_[A][D]=f(r(n(A*v,2)+n(D*m,2))/1e3)),(k=_[A][D])>0&&(E+=k,M+=k*u[T=4*(L*t+S)],O+=k*u[T+1],j+=k*u[T+2],P+=k*u[T+3]))}d[T=4*(C*s+l)]=M/E,d[T+1]=O/E,d[T+2]=j/E,d[T+3]=P/E}return++l<s?e(l):h}(0)},bilinearFiltering:function(e,t,n,r,o){var a,s,l,c,u,h,d,f,p,g=0,v=this.rcpScaleX,m=this.rcpScaleY,b=4*(t-1),y=e.imageData.data,_=e.ctx.createImageData(r,o),x=_.data;for(l=0;l<o;l++)for(c=0;c<r;c++)for(u=v*c-(a=i(v*c)),h=m*l-(s=i(m*l)),p=4*(s*t+a),d=0;d<4;d++)f=y[p+d]*(1-u)*(1-h)+y[p+4+d]*u*(1-h)+y[p+b+d]*h*(1-u)+y[p+b+4+d]*u*h,x[g++]=f;return _},hermiteFastResize:function(e,t,n,a,s){for(var c=this.rcpScaleX,u=this.rcpScaleY,h=l(c/2),d=l(u/2),f=e.imageData.data,p=e.ctx.createImageData(a,s),g=p.data,v=0;v<s;v++)for(var m=0;m<a;m++){for(var b=4*(m+v*a),y=0,_=0,x=0,w=0,C=0,S=0,k=0,T=(v+.5)*u,E=i(v*u);E<(v+1)*u;E++)for(var M=o(T-(E+.5))/d,O=(m+.5)*c,j=M*M,P=i(m*c);P<(m+1)*c;P++){var A=o(O-(P+.5))/h,D=r(j+A*A);D>1&&D<-1||(y=2*D*D*D-3*D*D+1)>0&&(k+=y*f[(A=4*(P+E*t))+3],x+=y,f[A+3]<255&&(y=y*f[A+3]/250),w+=y*f[A],C+=y*f[A+1],S+=y*f[A+2],_+=y)}g[b]=w/_,g[b+1]=C/_,g[b+2]=S/_,g[b+3]=k/x}return p},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),t.Image.filters.Resize.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Contrast=i(n.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(e){if(0!==this.contrast){var t,n=e.imageData.data,i=n.length,r=Math.floor(255*this.contrast),o=259*(r+255)/(255*(259-r));for(t=0;t<i;t+=4)n[t]=o*(n[t]-128)+128,n[t+1]=o*(n[t+1]-128)+128,n[t+2]=o*(n[t+2]-128)+128}},getUniformLocations:function(e,t){return{uContrast:e.getUniformLocation(t,"uContrast")}},sendUniformData:function(e,t){e.uniform1f(t.uContrast,this.contrast)}}),t.Image.filters.Contrast.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Saturation=i(n.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(e){if(0!==this.saturation){var t,n,i=e.imageData.data,r=i.length,o=-this.saturation;for(t=0;t<r;t+=4)n=Math.max(i[t],i[t+1],i[t+2]),i[t]+=n!==i[t]?(n-i[t])*o:0,i[t+1]+=n!==i[t+1]?(n-i[t+1])*o:0,i[t+2]+=n!==i[t+2]?(n-i[t+2])*o:0}},getUniformLocations:function(e,t){return{uSaturation:e.getUniformLocation(t,"uSaturation")}},sendUniformData:function(e,t){e.uniform1f(t.uSaturation,-this.saturation)}}),t.Image.filters.Saturation.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Blur=i(n.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(e){e.webgl?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},applyTo2d:function(e){e.imageData=this.simpleBlur(e)},simpleBlur:function(e){var n,i,r=e.filterBackend.resources,o=e.imageData.width,a=e.imageData.height;r.blurLayer1||(r.blurLayer1=t.util.createCanvasElement(),r.blurLayer2=t.util.createCanvasElement()),n=r.blurLayer1,i=r.blurLayer2,n.width===o&&n.height===a||(i.width=n.width=o,i.height=n.height=a);var s,l,c,u,h=n.getContext("2d"),d=i.getContext("2d"),f=.06*this.blur*.5;for(h.putImageData(e.imageData,0,0),d.clearRect(0,0,o,a),u=-15;u<=15;u++)c=f*(l=u/15)*o+(s=(Math.random()-.5)/4),d.globalAlpha=1-Math.abs(l),d.drawImage(n,c,s),h.drawImage(i,0,0),d.globalAlpha=1,d.clearRect(0,0,i.width,i.height);for(u=-15;u<=15;u++)c=f*(l=u/15)*a+(s=(Math.random()-.5)/4),d.globalAlpha=1-Math.abs(l),d.drawImage(n,s,c),h.drawImage(i,0,0),d.globalAlpha=1,d.clearRect(0,0,i.width,i.height);e.ctx.drawImage(n,0,0);var p=e.ctx.getImageData(0,0,n.width,n.height);return h.globalAlpha=1,h.clearRect(0,0,n.width,n.height),p},getUniformLocations:function(e,t){return{delta:e.getUniformLocation(t,"uDelta")}},sendUniformData:function(e,t){var n=this.chooseRightDelta();e.uniform2fv(t.delta,n)},chooseRightDelta:function(){var e,t=1,n=[0,0];return this.horizontal?this.aspectRatio>1&&(t=1/this.aspectRatio):this.aspectRatio<1&&(t=this.aspectRatio),e=t*this.blur*.12,this.horizontal?n[0]=e:n[1]=e,n}}),n.Blur.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Gamma=i(n.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(e){this.gamma=[1,1,1],n.BaseFilter.prototype.initialize.call(this,e)},applyTo2d:function(e){var t,n=e.imageData.data,i=this.gamma,r=n.length,o=1/i[0],a=1/i[1],s=1/i[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),t=0,r=256;t<r;t++)this.rVals[t]=255*Math.pow(t/255,o),this.gVals[t]=255*Math.pow(t/255,a),this.bVals[t]=255*Math.pow(t/255,s);for(t=0,r=n.length;t<r;t+=4)n[t]=this.rVals[n[t]],n[t+1]=this.gVals[n[t+1]],n[t+2]=this.bVals[n[t+2]]},getUniformLocations:function(e,t){return{uGamma:e.getUniformLocation(t,"uGamma")}},sendUniformData:function(e,t){e.uniform3fv(t.uGamma,this.gamma)}}),t.Image.filters.Gamma.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Composed=i(n.BaseFilter,{type:"Composed",subFilters:[],initialize:function(e){this.callSuper("initialize",e),this.subFilters=this.subFilters.slice(0)},applyTo:function(e){e.passes+=this.subFilters.length-1,this.subFilters.forEach((function(t){t.applyTo(e)}))},toObject:function(){return t.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map((function(e){return e.toObject()}))})},isNeutralState:function(){return!this.subFilters.some((function(e){return!e.isNeutralState()}))}}),t.Image.filters.Composed.fromObject=function(e,n){var i=(e.subFilters||[]).map((function(e){return new t.Image.filters[e.type](e)})),r=new t.Image.filters.Composed({subFilters:i});return n&&n(r),r}}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.HueRotation=i(n.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var e=this.rotation*Math.PI,n=t.util.cos(e),i=t.util.sin(e),r=Math.sqrt(1/3)*i,o=1-n;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=n+o/3,this.matrix[1]=1/3*o-r,this.matrix[2]=1/3*o+r,this.matrix[5]=1/3*o+r,this.matrix[6]=n+1/3*o,this.matrix[7]=1/3*o-r,this.matrix[10]=1/3*o-r,this.matrix[11]=1/3*o+r,this.matrix[12]=n+1/3*o},isNeutralState:function(e){return this.calculateMatrix(),n.BaseFilter.prototype.isNeutralState.call(this,e)},applyTo:function(e){this.calculateMatrix(),n.BaseFilter.prototype.applyTo.call(this,e)}}),t.Image.filters.HueRotation.fromObject=t.Image.filters.BaseFilter.fromObject}(t),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.clone;t.Text?t.warn("fabric.Text is already defined"):(t.Text=t.util.createClass(t.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:t.Object.prototype.stateProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),cacheProperties:t.Object.prototype.cacheProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),stroke:null,shadow:null,_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(e,t){this.styles=t&&t.styles||{},this.text=e,this.__skipDimension=!0,this.callSuper("initialize",t),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},getMeasuringContext:function(){return t._measuringContext||(t._measuringContext=this.canvas&&this.canvas.contextCache||t.util.createCanvasElement().getContext("2d")),t._measuringContext},_splitText:function(){var e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var e,t,n,i,r,o,a,s=0,l=this._textLines.length;s<l;s++)if(("justify"===this.textAlign||s!==l-1&&!this.isEndOfWrapping(s))&&(i=0,r=this._textLines[s],(t=this.getLineWidth(s))<this.width&&(a=this.textLines[s].match(this._reSpacesAndTabs)))){n=a.length,e=(this.width-t)/n;for(var c=0,u=r.length;c<=u;c++)o=this.__charBounds[s][c],this._reSpaceAndTab.test(r[c])?(o.width+=e,o.kernedWidth+=e,o.left+=i,i+=e):o.left+=i}},isEndOfWrapping:function(e){return e===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var e=this.callSuper("_getCacheCanvasDimensions"),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e},_render:function(e){this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")},_renderText:function(e){"stroke"===this.paintFirst?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))},_setTextStyles:function(e,t,n){e.textBaseline="alphabetic",e.font=this._getFontDeclaration(t,n)},calcTextWidth:function(){for(var e=this.getLineWidth(0),t=1,n=this._textLines.length;t<n;t++){var i=this.getLineWidth(t);i>e&&(e=i)}return e},_renderTextLine:function(e,t,n,i,r,o){this._renderChars(e,t,n,i,r,o)},_renderTextLinesBackground:function(e){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var t,n,i,r,o,a,s=0,l=e.fillStyle,c=this._getLeftOffset(),u=this._getTopOffset(),h=0,d=0,f=0,p=this._textLines.length;f<p;f++)if(t=this.getHeightOfLine(f),this.textBackgroundColor||this.styleHas("textBackgroundColor",f)){i=this._textLines[f],n=this._getLineLeftOffset(f),d=0,h=0,r=this.getValueOfPropertyAt(f,0,"textBackgroundColor");for(var g=0,v=i.length;g<v;g++)o=this.__charBounds[f][g],(a=this.getValueOfPropertyAt(f,g,"textBackgroundColor"))!==r?(e.fillStyle=r,r&&e.fillRect(c+n+h,u+s,d,t/this.lineHeight),h=o.left,d=o.width,r=a):d+=o.kernedWidth;a&&(e.fillStyle=a,e.fillRect(c+n+h,u+s,d,t/this.lineHeight)),s+=t}else s+=t;e.fillStyle=l,this._removeShadow(e)}},getFontCache:function(e){var n=e.fontFamily.toLowerCase();t.charWidthsCache[n]||(t.charWidthsCache[n]={});var i=t.charWidthsCache[n],r=e.fontStyle.toLowerCase()+"_"+(e.fontWeight+"").toLowerCase();return i[r]||(i[r]={}),i[r]},_applyCharStyles:function(e,t,n,i,r){this._setFillStyles(t,r),this._setStrokeStyles(t,r),t.font=this._getFontDeclaration(r)},_measureChar:function(e,t,n,i){var r,o,a,s,l=this.getFontCache(t),c=n+e,u=this._getFontDeclaration(t)===this._getFontDeclaration(i),h=t.fontSize/this.CACHE_FONT_SIZE;if(n&&void 0!==l[n]&&(a=l[n]),void 0!==l[e]&&(s=r=l[e]),u&&void 0!==l[c]&&(s=(o=l[c])-a),void 0===r||void 0===a||void 0===o){var d=this.getMeasuringContext();this._setTextStyles(d,t,!0)}return void 0===r&&(s=r=d.measureText(e).width,l[e]=r),void 0===a&&u&&n&&(a=d.measureText(n).width,l[n]=a),u&&void 0===o&&(o=d.measureText(c).width,l[c]=o,s=o-a),{width:r*h,kernedWidth:s*h}},getHeightOfChar:function(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")},measureLine:function(e){var t=this._measureLine(e);return 0!==this.charSpacing&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t},_measureLine:function(e){var t,n,i,r,o=0,a=this._textLines[e],s=new Array(a.length);for(this.__charBounds[e]=s,t=0;t<a.length;t++)n=a[t],r=this._getGraphemeBox(n,e,t,i),s[t]=r,o+=r.kernedWidth,i=n;return s[t]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize},{width:o,numOfSpaces:0}},_getGraphemeBox:function(e,t,n,i,r){var o,a=this.getCompleteStyleDeclaration(t,n),s=i?this.getCompleteStyleDeclaration(t,n-1):{},l=this._measureChar(e,a,i,s),c=l.kernedWidth,u=l.width;0!==this.charSpacing&&(u+=o=this._getWidthOfCharSpacing(),c+=o);var h={width:u,left:0,height:a.fontSize,kernedWidth:c,deltaY:a.deltaY};if(n>0&&!r){var d=this.__charBounds[t][n-1];h.left=d.left+d.width+l.kernedWidth-l.width}return h},getHeightOfLine:function(e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var t=this._textLines[e],n=this.getHeightOfChar(e,0),i=1,r=t.length;i<r;i++)n=Math.max(this.getHeightOfChar(e,i),n);return this.__lineHeights[e]=n*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var e,t=0,n=0,i=this._textLines.length;n<i;n++)e=this.getHeightOfLine(n),t+=n===i-1?e/this.lineHeight:e;return t},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(e,t){e.save();for(var n=0,i=this._getLeftOffset(),r=this._getTopOffset(),o=this._applyPatternGradientTransform(e,"fillText"===t?this.fill:this.stroke),a=0,s=this._textLines.length;a<s;a++){var l=this.getHeightOfLine(a),c=l/this.lineHeight,u=this._getLineLeftOffset(a);this._renderTextLine(t,e,this._textLines[a],i+u-o.offsetX,r+n+c-o.offsetY,a),n+=l}e.restore()},_renderTextFill:function(e){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(e,"fillText")},_renderTextStroke:function(e){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())},_renderChars:function(e,t,n,i,r,o){var a,s,l,c,u=this.getHeightOfLine(o),h=-1!==this.textAlign.indexOf("justify"),d="",f=0,p=!h&&0===this.charSpacing&&this.isEmptyStyles(o);if(t.save(),r-=u*this._fontSizeFraction/this.lineHeight,p)return this._renderChar(e,t,o,0,this.textLines[o],i,r,u),void t.restore();for(var g=0,v=n.length-1;g<=v;g++)c=g===v||this.charSpacing,d+=n[g],l=this.__charBounds[o][g],0===f?(i+=l.kernedWidth-l.width,f+=l.width):f+=l.kernedWidth,h&&!c&&this._reSpaceAndTab.test(n[g])&&(c=!0),c||(a=a||this.getCompleteStyleDeclaration(o,g),s=this.getCompleteStyleDeclaration(o,g+1),c=this._hasStyleChanged(a,s)),c&&(this._renderChar(e,t,o,g,d,i,r,u),d="",a=s,i+=f,f=0);t.restore()},_renderChar:function(e,t,n,i,r,o,a){var s=this._getStyleDeclaration(n,i),l=this.getCompleteStyleDeclaration(n,i),c="fillText"===e&&l.fill,u="strokeText"===e&&l.stroke&&l.strokeWidth;(u||c)&&(s&&t.save(),this._applyCharStyles(e,t,n,i,l),s&&s.textBackgroundColor&&this._removeShadow(t),s&&s.deltaY&&(a+=s.deltaY),c&&t.fillText(r,o,a),u&&t.strokeText(r,o,a),s&&t.restore())},setSuperscript:function(e,t){return this._setScript(e,t,this.superscript)},setSubscript:function(e,t){return this._setScript(e,t,this.subscript)},_setScript:function(e,t,n){var i=this.get2DCursorLocation(e,!0),r=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),o=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),a={fontSize:r*n.size,deltaY:o+r*n.baseline};return this.setSelectionStyles(a,e,t),this},_hasStyleChanged:function(e,t){return e.fill!==t.fill||e.stroke!==t.stroke||e.strokeWidth!==t.strokeWidth||e.fontSize!==t.fontSize||e.fontFamily!==t.fontFamily||e.fontWeight!==t.fontWeight||e.fontStyle!==t.fontStyle||e.deltaY!==t.deltaY},_hasStyleChangedForSvg:function(e,t){return this._hasStyleChanged(e,t)||e.overline!==t.overline||e.underline!==t.underline||e.linethrough!==t.linethrough},_getLineLeftOffset:function(e){var t=this.getLineWidth(e);return"center"===this.textAlign?(this.width-t)/2:"right"===this.textAlign?this.width-t:"justify-center"===this.textAlign&&this.isEndOfWrapping(e)?(this.width-t)/2:"justify-right"===this.textAlign&&this.isEndOfWrapping(e)?this.width-t:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var e=this._forceClearCache;return e||(e=this.hasStateChanged("_dimensionAffectingProps")),e&&(this.dirty=!0,this._forceClearCache=!1),e},getLineWidth:function(e){return this.__lineWidths[e]?this.__lineWidths[e]:(t=""===this._textLines[e]?0:this.measureLine(e).width,this.__lineWidths[e]=t,t);var t},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(e,t,n){var i=this._getStyleDeclaration(e,t);return i&&void 0!==i[n]?i[n]:this[n]},_renderTextDecoration:function(e,t){if(this[t]||this.styleHas(t)){for(var n,i,r,o,a,s,l,c,u,h,d,f,p,g,v,m,b=this._getLeftOffset(),y=this._getTopOffset(),_=this._getWidthOfCharSpacing(),x=0,w=this._textLines.length;x<w;x++)if(n=this.getHeightOfLine(x),this[t]||this.styleHas(t,x)){l=this._textLines[x],g=n/this.lineHeight,o=this._getLineLeftOffset(x),h=0,d=0,c=this.getValueOfPropertyAt(x,0,t),m=this.getValueOfPropertyAt(x,0,"fill"),u=y+g*(1-this._fontSizeFraction),i=this.getHeightOfChar(x,0),a=this.getValueOfPropertyAt(x,0,"deltaY");for(var C=0,S=l.length;C<S;C++)f=this.__charBounds[x][C],p=this.getValueOfPropertyAt(x,C,t),v=this.getValueOfPropertyAt(x,C,"fill"),r=this.getHeightOfChar(x,C),s=this.getValueOfPropertyAt(x,C,"deltaY"),(p!==c||v!==m||r!==i||s!==a)&&d>0?(e.fillStyle=m,c&&m&&e.fillRect(b+o+h,u+this.offsets[t]*i+a,d,this.fontSize/15),h=f.left,d=f.width,c=p,m=v,i=r,a=s):d+=f.kernedWidth;e.fillStyle=v,p&&v&&e.fillRect(b+o+h,u+this.offsets[t]*i+a,d-_,this.fontSize/15),y+=n}else y+=n;this._removeShadow(e)}},_getFontDeclaration:function(e,n){var i=e||this,r=this.fontFamily,o=t.Text.genericFonts.indexOf(r.toLowerCase())>-1,a=void 0===r||r.indexOf("'")>-1||r.indexOf(",")>-1||r.indexOf('"')>-1||o?i.fontFamily:'"'+i.fontFamily+'"';return[t.isLikelyNode?i.fontWeight:i.fontStyle,t.isLikelyNode?i.fontStyle:i.fontWeight,n?this.CACHE_FONT_SIZE+"px":i.fontSize+"px",a].join(" ")},render:function(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",e)))},_splitTextIntoLines:function(e){for(var n=e.split(this._reNewline),i=new Array(n.length),r=["\n"],o=[],a=0;a<n.length;a++)i[a]=t.util.string.graphemeSplit(n[a]),o=o.concat(i[a],r);return o.pop(),{_unwrappedLines:i,lines:n,graphemeText:o,graphemeLines:i}},toObject:function(e){var t=["text","fontSize","fontWeight","fontFamily","fontStyle","lineHeight","underline","overline","linethrough","textAlign","textBackgroundColor","charSpacing"].concat(e),i=this.callSuper("toObject",t);return i.styles=n(this.styles,!0),i},set:function(e,t){this.callSuper("set",e,t);var n=!1;if("object"==typeof e)for(var i in e)n=n||-1!==this._dimensionAffectingProps.indexOf(i);else n=-1!==this._dimensionAffectingProps.indexOf(e);return n&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),t.Text.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),t.Text.DEFAULT_SVG_FONT_SIZE=16,t.Text.fromElement=function(e,i,r){if(!e)return i(null);var o=t.parseAttributes(e,t.Text.ATTRIBUTE_NAMES),a=o.textAnchor||"left";if((r=t.util.object.extend(r?n(r):{},o)).top=r.top||0,r.left=r.left||0,o.textDecoration){var s=o.textDecoration;-1!==s.indexOf("underline")&&(r.underline=!0),-1!==s.indexOf("overline")&&(r.overline=!0),-1!==s.indexOf("line-through")&&(r.linethrough=!0),delete r.textDecoration}"dx"in o&&(r.left+=o.dx),"dy"in o&&(r.top+=o.dy),"fontSize"in r||(r.fontSize=t.Text.DEFAULT_SVG_FONT_SIZE);var l="";"textContent"in e?l=e.textContent:"firstChild"in e&&null!==e.firstChild&&"data"in e.firstChild&&null!==e.firstChild.data&&(l=e.firstChild.data),l=l.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var c=r.strokeWidth;r.strokeWidth=0;var u=new t.Text(l,r),h=u.getScaledHeight()/u.height,d=((u.height+u.strokeWidth)*u.lineHeight-u.height)*h,f=u.getScaledHeight()+d,p=0;"center"===a&&(p=u.getScaledWidth()/2),"right"===a&&(p=u.getScaledWidth()),u.set({left:u.left-p,top:u.top-(f-u.fontSize*(.07+u._fontSizeFraction))/u.lineHeight,strokeWidth:void 0!==c?c:1}),i(u)},t.Text.fromObject=function(e,n){return t.Object._fromObject("Text",e,n,"text")},t.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],t.util.createAccessors&&t.util.createAccessors(t.Text))}(t),k.util.object.extend(k.Text.prototype,{isEmptyStyles:function(e){if(!this.styles)return!0;if(void 0!==e&&!this.styles[e])return!0;var t=void 0===e?this.styles:{line:this.styles[e]};for(var n in t)for(var i in t[n])for(var r in t[n][i])return!1;return!0},styleHas:function(e,t){if(!this.styles||!e||""===e)return!1;if(void 0!==t&&!this.styles[t])return!1;var n=void 0===t?this.styles:{0:this.styles[t]};for(var i in n)for(var r in n[i])if(void 0!==n[i][r][e])return!0;return!1},cleanStyle:function(e){if(!this.styles||!e||""===e)return!1;var t,n,i=this.styles,r=0,o=!0,a=0;for(var s in i){for(var l in t=0,i[s]){var c;r++,(c=i[s][l]).hasOwnProperty(e)?(n?c[e]!==n&&(o=!1):n=c[e],c[e]===this[e]&&delete c[e]):o=!1,0!==Object.keys(c).length?t++:delete i[s][l]}0===t&&delete i[s]}for(var u=0;u<this._textLines.length;u++)a+=this._textLines[u].length;o&&r===a&&(this[e]=n,this.removeStyle(e))},removeStyle:function(e){if(this.styles&&e&&""!==e){var t,n,i,r=this.styles;for(n in r){for(i in t=r[n])delete t[i][e],0===Object.keys(t[i]).length&&delete t[i];0===Object.keys(t).length&&delete r[n]}}},_extendStyles:function(e,t){var n=this.get2DCursorLocation(e);this._getLineStyle(n.lineIndex)||this._setLineStyle(n.lineIndex),this._getStyleDeclaration(n.lineIndex,n.charIndex)||this._setStyleDeclaration(n.lineIndex,n.charIndex,{}),k.util.object.extend(this._getStyleDeclaration(n.lineIndex,n.charIndex),t)},get2DCursorLocation:function(e,t){void 0===e&&(e=this.selectionStart);for(var n=t?this._unwrappedTextLines:this._textLines,i=n.length,r=0;r<i;r++){if(e<=n[r].length)return{lineIndex:r,charIndex:e};e-=n[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:n[r-1].length<e?n[r-1].length:e}},getSelectionStyles:function(e,t,n){void 0===e&&(e=this.selectionStart||0),void 0===t&&(t=this.selectionEnd||e);for(var i=[],r=e;r<t;r++)i.push(this.getStyleAtPosition(r,n));return i},getStyleAtPosition:function(e,t){var n=this.get2DCursorLocation(e);return(t?this.getCompleteStyleDeclaration(n.lineIndex,n.charIndex):this._getStyleDeclaration(n.lineIndex,n.charIndex))||{}},setSelectionStyles:function(e,t,n){void 0===t&&(t=this.selectionStart||0),void 0===n&&(n=this.selectionEnd||t);for(var i=t;i<n;i++)this._extendStyles(i,e);return this._forceClearCache=!0,this},_getStyleDeclaration:function(e,t){var n=this.styles&&this.styles[e];return n?n[t]:null},getCompleteStyleDeclaration:function(e,t){for(var n,i=this._getStyleDeclaration(e,t)||{},r={},o=0;o<this._styleProperties.length;o++)r[n=this._styleProperties[o]]=void 0===i[n]?this[n]:i[n];return r},_setStyleDeclaration:function(e,t,n){this.styles[e][t]=n},_deleteStyleDeclaration:function(e,t){delete this.styles[e][t]},_getLineStyle:function(e){return!!this.styles[e]},_setLineStyle:function(e){this.styles[e]={}},_deleteLineStyle:function(e){delete this.styles[e]}}),function(){function e(e){e.textDecoration&&(e.textDecoration.indexOf("underline")>-1&&(e.underline=!0),e.textDecoration.indexOf("line-through")>-1&&(e.linethrough=!0),e.textDecoration.indexOf("overline")>-1&&(e.overline=!0),delete e.textDecoration)}k.IText=k.util.createClass(k.Text,k.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,caching:!0,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(e,t){this.callSuper("initialize",e,t),this.initBehavior()},setSelectionStart:function(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)},setSelectionEnd:function(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)},_updateAndFire:function(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(e){this.clearContextTop(),this.callSuper("render",e),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(e){this.callSuper("_render",e)},clearContextTop:function(e){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this.canvas.contextTop,n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this._clearTextArea(t),e||t.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this._getCursorBoundaries(),t=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(e,t):this.renderSelection(e,t),t.restore()}},_clearTextArea:function(e){var t=this.width+4,n=this.height+4;e.clearRect(-t/2,-n/2,t,n)},_getCursorBoundaries:function(e){void 0===e&&(e=this.selectionStart);var t=this._getLeftOffset(),n=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e);return{left:t,top:n,leftOffset:i.left,topOffset:i.top}},_getCursorBoundariesOffsets:function(e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var t,n,i,r,o=0,a=0,s=this.get2DCursorLocation(e);i=s.charIndex,n=s.lineIndex;for(var l=0;l<n;l++)o+=this.getHeightOfLine(l);t=this._getLineLeftOffset(n);var c=this.__charBounds[n][i];return c&&(a=c.left),0!==this.charSpacing&&i===this._textLines[n].length&&(a-=this._getWidthOfCharSpacing()),r={top:o,left:t+(a>0?a:0)},this.cursorOffsetCache=r,this.cursorOffsetCache},renderCursor:function(e,t){var n=this.get2DCursorLocation(),i=n.lineIndex,r=n.charIndex>0?n.charIndex-1:0,o=this.getValueOfPropertyAt(i,r,"fontSize"),a=this.scaleX*this.canvas.getZoom(),s=this.cursorWidth/a,l=e.topOffset,c=this.getValueOfPropertyAt(i,r,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-o*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(e,t),t.fillStyle=this.getValueOfPropertyAt(i,r,"fill"),t.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,t.fillRect(e.left+e.leftOffset-s/2,l+e.top+c,s,o)},renderSelection:function(e,t){for(var n=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,i=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,r=-1!==this.textAlign.indexOf("justify"),o=this.get2DCursorLocation(n),a=this.get2DCursorLocation(i),s=o.lineIndex,l=a.lineIndex,c=o.charIndex<0?0:o.charIndex,u=a.charIndex<0?0:a.charIndex,h=s;h<=l;h++){var d,f=this._getLineLeftOffset(h)||0,p=this.getHeightOfLine(h),g=0,v=0;if(h===s&&(g=this.__charBounds[s][c].left),h>=s&&h<l)v=r&&!this.isEndOfWrapping(h)?this.width:this.getLineWidth(h)||5;else if(h===l)if(0===u)v=this.__charBounds[l][u].left;else{var m=this._getWidthOfCharSpacing();v=this.__charBounds[l][u-1].left+this.__charBounds[l][u-1].width-m}d=p,(this.lineHeight<1||h===l&&this.lineHeight>1)&&(p/=this.lineHeight),this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",t.fillRect(e.left+f+g,e.top+e.topOffset+p,v-g,1)):(t.fillStyle=this.selectionColor,t.fillRect(e.left+f+g,e.top+e.topOffset,v-g,p)),e.topOffset+=d}},getCurrentCharFontSize:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")},getCurrentCharColor:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")},_getCurrentCharIndex:function(){var e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}}),k.IText.fromObject=function(t,n){if(e(t),t.styles)for(var i in t.styles)for(var r in t.styles[i])e(t.styles[i][r]);k.Object._fromObject("IText",t,n,"text")}}(),w=k.util.object.clone,k.util.object.extend(k.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",(function(){var t=e.canvas;t&&(t._hasITextHandlers||(t._hasITextHandlers=!0,e._initCanvasHandlers(t)),t._iTextInstances=t._iTextInstances||[],t._iTextInstances.push(e))}))},initRemovedHandler:function(){var e=this;this.on("removed",(function(){var t=e.canvas;t&&(t._iTextInstances=t._iTextInstances||[],k.util.removeFromArray(t._iTextInstances,e),0===t._iTextInstances.length&&(t._hasITextHandlers=!1,e._removeCanvasHandlers(t)))}))},_initCanvasHandlers:function(e){e._mouseUpITextHandler=function(){e._iTextInstances&&e._iTextInstances.forEach((function(e){e.__isMousedown=!1}))},e.on("mouse:up",e._mouseUpITextHandler)},_removeCanvasHandlers:function(e){e.off("mouse:up",e._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(e,t,n,i){var r;return r={isAborted:!1,abort:function(){this.isAborted=!0}},e.animate("_currentCursorOpacity",t,{duration:n,onComplete:function(){r.isAborted||e[i]()},onChange:function(){e.canvas&&e.selectionStart===e.selectionEnd&&e.renderCursorOrSelection()},abort:function(){return r.isAborted}}),r},_onTickComplete:function(){var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout((function(){e._currentTickCompleteState=e._animateCursor(e,0,this.cursorDuration/2,"_tick")}),100)},initDelayedCursor:function(e){var t=this,n=e?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout((function(){t._tick()}),n)},abortCursorAnimation:function(){var e=this._currentTickState||this._currentTickCompleteState,t=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,e&&t&&t.clearContext(t.contextTop||t.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(e){var t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t},findWordBoundaryRight:function(e){var t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t},findLineBoundaryLeft:function(e){for(var t=0,n=e-1;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t},findLineBoundaryRight:function(e){for(var t=0,n=e;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t},searchWordBoundary:function(e,t){for(var n=this._reSpace.test(this._text[e])?e-1:e,i=this._text[n],r=/[ \n\.,;!\?\-]/;!r.test(i)&&n>0&&n<this._text.length;)n+=t,i=this._text[n];return r.test(i)&&"\n"!==i&&(n+=1===t?0:1),n},selectWord:function(e){e=e||this.selectionStart;var t=this.searchWordBoundary(e,-1),n=this.searchWordBoundary(e,1);this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(e){e=e||this.selectionStart;var t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(e){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(e),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(e){e._iTextInstances&&e._iTextInstances.forEach((function(e){e.selected=!1,e.isEditing&&e.exitEditing()}))},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(e){if(this.__isMousedown&&this.isEditing){var t=this.getSelectionStartFromPointer(e.e),n=this.selectionStart,i=this.selectionEnd;(t===this.__selectionStartOnMouseDown&&n!==i||n!==t&&i!==t)&&(t>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=t):(this.selectionStart=t,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===n&&this.selectionEnd===i||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(e,t,n){var i=n.slice(0,e),r=k.util.string.graphemeSplit(i).length;if(e===t)return{selectionStart:r,selectionEnd:r};var o=n.slice(e,t);return{selectionStart:r,selectionEnd:r+k.util.string.graphemeSplit(o).length}},fromGraphemeToStringSelection:function(e,t,n){var i=n.slice(0,e).join("").length;return e===t?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+n.slice(e,t).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var e=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),i=n.lineIndex,r=n.charIndex,o=this.getValueOfPropertyAt(i,r,"fontSize")*this.lineHeight,a=t.leftOffset,s=this.calcTransformMatrix(),l={x:t.left+a,y:t.top+t.topOffset+o},c=this.canvas.upperCanvasEl,u=c.width,h=c.height,d=u-o,f=h-o,p=c.clientWidth/u,g=c.clientHeight/h;return l=k.util.transformPoint(l,s),(l=k.util.transformPoint(l,this.canvas.viewportTransform)).x*=p,l.y*=g,l.x<0&&(l.x=0),l.x>d&&(l.x=d),l.y<0&&(l.y=0),l.y>f&&(l.y=f),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:o+"px",charHeight:o}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var e=this._textBeforeEdit!==this.text;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&(this.hiddenTextarea.blur&&this.hiddenTextarea.blur(),this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null),this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var e in this.styles)this._textLines[e]||delete this.styles[e]},removeStyleFromTo:function(e,t){var n,i,r=this.get2DCursorLocation(e,!0),o=this.get2DCursorLocation(t,!0),a=r.lineIndex,s=r.charIndex,l=o.lineIndex,c=o.charIndex;if(a!==l){if(this.styles[a])for(n=s;n<this._unwrappedTextLines[a].length;n++)delete this.styles[a][n];if(this.styles[l])for(n=c;n<this._unwrappedTextLines[l].length;n++)(i=this.styles[l][n])&&(this.styles[a]||(this.styles[a]={}),this.styles[a][s+n-c]=i);for(n=a+1;n<=l;n++)delete this.styles[n];this.shiftLineStyles(l,a-l)}else if(this.styles[a]){i=this.styles[a];var u,h,d=c-s;for(n=s;n<c;n++)delete i[n];for(h in this.styles[a])(u=parseInt(h,10))>=c&&(i[u-d]=i[h],delete i[h])}},shiftLineStyles:function(e,t){var n=w(this.styles);for(var i in this.styles){var r=parseInt(i,10);r>e&&(this.styles[r+t]=n[r],n[r-t]||delete this.styles[r])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(e,t,n,i){var r,o={},a=!1;for(var s in n||(n=1),this.shiftLineStyles(e,n),this.styles[e]&&(r=this.styles[e][0===t?t:t-1]),this.styles[e]){var l=parseInt(s,10);l>=t&&(a=!0,o[l-t]=this.styles[e][s],delete this.styles[e][s])}for(a?this.styles[e+n]=o:delete this.styles[e+n];n>1;)n--,i&&i[n]?this.styles[e+n]={0:w(i[n])}:r?this.styles[e+n]={0:w(r)}:delete this.styles[e+n];this._forceClearCache=!0},insertCharStyleObject:function(e,t,n,i){this.styles||(this.styles={});var r=this.styles[e],o=r?w(r):{};for(var a in n||(n=1),o){var s=parseInt(a,10);s>=t&&(r[s+n]=o[s],o[s-n]||delete r[s])}if(this._forceClearCache=!0,i)for(;n--;)Object.keys(i[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=w(i[n]));else if(r)for(var l=r[t?t-1:1];l&&n--;)this.styles[e][t+n]=w(l)},insertNewStyleBlock:function(e,t,n){for(var i=this.get2DCursorLocation(t,!0),r=[0],o=0,a=0;a<e.length;a++)"\n"===e[a]?r[++o]=0:r[o]++;for(r[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,r[0],n),n=n&&n.slice(r[0]+1)),o&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+r[0],o),a=1;a<o;a++)r[a]>0?this.insertCharStyleObject(i.lineIndex+a,0,r[a],n):n&&(this.styles[i.lineIndex+a][0]=n[0]),n=n&&n.slice(r[a]+1);r[a]>0&&this.insertCharStyleObject(i.lineIndex+a,0,r[a],n)},setSelectionStartEndWithShift:function(e,t,n){n<=e?(t===e?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?"right"===this._selectionDirection?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=t),this.selectionEnd=n)},setSelectionInBoundaries:function(){var e=this.text.length;this.selectionStart>e?this.selectionStart=e:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>e?this.selectionEnd=e:this.selectionEnd<0&&(this.selectionEnd=0)}}),k.util.object.extend(k.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(e){if(this.canvas){this.__newClickTime=+new Date;var t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),this._stopEvent(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("mousedblclick",(function(e){this.selectWord(this.getSelectionStartFromPointer(e.e))})),this.on("tripleclick",(function(e){this.selectLine(this.getSelectionStartFromPointer(e.e))}))},_mouseDownHandler:function(e){!this.canvas||!this.editable||e.e.button&&1!==e.e.button||(this.__isMousedown=!0,this.selected&&this.setCursorByClick(e.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(e){!this.canvas||!this.editable||e.e.button&&1!==e.e.button||this===this.canvas._activeObject&&(this.selected=!0)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(e){if(this.__isMousedown=!1,!(!this.editable||this.group||e.transform&&e.transform.actionPerformed||e.e.button&&1!==e.e.button)){if(this.canvas){var t=this.canvas._activeObject;if(t&&t!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(e.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(e){var t=this.getSelectionStartFromPointer(e),n=this.selectionStart,i=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,i,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(e){for(var t=this.getLocalPointer(e),n=0,i=0,r=0,o=0,a=0,s=0,l=this._textLines.length;s<l&&r<=t.y;s++)r+=this.getHeightOfLine(s)*this.scaleY,a=s,s>0&&(o+=this._textLines[s-1].length+this.missingNewlineOffset(s-1));i=this._getLineLeftOffset(a)*this.scaleX;for(var c=0,u=this._textLines[a].length;c<u&&(n=i,(i+=this.__charBounds[a][c].kernedWidth*this.scaleX)<=t.x);c++)o++;return this._getNewSelectionStartFromOffset(t,n,i,o,u)},_getNewSelectionStartFromOffset:function(e,t,n,i,r){var o=e.x-t,a=n-e.x,s=i+(a>o||a<0?0:1);return this.flipX&&(s=r-s),s>this._text.length&&(s=this._text.length),s}}),k.util.object.extend(k.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=k.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var e=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+e.top+"; left: "+e.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; paddingｰtop: "+e.fontSize+";",k.document.body.appendChild(this.hiddenTextarea),k.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),k.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),k.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),k.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),k.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),k.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),k.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),k.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),k.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(k.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(this.isEditing&&!this.inCompositionMode){if(e.keyCode in this.keysMap)this[this.keysMap[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown&&(e.ctrlKey||e.metaKey)))return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(e){var t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),this.isEditing){var n,i,r=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,a=r.length,s=a-o;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var l=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),c=this.selectionStart>l.selectionStart;this.selectionStart!==this.selectionEnd?(n=this._text.slice(this.selectionStart,this.selectionEnd),s+=this.selectionEnd-this.selectionStart):a<o&&(n=c?this._text.slice(this.selectionEnd+s,this.selectionEnd):this._text.slice(this.selectionStart,this.selectionStart-s)),i=r.slice(l.selectionEnd-s,l.selectionEnd),n&&n.length&&(this.selectionStart!==this.selectionEnd?this.removeStyleFromTo(this.selectionStart,this.selectionEnd):c?this.removeStyleFromTo(this.selectionEnd-n.length,this.selectionEnd):this.removeStyleFromTo(this.selectionEnd,this.selectionEnd+n.length)),i.length&&(t&&i.join("")===k.copiedText&&!k.disableStyleCopyPaste?this.insertNewStyleBlock(i,this.selectionStart,k.copiedTextStyle):this.insertNewStyleBlock(i,this.selectionStart)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(e){this.compositionStart=e.target.selectionStart,this.compositionEnd=e.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(k.copiedText=this.getSelectedText(),k.disableStyleCopyPaste?k.copiedTextStyle=null:k.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(e){return e&&e.clipboardData||k.window.clipboardData},_getWidthBeforeCursor:function(e,t){var n,i=this._getLineLeftOffset(e);return t>0&&(i+=(n=this.__charBounds[e][t-1]).left+n.width),i},getDownCursorOffset:function(e,t){var n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),r=i.lineIndex;if(r===this._textLines.length-1||e.metaKey||34===e.keyCode)return this._text.length-n;var o=i.charIndex,a=this._getWidthBeforeCursor(r,o),s=this._getIndexOnLine(r+1,a);return this._textLines[r].slice(o).length+s+1+this.missingNewlineOffset(r)},_getSelectionForOffset:function(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(e,t){var n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),r=i.lineIndex;if(0===r||e.metaKey||33===e.keyCode)return-n;var o=i.charIndex,a=this._getWidthBeforeCursor(r,o),s=this._getIndexOnLine(r-1,a),l=this._textLines[r].slice(0,o),c=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+s-l.length+(1-c)},_getIndexOnLine:function(e,t){for(var n,i,r=this._textLines[e],o=this._getLineLeftOffset(e),a=0,s=0,l=r.length;s<l;s++)if((o+=n=this.__charBounds[e][s].width)>t){i=!0;var c=o-n,u=o,h=Math.abs(c-t);a=Math.abs(u-t)<h?s:s-1;break}return i||(a=r.length-1),a},moveCursorDown:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)},moveCursorUp:function(e){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",e)},_moveCursorUpOrDown:function(e,t){var n=this["get"+e+"CursorOffset"](t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),0!==n&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(e){var t="left"===this._selectionDirection?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),0!==e},moveCursorWithoutShift:function(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),0!==e},moveCursorLeft:function(e){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",e)},_move:function(e,t,n){var i;if(e.altKey)i=this["findWordBoundary"+n](this[t]);else{if(!e.metaKey&&35!==e.keyCode&&36!==e.keyCode)return this[t]+="Left"===n?-1:1,!0;i=this["findLineBoundary"+n](this[t])}if(void 0!==typeof i&&this[t]!==i)return this[t]=i,!0},_moveLeft:function(e,t){return this._move(e,t,"Left")},_moveRight:function(e,t){return this._move(e,t,"Right")},moveCursorLeftWithoutShift:function(e){var t=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t},moveCursorLeftWithShift:function(e){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(e,"selectionStart")):void 0},moveCursorRight:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)},_moveCursorLeftOrRight:function(e,t){var n="moveCursor"+e+"With";this._currentCursorOpacity=1,t.shiftKey?n+="Shift":n+="outShift",this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(e){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(e,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(e){var t=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t},removeChars:function(e,t){void 0===t&&(t=e+1),this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(e,t,n,i){void 0===i&&(i=n),i>n&&this.removeStyleFromTo(n,i);var r=k.util.string.graphemeSplit(e);this.insertNewStyleBlock(r,n,t),this._text=[].concat(this._text.slice(0,n),r,this._text.slice(i)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),C=k.util.toFixed,S=/  +/g,k.util.object.extend(k.Text.prototype,{_toSVG:function(){var e=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(e.textTop,e.textLeft);return this._wrapSVGTextAndBg(t)},toSVG:function(e){return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(e){var t=this.getSvgTextDecoration(this);return[e.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",t?'text-decoration="'+t+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(e,t){var n,i=[],r=[],o=e;this._setSVGBg(r);for(var a=0,s=this._textLines.length;a<s;a++)n=this._getLineLeftOffset(a),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(r,a,t+n,o),this._setSVGTextLineText(i,a,t+n,o),o+=this.getHeightOfLine(a);return{textSpans:i,textBgRects:r}},_createTextCharSpan:function(e,t,n,i){var r=e!==e.trim()||e.match(S),o=this.getSvgSpanStyles(t,r),a=o?'style="'+o+'"':"",s=t.deltaY,l="",c=k.Object.NUM_FRACTION_DIGITS;return s&&(l=' dy="'+C(s,c)+'" '),['<tspan x="',C(n,c),'" y="',C(i,c),'" ',l,a,">",k.util.string.escapeXml(e),"</tspan>"].join("")},_setSVGTextLineText:function(e,t,n,i){var r,o,a,s,l,c=this.getHeightOfLine(t),u=-1!==this.textAlign.indexOf("justify"),h="",d=0,f=this._textLines[t];i+=c*(1-this._fontSizeFraction)/this.lineHeight;for(var p=0,g=f.length-1;p<=g;p++)l=p===g||this.charSpacing,h+=f[p],a=this.__charBounds[t][p],0===d?(n+=a.kernedWidth-a.width,d+=a.width):d+=a.kernedWidth,u&&!l&&this._reSpaceAndTab.test(f[p])&&(l=!0),l||(r=r||this.getCompleteStyleDeclaration(t,p),o=this.getCompleteStyleDeclaration(t,p+1),l=this._hasStyleChangedForSvg(r,o)),l&&(s=this._getStyleDeclaration(t,p)||{},e.push(this._createTextCharSpan(h,s,n,i)),h="",r=o,n+=d,d=0)},_pushTextBgRect:function(e,t,n,i,r,o){var a=k.Object.NUM_FRACTION_DIGITS;e.push("\t\t<rect ",this._getFillAttributes(t),' x="',C(n,a),'" y="',C(i,a),'" width="',C(r,a),'" height="',C(o,a),'"></rect>\n')},_setSVGTextLineBg:function(e,t,n,i){for(var r,o,a=this._textLines[t],s=this.getHeightOfLine(t)/this.lineHeight,l=0,c=0,u=this.getValueOfPropertyAt(t,0,"textBackgroundColor"),h=0,d=a.length;h<d;h++)r=this.__charBounds[t][h],(o=this.getValueOfPropertyAt(t,h,"textBackgroundColor"))!==u?(u&&this._pushTextBgRect(e,u,n+c,i,l,s),c=r.left,l=r.width,u=o):l+=r.kernedWidth;o&&this._pushTextBgRect(e,o,n+c,i,l,s)},_getFillAttributes:function(e){var t=e&&"string"==typeof e?new k.Color(e):"";return t&&t.getSource()&&1!==t.getAlpha()?'opacity="'+t.getAlpha()+'" fill="'+t.setAlpha(1).toRgb()+'"':'fill="'+e+'"'},_getSVGLineTopOffset:function(e){for(var t,n=0,i=0;i<e;i++)n+=this.getHeightOfLine(i);return t=this.getHeightOfLine(i),{lineTop:n,offset:(this._fontSizeMult-this._fontSizeFraction)*t/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(e){return k.Object.prototype.getSvgStyles.call(this,e)+" white-space: pre;"}}),function(e){"use strict";var t=e.fabric||(e.fabric={});t.Textbox=t.util.createClass(t.IText,t.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:t.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(e){for(var t=0,n=0,i=0,r={},o=0;o<e.graphemeLines.length;o++)"\n"===e.graphemeText[i]&&o>0?(n=0,i++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[i])&&o>0&&(n++,i++),r[o]={line:t,offset:n},i+=e.graphemeLines[o].length,n+=e.graphemeLines[o].length;return r},styleHas:function(e,n){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[n];i&&(n=i.line)}return t.Text.prototype.styleHas.call(this,e,n)},isEmptyStyles:function(e){var t,n,i=0,r=!1,o=this._styleMap[e],a=this._styleMap[e+1];for(var s in o&&(e=o.line,i=o.offset),a&&(r=a.line===e,t=a.offset),n=void 0===e?this.styles:{line:this.styles[e]})for(var l in n[s])if(l>=i&&(!r||l<t))for(var c in n[s][l])return!1;return!0},_getStyleDeclaration:function(e,t){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[e];if(!n)return null;e=n.line,t=n.offset+t}return this.callSuper("_getStyleDeclaration",e,t)},_setStyleDeclaration:function(e,t,n){var i=this._styleMap[e];e=i.line,t=i.offset+t,this.styles[e][t]=n},_deleteStyleDeclaration:function(e,t){var n=this._styleMap[e];e=n.line,t=n.offset+t,delete this.styles[e][t]},_getLineStyle:function(e){var t=this._styleMap[e];return!!this.styles[t.line]},_setLineStyle:function(e){var t=this._styleMap[e];this.styles[t.line]={}},_wrapText:function(e,t){var n,i=[];for(this.isWrapping=!0,n=0;n<e.length;n++)i=i.concat(this._wrapLine(e[n],n,t));return this.isWrapping=!1,i},_measureWord:function(e,t,n){var i,r=0;n=n||0;for(var o=0,a=e.length;o<a;o++){r+=this._getGraphemeBox(e[o],t,o+n,i,!0).kernedWidth,i=e[o]}return r},_wrapLine:function(e,n,i,r){var o=0,a=this.splitByGrapheme,s=[],l=[],c=a?t.util.string.graphemeSplit(e):e.split(this._wordJoiners),u="",h=0,d=a?"":" ",f=0,p=0,g=0,v=!0,m=a?0:this._getWidthOfCharSpacing();r=r||0;0===c.length&&c.push([]),i-=r;for(var b=0;b<c.length;b++)u=a?c[b]:t.util.string.graphemeSplit(c[b]),f=this._measureWord(u,n,h),h+=u.length,(o+=p+f-m)>=i&&!v?(s.push(l),l=[],o=f,v=!0):o+=m,v||a||l.push(d),l=l.concat(u),p=this._measureWord([d],n,h),h++,v=!1,f>g&&(g=f);return b&&s.push(l),g+r>this.dynamicMinWidth&&(this.dynamicMinWidth=g-m+r),s},isEndOfWrapping:function(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line},missingNewlineOffset:function(e){return this.splitByGrapheme?this.isEndOfWrapping(e)?1:0:1},_splitTextIntoLines:function(e){for(var n=t.Text.prototype._splitTextIntoLines.call(this,e),i=this._wrapText(n.lines,this.width),r=new Array(i.length),o=0;o<i.length;o++)r[o]=i[o].join("");return n.lines=r,n.graphemeLines=i,n},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var e={};for(var t in this._styleMap)this._textLines[t]&&(e[this._styleMap[t].line]=1);for(var t in this.styles)e[t]||delete this.styles[t]},toObject:function(e){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(e))}}),t.Textbox.fromObject=function(e,n){return t.Object._fromObject("Textbox",e,n,"text")}}(t)}).call(this,n(1145).Buffer)},1145:function(e,t,n){"use strict";(function(e){var i=n(1146),r=n(1147),o=n(1148);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=d(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,n),r=(e=s(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=s(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?s(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=s(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|f(t.length);e=s(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function f(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(e).length;default:if(i)return V(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return j(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return M(this,t,n);case"latin1":case"binary":return O(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function v(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function m(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:b(e,t,n,i,r);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,i,r){var o,a=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){var u=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var h=!0,d=0;d<l;d++)if(c(e,o+d)!==c(t,d)){h=!1;break}if(h)return o}return-1}function y(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function _(e,t,n,i){return U(V(t,e.length-n),e,n,i)}function x(e,t,n,i){return U(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function w(e,t,n,i){return x(e,t,n,i)}function C(e,t,n,i){return U(N(t),e,n,i)}function S(e,t,n,i){return U(function(e,t){for(var n,i,r,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(t,e.length-n),e,n,i)}function k(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var o,a,s,l,c=e[r],u=null,h=c>239?4:c>223?3:c>191?2:1;if(r+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[r+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[r+1],a=e[r+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[r+1],a=e[r+2],s=e[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),r+=h}return function(e){var t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=E));return n}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return u(t),t<=0?s(e,t):void 0!==n?"string"==typeof i?s(e,t).fill(n,i):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,r),r+=a.length}return i},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):g.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,r){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(r>>>=0)-(i>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),c=this.slice(i,r),u=e.slice(t,n),h=0;h<s;++h)if(c[h]!==u[h]){o=c[h],a=u[h];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return x(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return C(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function M(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function O(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function j(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=t;o<n;++o)r+=H(e[o]);return r}function P(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function A(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,i,r,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function L(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function I(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function z(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,i,o){return o||z(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function R(e,t,n,i,o){return o||z(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var r=t-e;n=new l(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=t,r=1,o=this[e+--i];i>0&&(r*=256);)o+=this[e+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);D(this,e,t,n,r-1,-r)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);D(this,e,t,n,r-1,-r)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return R(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return R(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,o=i-n;if(this===e&&n<t&&t<i)for(r=o-1;r>=0;--r)e[r+t]=this[r+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=l.isBuffer(e)?e:V(new l(e,i).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function V(e,t){var n;t=t||1/0;for(var i=e.length,r=null,o=[],a=0;a<i;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function N(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,n(50))},1146:function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=c(e),a=i[0],s=i[1],l=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),u=0,h=s>0?a-4:a;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===s&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===s&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o=[],a=0,s=n-r;a<s;a+=16383)o.push(u(e,a,a+16383>s?s:a+16383));1===r?(t=e[n-1],o.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return o.join("")};for(var i=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)i[s]=a[s],r[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var r,o,a=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(i[(o=r)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},1147:function(e,t){t.read=function(e,t,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?r-1:0,d=n?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=s;u>0;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,i),o-=c}return(f?-1:1)*a*Math.pow(2,o-i)},t.write=function(e,t,n,i,r,o){var a,s,l,c=8*o-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,p=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*l-1)*Math.pow(2,r),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;e[n+f]=255&s,f+=p,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;e[n+f]=255&a,f+=p,a/=256,c-=8);e[n+f-p]|=128*g}},1148:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},1149:function(e,t){},1150:function(e,t){},1151:function(e,t){},1152:function(e,t,n){"use strict";t.__esModule=!0,t.default={TUI_LOGO_BASE64_STRING:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbsAAAAlCAYAAADbckeZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkM2NzE2RkE1QzJBMTFFOTlDRTNENEUzMDQxRTAyQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkM2NzE2RkI1QzJBMTFFOTlDRTNENEUzMDQxRTAyQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2QzY3MTZGODVDMkExMUU5OUNFM0Q0RTMwNDFFMDJBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2QzY3MTZGOTVDMkExMUU5OUNFM0Q0RTMwNDFFMDJBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgkK6b0AABLHSURBVHja7F0LuFVTHv+fysWtq5BEyaMGKeUTEzOIzDUo5DmMQQ81X5gipkkeRSNGSfLMs1FKJqY8wr1JhUEzDMpEil70mG7vkp6zfrP/+7vrrNY+e61z9j5n39v6fd//q33u2o/12Ov//u9UWVkZCdQUlKJ4sV3QzizOO0rQBYLaCWok6GBBRYJ+ELRU0CeCJgn6UNCOGJ+/vqCVMY9RDUENBO2T5flbBC0I+NsRgmrF+OyY2295nh0cHAqDSwVdIR1PFfSIpt0Zgn4j6CdBIwX9pyp2trS01LgtNr+xyuDEhWWCDuUN2QTnCxokqFXA3+sKai6ovaA/8vX/Iugxi3uY4hVBFwr6s6A7YmCiPQR1EnQ8Cx65YAIveBnv8DjFjXmCWvILZMIcZdgKW6bn53qfTFD7ebagd91+u9tgoqBzcrzGTEGnRvhMR/Ne5WOtps1lgsZLx9157/lK0/YCZT95U9ALVXGyajB3zwcaCjrAoF0zQTNYW2tlef0HBX0t6NcRPvdF0uLpJ+iYiK6LTbcva0P3CDoxAkYHtNEw0/Z5muNmmvtXZxQplCKH3Qm1NGvAlvYowHP3Uo73FtQ1oO2xgq6U6PiqOlk1mPKFsM3gzAgkncMETRZ0cwTPu6egIcriHh7BdbG4XmZNtCTiMX5AM8f5XlMODg7JZtIqalb3TidpY4L29JagfSPq11CmXNCHPF+XDBiJz8+R4Y9STA1RYbagJ9y77ODgkAGjlGP42cftjhy+EGgtaHQMzwPtbo6gZ7I49yBB/TNoT2DM2fgGryPPZh4HbiIXIOLgUCggXuA2y3O2FeA5IRD/SF6sBvzODwn6l2N28aOYPP9c7RgXICI2P7M87z5BdQL+Bt9Ub0o3cZoAUZYDY+onxnCK228cHAoGMI41VeRZ/8q02yAJZkxoI4fGeP2iLJgSgkWuCmlzu6ADLa+LYKD6MfRxC0Xjo3QoHCDs1ctCWEVg1l4RP0sqD4Iw9p64/US1qHoGDVWXfu1B2adZhaK8vDwlqE5SNDts/H3zcJ9fkedrKzd80UcYLCZM0mBB3Syeo1NM/UMU6nzHLxKL+xSGhKjezeSFiSMy7mLy8iuB1bxOHyUvKllFW0GdBXUgL+/UF1gXC3qDPBP7PMvnQ8AUIu06Cvo5eVHTYEQrBH1KXpj6OBaqalJ6ENR6MkvHASO/WtC5go7jdx/v2H8FfSToJb4PzPCIeO4hnQsT2xiDeyDt5XLyorGbkuf/x/UquB9vk+evWlPF1s9BPHbn8ZrZT9BWnnO4U57l/tlc70/S8TpBd0rHQyXe0FY5F/l5QUF6SMWYluG++7ISgbV7Ah+neF2hL7BMvWy4TyPfuq9gZv7xnNLS0pHiGO9ZT0FdyMvRLhK/rcL6TZWVle3M46QdImiJdHyDoIfzdG9d/pkOvyPPf2iCHawFmi40TGjjGPrWmxm0DthEl+dxjhFJ+75Bu+qQZ6deG9HEUzXt1ioSLDb+S8hL9s2klWFTQQ4p/Dp1eY6vDnmmrbyRPWjYhyvY8tEopB1839cK+iel+6qXs3aZSXhEoNdtFB589hlvUgcz4/YxJsTScgD39woKt1aB0d1F0URVv84btyx09olY++3PwlHtkHUIP9wtbOG5W/rbKB5TVSiYJR0vYwboA4LYnlk8L+49LGAN3Mx9MQlAfI95wxcZ2hyr/B35f0ifmMQCm4rRhTZjdsrjvc42mMDaLIXbLMaHLNo2jKlveAYUB6jjlKgqAWhyT1O4+fFGQffyvM4wYHS+aWiYIrkHMaH7eN00Mrhuc2bkNknUxSxkDjXc5I7jfp5mcQ9ogR+zZmqyn9VjpjSWkhOgF6RtY+wGUXg8Q4q1mckUTexDlAoQnucVFqhMI+0hMP+D7KLeMfcvBDC6/zP0Qk42XuB2BbhfWYY2/QxffBmnsOnkRQMtcBPFZ6OGVFvCC2QnOSQZsjVjO2tN0P5aawSWPvzyqwUW1rNkW8KMSE1OHsyM48OAZ7g1gCFinX5JXjk+PEsLqvQl7skbsOnmMy5gw0KfUa1jAZuamkoad4kBo/YBn3k5a4IyYLb8iPtRwlrAyZTuI8T7soIFimwRp9/sedKnJ23keV/LVptWEtPG/vaLCO69UlIMarPQ4gNRnBsCztukWQMTWNFQAdPpbL5WIxZaUhomeQ6ZmTVP1ygzP7Imf1ChmV2TAkhWTTP87VA2A2SD+1l9/jGkHXwpcVYg6MgmmjsdP0k0ilkgGcZztUnaHGCKGcGSvf9bW2Ujgj9roiTU1GHtvquy0dwZoImdwhqDyoCGswQum71rMcPC70eQecWP/hpGh37CLAsf02bp9xKqNHXaVBQZqzC67SxIDODNVAYEiceZ6fmA+f9V0pues8FJZFdOEMx2pOb3P5Bn5k7TTFgYh1D9k6KpXs9jtzdFU5HlEEVoulU6xhiaBsMN1DA6CFGI0/gbpZvDm/B6lWMgIJyMZ41/UYigITO6Mfzcc0tLS7eXl5djjGpgIX8j6Gd5esnXS/8/uACbTKZ7DqXso9oOYWl0YEi7ORR/uR0szKfI8w8SSzbYIOvnYXyx2XzneJkRemo2OmhVT/MmOClAqodjf6Hy+wbeJLA5XCP9jkANBDOsUtrfQ+kmP8zbRbzxq9jGEvY08oIhTjToWwONdjafGe83AfvCXdzncsO1ioCz9hrLTFAhic/J86l+zJqejwE5MDvVgnKywkzDMEuzBko0+wjG7gzpnZaxhudzKo9d1Clc2VqJGrNgI+NLnrelmvZgZvAJz1TGBKZP1CS+2vC5egkGlxYHIo7X+FIbtIHLNCognL6/z6KTM2jXKLIdkurto34BNpige7bTSFK2gLTyTMCC9PEceb6FOFGLJb1+fAzpCdGonTSa9GHkBeTYAr6BTzWMDhvJ946PhQJBHk9m+DuYzgeCfqlhUgsznAetAua5Ikn6hVnrdakNzF6qT+yxAEYnYxWvlS8o3Pd9LaWbY7ExdQ5gdDIQoNKLNbYw9FaO36DwikmwvCD9R67wfxqb0ZKybruygCKjW8i+AnzIjHtoQvrRR1EetvH6WRpy3pNseZADkq5krW+BwXv1SKaNcS5zThUtsmR2qLB/t0G7lQWYgArNbzUounqX91PmL0hgbGCnbhlzP7tIzM6Xaj/XtDsjS2b3aoD5xcEMzxtIzG9omF1YtfnF/D7L60v1QZ+lHMM8drvhc89l89BdIe3OVY4hBL5veI9xvLmfmaENmPnpGoZtgjn8LrSWfoOGODoha6ODZq1MNzx3OGv2xyagH6oJ+wEyL+xxI1slGkh7dMdMjIwxWGhxOzMxu0JhaQHu+UOAFHpcRNe/nCfkgwxtEFI7Jeaxb8Dq/2rHVxKJOQZt1Fy5jQbSPTBfYXZqorr6VQqsxXUWzz7BgNmp9yi3HJ93Qpgdghlkc91WXu+mX3BRU3GaRTSvqNQ0Lcc9UA0w+bvF9bazIFpoZoeAEDU+YqzF+bAiTGZrgI9TDZhdplSFgjK7haza5vMZ1MTrugFabS5AoADCX4M+JDudVfwRMfe1Gav1DsnDwiw2wiVk5j9ZrrFcqIKQjC8tnx3a3RaqNJWqgM9J9X3PtrxHWHv1U2EIyhiTw3xE5VKB++aWHM6vQ7v63KIeu3wxO1KEkTmW1/g85JqkuUfG96qQeXYbSF8hIi5s1JgDBpDZN/Zs0EaRSHR4mFX1LTH2tzY5JBU7sjgnqnSSYuV4keX5EFCXZfi7zp9na2EIax/1Z7GS8vUXXVrSEstrLElAP+pqBLetltdYFHJNFSsReZnkSZ6Ux3uhVJAc7oz8nhtiutdgCs+ngwaIyK31MT3DUko2NmikWhsJONO1qgPiypVU/dZNLc+H1pYpF3WVhpnbfvA4rP3qgPHKllYmZM5XaX6zNbE2S0A/1DXWOAvh+6iQa1q/L4Vmdi/mcaN6SjkeRvF9JRjJriZO/3oxSKn+5p/0FADVf9rC4twWIdeqDogrYVmV/G2DpZDAXjNEa1XNSa0s79HaUuqHtnkAVX6M2pbuSMicb9YwvBaW12iZgH58r+EzLXNcAzlrrIVmdsgnykeo7Lvk5Qj5QL7PuTHfs3eIlIUNY3hM90aduC2UbKjfz7IpqN0t5FpOswuGaspH1JtNGbseBm2maN4FU8kexR2uCWkzX7FcwO9/aTWZ92nKcReLc4tjGAe1UIZJzUxoYarP7XqLex5OXvSljJwT/5Ngq0ZI6uIYrw+pT05u9GsHxo0iSq8Or9s04oqaerQKvNQTlWNExbY3OK89t810LafZBaOc0s35dUPWqQxECpqkI72oYWD3GPZ5pCFjVF0geMf3qwbz/ppGGDHNAUYuWpOIn0fV0k0L2atRpFdxX0zwlLIGUDFmcnVgdjC5XUjhpbayBUrvfKJIGEfnqW/INSnV/I4w6UExvizTq8BLPZHSo2Ox0Y0JYXjtuU1KkfKrI7OLC/BPPaP89lsK918fSV6enwkThhT+nka7wyYW5MuGH/Btiw1xuKL9opTZS7RrAE6QINqXkllWb6yGwUB4DUuPQnHxPjE8j+oOaUdm9X0Rbb5W+Q0fi20Two8wr2raCUqUrci1I0mp+g1m1JknOsoPOiLq8QnpGCHGA/LcN0xea9YwfQwUtH9MC7NrFdl0t7I0/or0G8KLYQJ7mjdkPywefoturNGlNBL9VnKw0QiRbgNzVwPlXcEmA7cCqnH4QSYohYdSTSj/ZeNf7k5e6ad9FO0dSe2oi4gE4wUseGIjR5UMm4/Xfs3P3Ev6Dc8/j99xrKsKhcGh1NoF5JlJD2SNAcLTtxGN/dlkn8YAq9Zt0jHcD7fwGPnAPCF3Fxap56TnTfHY9eI5ikN5mUvpKWKYo9E8l/gWISxlSLXCR7gnSFo9goj6U7qV6UDuB/LlUB/Vr2SzNysFiHNQy9EtoojSw5L0iQtIZet4sOrmeK2dPHCDNS95vTz3C5FlPamy0j0c/NfFcB+85B0oOZFlpqaOIZRuZk7xRtnd4PwhZJd0uzvAxNe3jLW5txXhshPTZpakEfWqmgbXGUr2X/M9sAHKeXcws4UVEjat1wsGfBKlf9YFAtOTTKtZS8J+grq4qr8Jx6h6dElEY9+cyQazFGZHPGYjFEZezHsaaA3PAwRm1eS7msw/pWOCFcxguysWqxW8jvanykC/wyjdhP0YCxhdlDG/mQnrbANfQyekbeL1WBFFRzJJAjtifNmC8BYv3pk5XGMJS28qo6tHu/p68gV5M78pYiED440SS21ZCsvHXEUZPNGPmZYthlB6STQHO7zDm9ZGzd/2YqakMroK0pvlg4CSZyhJZxotiz3nDto1aG1bQPvNrM0FfbZrX9Z8Did9YAUEw9cTOj/YJ4I+wFuP56e2ZrzvjuFZBlH6lxZ8NKT0iHaYKE/VaPhB3/zciyq/WK8TyE4X9O+oOlEjRDKzra4Av9ubOT7TV7xxX8r/N0UFb36QCF/T/B0vdaHC8WcF/D8XILz3cZacIEGvyuIaM8k+pBcS5ZQIxwYbHPwnqLo/36D9fG7bNweBzMHDZH7XygzavslrzXbzwXfljmQmFpTAvo0F3RPY+lKiYUpBgGaA6OrOFmsZz3ErP9eohM4N1nYf3gfDzKwwfcJ0eyHFE4W9mBWItSHtptGuecNI9EYBjYuZp5j0exQzzkgrQKXKyjKu8xTZ2YF3UPQh0614oOEYbcTmCEgTS1liRPV9RGbNyCAByip0M4r3o4u6F3musjE3oexNtZu571HlJ2Isj7IYk+8ovtzIPajSlHYCVX6SCfOM9IKJTEnx0amRia8FaDEw48jltcZSeDGBhrzufcB0Nd7gmVDFv7ki0JgwKN+fdRLfu0h6v+Bi+FgSkLsrAu7zFmN2DK+3BjyPS5khyoniiMjsoVhGTFKUYJJFxGgHZmTwEe3DzHI592Uq/xuFoHQO5R79CCE97IO4mAsE7nTkufX9jUtYQx8vMXr4t09RlJZpyvX2o/QUBZgLTQph789zD226Mc8fhM95rCFPN5ifs3jc2vAaKOb5WcxzM8lQ6FX7sLG0tHRMLszOwcHBIZ9AsMI3lF6l5WRmiA4OaRAMzrhtDTdcDg4OMSGbyOp7FUYHzccVNHfIGY7ZOTg4xAVE5iEq0jTZG+beXspvCLff7obSwTE7BweHJAK+Q4T0w8eDgBCEocOXpH4aCL5i5FahpN+zlO47XkDxfwrLYTdBLTcEDg4OESNF6SX5ECLfkwkBLch9g3kS/jmUEtMVWEAAz3lUPb9o4eCYnYODQzUBquCghJea4AwGF1auD8wQoeqz3TA6RAVnxnRwcIgaSD9CmT6kGCBvbpnheQiBRyL18ZRez9bBwWl2Dg4OiQVqJyKZHFU9kCcLnx3y+ZBfhaAVJEAjxwqpBvDZIXG9wg2bQxz4nwADAGYU1d6UWuZCAAAAAElFTkSuQmCC"}},1153:function(e,t,n){},1154:function(e,t,n){},1204:function(e,t,n){e.exports=n(1140)},486:function(e,t,n){"use strict";t.__esModule=!0,t.getMessage=function(e,t){return(i[e]||{})[t]||""};var i={ko:{tuiImageEditor:"이미지 에디터",done:"완료",cancel:"취소",noImage:"선택된 이미지가 없거나 편집할 수 없는 이미지입니다.",imageLoadFailed:"URL 이미지는 편집할 수 없습니다."},en:{tuiImageEditor:"Image Editor",done:"Done",cancel:"Cancel",noImage:"The selected image is missing or can not be edited.",imageLoadFailed:"URL images can not be edited."}}},487:function(e,t,n){var i;i=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.c=t,n.p="dist",n(0)}([function(e,t,n){"use strict";var i={},r=n(1),o=r.extend;o(i,r),o(i,n(3)),o(i,n(2)),o(i,n(4)),o(i,n(5)),o(i,n(6)),o(i,n(7)),o(i,n(8)),o(i,n(9)),i.browser=n(10),i.popup=n(11),i.formatDate=n(12),i.defineClass=n(13),i.defineModule=n(14),i.defineNamespace=n(15),i.CustomEvents=n(16),i.Enum=n(17),i.ExMap=n(18),i.HashMap=n(20),i.Map=n(19),e.exports=i},function(e,t,n){"use strict";var i=n(2),r=n(3),o=0;function a(e,t){var n,o=[],s=[];if(isNaN(e)&&isNaN(t)&&i.isNumber(e)&&i.isNumber(t))return!0;if(e===t)return!0;if(i.isFunction(e)&&i.isFunction(t)||e instanceof Date&&t instanceof Date||e instanceof RegExp&&t instanceof RegExp||e instanceof String&&t instanceof String||e instanceof Number&&t instanceof Number)return e.toString()===t.toString();if(!(e instanceof Object&&t instanceof Object))return!1;if(e.isPrototypeOf(t)||t.isPrototypeOf(e)||e.constructor!==t.constructor||e.prototype!==t.prototype)return!1;if(r.inArray(e,o)>-1||r.inArray(t,s)>-1)return!1;for(n in t){if(t.hasOwnProperty(n)!==e.hasOwnProperty(n))return!1;if(typeof t[n]!=typeof e[n])return!1}for(n in e){if(t.hasOwnProperty(n)!==e.hasOwnProperty(n))return!1;if(typeof t[n]!=typeof e[n])return!1;if("object"==typeof e[n]||"function"==typeof e[n]){if(o.push(e),s.push(t),!a(e[n],t[n]))return!1;o.pop(),s.pop()}else if(e[n]!==t[n])return!1}return!0}function s(e,t){for(var n=arguments,r=n[0],o=1,a=n.length;o<a;o+=1){if(i.isUndefined(r)||i.isNull(r))return;r=r[n[o]]}return r}e.exports={extend:function(e,t){var n,i,r,o,a=Object.prototype.hasOwnProperty;for(r=1,o=arguments.length;r<o;r+=1)for(i in n=arguments[r])a.call(n,i)&&(e[i]=n[i]);return e},stamp:function(e){return e.__fe_id||(o+=1,e.__fe_id=o),e.__fe_id},hasStamp:function(e){return i.isExisty(s(e,"__fe_id"))},resetLastId:function(){o=0},keys:Object.prototype.keys||function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n},compareJSON:function(e){var t=arguments.length,n=1;if(t<1)return!0;for(;n<t;n+=1)if(!a(e,arguments[n]))return!1;return!0},pick:s}},function(e,t){"use strict";var n=Object.prototype.toString;function i(e){return!r(e)&&!o(e)}function r(e){return void 0===e}function o(e){return null===e}function a(e){return i(e)&&!1!==e}function s(e){return i(e)&&("[object Arguments]"===n.call(e)||!!e.callee)}function l(e){return e instanceof Array}function c(e){return e===Object(e)}function u(e){return e instanceof Function}function h(e){return"string"==typeof e||e instanceof String}function d(e){return!(i(e)&&!function(e){return h(e)&&""===e}(e)&&(l(e)||s(e)?0!==e.length:c(e)&&!u(e)&&function(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}(e)))}e.exports={isExisty:i,isUndefined:r,isNull:o,isTruthy:a,isFalsy:function(e){return!a(e)},isArguments:s,isArray:l,isArraySafe:function(e){return"[object Array]"===n.call(e)},isObject:c,isFunction:u,isFunctionSafe:function(e){return"[object Function]"===n.call(e)},isNumber:function(e){return"number"==typeof e||e instanceof Number},isNumberSafe:function(e){return"[object Number]"===n.call(e)},isDate:function(e){return e instanceof Date},isDateSafe:function(e){return"[object Date]"===n.call(e)},isString:h,isStringSafe:function(e){return"[object String]"===n.call(e)},isBoolean:function(e){return"boolean"==typeof e||e instanceof Boolean},isBooleanSafe:function(e){return"[object Boolean]"===n.call(e)},isHTMLNode:function(e){return"object"==typeof HTMLElement?e&&(e instanceof HTMLElement||!!e.nodeType):!(!e||!e.nodeType)},isHTMLTag:function(e){return"object"==typeof HTMLElement?e&&e instanceof HTMLElement:!(!e||!e.nodeType||1!==e.nodeType)},isEmpty:d,isNotEmpty:function(e){return!d(e)}}},function(e,t,n){"use strict";var i,r=n(4),o=n(2),a=Array.prototype.slice;i={inArray:function(e,t,n){var i,r;if(n=n||0,!o.isArray(t))return-1;if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e,n);for(r=t.length,i=n;n>=0&&i<r;i+=1)if(t[i]===e)return i;return-1},range:function(e,t,n){var i,r=[];for(o.isUndefined(t)&&(t=e||0,e=0),t*=i=(n=n||1)<0?-1:1;e*i<t;e+=n)r.push(e);return r},zip:function(){var e=a.call(arguments),t=[];return r.forEach(e,(function(e){r.forEach(e,(function(e,n){t[n]||(t[n]=[]),t[n].push(e)}))})),t}},e.exports=i},function(e,t,n){"use strict";var i=n(2),r=n(1);function o(e,t,n){var i=0,r=e.length;for(n=n||null;i<r&&!1!==t.call(n,e[i],i,e);i+=1);}function a(e,t,n){var i;for(i in n=n||null,e)if(e.hasOwnProperty(i)&&!1===t.call(n,e[i],i,e))break}function s(e,t,n){i.isArray(e)?o(e,t,n):a(e,t,n)}function l(e,t,n){var i=[];return n=n||null,s(e,(function(){i.push(t.apply(n,arguments))})),i}e.exports={forEachOwnProperties:a,forEachArray:o,forEach:s,toArray:function(e){var t;try{t=Array.prototype.slice.call(e)}catch(n){t=[],o(e,(function(e){t.push(e)}))}return t},map:l,reduce:function(e,t,n){var o,a,s,l=0;for(n=n||null,i.isArray(e)?(a=e.length,s=e[l]):(a=(o=r.keys(e)).length,s=e[o[l+=1]]),l+=1;l<a;l+=1)s=t.call(n,s,e[o?o[l]:l]);return s},filter:function(e,t,n){var r,o;if(n=n||null,!i.isObject(e)||!i.isFunction(t))throw new Error("wrong parameter");return i.isArray(e)?(r=[],o=function(e,t){e.push(t[0])}):(r={},o=function(e,t){e[t[1]]=t[0]}),s(e,(function(){t.apply(n,arguments)&&o(r,arguments)}),n),r},pluck:function(e,t){return l(e,(function(e){return e[t]}))}}},function(e,t){"use strict";e.exports={bind:function(e,t){var n,i=Array.prototype.slice;return e.bind?e.bind.apply(e,i.call(arguments,1)):(n=i.call(arguments,2),function(){return e.apply(t,n.length?n.concat(i.call(arguments)):arguments)})}}},function(e,t){"use strict";function n(e){function t(){}return t.prototype=e,new t}e.exports={createObject:n,inherit:function(e,t){var i=n(t.prototype);i.constructor=e,e.prototype=i}}},function(e,t,n){"use strict";var i=n(4),r=n(1);e.exports={decodeHTMLEntity:function(e){var t={"&quot;":'"',"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&nbsp;":" "};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&nbsp;/g,(function(e){return t[e]?t[e]:e}))},encodeHTMLEntity:function(e){var t={'"':"quot","&":"amp","<":"lt",">":"gt","'":"#39"};return e.replace(/[<>&"']/g,(function(e){return t[e]?"&"+t[e]+";":e}))},hasEncodableString:function(e){return/[<>&"']/.test(e)},getDuplicatedChar:function(e,t){for(var n,o=0,a=e.length,s={};o<a;o+=1)s[n=e.charAt(o)]=1;for(o=0,a=t.length;o<a;o+=1)s[n=t.charAt(o)]&&(s[n]+=1);return s=i.filter(s,(function(e){return e>1})),(s=r.keys(s).sort()).join("")}}},function(e,t){"use strict";var n={},i=Array.prototype.slice;n.timestamp=function(){return Number(new Date)},n.debounce=function(e,t){var n,r;return t=t||0,function(){r=i.call(arguments),window.clearTimeout(n),n=window.setTimeout((function(){e.apply(null,r)}),t)}},n.throttle=function(e,t){var r,o,a,s,l=!0,c=function(t){e.apply(null,t),r=null};function u(){if(s=i.call(arguments),l)return c(s),void(l=!1);a=n.timestamp(),r=r||a,o(s),a-r>=t&&c(s)}return t=t||0,o=n.debounce(c,t),u.reset=function(){l=!0,r=null},u},e.exports=n},function(e,t,n){"use strict";var i=n(1),r=n(4),o=n(2),a=6048e5;function s(e,t){var n=r.map(i.keys(t),(function(e,n){return(0===n?"":"&")+e+"="+t[e]})).join(""),o=document.createElement("img");return o.src=e+"?"+n,o.style.display="none",document.body.appendChild(o),document.body.removeChild(o),o}e.exports={imagePing:s,sendHostname:function(e,t){var n=location.hostname,i="TOAST UI "+e+" for "+n+": Statistics",r=window.localStorage.getItem(i);(o.isUndefined(window.tui)||!1!==window.tui.usageStatistics)&&(r&&!function(e){return(new Date).getTime()-e>a}(r)||(window.localStorage.setItem(i,(new Date).getTime()),setTimeout((function(){"interactive"!==document.readyState&&"complete"!==document.readyState||s("https://www.google-analytics.com/collect",{v:1,t:"event",tid:t,cid:n,dp:n,dh:e,el:e,ec:"use"})}),1e3)))}}},function(e,t){"use strict";var n,i,r,o,a,s,l,c,u,h,d={chrome:!1,firefox:!1,safari:!1,msie:!1,edge:!1,others:!1,version:0};window&&window.navigator&&(r=window.navigator,o=r.appName.replace(/\s/g,"_"),a=r.userAgent,s=/MSIE\s([0-9]+[.0-9]*)/,l=/Trident.*rv:11\./,c=/Edge\/(\d+)\./,u={firefox:/Firefox\/(\d+)\./,chrome:/Chrome\/(\d+)\./,safari:/Version\/([\d.]+).*Safari\/(\d+)/},(h={Microsoft_Internet_Explorer:function(){var e=a.match(s);e?(d.msie=!0,d.version=parseFloat(e[1])):d.others=!0},Netscape:function(){var e=!1;if(l.exec(a))d.msie=!0,d.version=11,e=!0;else if(c.exec(a))d.edge=!0,d.version=a.match(c)[1],e=!0;else for(n in u)if(u.hasOwnProperty(n)&&(i=a.match(u[n]))&&i.length>1){d[n]=e=!0,d.version=parseFloat(i[1]||0);break}e||(d.others=!0)}})[o]&&h[o]()),e.exports=d},function(e,t,n){"use strict";var i=n(4),r=n(2),o=n(5),a=n(10),s=n(1),l=0;function c(){this.openedPopup={},this.closeWithParentPopup={},this.postBridgeUrl=""}c.prototype.getPopupList=function(e){return r.isExisty(e)?this.openedPopup[e]:this.openedPopup},c.prototype.openPopup=function(e,t){var n,i,c;if((t=s.extend({popupName:"popup_"+l+"_"+Number(new Date),popupOptionStr:"",useReload:!0,closeWithParent:!0,method:"get",param:{}},t||{})).method=t.method.toUpperCase(),this.postBridgeUrl=t.postBridgeUrl||this.postBridgeUrl,c="POST"===t.method&&t.param&&a.msie&&11===a.version,!r.isExisty(e))throw new Error("Popup#open() need popup url.");l+=1,t.param&&("GET"===t.method?e=e+(/\?/.test(e)?"&":"?")+this._parameterize(t.param):"POST"===t.method&&(c||(i=this.createForm(e,t.param,t.method,t.popupName),e="about:blank"))),n=this.openedPopup[t.popupName],r.isExisty(n)?n.closed?this.openedPopup[t.popupName]=n=this._open(c,t.param,e,t.popupName,t.popupOptionStr):(t.useReload&&n.location.replace(e),n.focus()):this.openedPopup[t.popupName]=n=this._open(c,t.param,e,t.popupName,t.popupOptionStr),this.closeWithParentPopup[t.popupName]=t.closeWithParent,(!n||n.closed||r.isUndefined(n.closed))&&alert("please enable popup windows for this website"),t.param&&"POST"===t.method&&!c&&(n&&i.submit(),i.parentNode&&i.parentNode.removeChild(i)),window.onunload=o.bind(this.closeAllPopup,this)},c.prototype.close=function(e,t){var n=t||window;(e=!!r.isExisty(e)&&e)&&(window.onunload=null),n.closed||(n.opener=window.location.href,n.close())},c.prototype.closeAllPopup=function(e){var t=r.isExisty(e);i.forEachOwnProperties(this.openedPopup,(function(e,n){(t&&this.closeWithParentPopup[n]||!t)&&this.close(!1,e)}),this)},c.prototype.focus=function(e){this.getPopupList(e).focus()},c.prototype.parseQuery=function(){var e,t,n={};return e=window.location.search.substr(1),i.forEachArray(e.split("&"),(function(e){t=e.split("="),n[decodeURIComponent(t[0])]=decodeURIComponent(t[1])})),n},c.prototype.createForm=function(e,t,n,r,o){var a,s=document.createElement("form");return o=o||document.body,s.method=n||"POST",s.action=e||"",s.target=r||"",s.style.display="none",i.forEachOwnProperties(t,(function(e,t){(a=document.createElement("input")).name=t,a.type="hidden",a.value=e,s.appendChild(a)})),o.appendChild(s),s},c.prototype._parameterize=function(e){var t=[];return i.forEachOwnProperties(e,(function(e,n){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})),t.join("&")},c.prototype._open=function(e,t,n,i,r){var o;return e?(o=window.open(this.postBridgeUrl,i,r),setTimeout((function(){o.redirect(n,t)}),100)):o=window.open(n,i,r),o},e.exports=new c},function(e,t,n){"use strict";var i=n(2),r=n(1),o=/[\\]*YYYY|[\\]*YY|[\\]*MMMM|[\\]*MMM|[\\]*MM|[\\]*M|[\\]*DD|[\\]*D|[\\]*HH|[\\]*H|[\\]*A/gi,a=["Invalid month","January","February","March","April","May","June","July","August","September","October","November","December"],s=[0,31,28,31,30,31,30,31,31,30,31,30,31],l={M:function(e){return Number(e.month)},MM:function(e){var t=e.month;return Number(t)<10?"0"+t:t},MMM:function(e){return a[Number(e.month)].substr(0,3)},MMMM:function(e){return a[Number(e.month)]},D:function(e){return Number(e.date)},d:function(e){return l.D(e)},DD:function(e){var t=e.date;return Number(t)<10?"0"+t:t},dd:function(e){return l.DD(e)},YY:function(e){return Number(e.year)%100},yy:function(e){return l.YY(e)},YYYY:function(e){var t="20",n=e.year;return n>69&&n<100&&(t="19"),Number(n)<100?t+String(n):n},yyyy:function(e){return l.YYYY(e)},A:function(e){return e.meridiem},a:function(e){return e.meridiem},hh:function(e){var t=e.hour;return Number(t)<10?"0"+t:t},HH:function(e){return l.hh(e)},h:function(e){return String(Number(e.hour))},H:function(e){return l.h(e)},m:function(e){return String(Number(e.minute))},mm:function(e){var t=e.minute;return Number(t)<10?"0"+t:t}};e.exports=function(e,t,n){var a,c,u=r.pick(n,"meridiemSet","AM")||"AM",h=r.pick(n,"meridiemSet","PM")||"PM";return!!function(e,t,n){var i;return e=Number(e),t=Number(t),n=Number(n),(e>-1&&e<100||e>1969&&e<2070)&&t>0&&t<13&&(i=s[t],2===t&&e%4==0&&(e%100==0&&e%400!=0||(i=29)),n>0&&n<=i)}((c=i.isDate(t)?{year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate(),hour:t.getHours(),minute:t.getMinutes()}:{year:t.year,month:t.month,date:t.date,hour:t.hour,minute:t.minute}).year,c.month,c.date)&&(c.meridiem="",/([^\\]|^)[aA]\b/.test(e)&&(a=c.hour>11?h:u,c.hour>12&&(c.hour%=12),0===c.hour&&(c.hour=12),c.meridiem=a),e.replace(o,(function(e){return e.indexOf("\\")>-1?e.replace(/\\/,""):l[e](c)||""})))}},function(e,t,n){"use strict";var i=n(6).inherit,r=n(1).extend;e.exports=function(e,t){var n;return t||(t=e,e=null),n=t.init||function(){},e&&i(n,e),t.hasOwnProperty("static")&&(r(n,t.static),delete t.static),r(n.prototype,t),n}},function(e,t,n){"use strict";var i=n(15),r=n(2),o="initialize";e.exports=function(e,t){var n=t||{};return r.isFunction(n[o])&&n[o](),i(e,n)}},function(e,t,n){"use strict";var i=n(4),r=n(1);e.exports=function(e,t,n){var o,a,s;return(o=e.split(".")).unshift(window),a=i.reduce(o,(function(e,t){return e[t]=e[t]||{},e[t]})),n?(s=o.pop(),a=r.pick.apply(null,o)[s]=t):r.extend(a,t),a}},function(e,t,n){"use strict";var i=n(4),r=n(2),o=n(1),a=/\s+/g;function s(){this.events=null,this.contexts=null}s.mixin=function(e){o.extend(e.prototype,s.prototype)},s.prototype._getHandlerItem=function(e,t){var n={handler:e};return t&&(n.context=t),n},s.prototype._safeEvent=function(e){var t,n=this.events;return n||(n=this.events={}),e&&((t=n[e])||(t=[],n[e]=t),n=t),n},s.prototype._safeContext=function(){var e=this.contexts;return e||(e=this.contexts=[]),e},s.prototype._indexOfContext=function(e){for(var t=this._safeContext(),n=0;t[n];){if(e===t[n][0])return n;n+=1}return-1},s.prototype._memorizeContext=function(e){var t,n;r.isExisty(e)&&(t=this._safeContext(),(n=this._indexOfContext(e))>-1?t[n][1]+=1:t.push([e,1]))},s.prototype._forgetContext=function(e){var t,n;r.isExisty(e)&&(t=this._safeContext(),(n=this._indexOfContext(e))>-1&&(t[n][1]-=1,t[n][1]<=0&&t.splice(n,1)))},s.prototype._bindEvent=function(e,t,n){var i=this._safeEvent(e);this._memorizeContext(n),i.push(this._getHandlerItem(t,n))},s.prototype.on=function(e,t,n){var o=this;r.isString(e)?(e=e.split(a),i.forEach(e,(function(e){o._bindEvent(e,t,n)}))):r.isObject(e)&&(n=t,i.forEach(e,(function(e,t){o.on(t,e,n)})))},s.prototype.once=function(e,t,n){var o=this;if(r.isObject(e))return n=t,void i.forEach(e,(function(e,t){o.once(t,e,n)}));this.on(e,(function i(){t.apply(n,arguments),o.off(e,i,n)}),n)},s.prototype._spliceMatches=function(e,t){var n,i=0;if(r.isArray(e))for(n=e.length;i<n;i+=1)!0===t(e[i])&&(e.splice(i,1),n-=1,i-=1)},s.prototype._matchHandler=function(e){var t=this;return function(n){var i=e===n.handler;return i&&t._forgetContext(n.context),i}},s.prototype._matchContext=function(e){var t=this;return function(n){var i=e===n.context;return i&&t._forgetContext(n.context),i}},s.prototype._matchHandlerAndContext=function(e,t){var n=this;return function(i){var r=e===i.handler,o=t===i.context,a=r&&o;return a&&n._forgetContext(i.context),a}},s.prototype._offByEventName=function(e,t){var n=this,o=i.forEachArray,s=r.isFunction(t),l=n._matchHandler(t);e=e.split(a),o(e,(function(e){var t=n._safeEvent(e);s?n._spliceMatches(t,l):(o(t,(function(e){n._forgetContext(e.context)})),n.events[e]=[])}))},s.prototype._offByHandler=function(e){var t=this,n=this._matchHandler(e);i.forEach(this._safeEvent(),(function(e){t._spliceMatches(e,n)}))},s.prototype._offByObject=function(e,t){var n,o=this;this._indexOfContext(e)<0?i.forEach(e,(function(e,t){o.off(t,e)})):r.isString(t)?(n=this._matchContext(e),o._spliceMatches(this._safeEvent(t),n)):r.isFunction(t)?(n=this._matchHandlerAndContext(t,e),i.forEach(this._safeEvent(),(function(e){o._spliceMatches(e,n)}))):(n=this._matchContext(e),i.forEach(this._safeEvent(),(function(e){o._spliceMatches(e,n)})))},s.prototype.off=function(e,t){r.isString(e)?this._offByEventName(e,t):arguments.length?r.isFunction(e)?this._offByHandler(e):r.isObject(e)&&this._offByObject(e,t):(this.events={},this.contexts=[])},s.prototype.fire=function(e){this.invoke.apply(this,arguments)},s.prototype.invoke=function(e){var t,n,i,r;if(!this.hasListener(e))return!0;for(t=this._safeEvent(e),n=Array.prototype.slice.call(arguments,1),i=0;t[i];){if(!1===(r=t[i]).handler.apply(r.context,n))return!1;i+=1}return!0},s.prototype.hasListener=function(e){return this.getListenerLength(e)>0},s.prototype.getListenerLength=function(e){return this._safeEvent(e).length},e.exports=s},function(e,t,n){"use strict";var i=n(4),r=n(2),o=function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}(),a=0;function s(e){e&&this.set.apply(this,arguments)}s.prototype.set=function(e){var t=this;r.isArray(e)||(e=i.toArray(arguments)),i.forEach(e,(function(e){t._addItem(e)}))},s.prototype.getName=function(e){var t,n=this;return i.forEach(this,(function(i,r){if(n._isEnumItem(r)&&e===i)return t=r,!1})),t},s.prototype._addItem=function(e){var t;this.hasOwnProperty(e)||(t=this._makeEnumValue(),o?Object.defineProperty(this,e,{enumerable:!0,configurable:!1,writable:!1,value:t}):this[e]=t)},s.prototype._makeEnumValue=function(){var e;return e=a,a+=1,e},s.prototype._isEnumItem=function(e){return r.isNumber(this[e])},e.exports=s},function(e,t,n){"use strict";var i=n(4),r=n(19);function o(e){this._map=new r(e),this.size=this._map.size}i.forEachArray(["get","has","forEach","keys","values","entries"],(function(e){o.prototype[e]=function(){return this._map[e].apply(this._map,arguments)}})),i.forEachArray(["delete","clear"],(function(e){o.prototype[e]=function(){var t=this._map[e].apply(this._map,arguments);return this.size=this._map.size,t}})),o.prototype.set=function(){return this._map.set.apply(this._map,arguments),this.size=this._map.size,this},o.prototype.setObject=function(e){i.forEachOwnProperties(e,(function(e,t){this.set(t,e)}),this)},o.prototype.deleteByKeys=function(e){i.forEachArray(e,(function(e){this.delete(e)}),this)},o.prototype.merge=function(e){e.forEach((function(e,t){this.set(t,e)}),this)},o.prototype.filter=function(e){var t=new o;return this.forEach((function(n,i){e(n,i)&&t.set(i,n)})),t},e.exports=o},function(e,t,n){"use strict";var i=n(4),r=n(2),o=n(3),a=n(10),s=n(5),l={},c={};function u(e,t){this._keys=e,this._valueGetter=t,this._length=this._keys.length,this._index=-1,this._done=!1}function h(e){this._valuesForString={},this._valuesForIndex={},this._keys=[],e&&this._setInitData(e),this.size=0}u.prototype.next=function(){var e={};do{this._index+=1}while(r.isUndefined(this._keys[this._index])&&this._index<this._length);return this._index>=this._length?e.done=!0:(e.done=!1,e.value=this._valueGetter(this._keys[this._index],this._index)),e},h.prototype._setInitData=function(e){if(!r.isArray(e))throw new Error("Only Array is supported.");i.forEachArray(e,(function(e){this.set(e[0],e[1])}),this)},h.prototype._isNaN=function(e){return"number"==typeof e&&e!=e},h.prototype._getKeyIndex=function(e){var t,n=-1;return r.isString(e)?(t=this._valuesForString[e])&&(n=t.keyIndex):n=o.inArray(e,this._keys),n},h.prototype._getOriginKey=function(e){var t=e;return e===l?t=void 0:e===c&&(t=NaN),t},h.prototype._getUniqueKey=function(e){var t=e;return r.isUndefined(e)?t=l:this._isNaN(e)&&(t=c),t},h.prototype._getValueObject=function(e,t){return r.isString(e)?this._valuesForString[e]:(r.isUndefined(t)&&(t=this._getKeyIndex(e)),t>=0?this._valuesForIndex[t]:void 0)},h.prototype._getOriginValue=function(e,t){return this._getValueObject(e,t).origin},h.prototype._getKeyValuePair=function(e,t){return[this._getOriginKey(e),this._getOriginValue(e,t)]},h.prototype._createValueObject=function(e,t){return{keyIndex:t,origin:e}},h.prototype.set=function(e,t){var n,i=this._getUniqueKey(e),o=this._getKeyIndex(i);return o<0&&(o=this._keys.push(i)-1,this.size+=1),n=this._createValueObject(t,o),r.isString(e)?this._valuesForString[e]=n:this._valuesForIndex[o]=n,this},h.prototype.get=function(e){var t=this._getUniqueKey(e),n=this._getValueObject(t);return n&&n.origin},h.prototype.keys=function(){return new u(this._keys,s.bind(this._getOriginKey,this))},h.prototype.values=function(){return new u(this._keys,s.bind(this._getOriginValue,this))},h.prototype.entries=function(){return new u(this._keys,s.bind(this._getKeyValuePair,this))},h.prototype.has=function(e){return!!this._getValueObject(e)},h.prototype.delete=function(e){var t;r.isString(e)?this._valuesForString[e]&&(t=this._valuesForString[e].keyIndex,delete this._valuesForString[e]):(t=this._getKeyIndex(e))>=0&&delete this._valuesForIndex[t],t>=0&&(delete this._keys[t],this.size-=1)},h.prototype.forEach=function(e,t){t=t||this,i.forEachArray(this._keys,(function(n){r.isUndefined(n)||e.call(t,this._getValueObject(n).origin,n,this)}),this)},h.prototype.clear=function(){h.call(this)},window.Map&&(a.firefox&&a.version>=37||a.chrome&&a.version>=42)&&(h=window.Map),e.exports=h},function(e,t,n){"use strict";var i=n(4),r=n(2);function o(e){this.length=0,e&&this.setObject(e)}o.prototype.set=function(e,t){2===arguments.length?this.setKeyValue(e,t):this.setObject(e)},o.prototype.setKeyValue=function(e,t){this.has(e)||(this.length+=1),this[this.encodeKey(e)]=t},o.prototype.setObject=function(e){var t=this;i.forEachOwnProperties(e,(function(e,n){t.setKeyValue(n,e)}))},o.prototype.merge=function(e){var t=this;e.each((function(e,n){t.setKeyValue(n,e)}))},o.prototype.encodeKey=function(e){return"å"+e},o.prototype.decodeKey=function(e){var t=e.split("å");return t[t.length-1]},o.prototype.get=function(e){return this[this.encodeKey(e)]},o.prototype.has=function(e){return this.hasOwnProperty(this.encodeKey(e))},o.prototype.remove=function(e){return arguments.length>1&&(e=i.toArray(arguments)),r.isArray(e)?this.removeByKeyArray(e):this.removeByKey(e)},o.prototype.removeByKey=function(e){var t=this.has(e)?this.get(e):null;return null!==t&&(delete this[this.encodeKey(e)],this.length-=1),t},o.prototype.removeByKeyArray=function(e){var t=[],n=this;return i.forEach(e,(function(e){t.push(n.removeByKey(e))})),t},o.prototype.removeAll=function(){var e=this;this.each((function(t,n){e.remove(n)}))},o.prototype.each=function(e){var t,n=this;i.forEachOwnProperties(this,(function(i,r){if("å"===r.charAt(0)&&(t=e(i,n.decodeKey(r))),!1===t)return t}))},o.prototype.keys=function(){var e=[],t=this;return this.each((function(n,i){e.push(t.decodeKey(i))})),e},o.prototype.find=function(e){var t=[];return this.each((function(n,i){e(n,i)&&t.push(n)})),t},o.prototype.toArray=function(){var e=[];return this.each((function(t){e.push(t)})),e},e.exports=o}])},e.exports=i()},50:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}});